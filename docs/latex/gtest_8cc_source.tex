\doxysection{gtest.\+cc}
\hypertarget{gtest_8cc_source}{}\label{gtest_8cc_source}\index{/Users/yjack/GitHub/SimEvo/build/\_deps/googletest-\/src/googletest/src/gtest.cc@{/Users/yjack/GitHub/SimEvo/build/\_deps/googletest-\/src/googletest/src/gtest.cc}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Copyright\ 2005,\ Google\ Inc.}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ All\ rights\ reserved.}}
\DoxyCodeLine{00003\ \textcolor{comment}{//}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ Redistribution\ and\ use\ in\ source\ and\ binary\ forms,\ with\ or\ without}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ modification,\ are\ permitted\ provided\ that\ the\ following\ conditions\ are}}
\DoxyCodeLine{00006\ \textcolor{comment}{//\ met:}}
\DoxyCodeLine{00007\ \textcolor{comment}{//}}
\DoxyCodeLine{00008\ \textcolor{comment}{//\ \ \ \ \ *\ Redistributions\ of\ source\ code\ must\ retain\ the\ above\ copyright}}
\DoxyCodeLine{00009\ \textcolor{comment}{//\ notice,\ this\ list\ of\ conditions\ and\ the\ following\ disclaimer.}}
\DoxyCodeLine{00010\ \textcolor{comment}{//\ \ \ \ \ *\ Redistributions\ in\ binary\ form\ must\ reproduce\ the\ above}}
\DoxyCodeLine{00011\ \textcolor{comment}{//\ copyright\ notice,\ this\ list\ of\ conditions\ and\ the\ following\ disclaimer}}
\DoxyCodeLine{00012\ \textcolor{comment}{//\ in\ the\ documentation\ and/or\ other\ materials\ provided\ with\ the}}
\DoxyCodeLine{00013\ \textcolor{comment}{//\ distribution.}}
\DoxyCodeLine{00014\ \textcolor{comment}{//\ \ \ \ \ *\ Neither\ the\ name\ of\ Google\ Inc.\ nor\ the\ names\ of\ its}}
\DoxyCodeLine{00015\ \textcolor{comment}{//\ contributors\ may\ be\ used\ to\ endorse\ or\ promote\ products\ derived\ from}}
\DoxyCodeLine{00016\ \textcolor{comment}{//\ this\ software\ without\ specific\ prior\ written\ permission.}}
\DoxyCodeLine{00017\ \textcolor{comment}{//}}
\DoxyCodeLine{00018\ \textcolor{comment}{//\ THIS\ SOFTWARE\ IS\ PROVIDED\ BY\ THE\ COPYRIGHT\ HOLDERS\ AND\ CONTRIBUTORS}}
\DoxyCodeLine{00019\ \textcolor{comment}{//\ "{}AS\ IS"{}\ AND\ ANY\ EXPRESS\ OR\ IMPLIED\ WARRANTIES,\ INCLUDING,\ BUT\ NOT}}
\DoxyCodeLine{00020\ \textcolor{comment}{//\ LIMITED\ TO,\ THE\ IMPLIED\ WARRANTIES\ OF\ MERCHANTABILITY\ AND\ FITNESS\ FOR}}
\DoxyCodeLine{00021\ \textcolor{comment}{//\ A\ PARTICULAR\ PURPOSE\ ARE\ DISCLAIMED.\ IN\ NO\ EVENT\ SHALL\ THE\ COPYRIGHT}}
\DoxyCodeLine{00022\ \textcolor{comment}{//\ OWNER\ OR\ CONTRIBUTORS\ BE\ LIABLE\ FOR\ ANY\ DIRECT,\ INDIRECT,\ INCIDENTAL,}}
\DoxyCodeLine{00023\ \textcolor{comment}{//\ SPECIAL,\ EXEMPLARY,\ OR\ CONSEQUENTIAL\ DAMAGES\ (INCLUDING,\ BUT\ NOT}}
\DoxyCodeLine{00024\ \textcolor{comment}{//\ LIMITED\ TO,\ PROCUREMENT\ OF\ SUBSTITUTE\ GOODS\ OR\ SERVICES;\ LOSS\ OF\ USE,}}
\DoxyCodeLine{00025\ \textcolor{comment}{//\ DATA,\ OR\ PROFITS;\ OR\ BUSINESS\ INTERRUPTION)\ HOWEVER\ CAUSED\ AND\ ON\ ANY}}
\DoxyCodeLine{00026\ \textcolor{comment}{//\ THEORY\ OF\ LIABILITY,\ WHETHER\ IN\ CONTRACT,\ STRICT\ LIABILITY,\ OR\ TORT}}
\DoxyCodeLine{00027\ \textcolor{comment}{//\ (INCLUDING\ NEGLIGENCE\ OR\ OTHERWISE)\ ARISING\ IN\ ANY\ WAY\ OUT\ OF\ THE\ USE}}
\DoxyCodeLine{00028\ \textcolor{comment}{//\ OF\ THIS\ SOFTWARE,\ EVEN\ IF\ ADVISED\ OF\ THE\ POSSIBILITY\ OF\ SUCH\ DAMAGE.}}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00030\ \textcolor{comment}{//}}
\DoxyCodeLine{00031\ \textcolor{comment}{//\ The\ Google\ C++\ Testing\ and\ Mocking\ Framework\ (Google\ Test)}}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00033\ \textcolor{preprocessor}{\#include\ "{}gtest/gtest.h"{}}}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00035\ \textcolor{preprocessor}{\#include\ <ctype.h>}}
\DoxyCodeLine{00036\ \textcolor{preprocessor}{\#include\ <stdarg.h>}}
\DoxyCodeLine{00037\ \textcolor{preprocessor}{\#include\ <stdio.h>}}
\DoxyCodeLine{00038\ \textcolor{preprocessor}{\#include\ <stdlib.h>}}
\DoxyCodeLine{00039\ \textcolor{preprocessor}{\#include\ <time.h>}}
\DoxyCodeLine{00040\ \textcolor{preprocessor}{\#include\ <wchar.h>}}
\DoxyCodeLine{00041\ \textcolor{preprocessor}{\#include\ <wctype.h>}}
\DoxyCodeLine{00042\ }
\DoxyCodeLine{00043\ \textcolor{preprocessor}{\#include\ <algorithm>}}
\DoxyCodeLine{00044\ \textcolor{preprocessor}{\#include\ <chrono>}\ \ \textcolor{comment}{//\ NOLINT}}
\DoxyCodeLine{00045\ \textcolor{preprocessor}{\#include\ <cmath>}}
\DoxyCodeLine{00046\ \textcolor{preprocessor}{\#include\ <cstdint>}}
\DoxyCodeLine{00047\ \textcolor{preprocessor}{\#include\ <initializer\_list>}}
\DoxyCodeLine{00048\ \textcolor{preprocessor}{\#include\ <iomanip>}}
\DoxyCodeLine{00049\ \textcolor{preprocessor}{\#include\ <iterator>}}
\DoxyCodeLine{00050\ \textcolor{preprocessor}{\#include\ <limits>}}
\DoxyCodeLine{00051\ \textcolor{preprocessor}{\#include\ <list>}}
\DoxyCodeLine{00052\ \textcolor{preprocessor}{\#include\ <map>}}
\DoxyCodeLine{00053\ \textcolor{preprocessor}{\#include\ <ostream>}\ \ \textcolor{comment}{//\ NOLINT}}
\DoxyCodeLine{00054\ \textcolor{preprocessor}{\#include\ <sstream>}}
\DoxyCodeLine{00055\ \textcolor{preprocessor}{\#include\ <unordered\_set>}}
\DoxyCodeLine{00056\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00057\ }
\DoxyCodeLine{00058\ \textcolor{preprocessor}{\#include\ "{}gtest/gtest-\/assertion-\/result.h"{}}}
\DoxyCodeLine{00059\ \textcolor{preprocessor}{\#include\ "{}gtest/gtest-\/spi.h"{}}}
\DoxyCodeLine{00060\ \textcolor{preprocessor}{\#include\ "{}gtest/internal/custom/gtest.h"{}}}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ \textcolor{preprocessor}{\#if\ GTEST\_OS\_LINUX}}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00064\ \textcolor{preprocessor}{\#include\ <fcntl.h>}\ \ \ \textcolor{comment}{//\ NOLINT}}
\DoxyCodeLine{00065\ \textcolor{preprocessor}{\#include\ <limits.h>}\ \ \textcolor{comment}{//\ NOLINT}}
\DoxyCodeLine{00066\ \textcolor{preprocessor}{\#include\ <sched.h>}\ \ \ \textcolor{comment}{//\ NOLINT}}
\DoxyCodeLine{00067\ \textcolor{comment}{//\ Declares\ vsnprintf().\ \ This\ header\ is\ not\ available\ on\ Windows.}}
\DoxyCodeLine{00068\ \textcolor{preprocessor}{\#include\ <strings.h>}\ \ \ \textcolor{comment}{//\ NOLINT}}
\DoxyCodeLine{00069\ \textcolor{preprocessor}{\#include\ <sys/mman.h>}\ \ \textcolor{comment}{//\ NOLINT}}
\DoxyCodeLine{00070\ \textcolor{preprocessor}{\#include\ <sys/time.h>}\ \ \textcolor{comment}{//\ NOLINT}}
\DoxyCodeLine{00071\ \textcolor{preprocessor}{\#include\ <unistd.h>}\ \ \ \ \textcolor{comment}{//\ NOLINT}}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \textcolor{preprocessor}{\#include\ <string>}}
\DoxyCodeLine{00074\ }
\DoxyCodeLine{00075\ \textcolor{preprocessor}{\#elif\ GTEST\_OS\_ZOS}}
\DoxyCodeLine{00076\ \textcolor{preprocessor}{\#include\ <sys/time.h>}\ \ \textcolor{comment}{//\ NOLINT}}
\DoxyCodeLine{00077\ }
\DoxyCodeLine{00078\ \textcolor{comment}{//\ On\ z/OS\ we\ additionally\ need\ strings.h\ for\ strcasecmp.}}
\DoxyCodeLine{00079\ \textcolor{preprocessor}{\#include\ <strings.h>}\ \ \ \textcolor{comment}{//\ NOLINT}}
\DoxyCodeLine{00080\ }
\DoxyCodeLine{00081\ \textcolor{preprocessor}{\#elif\ GTEST\_OS\_WINDOWS\_MOBILE\ \ }\textcolor{comment}{//\ We\ are\ on\ Windows\ CE.}}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00083\ \textcolor{preprocessor}{\#include\ <windows.h>}\ \ \textcolor{comment}{//\ NOLINT}}
\DoxyCodeLine{00084\ \textcolor{preprocessor}{\#undef\ min}}
\DoxyCodeLine{00085\ }
\DoxyCodeLine{00086\ \textcolor{preprocessor}{\#elif\ GTEST\_OS\_WINDOWS\ \ }\textcolor{comment}{//\ We\ are\ on\ Windows\ proper.}}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00088\ \textcolor{preprocessor}{\#include\ <windows.h>}\ \ \textcolor{comment}{//\ NOLINT}}
\DoxyCodeLine{00089\ \textcolor{preprocessor}{\#undef\ min}}
\DoxyCodeLine{00090\ }
\DoxyCodeLine{00091\ \textcolor{preprocessor}{\#ifdef\ \_MSC\_VER}}
\DoxyCodeLine{00092\ \textcolor{preprocessor}{\#include\ <crtdbg.h>}\ \ \textcolor{comment}{//\ NOLINT}}
\DoxyCodeLine{00093\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00095\ \textcolor{preprocessor}{\#include\ <io.h>}\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ NOLINT}}
\DoxyCodeLine{00096\ \textcolor{preprocessor}{\#include\ <sys/stat.h>}\ \ \ \textcolor{comment}{//\ NOLINT}}
\DoxyCodeLine{00097\ \textcolor{preprocessor}{\#include\ <sys/timeb.h>}\ \ \textcolor{comment}{//\ NOLINT}}
\DoxyCodeLine{00098\ \textcolor{preprocessor}{\#include\ <sys/types.h>}\ \ \textcolor{comment}{//\ NOLINT}}
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00100\ \textcolor{preprocessor}{\#if\ GTEST\_OS\_WINDOWS\_MINGW}}
\DoxyCodeLine{00101\ \textcolor{preprocessor}{\#include\ <sys/time.h>}\ \ \textcolor{comment}{//\ NOLINT}}
\DoxyCodeLine{00102\ \textcolor{preprocessor}{\#endif\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }\textcolor{comment}{//\ GTEST\_OS\_WINDOWS\_MINGW}}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00104\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00106\ \textcolor{comment}{//\ cpplint\ thinks\ that\ the\ header\ is\ already\ included,\ so\ we\ want\ to}}
\DoxyCodeLine{00107\ \textcolor{comment}{//\ silence\ it.}}
\DoxyCodeLine{00108\ \textcolor{preprocessor}{\#include\ <sys/time.h>}\ \ \textcolor{comment}{//\ NOLINT}}
\DoxyCodeLine{00109\ \textcolor{preprocessor}{\#include\ <unistd.h>}\ \ \ \ \textcolor{comment}{//\ NOLINT}}
\DoxyCodeLine{00110\ }
\DoxyCodeLine{00111\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GTEST\_OS\_LINUX}}
\DoxyCodeLine{00112\ }
\DoxyCodeLine{00113\ \textcolor{preprocessor}{\#if\ GTEST\_HAS\_EXCEPTIONS}}
\DoxyCodeLine{00114\ \textcolor{preprocessor}{\#include\ <stdexcept>}}
\DoxyCodeLine{00115\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00116\ }
\DoxyCodeLine{00117\ \textcolor{preprocessor}{\#if\ GTEST\_CAN\_STREAM\_RESULTS\_}}
\DoxyCodeLine{00118\ \textcolor{preprocessor}{\#include\ <arpa/inet.h>}\ \ \ \textcolor{comment}{//\ NOLINT}}
\DoxyCodeLine{00119\ \textcolor{preprocessor}{\#include\ <netdb.h>}\ \ \ \ \ \ \ \textcolor{comment}{//\ NOLINT}}
\DoxyCodeLine{00120\ \textcolor{preprocessor}{\#include\ <sys/socket.h>}\ \ \textcolor{comment}{//\ NOLINT}}
\DoxyCodeLine{00121\ \textcolor{preprocessor}{\#include\ <sys/types.h>}\ \ \ \textcolor{comment}{//\ NOLINT}}
\DoxyCodeLine{00122\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00123\ }
\DoxyCodeLine{00124\ \textcolor{preprocessor}{\#include\ "{}src/gtest-\/internal-\/inl.h"{}}}
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00126\ \textcolor{preprocessor}{\#if\ GTEST\_OS\_WINDOWS}}
\DoxyCodeLine{00127\ \textcolor{preprocessor}{\#define\ vsnprintf\ \_vsnprintf}}
\DoxyCodeLine{00128\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GTEST\_OS\_WINDOWS}}
\DoxyCodeLine{00129\ }
\DoxyCodeLine{00130\ \textcolor{preprocessor}{\#if\ GTEST\_OS\_MAC}}
\DoxyCodeLine{00131\ \textcolor{preprocessor}{\#ifndef\ GTEST\_OS\_IOS}}
\DoxyCodeLine{00132\ \textcolor{preprocessor}{\#include\ <crt\_externs.h>}}
\DoxyCodeLine{00133\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00134\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00135\ }
\DoxyCodeLine{00136\ \textcolor{preprocessor}{\#if\ GTEST\_HAS\_ABSL}}
\DoxyCodeLine{00137\ \textcolor{preprocessor}{\#include\ "{}absl/debugging/failure\_signal\_handler.h"{}}}
\DoxyCodeLine{00138\ \textcolor{preprocessor}{\#include\ "{}absl/debugging/stacktrace.h"{}}}
\DoxyCodeLine{00139\ \textcolor{preprocessor}{\#include\ "{}absl/debugging/symbolize.h"{}}}
\DoxyCodeLine{00140\ \textcolor{preprocessor}{\#include\ "{}absl/flags/parse.h"{}}}
\DoxyCodeLine{00141\ \textcolor{preprocessor}{\#include\ "{}absl/flags/usage.h"{}}}
\DoxyCodeLine{00142\ \textcolor{preprocessor}{\#include\ "{}absl/strings/str\_cat.h"{}}}
\DoxyCodeLine{00143\ \textcolor{preprocessor}{\#include\ "{}absl/strings/str\_replace.h"{}}}
\DoxyCodeLine{00144\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GTEST\_HAS\_ABSL}}
\DoxyCodeLine{00145\ }
\DoxyCodeLine{00146\ \textcolor{comment}{//\ Checks\ builtin\ compiler\ feature\ |x|\ while\ avoiding\ an\ extra\ layer\ of\ \#ifdefs}}
\DoxyCodeLine{00147\ \textcolor{comment}{//\ at\ the\ callsite.}}
\DoxyCodeLine{00148\ \textcolor{preprocessor}{\#if\ defined(\_\_has\_builtin)}}
\DoxyCodeLine{00149\ \textcolor{preprocessor}{\#define\ GTEST\_HAS\_BUILTIN(x)\ \_\_has\_builtin(x)}}
\DoxyCodeLine{00150\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00151\ \textcolor{preprocessor}{\#define\ GTEST\_HAS\_BUILTIN(x)\ 0}}
\DoxyCodeLine{00152\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ defined(\_\_has\_builtin)}}
\DoxyCodeLine{00153\ }
\DoxyCodeLine{00154\ \textcolor{keyword}{namespace\ }testing\ \{}
\DoxyCodeLine{00155\ }
\DoxyCodeLine{00156\ \textcolor{keyword}{using\ }internal::CountIf;}
\DoxyCodeLine{00157\ \textcolor{keyword}{using\ }internal::ForEach;}
\DoxyCodeLine{00158\ \textcolor{keyword}{using\ }internal::GetElementOr;}
\DoxyCodeLine{00159\ \textcolor{keyword}{using\ }internal::Shuffle;}
\DoxyCodeLine{00160\ }
\DoxyCodeLine{00161\ \textcolor{comment}{//\ Constants.}}
\DoxyCodeLine{00162\ }
\DoxyCodeLine{00163\ \textcolor{comment}{//\ A\ test\ whose\ test\ suite\ name\ or\ test\ name\ matches\ this\ filter\ is}}
\DoxyCodeLine{00164\ \textcolor{comment}{//\ disabled\ and\ not\ run.}}
\DoxyCodeLine{00165\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ kDisableTestFilter[]\ =\ \textcolor{stringliteral}{"{}DISABLED\_*:*/DISABLED\_*"{}};}
\DoxyCodeLine{00166\ }
\DoxyCodeLine{00167\ \textcolor{comment}{//\ A\ test\ suite\ whose\ name\ matches\ this\ filter\ is\ considered\ a\ death}}
\DoxyCodeLine{00168\ \textcolor{comment}{//\ test\ suite\ and\ will\ be\ run\ before\ test\ suites\ whose\ name\ doesn't}}
\DoxyCodeLine{00169\ \textcolor{comment}{//\ match\ this\ filter.}}
\DoxyCodeLine{00170\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ kDeathTestSuiteFilter[]\ =\ \textcolor{stringliteral}{"{}*DeathTest:*DeathTest/*"{}};}
\DoxyCodeLine{00171\ }
\DoxyCodeLine{00172\ \textcolor{comment}{//\ A\ test\ filter\ that\ matches\ everything.}}
\DoxyCodeLine{00173\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ kUniversalFilter[]\ =\ \textcolor{stringliteral}{"{}*"{}};}
\DoxyCodeLine{00174\ }
\DoxyCodeLine{00175\ \textcolor{comment}{//\ The\ default\ output\ format.}}
\DoxyCodeLine{00176\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ kDefaultOutputFormat[]\ =\ \textcolor{stringliteral}{"{}xml"{}};}
\DoxyCodeLine{00177\ \textcolor{comment}{//\ The\ default\ output\ file.}}
\DoxyCodeLine{00178\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ kDefaultOutputFile[]\ =\ \textcolor{stringliteral}{"{}test\_detail"{}};}
\DoxyCodeLine{00179\ }
\DoxyCodeLine{00180\ \textcolor{comment}{//\ The\ environment\ variable\ name\ for\ the\ test\ shard\ index.}}
\DoxyCodeLine{00181\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ kTestShardIndex[]\ =\ \textcolor{stringliteral}{"{}GTEST\_SHARD\_INDEX"{}};}
\DoxyCodeLine{00182\ \textcolor{comment}{//\ The\ environment\ variable\ name\ for\ the\ total\ number\ of\ test\ shards.}}
\DoxyCodeLine{00183\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ kTestTotalShards[]\ =\ \textcolor{stringliteral}{"{}GTEST\_TOTAL\_SHARDS"{}};}
\DoxyCodeLine{00184\ \textcolor{comment}{//\ The\ environment\ variable\ name\ for\ the\ test\ shard\ status\ file.}}
\DoxyCodeLine{00185\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ kTestShardStatusFile[]\ =\ \textcolor{stringliteral}{"{}GTEST\_SHARD\_STATUS\_FILE"{}};}
\DoxyCodeLine{00186\ }
\DoxyCodeLine{00187\ \textcolor{keyword}{namespace\ }internal\ \{}
\DoxyCodeLine{00188\ }
\DoxyCodeLine{00189\ \textcolor{comment}{//\ The\ text\ used\ in\ failure\ messages\ to\ indicate\ the\ start\ of\ the}}
\DoxyCodeLine{00190\ \textcolor{comment}{//\ stack\ trace.}}
\DoxyCodeLine{00191\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ kStackTraceMarker[]\ =\ \textcolor{stringliteral}{"{}\(\backslash\)nStack\ trace:\(\backslash\)n"{}};}
\DoxyCodeLine{00192\ }
\DoxyCodeLine{00193\ \textcolor{comment}{//\ g\_help\_flag\ is\ true\ if\ and\ only\ if\ the\ -\/-\/help\ flag\ or\ an\ equivalent\ form}}
\DoxyCodeLine{00194\ \textcolor{comment}{//\ is\ specified\ on\ the\ command\ line.}}
\DoxyCodeLine{00195\ \textcolor{keywordtype}{bool}\ g\_help\_flag\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00196\ }
\DoxyCodeLine{00197\ \textcolor{comment}{//\ Utility\ function\ to\ Open\ File\ for\ Writing}}
\DoxyCodeLine{00198\ \textcolor{keyword}{static}\ FILE*\ OpenFileForWriting(\textcolor{keyword}{const}\ std::string\&\ output\_file)\ \{}
\DoxyCodeLine{00199\ \ \ FILE*\ fileout\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00200\ \ \ FilePath\ output\_file\_path(output\_file);}
\DoxyCodeLine{00201\ \ \ FilePath\ output\_dir(output\_file\_path.RemoveFileName());}
\DoxyCodeLine{00202\ }
\DoxyCodeLine{00203\ \ \ \textcolor{keywordflow}{if}\ (output\_dir.CreateDirectoriesRecursively())\ \{}
\DoxyCodeLine{00204\ \ \ \ \ fileout\ =\ posix::FOpen(output\_file.c\_str(),\ \textcolor{stringliteral}{"{}w"{}});}
\DoxyCodeLine{00205\ \ \ \}}
\DoxyCodeLine{00206\ \ \ \textcolor{keywordflow}{if}\ (fileout\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00207\ \ \ \ \ GTEST\_LOG\_(FATAL)\ <<\ \textcolor{stringliteral}{"{}Unable\ to\ open\ file\ \(\backslash\)"{}"{}}\ <<\ output\_file\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}"{}};}
\DoxyCodeLine{00208\ \ \ \}}
\DoxyCodeLine{00209\ \ \ \textcolor{keywordflow}{return}\ fileout;}
\DoxyCodeLine{00210\ \}}
\DoxyCodeLine{00211\ }
\DoxyCodeLine{00212\ \}\ \ \textcolor{comment}{//\ namespace\ internal}}
\DoxyCodeLine{00213\ }
\DoxyCodeLine{00214\ \textcolor{comment}{//\ Bazel\ passes\ in\ the\ argument\ to\ '-\/-\/test\_filter'\ via\ the\ TESTBRIDGE\_TEST\_ONLY}}
\DoxyCodeLine{00215\ \textcolor{comment}{//\ environment\ variable.}}
\DoxyCodeLine{00216\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ GetDefaultFilter()\ \{}
\DoxyCodeLine{00217\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \textcolor{keyword}{const}\ testbridge\_test\_only\ =}
\DoxyCodeLine{00218\ \ \ \ \ \ \ internal::posix::GetEnv(\textcolor{stringliteral}{"{}TESTBRIDGE\_TEST\_ONLY"{}});}
\DoxyCodeLine{00219\ \ \ \textcolor{keywordflow}{if}\ (testbridge\_test\_only\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00220\ \ \ \ \ \textcolor{keywordflow}{return}\ testbridge\_test\_only;}
\DoxyCodeLine{00221\ \ \ \}}
\DoxyCodeLine{00222\ \ \ \textcolor{keywordflow}{return}\ kUniversalFilter;}
\DoxyCodeLine{00223\ \}}
\DoxyCodeLine{00224\ }
\DoxyCodeLine{00225\ \textcolor{comment}{//\ Bazel\ passes\ in\ the\ argument\ to\ '-\/-\/test\_runner\_fail\_fast'\ via\ the}}
\DoxyCodeLine{00226\ \textcolor{comment}{//\ TESTBRIDGE\_TEST\_RUNNER\_FAIL\_FAST\ environment\ variable.}}
\DoxyCodeLine{00227\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ GetDefaultFailFast()\ \{}
\DoxyCodeLine{00228\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \textcolor{keyword}{const}\ testbridge\_test\_runner\_fail\_fast\ =}
\DoxyCodeLine{00229\ \ \ \ \ \ \ internal::posix::GetEnv(\textcolor{stringliteral}{"{}TESTBRIDGE\_TEST\_RUNNER\_FAIL\_FAST"{}});}
\DoxyCodeLine{00230\ \ \ \textcolor{keywordflow}{if}\ (testbridge\_test\_runner\_fail\_fast\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00231\ \ \ \ \ \textcolor{keywordflow}{return}\ strcmp(testbridge\_test\_runner\_fail\_fast,\ \textcolor{stringliteral}{"{}1"{}})\ ==\ 0;}
\DoxyCodeLine{00232\ \ \ \}}
\DoxyCodeLine{00233\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00234\ \}}
\DoxyCodeLine{00235\ }
\DoxyCodeLine{00236\ \}\ \ \textcolor{comment}{//\ namespace\ testing}}
\DoxyCodeLine{00237\ }
\DoxyCodeLine{00238\ GTEST\_DEFINE\_bool\_(}
\DoxyCodeLine{00239\ \ \ \ \ fail\_fast,}
\DoxyCodeLine{00240\ \ \ \ \ testing::internal::BoolFromGTestEnv(\textcolor{stringliteral}{"{}fail\_fast"{}},}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ testing::GetDefaultFailFast()),}
\DoxyCodeLine{00242\ \ \ \ \ \textcolor{stringliteral}{"{}True\ if\ and\ only\ if\ a\ test\ failure\ should\ stop\ further\ test\ execution."{}});}
\DoxyCodeLine{00243\ }
\DoxyCodeLine{00244\ GTEST\_DEFINE\_bool\_(}
\DoxyCodeLine{00245\ \ \ \ \ also\_run\_disabled\_tests,}
\DoxyCodeLine{00246\ \ \ \ \ testing::internal::BoolFromGTestEnv(\textcolor{stringliteral}{"{}also\_run\_disabled\_tests"{}},\ \textcolor{keyword}{false}),}
\DoxyCodeLine{00247\ \ \ \ \ \textcolor{stringliteral}{"{}Run\ disabled\ tests\ too,\ in\ addition\ to\ the\ tests\ normally\ being\ run."{}});}
\DoxyCodeLine{00248\ }
\DoxyCodeLine{00249\ GTEST\_DEFINE\_bool\_(}
\DoxyCodeLine{00250\ \ \ \ \ break\_on\_failure,}
\DoxyCodeLine{00251\ \ \ \ \ testing::internal::BoolFromGTestEnv(\textcolor{stringliteral}{"{}break\_on\_failure"{}},\ \textcolor{keyword}{false}),}
\DoxyCodeLine{00252\ \ \ \ \ \textcolor{stringliteral}{"{}True\ if\ and\ only\ if\ a\ failed\ assertion\ should\ be\ a\ debugger\ "{}}}
\DoxyCodeLine{00253\ \ \ \ \ \textcolor{stringliteral}{"{}break-\/point."{}});}
\DoxyCodeLine{00254\ }
\DoxyCodeLine{00255\ GTEST\_DEFINE\_bool\_(catch\_exceptions,}
\DoxyCodeLine{00256\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ testing::internal::BoolFromGTestEnv(\textcolor{stringliteral}{"{}catch\_exceptions"{}},}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{true}),}
\DoxyCodeLine{00258\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}True\ if\ and\ only\ if\ "{}}\ GTEST\_NAME\_}
\DoxyCodeLine{00259\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ should\ catch\ exceptions\ and\ treat\ them\ as\ test\ failures."{}});}
\DoxyCodeLine{00260\ }
\DoxyCodeLine{00261\ GTEST\_DEFINE\_string\_(}
\DoxyCodeLine{00262\ \ \ \ \ color,\ testing::internal::StringFromGTestEnv(\textcolor{stringliteral}{"{}color"{}},\ \textcolor{stringliteral}{"{}auto"{}}),}
\DoxyCodeLine{00263\ \ \ \ \ \textcolor{stringliteral}{"{}Whether\ to\ use\ colors\ in\ the\ output.\ \ Valid\ values:\ yes,\ no,\ "{}}}
\DoxyCodeLine{00264\ \ \ \ \ \textcolor{stringliteral}{"{}and\ auto.\ \ 'auto'\ means\ to\ use\ colors\ if\ the\ output\ is\ "{}}}
\DoxyCodeLine{00265\ \ \ \ \ \textcolor{stringliteral}{"{}being\ sent\ to\ a\ terminal\ and\ the\ TERM\ environment\ variable\ "{}}}
\DoxyCodeLine{00266\ \ \ \ \ \textcolor{stringliteral}{"{}is\ set\ to\ a\ terminal\ type\ that\ supports\ colors."{}});}
\DoxyCodeLine{00267\ }
\DoxyCodeLine{00268\ GTEST\_DEFINE\_string\_(}
\DoxyCodeLine{00269\ \ \ \ \ filter,}
\DoxyCodeLine{00270\ \ \ \ \ testing::internal::StringFromGTestEnv(\textcolor{stringliteral}{"{}filter"{}},}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ testing::GetDefaultFilter()),}
\DoxyCodeLine{00272\ \ \ \ \ \textcolor{stringliteral}{"{}A\ colon-\/separated\ list\ of\ glob\ (not\ regex)\ patterns\ "{}}}
\DoxyCodeLine{00273\ \ \ \ \ \textcolor{stringliteral}{"{}for\ filtering\ the\ tests\ to\ run,\ optionally\ followed\ by\ a\ "{}}}
\DoxyCodeLine{00274\ \ \ \ \ \textcolor{stringliteral}{"{}'-\/'\ and\ a\ :\ separated\ list\ of\ negative\ patterns\ (tests\ to\ "{}}}
\DoxyCodeLine{00275\ \ \ \ \ \textcolor{stringliteral}{"{}exclude).\ \ A\ test\ is\ run\ if\ it\ matches\ one\ of\ the\ positive\ "{}}}
\DoxyCodeLine{00276\ \ \ \ \ \textcolor{stringliteral}{"{}patterns\ and\ does\ not\ match\ any\ of\ the\ negative\ patterns."{}});}
\DoxyCodeLine{00277\ }
\DoxyCodeLine{00278\ GTEST\_DEFINE\_bool\_(}
\DoxyCodeLine{00279\ \ \ \ \ install\_failure\_signal\_handler,}
\DoxyCodeLine{00280\ \ \ \ \ testing::internal::BoolFromGTestEnv(\textcolor{stringliteral}{"{}install\_failure\_signal\_handler"{}},}
\DoxyCodeLine{00281\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{false}),}
\DoxyCodeLine{00282\ \ \ \ \ \textcolor{stringliteral}{"{}If\ true\ and\ supported\ on\ the\ current\ platform,\ "{}}\ GTEST\_NAME\_}
\DoxyCodeLine{00283\ \ \ \ \ \textcolor{stringliteral}{"{}\ should\ "{}}}
\DoxyCodeLine{00284\ \ \ \ \ \textcolor{stringliteral}{"{}install\ a\ signal\ handler\ that\ dumps\ debugging\ information\ when\ fatal\ "{}}}
\DoxyCodeLine{00285\ \ \ \ \ \textcolor{stringliteral}{"{}signals\ are\ raised."{}});}
\DoxyCodeLine{00286\ }
\DoxyCodeLine{00287\ GTEST\_DEFINE\_bool\_(list\_tests,\ \textcolor{keyword}{false},\ \textcolor{stringliteral}{"{}List\ all\ tests\ without\ running\ them."{}});}
\DoxyCodeLine{00288\ }
\DoxyCodeLine{00289\ \textcolor{comment}{//\ The\ net\ priority\ order\ after\ flag\ processing\ is\ thus:}}
\DoxyCodeLine{00290\ \textcolor{comment}{//\ \ \ -\/-\/gtest\_output\ command\ line\ flag}}
\DoxyCodeLine{00291\ \textcolor{comment}{//\ \ \ GTEST\_OUTPUT\ environment\ variable}}
\DoxyCodeLine{00292\ \textcolor{comment}{//\ \ \ XML\_OUTPUT\_FILE\ environment\ variable}}
\DoxyCodeLine{00293\ \textcolor{comment}{//\ \ \ ''}}
\DoxyCodeLine{00294\ GTEST\_DEFINE\_string\_(}
\DoxyCodeLine{00295\ \ \ \ \ output,}
\DoxyCodeLine{00296\ \ \ \ \ testing::internal::StringFromGTestEnv(}
\DoxyCodeLine{00297\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}output"{}},\ testing::internal::OutputFlagAlsoCheckEnvVar().c\_str()),}
\DoxyCodeLine{00298\ \ \ \ \ \textcolor{stringliteral}{"{}A\ format\ (defaults\ to\ \(\backslash\)"{}xml\(\backslash\)"{}\ but\ can\ be\ specified\ to\ be\ \(\backslash\)"{}json\(\backslash\)"{}),\ "{}}}
\DoxyCodeLine{00299\ \ \ \ \ \textcolor{stringliteral}{"{}optionally\ followed\ by\ a\ colon\ and\ an\ output\ file\ name\ or\ directory.\ "{}}}
\DoxyCodeLine{00300\ \ \ \ \ \textcolor{stringliteral}{"{}A\ directory\ is\ indicated\ by\ a\ trailing\ pathname\ separator.\ "{}}}
\DoxyCodeLine{00301\ \ \ \ \ \textcolor{stringliteral}{"{}Examples:\ \(\backslash\)"{}xml:filename.xml\(\backslash\)"{},\ \(\backslash\)"{}xml::directoryname/\(\backslash\)"{}.\ "{}}}
\DoxyCodeLine{00302\ \ \ \ \ \textcolor{stringliteral}{"{}If\ a\ directory\ is\ specified,\ output\ files\ will\ be\ created\ "{}}}
\DoxyCodeLine{00303\ \ \ \ \ \textcolor{stringliteral}{"{}within\ that\ directory,\ with\ file-\/names\ based\ on\ the\ test\ "{}}}
\DoxyCodeLine{00304\ \ \ \ \ \textcolor{stringliteral}{"{}executable's\ name\ and,\ if\ necessary,\ made\ unique\ by\ adding\ "{}}}
\DoxyCodeLine{00305\ \ \ \ \ \textcolor{stringliteral}{"{}digits."{}});}
\DoxyCodeLine{00306\ }
\DoxyCodeLine{00307\ GTEST\_DEFINE\_bool\_(}
\DoxyCodeLine{00308\ \ \ \ \ brief,\ testing::internal::BoolFromGTestEnv(\textcolor{stringliteral}{"{}brief"{}},\ \textcolor{keyword}{false}),}
\DoxyCodeLine{00309\ \ \ \ \ \textcolor{stringliteral}{"{}True\ if\ only\ test\ failures\ should\ be\ displayed\ in\ text\ output."{}});}
\DoxyCodeLine{00310\ }
\DoxyCodeLine{00311\ GTEST\_DEFINE\_bool\_(print\_time,}
\DoxyCodeLine{00312\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ testing::internal::BoolFromGTestEnv(\textcolor{stringliteral}{"{}print\_time"{}},\ \textcolor{keyword}{true}),}
\DoxyCodeLine{00313\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}True\ if\ and\ only\ if\ "{}}\ GTEST\_NAME\_}
\DoxyCodeLine{00314\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ should\ display\ elapsed\ time\ in\ text\ output."{}});}
\DoxyCodeLine{00315\ }
\DoxyCodeLine{00316\ GTEST\_DEFINE\_bool\_(print\_utf8,}
\DoxyCodeLine{00317\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ testing::internal::BoolFromGTestEnv(\textcolor{stringliteral}{"{}print\_utf8"{}},\ \textcolor{keyword}{true}),}
\DoxyCodeLine{00318\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}True\ if\ and\ only\ if\ "{}}\ GTEST\_NAME\_}
\DoxyCodeLine{00319\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ prints\ UTF8\ characters\ as\ text."{}});}
\DoxyCodeLine{00320\ }
\DoxyCodeLine{00321\ GTEST\_DEFINE\_int32\_(}
\DoxyCodeLine{00322\ \ \ \ \ random\_seed,\ testing::internal::Int32FromGTestEnv(\textcolor{stringliteral}{"{}random\_seed"{}},\ 0),}
\DoxyCodeLine{00323\ \ \ \ \ \textcolor{stringliteral}{"{}Random\ number\ seed\ to\ use\ when\ shuffling\ test\ orders.\ \ Must\ be\ in\ range\ "{}}}
\DoxyCodeLine{00324\ \ \ \ \ \textcolor{stringliteral}{"{}[1,\ 99999],\ or\ 0\ to\ use\ a\ seed\ based\ on\ the\ current\ time."{}});}
\DoxyCodeLine{00325\ }
\DoxyCodeLine{00326\ GTEST\_DEFINE\_int32\_(}
\DoxyCodeLine{00327\ \ \ \ \ repeat,\ testing::internal::Int32FromGTestEnv(\textcolor{stringliteral}{"{}repeat"{}},\ 1),}
\DoxyCodeLine{00328\ \ \ \ \ \textcolor{stringliteral}{"{}How\ many\ times\ to\ repeat\ each\ test.\ \ Specify\ a\ negative\ number\ "{}}}
\DoxyCodeLine{00329\ \ \ \ \ \textcolor{stringliteral}{"{}for\ repeating\ forever.\ \ Useful\ for\ shaking\ out\ flaky\ tests."{}});}
\DoxyCodeLine{00330\ }
\DoxyCodeLine{00331\ GTEST\_DEFINE\_bool\_(}
\DoxyCodeLine{00332\ \ \ \ \ recreate\_environments\_when\_repeating,}
\DoxyCodeLine{00333\ \ \ \ \ testing::internal::BoolFromGTestEnv(\textcolor{stringliteral}{"{}recreate\_environments\_when\_repeating"{}},}
\DoxyCodeLine{00334\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{false}),}
\DoxyCodeLine{00335\ \ \ \ \ \textcolor{stringliteral}{"{}Controls\ whether\ global\ test\ environments\ are\ recreated\ for\ each\ repeat\ "{}}}
\DoxyCodeLine{00336\ \ \ \ \ \textcolor{stringliteral}{"{}of\ the\ tests.\ If\ set\ to\ false\ the\ global\ test\ environments\ are\ only\ set\ "{}}}
\DoxyCodeLine{00337\ \ \ \ \ \textcolor{stringliteral}{"{}up\ once,\ for\ the\ first\ iteration,\ and\ only\ torn\ down\ once,\ for\ the\ last.\ "{}}}
\DoxyCodeLine{00338\ \ \ \ \ \textcolor{stringliteral}{"{}Useful\ for\ shaking\ out\ flaky\ tests\ with\ stable,\ expensive\ test\ "{}}}
\DoxyCodeLine{00339\ \ \ \ \ \textcolor{stringliteral}{"{}environments.\ If\ -\/-\/gtest\_repeat\ is\ set\ to\ a\ negative\ number,\ meaning\ "{}}}
\DoxyCodeLine{00340\ \ \ \ \ \textcolor{stringliteral}{"{}there\ is\ no\ last\ run,\ the\ environments\ will\ always\ be\ recreated\ to\ avoid\ "{}}}
\DoxyCodeLine{00341\ \ \ \ \ \textcolor{stringliteral}{"{}leaks."{}});}
\DoxyCodeLine{00342\ }
\DoxyCodeLine{00343\ GTEST\_DEFINE\_bool\_(show\_internal\_stack\_frames,\ \textcolor{keyword}{false},}
\DoxyCodeLine{00344\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}True\ if\ and\ only\ if\ "{}}\ GTEST\_NAME\_}
\DoxyCodeLine{00345\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ should\ include\ internal\ stack\ frames\ when\ "{}}}
\DoxyCodeLine{00346\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}printing\ test\ failure\ stack\ traces."{}});}
\DoxyCodeLine{00347\ }
\DoxyCodeLine{00348\ GTEST\_DEFINE\_bool\_(shuffle,}
\DoxyCodeLine{00349\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ testing::internal::BoolFromGTestEnv(\textcolor{stringliteral}{"{}shuffle"{}},\ \textcolor{keyword}{false}),}
\DoxyCodeLine{00350\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}True\ if\ and\ only\ if\ "{}}\ GTEST\_NAME\_}
\DoxyCodeLine{00351\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ should\ randomize\ tests'\ order\ on\ every\ run."{}});}
\DoxyCodeLine{00352\ }
\DoxyCodeLine{00353\ GTEST\_DEFINE\_int32\_(}
\DoxyCodeLine{00354\ \ \ \ \ stack\_trace\_depth,}
\DoxyCodeLine{00355\ \ \ \ \ testing::internal::Int32FromGTestEnv(\textcolor{stringliteral}{"{}stack\_trace\_depth"{}},}
\DoxyCodeLine{00356\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ testing::kMaxStackTraceDepth),}
\DoxyCodeLine{00357\ \ \ \ \ \textcolor{stringliteral}{"{}The\ maximum\ number\ of\ stack\ frames\ to\ print\ when\ an\ "{}}}
\DoxyCodeLine{00358\ \ \ \ \ \textcolor{stringliteral}{"{}assertion\ fails.\ \ The\ valid\ range\ is\ 0\ through\ 100,\ inclusive."{}});}
\DoxyCodeLine{00359\ }
\DoxyCodeLine{00360\ GTEST\_DEFINE\_string\_(}
\DoxyCodeLine{00361\ \ \ \ \ stream\_result\_to,}
\DoxyCodeLine{00362\ \ \ \ \ testing::internal::StringFromGTestEnv(\textcolor{stringliteral}{"{}stream\_result\_to"{}},\ \textcolor{stringliteral}{"{}"{}}),}
\DoxyCodeLine{00363\ \ \ \ \ \textcolor{stringliteral}{"{}This\ flag\ specifies\ the\ host\ name\ and\ the\ port\ number\ on\ which\ to\ stream\ "{}}}
\DoxyCodeLine{00364\ \ \ \ \ \textcolor{stringliteral}{"{}test\ results.\ Example:\ \(\backslash\)"{}localhost:555\(\backslash\)"{}.\ The\ flag\ is\ effective\ only\ on\ "{}}}
\DoxyCodeLine{00365\ \ \ \ \ \textcolor{stringliteral}{"{}Linux."{}});}
\DoxyCodeLine{00366\ }
\DoxyCodeLine{00367\ GTEST\_DEFINE\_bool\_(}
\DoxyCodeLine{00368\ \ \ \ \ throw\_on\_failure,}
\DoxyCodeLine{00369\ \ \ \ \ testing::internal::BoolFromGTestEnv(\textcolor{stringliteral}{"{}throw\_on\_failure"{}},\ \textcolor{keyword}{false}),}
\DoxyCodeLine{00370\ \ \ \ \ \textcolor{stringliteral}{"{}When\ this\ flag\ is\ specified,\ a\ failed\ assertion\ will\ throw\ an\ exception\ "{}}}
\DoxyCodeLine{00371\ \ \ \ \ \textcolor{stringliteral}{"{}if\ exceptions\ are\ enabled\ or\ exit\ the\ program\ with\ a\ non-\/zero\ code\ "{}}}
\DoxyCodeLine{00372\ \ \ \ \ \textcolor{stringliteral}{"{}otherwise.\ For\ use\ with\ an\ external\ test\ framework."{}});}
\DoxyCodeLine{00373\ }
\DoxyCodeLine{00374\ \textcolor{preprocessor}{\#if\ GTEST\_USE\_OWN\_FLAGFILE\_FLAG\_}}
\DoxyCodeLine{00375\ GTEST\_DEFINE\_string\_(}
\DoxyCodeLine{00376\ \ \ \ \ flagfile,\ testing::internal::StringFromGTestEnv(\textcolor{stringliteral}{"{}flagfile"{}},\ \textcolor{stringliteral}{"{}"{}}),}
\DoxyCodeLine{00377\ \ \ \ \ \textcolor{stringliteral}{"{}This\ flag\ specifies\ the\ flagfile\ to\ read\ command-\/line\ flags\ from."{}});}
\DoxyCodeLine{00378\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GTEST\_USE\_OWN\_FLAGFILE\_FLAG\_}}
\DoxyCodeLine{00379\ }
\DoxyCodeLine{00380\ \textcolor{keyword}{namespace\ }testing\ \{}
\DoxyCodeLine{00381\ \textcolor{keyword}{namespace\ }internal\ \{}
\DoxyCodeLine{00382\ }
\DoxyCodeLine{00383\ \textcolor{keyword}{const}\ uint32\_t\ Random::kMaxRange;}
\DoxyCodeLine{00384\ }
\DoxyCodeLine{00385\ \textcolor{comment}{//\ Generates\ a\ random\ number\ from\ [0,\ range),\ using\ a\ Linear}}
\DoxyCodeLine{00386\ \textcolor{comment}{//\ Congruential\ Generator\ (LCG).\ \ Crashes\ if\ 'range'\ is\ 0\ or\ greater}}
\DoxyCodeLine{00387\ \textcolor{comment}{//\ than\ kMaxRange.}}
\DoxyCodeLine{00388\ uint32\_t\ Random::Generate(uint32\_t\ range)\ \{}
\DoxyCodeLine{00389\ \ \ \textcolor{comment}{//\ These\ constants\ are\ the\ same\ as\ are\ used\ in\ glibc's\ rand(3).}}
\DoxyCodeLine{00390\ \ \ \textcolor{comment}{//\ Use\ wider\ types\ than\ necessary\ to\ prevent\ unsigned\ overflow\ diagnostics.}}
\DoxyCodeLine{00391\ \ \ state\_\ =\ \textcolor{keyword}{static\_cast<}uint32\_t\textcolor{keyword}{>}(1103515245ULL\ *\ state\_\ +\ 12345U)\ \%\ kMaxRange;}
\DoxyCodeLine{00392\ }
\DoxyCodeLine{00393\ \ \ GTEST\_CHECK\_(range\ >\ 0)\ <<\ \textcolor{stringliteral}{"{}Cannot\ generate\ a\ number\ in\ the\ range\ [0,\ 0)."{}};}
\DoxyCodeLine{00394\ \ \ GTEST\_CHECK\_(range\ <=\ kMaxRange)}
\DoxyCodeLine{00395\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Generation\ of\ a\ number\ in\ [0,\ "{}}\ <<\ range\ <<\ \textcolor{stringliteral}{"{})\ was\ requested,\ "{}}}
\DoxyCodeLine{00396\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}but\ this\ can\ only\ generate\ numbers\ in\ [0,\ "{}}\ <<\ kMaxRange\ <<\ \textcolor{stringliteral}{"{})."{}};}
\DoxyCodeLine{00397\ }
\DoxyCodeLine{00398\ \ \ \textcolor{comment}{//\ Converting\ via\ modulus\ introduces\ a\ bit\ of\ downward\ bias,\ but}}
\DoxyCodeLine{00399\ \ \ \textcolor{comment}{//\ it's\ simple,\ and\ a\ linear\ congruential\ generator\ isn't\ too\ good}}
\DoxyCodeLine{00400\ \ \ \textcolor{comment}{//\ to\ begin\ with.}}
\DoxyCodeLine{00401\ \ \ \textcolor{keywordflow}{return}\ state\_\ \%\ range;}
\DoxyCodeLine{00402\ \}}
\DoxyCodeLine{00403\ }
\DoxyCodeLine{00404\ \textcolor{comment}{//\ GTestIsInitialized()\ returns\ true\ if\ and\ only\ if\ the\ user\ has\ initialized}}
\DoxyCodeLine{00405\ \textcolor{comment}{//\ Google\ Test.\ \ Useful\ for\ catching\ the\ user\ mistake\ of\ not\ initializing}}
\DoxyCodeLine{00406\ \textcolor{comment}{//\ Google\ Test\ before\ calling\ RUN\_ALL\_TESTS().}}
\DoxyCodeLine{00407\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ GTestIsInitialized()\ \{\ \textcolor{keywordflow}{return}\ GetArgvs().size()\ >\ 0;\ \}}
\DoxyCodeLine{00408\ }
\DoxyCodeLine{00409\ \textcolor{comment}{//\ Iterates\ over\ a\ vector\ of\ TestSuites,\ keeping\ a\ running\ sum\ of\ the}}
\DoxyCodeLine{00410\ \textcolor{comment}{//\ results\ of\ calling\ a\ given\ int-\/returning\ method\ on\ each.}}
\DoxyCodeLine{00411\ \textcolor{comment}{//\ Returns\ the\ sum.}}
\DoxyCodeLine{00412\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{int}\ SumOverTestSuiteList(\textcolor{keyword}{const}\ std::vector<TestSuite*>\&\ case\_list,}
\DoxyCodeLine{00413\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ (TestSuite::*method)()\ const)\ \{}
\DoxyCodeLine{00414\ \ \ \textcolor{keywordtype}{int}\ sum\ =\ 0;}
\DoxyCodeLine{00415\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ case\_list.size();\ i++)\ \{}
\DoxyCodeLine{00416\ \ \ \ \ sum\ +=\ (case\_list[i]-\/>*method)();}
\DoxyCodeLine{00417\ \ \ \}}
\DoxyCodeLine{00418\ \ \ \textcolor{keywordflow}{return}\ sum;}
\DoxyCodeLine{00419\ \}}
\DoxyCodeLine{00420\ }
\DoxyCodeLine{00421\ \textcolor{comment}{//\ Returns\ true\ if\ and\ only\ if\ the\ test\ suite\ passed.}}
\DoxyCodeLine{00422\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ TestSuitePassed(\textcolor{keyword}{const}\ TestSuite*\ test\_suite)\ \{}
\DoxyCodeLine{00423\ \ \ \textcolor{keywordflow}{return}\ test\_suite-\/>should\_run()\ \&\&\ test\_suite-\/>Passed();}
\DoxyCodeLine{00424\ \}}
\DoxyCodeLine{00425\ }
\DoxyCodeLine{00426\ \textcolor{comment}{//\ Returns\ true\ if\ and\ only\ if\ the\ test\ suite\ failed.}}
\DoxyCodeLine{00427\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ TestSuiteFailed(\textcolor{keyword}{const}\ TestSuite*\ test\_suite)\ \{}
\DoxyCodeLine{00428\ \ \ \textcolor{keywordflow}{return}\ test\_suite-\/>should\_run()\ \&\&\ test\_suite-\/>Failed();}
\DoxyCodeLine{00429\ \}}
\DoxyCodeLine{00430\ }
\DoxyCodeLine{00431\ \textcolor{comment}{//\ Returns\ true\ if\ and\ only\ if\ test\_suite\ contains\ at\ least\ one\ test\ that}}
\DoxyCodeLine{00432\ \textcolor{comment}{//\ should\ run.}}
\DoxyCodeLine{00433\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ ShouldRunTestSuite(\textcolor{keyword}{const}\ TestSuite*\ test\_suite)\ \{}
\DoxyCodeLine{00434\ \ \ \textcolor{keywordflow}{return}\ test\_suite-\/>should\_run();}
\DoxyCodeLine{00435\ \}}
\DoxyCodeLine{00436\ }
\DoxyCodeLine{00437\ \textcolor{comment}{//\ AssertHelper\ constructor.}}
\DoxyCodeLine{00438\ AssertHelper::AssertHelper(TestPartResult::Type\ type,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ file,}
\DoxyCodeLine{00439\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ line,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ message)}
\DoxyCodeLine{00440\ \ \ \ \ :\ data\_(new\ AssertHelperData(type,\ file,\ line,\ message))\ \{\}}
\DoxyCodeLine{00441\ }
\DoxyCodeLine{00442\ AssertHelper::\string~AssertHelper()\ \{\ \textcolor{keyword}{delete}\ data\_;\ \}}
\DoxyCodeLine{00443\ }
\DoxyCodeLine{00444\ \textcolor{comment}{//\ Message\ assignment,\ for\ assertion\ streaming\ support.}}
\DoxyCodeLine{00445\ \textcolor{keywordtype}{void}\ AssertHelper::operator=(\textcolor{keyword}{const}\ Message\&\ message)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00446\ \ \ UnitTest::GetInstance()-\/>AddTestPartResult(}
\DoxyCodeLine{00447\ \ \ \ \ \ \ data\_-\/>type,\ data\_-\/>file,\ data\_-\/>line,}
\DoxyCodeLine{00448\ \ \ \ \ \ \ AppendUserMessage(data\_-\/>message,\ message),}
\DoxyCodeLine{00449\ \ \ \ \ \ \ UnitTest::GetInstance()-\/>impl()-\/>CurrentOsStackTraceExceptTop(1)}
\DoxyCodeLine{00450\ \ \ \ \ \ \ \textcolor{comment}{//\ Skips\ the\ stack\ frame\ for\ this\ function\ itself.}}
\DoxyCodeLine{00451\ \ \ );\ \ \textcolor{comment}{//\ NOLINT}}
\DoxyCodeLine{00452\ \}}
\DoxyCodeLine{00453\ }
\DoxyCodeLine{00454\ \textcolor{keyword}{namespace\ }\{}
\DoxyCodeLine{00455\ }
\DoxyCodeLine{00456\ \textcolor{comment}{//\ When\ TEST\_P\ is\ found\ without\ a\ matching\ INSTANTIATE\_TEST\_SUITE\_P}}
\DoxyCodeLine{00457\ \textcolor{comment}{//\ to\ creates\ test\ cases\ for\ it,\ a\ synthetic\ test\ case\ is}}
\DoxyCodeLine{00458\ \textcolor{comment}{//\ inserted\ to\ report\ ether\ an\ error\ or\ a\ log\ message.}}
\DoxyCodeLine{00459\ \textcolor{comment}{//}}
\DoxyCodeLine{00460\ \textcolor{comment}{//\ This\ configuration\ bit\ will\ likely\ be\ removed\ at\ some\ point.}}
\DoxyCodeLine{00461\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{bool}\ kErrorOnUninstantiatedParameterizedTest\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00462\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{bool}\ kErrorOnUninstantiatedTypeParameterizedTest\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00463\ }
\DoxyCodeLine{00464\ \textcolor{comment}{//\ A\ test\ that\ fails\ at\ a\ given\ file/line\ location\ with\ a\ given\ message.}}
\DoxyCodeLine{00465\ \textcolor{keyword}{class\ }FailureTest\ :\ \textcolor{keyword}{public}\ Test\ \{}
\DoxyCodeLine{00466\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00467\ \ \ \textcolor{keyword}{explicit}\ FailureTest(\textcolor{keyword}{const}\ CodeLocation\&\ loc,\ std::string\ error\_message,}
\DoxyCodeLine{00468\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ as\_error)}
\DoxyCodeLine{00469\ \ \ \ \ \ \ :\ loc\_(loc),}
\DoxyCodeLine{00470\ \ \ \ \ \ \ \ \ error\_message\_(std::move(error\_message)),}
\DoxyCodeLine{00471\ \ \ \ \ \ \ \ \ as\_error\_(as\_error)\ \{\}}
\DoxyCodeLine{00472\ }
\DoxyCodeLine{00473\ \ \ \textcolor{keywordtype}{void}\ TestBody()\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00474\ \ \ \ \ \textcolor{keywordflow}{if}\ (as\_error\_)\ \{}
\DoxyCodeLine{00475\ \ \ \ \ \ \ AssertHelper(TestPartResult::kNonFatalFailure,\ loc\_.file.c\_str(),}
\DoxyCodeLine{00476\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ loc\_.line,\ \textcolor{stringliteral}{"{}"{}})\ =\ Message()\ <<\ error\_message\_;}
\DoxyCodeLine{00477\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00478\ \ \ \ \ \ \ std::cout\ <<\ error\_message\_\ <<\ std::endl;}
\DoxyCodeLine{00479\ \ \ \ \ \}}
\DoxyCodeLine{00480\ \ \ \}}
\DoxyCodeLine{00481\ }
\DoxyCodeLine{00482\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00483\ \ \ \textcolor{keyword}{const}\ CodeLocation\ loc\_;}
\DoxyCodeLine{00484\ \ \ \textcolor{keyword}{const}\ std::string\ error\_message\_;}
\DoxyCodeLine{00485\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ as\_error\_;}
\DoxyCodeLine{00486\ \};}
\DoxyCodeLine{00487\ }
\DoxyCodeLine{00488\ \}\ \ \textcolor{comment}{//\ namespace}}
\DoxyCodeLine{00489\ }
\DoxyCodeLine{00490\ std::set<std::string>*\ GetIgnoredParameterizedTestSuites()\ \{}
\DoxyCodeLine{00491\ \ \ \textcolor{keywordflow}{return}\ UnitTest::GetInstance()-\/>impl()-\/>ignored\_parameterized\_test\_suites();}
\DoxyCodeLine{00492\ \}}
\DoxyCodeLine{00493\ }
\DoxyCodeLine{00494\ \textcolor{comment}{//\ Add\ a\ given\ test\_suit\ to\ the\ list\ of\ them\ allow\ to\ go\ un-\/instantiated.}}
\DoxyCodeLine{00495\ MarkAsIgnored::MarkAsIgnored(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ test\_suite)\ \{}
\DoxyCodeLine{00496\ \ \ GetIgnoredParameterizedTestSuites()-\/>insert(test\_suite);}
\DoxyCodeLine{00497\ \}}
\DoxyCodeLine{00498\ }
\DoxyCodeLine{00499\ \textcolor{comment}{//\ If\ this\ parameterized\ test\ suite\ has\ no\ instantiations\ (and\ that}}
\DoxyCodeLine{00500\ \textcolor{comment}{//\ has\ not\ been\ marked\ as\ okay),\ emit\ a\ test\ case\ reporting\ that.}}
\DoxyCodeLine{00501\ \textcolor{keywordtype}{void}\ InsertSyntheticTestCase(\textcolor{keyword}{const}\ std::string\&\ name,\ CodeLocation\ location,}
\DoxyCodeLine{00502\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ has\_test\_p)\ \{}
\DoxyCodeLine{00503\ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ ignored\ =\ *GetIgnoredParameterizedTestSuites();}
\DoxyCodeLine{00504\ \ \ \textcolor{keywordflow}{if}\ (ignored.find(name)\ !=\ ignored.end())\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00505\ }
\DoxyCodeLine{00506\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ kMissingInstantiation[]\ =\ \ \textcolor{comment}{//}}
\DoxyCodeLine{00507\ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ is\ defined\ via\ TEST\_P,\ but\ never\ instantiated.\ None\ of\ the\ test\ cases\ "{}}}
\DoxyCodeLine{00508\ \ \ \ \ \ \ \textcolor{stringliteral}{"{}will\ run.\ Either\ no\ INSTANTIATE\_TEST\_SUITE\_P\ is\ provided\ or\ the\ only\ "{}}}
\DoxyCodeLine{00509\ \ \ \ \ \ \ \textcolor{stringliteral}{"{}ones\ provided\ expand\ to\ nothing."{}}}
\DoxyCodeLine{00510\ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n"{}}}
\DoxyCodeLine{00511\ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Ideally,\ TEST\_P\ definitions\ should\ only\ ever\ be\ included\ as\ part\ of\ "{}}}
\DoxyCodeLine{00512\ \ \ \ \ \ \ \textcolor{stringliteral}{"{}binaries\ that\ intend\ to\ use\ them.\ (As\ opposed\ to,\ for\ example,\ being\ "{}}}
\DoxyCodeLine{00513\ \ \ \ \ \ \ \textcolor{stringliteral}{"{}placed\ in\ a\ library\ that\ may\ be\ linked\ in\ to\ get\ other\ utilities.)"{}};}
\DoxyCodeLine{00514\ }
\DoxyCodeLine{00515\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ kMissingTestCase[]\ =\ \ \textcolor{comment}{//}}
\DoxyCodeLine{00516\ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ is\ instantiated\ via\ INSTANTIATE\_TEST\_SUITE\_P,\ but\ no\ tests\ are\ "{}}}
\DoxyCodeLine{00517\ \ \ \ \ \ \ \textcolor{stringliteral}{"{}defined\ via\ TEST\_P\ .\ No\ test\ cases\ will\ run."{}}}
\DoxyCodeLine{00518\ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n"{}}}
\DoxyCodeLine{00519\ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Ideally,\ INSTANTIATE\_TEST\_SUITE\_P\ should\ only\ ever\ be\ invoked\ from\ "{}}}
\DoxyCodeLine{00520\ \ \ \ \ \ \ \textcolor{stringliteral}{"{}code\ that\ always\ depend\ on\ code\ that\ provides\ TEST\_P.\ Failing\ to\ do\ "{}}}
\DoxyCodeLine{00521\ \ \ \ \ \ \ \textcolor{stringliteral}{"{}so\ is\ often\ an\ indication\ of\ dead\ code,\ e.g.\ the\ last\ TEST\_P\ was\ "{}}}
\DoxyCodeLine{00522\ \ \ \ \ \ \ \textcolor{stringliteral}{"{}removed\ but\ the\ rest\ got\ left\ behind."{}};}
\DoxyCodeLine{00523\ }
\DoxyCodeLine{00524\ \ \ std::string\ message\ =}
\DoxyCodeLine{00525\ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Parameterized\ test\ suite\ "{}}\ +\ name\ +}
\DoxyCodeLine{00526\ \ \ \ \ \ \ (has\_test\_p\ ?\ kMissingInstantiation\ :\ kMissingTestCase)\ +}
\DoxyCodeLine{00527\ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n"{}}}
\DoxyCodeLine{00528\ \ \ \ \ \ \ \textcolor{stringliteral}{"{}To\ suppress\ this\ error\ for\ this\ test\ suite,\ insert\ the\ following\ line\ "{}}}
\DoxyCodeLine{00529\ \ \ \ \ \ \ \textcolor{stringliteral}{"{}(in\ a\ non-\/header)\ in\ the\ namespace\ it\ is\ defined\ in:"{}}}
\DoxyCodeLine{00530\ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n"{}}}
\DoxyCodeLine{00531\ \ \ \ \ \ \ \textcolor{stringliteral}{"{}GTEST\_ALLOW\_UNINSTANTIATED\_PARAMETERIZED\_TEST("{}}\ +}
\DoxyCodeLine{00532\ \ \ \ \ \ \ name\ +\ \textcolor{stringliteral}{"{});"{}};}
\DoxyCodeLine{00533\ }
\DoxyCodeLine{00534\ \ \ std::string\ full\_name\ =\ \textcolor{stringliteral}{"{}UninstantiatedParameterizedTestSuite<"{}}\ +\ name\ +\ \textcolor{stringliteral}{"{}>"{}};}
\DoxyCodeLine{00535\ \ \ RegisterTest(\ \ \textcolor{comment}{//}}
\DoxyCodeLine{00536\ \ \ \ \ \ \ \textcolor{stringliteral}{"{}GoogleTestVerification"{}},\ full\_name.c\_str(),}
\DoxyCodeLine{00537\ \ \ \ \ \ \ \textcolor{keyword}{nullptr},\ \ \textcolor{comment}{//\ No\ type\ parameter.}}
\DoxyCodeLine{00538\ \ \ \ \ \ \ \textcolor{keyword}{nullptr},\ \ \textcolor{comment}{//\ No\ value\ parameter.}}
\DoxyCodeLine{00539\ \ \ \ \ \ \ location.file.c\_str(),\ location.line,\ [message,\ location]\ \{}
\DoxyCodeLine{00540\ \ \ \ \ \ \ \ \ return\ new\ FailureTest(location,\ message,}
\DoxyCodeLine{00541\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ kErrorOnUninstantiatedParameterizedTest);}
\DoxyCodeLine{00542\ \ \ \ \ \ \ \});}
\DoxyCodeLine{00543\ \}}
\DoxyCodeLine{00544\ }
\DoxyCodeLine{00545\ \textcolor{keywordtype}{void}\ RegisterTypeParameterizedTestSuite(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ test\_suite\_name,}
\DoxyCodeLine{00546\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ CodeLocation\ code\_location)\ \{}
\DoxyCodeLine{00547\ \ \ GetUnitTestImpl()-\/>type\_parameterized\_test\_registry().RegisterTestSuite(}
\DoxyCodeLine{00548\ \ \ \ \ \ \ test\_suite\_name,\ code\_location);}
\DoxyCodeLine{00549\ \}}
\DoxyCodeLine{00550\ }
\DoxyCodeLine{00551\ \textcolor{keywordtype}{void}\ RegisterTypeParameterizedTestSuiteInstantiation(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ case\_name)\ \{}
\DoxyCodeLine{00552\ \ \ GetUnitTestImpl()-\/>type\_parameterized\_test\_registry().RegisterInstantiation(}
\DoxyCodeLine{00553\ \ \ \ \ \ \ case\_name);}
\DoxyCodeLine{00554\ \}}
\DoxyCodeLine{00555\ }
\DoxyCodeLine{00556\ \textcolor{keywordtype}{void}\ TypeParameterizedTestSuiteRegistry::RegisterTestSuite(}
\DoxyCodeLine{00557\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ test\_suite\_name,\ CodeLocation\ code\_location)\ \{}
\DoxyCodeLine{00558\ \ \ suites\_.emplace(std::string(test\_suite\_name),}
\DoxyCodeLine{00559\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ TypeParameterizedTestSuiteInfo(code\_location));}
\DoxyCodeLine{00560\ \}}
\DoxyCodeLine{00561\ }
\DoxyCodeLine{00562\ \textcolor{keywordtype}{void}\ TypeParameterizedTestSuiteRegistry::RegisterInstantiation(}
\DoxyCodeLine{00563\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ test\_suite\_name)\ \{}
\DoxyCodeLine{00564\ \ \ \textcolor{keyword}{auto}\ it\ =\ suites\_.find(std::string(test\_suite\_name));}
\DoxyCodeLine{00565\ \ \ \textcolor{keywordflow}{if}\ (it\ !=\ suites\_.end())\ \{}
\DoxyCodeLine{00566\ \ \ \ \ it-\/>second.instantiated\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00567\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00568\ \ \ \ \ GTEST\_LOG\_(ERROR)\ <<\ \textcolor{stringliteral}{"{}Unknown\ type\ parameterized\ test\ suit\ '"{}}}
\DoxyCodeLine{00569\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ test\_suite\_name\ <<\ \textcolor{stringliteral}{"{}'"{}};}
\DoxyCodeLine{00570\ \ \ \}}
\DoxyCodeLine{00571\ \}}
\DoxyCodeLine{00572\ }
\DoxyCodeLine{00573\ \textcolor{keywordtype}{void}\ TypeParameterizedTestSuiteRegistry::CheckForInstantiations()\ \{}
\DoxyCodeLine{00574\ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ ignored\ =\ *GetIgnoredParameterizedTestSuites();}
\DoxyCodeLine{00575\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ testcase\ :\ suites\_)\ \{}
\DoxyCodeLine{00576\ \ \ \ \ \textcolor{keywordflow}{if}\ (testcase.second.instantiated)\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00577\ \ \ \ \ \textcolor{keywordflow}{if}\ (ignored.find(testcase.first)\ !=\ ignored.end())\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00578\ }
\DoxyCodeLine{00579\ \ \ \ \ std::string\ message\ =}
\DoxyCodeLine{00580\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Type\ parameterized\ test\ suite\ "{}}\ +\ testcase.first\ +}
\DoxyCodeLine{00581\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ is\ defined\ via\ REGISTER\_TYPED\_TEST\_SUITE\_P,\ but\ never\ instantiated\ "{}}}
\DoxyCodeLine{00582\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}via\ INSTANTIATE\_TYPED\_TEST\_SUITE\_P.\ None\ of\ the\ test\ cases\ will\ run."{}}}
\DoxyCodeLine{00583\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n"{}}}
\DoxyCodeLine{00584\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Ideally,\ TYPED\_TEST\_P\ definitions\ should\ only\ ever\ be\ included\ as\ "{}}}
\DoxyCodeLine{00585\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}part\ of\ binaries\ that\ intend\ to\ use\ them.\ (As\ opposed\ to,\ for\ "{}}}
\DoxyCodeLine{00586\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}example,\ being\ placed\ in\ a\ library\ that\ may\ be\ linked\ in\ to\ get\ other\ "{}}}
\DoxyCodeLine{00587\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}utilities.)"{}}}
\DoxyCodeLine{00588\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n"{}}}
\DoxyCodeLine{00589\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}To\ suppress\ this\ error\ for\ this\ test\ suite,\ insert\ the\ following\ line\ "{}}}
\DoxyCodeLine{00590\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}(in\ a\ non-\/header)\ in\ the\ namespace\ it\ is\ defined\ in:"{}}}
\DoxyCodeLine{00591\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n"{}}}
\DoxyCodeLine{00592\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}GTEST\_ALLOW\_UNINSTANTIATED\_PARAMETERIZED\_TEST("{}}\ +}
\DoxyCodeLine{00593\ \ \ \ \ \ \ \ \ testcase.first\ +\ \textcolor{stringliteral}{"{});"{}};}
\DoxyCodeLine{00594\ }
\DoxyCodeLine{00595\ \ \ \ \ std::string\ full\_name\ =}
\DoxyCodeLine{00596\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}UninstantiatedTypeParameterizedTestSuite<"{}}\ +\ testcase.first\ +\ \textcolor{stringliteral}{"{}>"{}};}
\DoxyCodeLine{00597\ \ \ \ \ RegisterTest(\ \ \textcolor{comment}{//}}
\DoxyCodeLine{00598\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}GoogleTestVerification"{}},\ full\_name.c\_str(),}
\DoxyCodeLine{00599\ \ \ \ \ \ \ \ \ \textcolor{keyword}{nullptr},\ \ \textcolor{comment}{//\ No\ type\ parameter.}}
\DoxyCodeLine{00600\ \ \ \ \ \ \ \ \ \textcolor{keyword}{nullptr},\ \ \textcolor{comment}{//\ No\ value\ parameter.}}
\DoxyCodeLine{00601\ \ \ \ \ \ \ \ \ testcase.second.code\_location.file.c\_str(),}
\DoxyCodeLine{00602\ \ \ \ \ \ \ \ \ testcase.second.code\_location.line,\ [message,\ testcase]\ \{}
\DoxyCodeLine{00603\ \ \ \ \ \ \ \ \ \ \ return\ new\ FailureTest(testcase.second.code\_location,\ message,}
\DoxyCodeLine{00604\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ kErrorOnUninstantiatedTypeParameterizedTest);}
\DoxyCodeLine{00605\ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00606\ \ \ \}}
\DoxyCodeLine{00607\ \}}
\DoxyCodeLine{00608\ }
\DoxyCodeLine{00609\ \textcolor{comment}{//\ A\ copy\ of\ all\ command\ line\ arguments.\ \ Set\ by\ InitGoogleTest().}}
\DoxyCodeLine{00610\ static\ ::std::vector<std::string>\ g\_argvs;}
\DoxyCodeLine{00611\ }
\DoxyCodeLine{00612\ ::std::vector<std::string>\ GetArgvs()\ \{}
\DoxyCodeLine{00613\ \textcolor{preprocessor}{\#if\ defined(GTEST\_CUSTOM\_GET\_ARGVS\_)}}
\DoxyCodeLine{00614\ \ \ \textcolor{comment}{//\ GTEST\_CUSTOM\_GET\_ARGVS\_()\ may\ return\ a\ container\ of\ std::string\ or}}
\DoxyCodeLine{00615\ \ \ \textcolor{comment}{//\ ::string.\ This\ code\ converts\ it\ to\ the\ appropriate\ type.}}
\DoxyCodeLine{00616\ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ custom\ =\ GTEST\_CUSTOM\_GET\_ARGVS\_();}
\DoxyCodeLine{00617\ \ \ return\ ::std::vector<std::string>(custom.begin(),\ custom.end());}
\DoxyCodeLine{00618\ \textcolor{preprocessor}{\#else\ \ \ }\textcolor{comment}{//\ defined(GTEST\_CUSTOM\_GET\_ARGVS\_)}}
\DoxyCodeLine{00619\ \ \ \textcolor{keywordflow}{return}\ g\_argvs;}
\DoxyCodeLine{00620\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ defined(GTEST\_CUSTOM\_GET\_ARGVS\_)}}
\DoxyCodeLine{00621\ \}}
\DoxyCodeLine{00622\ }
\DoxyCodeLine{00623\ \textcolor{comment}{//\ Returns\ the\ current\ application's\ name,\ removing\ directory\ path\ if\ that}}
\DoxyCodeLine{00624\ \textcolor{comment}{//\ is\ present.}}
\DoxyCodeLine{00625\ FilePath\ GetCurrentExecutableName()\ \{}
\DoxyCodeLine{00626\ \ \ FilePath\ result;}
\DoxyCodeLine{00627\ }
\DoxyCodeLine{00628\ \textcolor{preprocessor}{\#if\ GTEST\_OS\_WINDOWS\ ||\ GTEST\_OS\_OS2}}
\DoxyCodeLine{00629\ \ \ result.Set(FilePath(GetArgvs()[0]).RemoveExtension(\textcolor{stringliteral}{"{}exe"{}}));}
\DoxyCodeLine{00630\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00631\ \ \ result.Set(FilePath(GetArgvs()[0]));}
\DoxyCodeLine{00632\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GTEST\_OS\_WINDOWS}}
\DoxyCodeLine{00633\ }
\DoxyCodeLine{00634\ \ \ \textcolor{keywordflow}{return}\ result.RemoveDirectoryName();}
\DoxyCodeLine{00635\ \}}
\DoxyCodeLine{00636\ }
\DoxyCodeLine{00637\ \textcolor{comment}{//\ Functions\ for\ processing\ the\ gtest\_output\ flag.}}
\DoxyCodeLine{00638\ }
\DoxyCodeLine{00639\ \textcolor{comment}{//\ Returns\ the\ output\ format,\ or\ "{}"{}\ for\ normal\ printed\ output.}}
\DoxyCodeLine{00640\ std::string\ UnitTestOptions::GetOutputFormat()\ \{}
\DoxyCodeLine{00641\ \ \ std::string\ s\ =\ GTEST\_FLAG\_GET(output);}
\DoxyCodeLine{00642\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \textcolor{keyword}{const}\ gtest\_output\_flag\ =\ s.c\_str();}
\DoxyCodeLine{00643\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \textcolor{keyword}{const}\ colon\ =\ strchr(gtest\_output\_flag,\ \textcolor{charliteral}{':'});}
\DoxyCodeLine{00644\ \ \ \textcolor{keywordflow}{return}\ (colon\ ==\ \textcolor{keyword}{nullptr})}
\DoxyCodeLine{00645\ \ \ \ \ \ \ \ \ \ \ \ \ \ ?\ std::string(gtest\_output\_flag)}
\DoxyCodeLine{00646\ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ std::string(gtest\_output\_flag,}
\DoxyCodeLine{00647\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ static\_cast<size\_t>(colon\ -\/\ gtest\_output\_flag));}
\DoxyCodeLine{00648\ \}}
\DoxyCodeLine{00649\ }
\DoxyCodeLine{00650\ \textcolor{comment}{//\ Returns\ the\ name\ of\ the\ requested\ output\ file,\ or\ the\ default\ if\ none}}
\DoxyCodeLine{00651\ \textcolor{comment}{//\ was\ explicitly\ specified.}}
\DoxyCodeLine{00652\ std::string\ UnitTestOptions::GetAbsolutePathToOutputFile()\ \{}
\DoxyCodeLine{00653\ \ \ std::string\ s\ =\ GTEST\_FLAG\_GET(output);}
\DoxyCodeLine{00654\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \textcolor{keyword}{const}\ gtest\_output\_flag\ =\ s.c\_str();}
\DoxyCodeLine{00655\ }
\DoxyCodeLine{00656\ \ \ std::string\ format\ =\ GetOutputFormat();}
\DoxyCodeLine{00657\ \ \ \textcolor{keywordflow}{if}\ (format.empty())\ format\ =\ std::string(kDefaultOutputFormat);}
\DoxyCodeLine{00658\ }
\DoxyCodeLine{00659\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \textcolor{keyword}{const}\ colon\ =\ strchr(gtest\_output\_flag,\ \textcolor{charliteral}{':'});}
\DoxyCodeLine{00660\ \ \ \textcolor{keywordflow}{if}\ (colon\ ==\ \textcolor{keyword}{nullptr})}
\DoxyCodeLine{00661\ \ \ \ \ \textcolor{keywordflow}{return}\ internal::FilePath::MakeFileName(}
\DoxyCodeLine{00662\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ internal::FilePath(}
\DoxyCodeLine{00663\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ UnitTest::GetInstance()-\/>original\_working\_dir()),}
\DoxyCodeLine{00664\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ internal::FilePath(kDefaultOutputFile),\ 0,\ format.c\_str())}
\DoxyCodeLine{00665\ \ \ \ \ \ \ \ \ .string();}
\DoxyCodeLine{00666\ }
\DoxyCodeLine{00667\ \ \ internal::FilePath\ output\_name(colon\ +\ 1);}
\DoxyCodeLine{00668\ \ \ \textcolor{keywordflow}{if}\ (!output\_name.IsAbsolutePath())}
\DoxyCodeLine{00669\ \ \ \ \ output\_name\ =\ internal::FilePath::ConcatPaths(}
\DoxyCodeLine{00670\ \ \ \ \ \ \ \ \ internal::FilePath(UnitTest::GetInstance()-\/>original\_working\_dir()),}
\DoxyCodeLine{00671\ \ \ \ \ \ \ \ \ internal::FilePath(colon\ +\ 1));}
\DoxyCodeLine{00672\ }
\DoxyCodeLine{00673\ \ \ \textcolor{keywordflow}{if}\ (!output\_name.IsDirectory())\ \textcolor{keywordflow}{return}\ output\_name.string();}
\DoxyCodeLine{00674\ }
\DoxyCodeLine{00675\ \ \ internal::FilePath\ result(internal::FilePath::GenerateUniqueFileName(}
\DoxyCodeLine{00676\ \ \ \ \ \ \ output\_name,\ internal::GetCurrentExecutableName(),}
\DoxyCodeLine{00677\ \ \ \ \ \ \ GetOutputFormat().c\_str()));}
\DoxyCodeLine{00678\ \ \ \textcolor{keywordflow}{return}\ result.string();}
\DoxyCodeLine{00679\ \}}
\DoxyCodeLine{00680\ }
\DoxyCodeLine{00681\ \textcolor{comment}{//\ Returns\ true\ if\ and\ only\ if\ the\ wildcard\ pattern\ matches\ the\ string.\ Each}}
\DoxyCodeLine{00682\ \textcolor{comment}{//\ pattern\ consists\ of\ regular\ characters,\ single-\/character\ wildcards\ (?),\ and}}
\DoxyCodeLine{00683\ \textcolor{comment}{//\ multi-\/character\ wildcards\ (*).}}
\DoxyCodeLine{00684\ \textcolor{comment}{//}}
\DoxyCodeLine{00685\ \textcolor{comment}{//\ This\ function\ implements\ a\ linear-\/time\ string\ globbing\ algorithm\ based\ on}}
\DoxyCodeLine{00686\ \textcolor{comment}{//\ https://research.swtch.com/glob.}}
\DoxyCodeLine{00687\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ PatternMatchesString(\textcolor{keyword}{const}\ std::string\&\ name\_str,}
\DoxyCodeLine{00688\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ pattern,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ pattern\_end)\ \{}
\DoxyCodeLine{00689\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ name\ =\ name\_str.c\_str();}
\DoxyCodeLine{00690\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \textcolor{keyword}{const}\ name\_begin\ =\ name;}
\DoxyCodeLine{00691\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \textcolor{keyword}{const}\ name\_end\ =\ name\ +\ name\_str.size();}
\DoxyCodeLine{00692\ }
\DoxyCodeLine{00693\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ pattern\_next\ =\ pattern;}
\DoxyCodeLine{00694\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ name\_next\ =\ name;}
\DoxyCodeLine{00695\ }
\DoxyCodeLine{00696\ \ \ \textcolor{keywordflow}{while}\ (pattern\ <\ pattern\_end\ ||\ name\ <\ name\_end)\ \{}
\DoxyCodeLine{00697\ \ \ \ \ \textcolor{keywordflow}{if}\ (pattern\ <\ pattern\_end)\ \{}
\DoxyCodeLine{00698\ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (*pattern)\ \{}
\DoxyCodeLine{00699\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{default}:\ \ \textcolor{comment}{//\ Match\ an\ ordinary\ character.}}
\DoxyCodeLine{00700\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (name\ <\ name\_end\ \&\&\ *name\ ==\ *pattern)\ \{}
\DoxyCodeLine{00701\ \ \ \ \ \ \ \ \ \ \ \ \ ++pattern;}
\DoxyCodeLine{00702\ \ \ \ \ \ \ \ \ \ \ \ \ ++name;}
\DoxyCodeLine{00703\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00704\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00705\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00706\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'?'}:\ \ \textcolor{comment}{//\ Match\ any\ single\ character.}}
\DoxyCodeLine{00707\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (name\ <\ name\_end)\ \{}
\DoxyCodeLine{00708\ \ \ \ \ \ \ \ \ \ \ \ \ ++pattern;}
\DoxyCodeLine{00709\ \ \ \ \ \ \ \ \ \ \ \ \ ++name;}
\DoxyCodeLine{00710\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00711\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00712\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00713\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'*'}:}
\DoxyCodeLine{00714\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Match\ zero\ or\ more\ characters.\ Start\ by\ skipping\ over\ the\ wildcard}}
\DoxyCodeLine{00715\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ and\ matching\ zero\ characters\ from\ name.\ If\ that\ fails,\ restart\ and}}
\DoxyCodeLine{00716\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ match\ one\ more\ character\ than\ the\ last\ attempt.}}
\DoxyCodeLine{00717\ \ \ \ \ \ \ \ \ \ \ pattern\_next\ =\ pattern;}
\DoxyCodeLine{00718\ \ \ \ \ \ \ \ \ \ \ name\_next\ =\ name\ +\ 1;}
\DoxyCodeLine{00719\ \ \ \ \ \ \ \ \ \ \ ++pattern;}
\DoxyCodeLine{00720\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00721\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00722\ \ \ \ \ \}}
\DoxyCodeLine{00723\ \ \ \ \ \textcolor{comment}{//\ Failed\ to\ match\ a\ character.\ Restart\ if\ possible.}}
\DoxyCodeLine{00724\ \ \ \ \ \textcolor{keywordflow}{if}\ (name\_begin\ <\ name\_next\ \&\&\ name\_next\ <=\ name\_end)\ \{}
\DoxyCodeLine{00725\ \ \ \ \ \ \ pattern\ =\ pattern\_next;}
\DoxyCodeLine{00726\ \ \ \ \ \ \ name\ =\ name\_next;}
\DoxyCodeLine{00727\ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00728\ \ \ \ \ \}}
\DoxyCodeLine{00729\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00730\ \ \ \}}
\DoxyCodeLine{00731\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00732\ \}}
\DoxyCodeLine{00733\ }
\DoxyCodeLine{00734\ \textcolor{keyword}{namespace\ }\{}
\DoxyCodeLine{00735\ }
\DoxyCodeLine{00736\ \textcolor{keywordtype}{bool}\ IsGlobPattern(\textcolor{keyword}{const}\ std::string\&\ pattern)\ \{}
\DoxyCodeLine{00737\ \ \ \textcolor{keywordflow}{return}\ std::any\_of(pattern.begin(),\ pattern.end(),}
\DoxyCodeLine{00738\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [](\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ c)\ \{\ return\ c\ ==\ \textcolor{stringliteral}{'?'}\ ||\ c\ ==\ \textcolor{stringliteral}{'*'};\ \});}
\DoxyCodeLine{00739\ \}}
\DoxyCodeLine{00740\ }
\DoxyCodeLine{00741\ \textcolor{keyword}{class\ }UnitTestFilter\ \{}
\DoxyCodeLine{00742\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00743\ \ \ UnitTestFilter()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00744\ }
\DoxyCodeLine{00745\ \ \ \textcolor{comment}{//\ Constructs\ a\ filter\ from\ a\ string\ of\ patterns\ separated\ by\ \`{}:`.}}
\DoxyCodeLine{00746\ \ \ \textcolor{keyword}{explicit}\ UnitTestFilter(\textcolor{keyword}{const}\ std::string\&\ filter)\ \{}
\DoxyCodeLine{00747\ \ \ \ \ \textcolor{comment}{//\ By\ design\ "{}"{}\ filter\ matches\ "{}"{}\ string.}}
\DoxyCodeLine{00748\ \ \ \ \ std::vector<std::string>\ all\_patterns;}
\DoxyCodeLine{00749\ \ \ \ \ SplitString(filter,\ \textcolor{charliteral}{':'},\ \&all\_patterns);}
\DoxyCodeLine{00750\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ exact\_match\_patterns\_begin\ =\ std::partition(}
\DoxyCodeLine{00751\ \ \ \ \ \ \ \ \ all\_patterns.begin(),\ all\_patterns.end(),\ \&IsGlobPattern);}
\DoxyCodeLine{00752\ }
\DoxyCodeLine{00753\ \ \ \ \ glob\_patterns\_.reserve(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{size\_t}\textcolor{keyword}{>}(}
\DoxyCodeLine{00754\ \ \ \ \ \ \ \ \ std::distance(all\_patterns.begin(),\ exact\_match\_patterns\_begin)));}
\DoxyCodeLine{00755\ \ \ \ \ std::move(all\_patterns.begin(),\ exact\_match\_patterns\_begin,}
\DoxyCodeLine{00756\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::inserter(glob\_patterns\_,\ glob\_patterns\_.begin()));}
\DoxyCodeLine{00757\ \ \ \ \ std::move(}
\DoxyCodeLine{00758\ \ \ \ \ \ \ \ \ exact\_match\_patterns\_begin,\ all\_patterns.end(),}
\DoxyCodeLine{00759\ \ \ \ \ \ \ \ \ std::inserter(exact\_match\_patterns\_,\ exact\_match\_patterns\_.begin()));}
\DoxyCodeLine{00760\ \ \ \}}
\DoxyCodeLine{00761\ }
\DoxyCodeLine{00762\ \ \ \textcolor{comment}{//\ Returns\ true\ if\ and\ only\ if\ name\ matches\ at\ least\ one\ of\ the\ patterns\ in}}
\DoxyCodeLine{00763\ \ \ \textcolor{comment}{//\ the\ filter.}}
\DoxyCodeLine{00764\ \ \ \textcolor{keywordtype}{bool}\ MatchesName(\textcolor{keyword}{const}\ std::string\&\ name)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00765\ \ \ \ \ \textcolor{keywordflow}{return}\ exact\_match\_patterns\_.count(name)\ >\ 0\ ||}
\DoxyCodeLine{00766\ \ \ \ \ \ \ \ \ \ \ \ std::any\_of(glob\_patterns\_.begin(),\ glob\_patterns\_.end(),}
\DoxyCodeLine{00767\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [\&name](\textcolor{keyword}{const}\ std::string\&\ pattern)\ \{}
\DoxyCodeLine{00768\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ return\ PatternMatchesString(}
\DoxyCodeLine{00769\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ name,\ pattern.c\_str(),}
\DoxyCodeLine{00770\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pattern.c\_str()\ +\ pattern.size());}
\DoxyCodeLine{00771\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00772\ \ \ \}}
\DoxyCodeLine{00773\ }
\DoxyCodeLine{00774\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00775\ \ \ std::vector<std::string>\ glob\_patterns\_;}
\DoxyCodeLine{00776\ \ \ std::unordered\_set<std::string>\ exact\_match\_patterns\_;}
\DoxyCodeLine{00777\ \};}
\DoxyCodeLine{00778\ }
\DoxyCodeLine{00779\ \textcolor{keyword}{class\ }PositiveAndNegativeUnitTestFilter\ \{}
\DoxyCodeLine{00780\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00781\ \ \ \textcolor{comment}{//\ Constructs\ a\ positive\ and\ a\ negative\ filter\ from\ a\ string.\ The\ string}}
\DoxyCodeLine{00782\ \ \ \textcolor{comment}{//\ contains\ a\ positive\ filter\ optionally\ followed\ by\ a\ '-\/'\ character\ and\ a}}
\DoxyCodeLine{00783\ \ \ \textcolor{comment}{//\ negative\ filter.\ In\ case\ only\ a\ negative\ filter\ is\ provided\ the\ positive}}
\DoxyCodeLine{00784\ \ \ \textcolor{comment}{//\ filter\ will\ be\ assumed\ "{}*"{}.}}
\DoxyCodeLine{00785\ \ \ \textcolor{comment}{//\ A\ filter\ is\ a\ list\ of\ patterns\ separated\ by\ ':'.}}
\DoxyCodeLine{00786\ \ \ \textcolor{keyword}{explicit}\ PositiveAndNegativeUnitTestFilter(\textcolor{keyword}{const}\ std::string\&\ filter)\ \{}
\DoxyCodeLine{00787\ \ \ \ \ std::vector<std::string>\ positive\_and\_negative\_filters;}
\DoxyCodeLine{00788\ }
\DoxyCodeLine{00789\ \ \ \ \ \textcolor{comment}{//\ NOTE:\ \`{}SplitString`\ always\ returns\ a\ non-\/empty\ container.}}
\DoxyCodeLine{00790\ \ \ \ \ SplitString(filter,\ \textcolor{charliteral}{'-\/'},\ \&positive\_and\_negative\_filters);}
\DoxyCodeLine{00791\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\&\ positive\_filter\ =\ positive\_and\_negative\_filters.front();}
\DoxyCodeLine{00792\ }
\DoxyCodeLine{00793\ \ \ \ \ \textcolor{keywordflow}{if}\ (positive\_and\_negative\_filters.size()\ >\ 1)\ \{}
\DoxyCodeLine{00794\ \ \ \ \ \ \ positive\_filter\_\ =\ UnitTestFilter(}
\DoxyCodeLine{00795\ \ \ \ \ \ \ \ \ \ \ positive\_filter.empty()\ ?\ kUniversalFilter\ :\ positive\_filter);}
\DoxyCodeLine{00796\ }
\DoxyCodeLine{00797\ \ \ \ \ \ \ \textcolor{comment}{//\ TODO(b/214626361):\ Fail\ on\ multiple\ '-\/'\ characters}}
\DoxyCodeLine{00798\ \ \ \ \ \ \ \textcolor{comment}{//\ For\ the\ moment\ to\ preserve\ old\ behavior\ we\ concatenate\ the\ rest\ of\ the}}
\DoxyCodeLine{00799\ \ \ \ \ \ \ \textcolor{comment}{//\ string\ parts\ with\ \`{}-\/`\ as\ separator\ to\ generate\ the\ negative\ filter.}}
\DoxyCodeLine{00800\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ negative\_filter\_string\ =\ positive\_and\_negative\_filters[1];}
\DoxyCodeLine{00801\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (std::size\_t\ i\ =\ 2;\ i\ <\ positive\_and\_negative\_filters.size();\ i++)}
\DoxyCodeLine{00802\ \ \ \ \ \ \ \ \ negative\_filter\_string\ =}
\DoxyCodeLine{00803\ \ \ \ \ \ \ \ \ \ \ \ \ negative\_filter\_string\ +\ \textcolor{charliteral}{'-\/'}\ +\ positive\_and\_negative\_filters[i];}
\DoxyCodeLine{00804\ \ \ \ \ \ \ negative\_filter\_\ =\ UnitTestFilter(negative\_filter\_string);}
\DoxyCodeLine{00805\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00806\ \ \ \ \ \ \ \textcolor{comment}{//\ In\ case\ we\ don't\ have\ a\ negative\ filter\ and\ positive\ filter\ is\ "{}"{}}}
\DoxyCodeLine{00807\ \ \ \ \ \ \ \textcolor{comment}{//\ we\ do\ not\ use\ kUniversalFilter\ by\ design\ as\ opposed\ to\ when\ we\ have\ a}}
\DoxyCodeLine{00808\ \ \ \ \ \ \ \textcolor{comment}{//\ negative\ filter.}}
\DoxyCodeLine{00809\ \ \ \ \ \ \ positive\_filter\_\ =\ UnitTestFilter(positive\_filter);}
\DoxyCodeLine{00810\ \ \ \ \ \}}
\DoxyCodeLine{00811\ \ \ \}}
\DoxyCodeLine{00812\ }
\DoxyCodeLine{00813\ \ \ \textcolor{comment}{//\ Returns\ true\ if\ and\ only\ if\ test\ name\ (this\ is\ generated\ by\ appending\ test}}
\DoxyCodeLine{00814\ \ \ \textcolor{comment}{//\ suit\ name\ and\ test\ name\ via\ a\ '.'\ character)\ matches\ the\ positive\ filter}}
\DoxyCodeLine{00815\ \ \ \textcolor{comment}{//\ and\ does\ not\ match\ the\ negative\ filter.}}
\DoxyCodeLine{00816\ \ \ \textcolor{keywordtype}{bool}\ MatchesTest(\textcolor{keyword}{const}\ std::string\&\ test\_suite\_name,}
\DoxyCodeLine{00817\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ test\_name)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00818\ \ \ \ \ \textcolor{keywordflow}{return}\ MatchesName(test\_suite\_name\ +\ \textcolor{stringliteral}{"{}."{}}\ +\ test\_name);}
\DoxyCodeLine{00819\ \ \ \}}
\DoxyCodeLine{00820\ }
\DoxyCodeLine{00821\ \ \ \textcolor{comment}{//\ Returns\ true\ if\ and\ only\ if\ name\ matches\ the\ positive\ filter\ and\ does\ not}}
\DoxyCodeLine{00822\ \ \ \textcolor{comment}{//\ match\ the\ negative\ filter.}}
\DoxyCodeLine{00823\ \ \ \textcolor{keywordtype}{bool}\ MatchesName(\textcolor{keyword}{const}\ std::string\&\ name)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00824\ \ \ \ \ \textcolor{keywordflow}{return}\ positive\_filter\_.MatchesName(name)\ \&\&}
\DoxyCodeLine{00825\ \ \ \ \ \ \ \ \ \ \ \ !negative\_filter\_.MatchesName(name);}
\DoxyCodeLine{00826\ \ \ \}}
\DoxyCodeLine{00827\ }
\DoxyCodeLine{00828\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00829\ \ \ UnitTestFilter\ positive\_filter\_;}
\DoxyCodeLine{00830\ \ \ UnitTestFilter\ negative\_filter\_;}
\DoxyCodeLine{00831\ \};}
\DoxyCodeLine{00832\ \}\ \ \textcolor{comment}{//\ namespace}}
\DoxyCodeLine{00833\ }
\DoxyCodeLine{00834\ \textcolor{keywordtype}{bool}\ UnitTestOptions::MatchesFilter(\textcolor{keyword}{const}\ std::string\&\ name\_str,}
\DoxyCodeLine{00835\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ filter)\ \{}
\DoxyCodeLine{00836\ \ \ \textcolor{keywordflow}{return}\ UnitTestFilter(filter).MatchesName(name\_str);}
\DoxyCodeLine{00837\ \}}
\DoxyCodeLine{00838\ }
\DoxyCodeLine{00839\ \textcolor{comment}{//\ Returns\ true\ if\ and\ only\ if\ the\ user-\/specified\ filter\ matches\ the\ test}}
\DoxyCodeLine{00840\ \textcolor{comment}{//\ suite\ name\ and\ the\ test\ name.}}
\DoxyCodeLine{00841\ \textcolor{keywordtype}{bool}\ UnitTestOptions::FilterMatchesTest(\textcolor{keyword}{const}\ std::string\&\ test\_suite\_name,}
\DoxyCodeLine{00842\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ test\_name)\ \{}
\DoxyCodeLine{00843\ \ \ \textcolor{comment}{//\ Split\ -\/-\/gtest\_filter\ at\ '-\/',\ if\ there\ is\ one,\ to\ separate\ into}}
\DoxyCodeLine{00844\ \ \ \textcolor{comment}{//\ positive\ filter\ and\ negative\ filter\ portions}}
\DoxyCodeLine{00845\ \ \ \textcolor{keywordflow}{return}\ PositiveAndNegativeUnitTestFilter(GTEST\_FLAG\_GET(filter))}
\DoxyCodeLine{00846\ \ \ \ \ \ \ .MatchesTest(test\_suite\_name,\ test\_name);}
\DoxyCodeLine{00847\ \}}
\DoxyCodeLine{00848\ }
\DoxyCodeLine{00849\ \textcolor{preprocessor}{\#if\ GTEST\_HAS\_SEH}}
\DoxyCodeLine{00850\ \textcolor{comment}{//\ Returns\ EXCEPTION\_EXECUTE\_HANDLER\ if\ Google\ Test\ should\ handle\ the}}
\DoxyCodeLine{00851\ \textcolor{comment}{//\ given\ SEH\ exception,\ or\ EXCEPTION\_CONTINUE\_SEARCH\ otherwise.}}
\DoxyCodeLine{00852\ \textcolor{comment}{//\ This\ function\ is\ useful\ as\ an\ \_\_except\ condition.}}
\DoxyCodeLine{00853\ \textcolor{keywordtype}{int}\ UnitTestOptions::GTestShouldProcessSEH(DWORD\ exception\_code)\ \{}
\DoxyCodeLine{00854\ \ \ \textcolor{comment}{//\ Google\ Test\ should\ handle\ a\ SEH\ exception\ if:}}
\DoxyCodeLine{00855\ \ \ \textcolor{comment}{//\ \ \ 1.\ the\ user\ wants\ it\ to,\ AND}}
\DoxyCodeLine{00856\ \ \ \textcolor{comment}{//\ \ \ 2.\ this\ is\ not\ a\ breakpoint\ exception,\ AND}}
\DoxyCodeLine{00857\ \ \ \textcolor{comment}{//\ \ \ 3.\ this\ is\ not\ a\ C++\ exception\ (VC++\ implements\ them\ via\ SEH,}}
\DoxyCodeLine{00858\ \ \ \textcolor{comment}{//\ \ \ \ \ \ apparently).}}
\DoxyCodeLine{00859\ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00860\ \ \ \textcolor{comment}{//\ SEH\ exception\ code\ for\ C++\ exceptions.}}
\DoxyCodeLine{00861\ \ \ \textcolor{comment}{//\ (see\ http://support.microsoft.com/kb/185294\ for\ more\ information).}}
\DoxyCodeLine{00862\ \ \ \textcolor{keyword}{const}\ DWORD\ kCxxExceptionCode\ =\ 0xe06d7363;}
\DoxyCodeLine{00863\ }
\DoxyCodeLine{00864\ \ \ \textcolor{keywordtype}{bool}\ should\_handle\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00865\ }
\DoxyCodeLine{00866\ \ \ \textcolor{keywordflow}{if}\ (!GTEST\_FLAG\_GET(catch\_exceptions))}
\DoxyCodeLine{00867\ \ \ \ \ should\_handle\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00868\ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (exception\_code\ ==\ EXCEPTION\_BREAKPOINT)}
\DoxyCodeLine{00869\ \ \ \ \ should\_handle\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00870\ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (exception\_code\ ==\ kCxxExceptionCode)}
\DoxyCodeLine{00871\ \ \ \ \ should\_handle\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00872\ }
\DoxyCodeLine{00873\ \ \ \textcolor{keywordflow}{return}\ should\_handle\ ?\ EXCEPTION\_EXECUTE\_HANDLER\ :\ EXCEPTION\_CONTINUE\_SEARCH;}
\DoxyCodeLine{00874\ \}}
\DoxyCodeLine{00875\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GTEST\_HAS\_SEH}}
\DoxyCodeLine{00876\ }
\DoxyCodeLine{00877\ \}\ \ \textcolor{comment}{//\ namespace\ internal}}
\DoxyCodeLine{00878\ }
\DoxyCodeLine{00879\ \textcolor{comment}{//\ The\ c'tor\ sets\ this\ object\ as\ the\ test\ part\ result\ reporter\ used\ by}}
\DoxyCodeLine{00880\ \textcolor{comment}{//\ Google\ Test.\ \ The\ 'result'\ parameter\ specifies\ where\ to\ report\ the}}
\DoxyCodeLine{00881\ \textcolor{comment}{//\ results.\ Intercepts\ only\ failures\ from\ the\ current\ thread.}}
\DoxyCodeLine{00882\ ScopedFakeTestPartResultReporter::ScopedFakeTestPartResultReporter(}
\DoxyCodeLine{00883\ \ \ \ \ TestPartResultArray*\ result)}
\DoxyCodeLine{00884\ \ \ \ \ :\ intercept\_mode\_(INTERCEPT\_ONLY\_CURRENT\_THREAD),\ result\_(result)\ \{}
\DoxyCodeLine{00885\ \ \ Init();}
\DoxyCodeLine{00886\ \}}
\DoxyCodeLine{00887\ }
\DoxyCodeLine{00888\ \textcolor{comment}{//\ The\ c'tor\ sets\ this\ object\ as\ the\ test\ part\ result\ reporter\ used\ by}}
\DoxyCodeLine{00889\ \textcolor{comment}{//\ Google\ Test.\ \ The\ 'result'\ parameter\ specifies\ where\ to\ report\ the}}
\DoxyCodeLine{00890\ \textcolor{comment}{//\ results.}}
\DoxyCodeLine{00891\ ScopedFakeTestPartResultReporter::ScopedFakeTestPartResultReporter(}
\DoxyCodeLine{00892\ \ \ \ \ InterceptMode\ intercept\_mode,\ TestPartResultArray*\ result)}
\DoxyCodeLine{00893\ \ \ \ \ :\ intercept\_mode\_(intercept\_mode),\ result\_(result)\ \{}
\DoxyCodeLine{00894\ \ \ Init();}
\DoxyCodeLine{00895\ \}}
\DoxyCodeLine{00896\ }
\DoxyCodeLine{00897\ \textcolor{keywordtype}{void}\ ScopedFakeTestPartResultReporter::Init()\ \{}
\DoxyCodeLine{00898\ \ \ internal::UnitTestImpl*\ \textcolor{keyword}{const}\ impl\ =\ internal::GetUnitTestImpl();}
\DoxyCodeLine{00899\ \ \ \textcolor{keywordflow}{if}\ (intercept\_mode\_\ ==\ INTERCEPT\_ALL\_THREADS)\ \{}
\DoxyCodeLine{00900\ \ \ \ \ old\_reporter\_\ =\ impl-\/>GetGlobalTestPartResultReporter();}
\DoxyCodeLine{00901\ \ \ \ \ impl-\/>SetGlobalTestPartResultReporter(\textcolor{keyword}{this});}
\DoxyCodeLine{00902\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00903\ \ \ \ \ old\_reporter\_\ =\ impl-\/>GetTestPartResultReporterForCurrentThread();}
\DoxyCodeLine{00904\ \ \ \ \ impl-\/>SetTestPartResultReporterForCurrentThread(\textcolor{keyword}{this});}
\DoxyCodeLine{00905\ \ \ \}}
\DoxyCodeLine{00906\ \}}
\DoxyCodeLine{00907\ }
\DoxyCodeLine{00908\ \textcolor{comment}{//\ The\ d'tor\ restores\ the\ test\ part\ result\ reporter\ used\ by\ Google\ Test}}
\DoxyCodeLine{00909\ \textcolor{comment}{//\ before.}}
\DoxyCodeLine{00910\ ScopedFakeTestPartResultReporter::\string~ScopedFakeTestPartResultReporter()\ \{}
\DoxyCodeLine{00911\ \ \ internal::UnitTestImpl*\ \textcolor{keyword}{const}\ impl\ =\ internal::GetUnitTestImpl();}
\DoxyCodeLine{00912\ \ \ \textcolor{keywordflow}{if}\ (intercept\_mode\_\ ==\ INTERCEPT\_ALL\_THREADS)\ \{}
\DoxyCodeLine{00913\ \ \ \ \ impl-\/>SetGlobalTestPartResultReporter(old\_reporter\_);}
\DoxyCodeLine{00914\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00915\ \ \ \ \ impl-\/>SetTestPartResultReporterForCurrentThread(old\_reporter\_);}
\DoxyCodeLine{00916\ \ \ \}}
\DoxyCodeLine{00917\ \}}
\DoxyCodeLine{00918\ }
\DoxyCodeLine{00919\ \textcolor{comment}{//\ Increments\ the\ test\ part\ result\ count\ and\ remembers\ the\ result.}}
\DoxyCodeLine{00920\ \textcolor{comment}{//\ This\ method\ is\ from\ the\ TestPartResultReporterInterface\ interface.}}
\DoxyCodeLine{00921\ \textcolor{keywordtype}{void}\ ScopedFakeTestPartResultReporter::ReportTestPartResult(}
\DoxyCodeLine{00922\ \ \ \ \ \textcolor{keyword}{const}\ TestPartResult\&\ result)\ \{}
\DoxyCodeLine{00923\ \ \ result\_-\/>Append(result);}
\DoxyCodeLine{00924\ \}}
\DoxyCodeLine{00925\ }
\DoxyCodeLine{00926\ \textcolor{keyword}{namespace\ }internal\ \{}
\DoxyCodeLine{00927\ }
\DoxyCodeLine{00928\ \textcolor{comment}{//\ Returns\ the\ type\ ID\ of\ ::testing::Test.\ \ We\ should\ always\ call\ this}}
\DoxyCodeLine{00929\ \textcolor{comment}{//\ instead\ of\ GetTypeId<\ ::testing::Test>()\ to\ get\ the\ type\ ID\ of}}
\DoxyCodeLine{00930\ \textcolor{comment}{//\ testing::Test.\ \ This\ is\ to\ work\ around\ a\ suspected\ linker\ bug\ when}}
\DoxyCodeLine{00931\ \textcolor{comment}{//\ using\ Google\ Test\ as\ a\ framework\ on\ Mac\ OS\ X.\ \ The\ bug\ causes}}
\DoxyCodeLine{00932\ \textcolor{comment}{//\ GetTypeId<\ ::testing::Test>()\ to\ return\ different\ values\ depending}}
\DoxyCodeLine{00933\ \textcolor{comment}{//\ on\ whether\ the\ call\ is\ from\ the\ Google\ Test\ framework\ itself\ or}}
\DoxyCodeLine{00934\ \textcolor{comment}{//\ from\ user\ test\ code.\ \ GetTestTypeId()\ is\ guaranteed\ to\ always}}
\DoxyCodeLine{00935\ \textcolor{comment}{//\ return\ the\ same\ value,\ as\ it\ always\ calls\ GetTypeId<>()\ from\ the}}
\DoxyCodeLine{00936\ \textcolor{comment}{//\ gtest.cc,\ which\ is\ within\ the\ Google\ Test\ framework.}}
\DoxyCodeLine{00937\ TypeId\ GetTestTypeId()\ \{\ \textcolor{keywordflow}{return}\ GetTypeId<Test>();\ \}}
\DoxyCodeLine{00938\ }
\DoxyCodeLine{00939\ \textcolor{comment}{//\ The\ value\ of\ GetTestTypeId()\ as\ seen\ from\ within\ the\ Google\ Test}}
\DoxyCodeLine{00940\ \textcolor{comment}{//\ library.\ \ This\ is\ solely\ for\ testing\ GetTestTypeId().}}
\DoxyCodeLine{00941\ \textcolor{keyword}{extern}\ \textcolor{keyword}{const}\ TypeId\ kTestTypeIdInGoogleTest\ =\ GetTestTypeId();}
\DoxyCodeLine{00942\ }
\DoxyCodeLine{00943\ \textcolor{comment}{//\ This\ predicate-\/formatter\ checks\ that\ 'results'\ contains\ a\ test\ part}}
\DoxyCodeLine{00944\ \textcolor{comment}{//\ failure\ of\ the\ given\ type\ and\ that\ the\ failure\ message\ contains\ the}}
\DoxyCodeLine{00945\ \textcolor{comment}{//\ given\ substring.}}
\DoxyCodeLine{00946\ \textcolor{keyword}{static}\ AssertionResult\ HasOneFailure(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \textcolor{comment}{/*\ results\_expr\ */},}
\DoxyCodeLine{00947\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \textcolor{comment}{/*\ type\_expr\ */},}
\DoxyCodeLine{00948\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \textcolor{comment}{/*\ substr\_expr\ */},}
\DoxyCodeLine{00949\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ TestPartResultArray\&\ results,}
\DoxyCodeLine{00950\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ TestPartResult::Type\ type,}
\DoxyCodeLine{00951\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ substr)\ \{}
\DoxyCodeLine{00952\ \ \ \textcolor{keyword}{const}\ std::string\ expected(type\ ==\ TestPartResult::kFatalFailure}
\DoxyCodeLine{00953\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ?\ \textcolor{stringliteral}{"{}1\ fatal\ failure"{}}}
\DoxyCodeLine{00954\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ \textcolor{stringliteral}{"{}1\ non-\/fatal\ failure"{}});}
\DoxyCodeLine{00955\ \ \ Message\ msg;}
\DoxyCodeLine{00956\ \ \ \textcolor{keywordflow}{if}\ (results.size()\ !=\ 1)\ \{}
\DoxyCodeLine{00957\ \ \ \ \ msg\ <<\ \textcolor{stringliteral}{"{}Expected:\ "{}}\ <<\ expected\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{00958\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ \ Actual:\ "{}}\ <<\ results.size()\ <<\ \textcolor{stringliteral}{"{}\ failures"{}};}
\DoxyCodeLine{00959\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ results.size();\ i++)\ \{}
\DoxyCodeLine{00960\ \ \ \ \ \ \ msg\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}\ <<\ results.GetTestPartResult(i);}
\DoxyCodeLine{00961\ \ \ \ \ \}}
\DoxyCodeLine{00962\ \ \ \ \ \textcolor{keywordflow}{return}\ AssertionFailure()\ <<\ msg;}
\DoxyCodeLine{00963\ \ \ \}}
\DoxyCodeLine{00964\ }
\DoxyCodeLine{00965\ \ \ \textcolor{keyword}{const}\ TestPartResult\&\ r\ =\ results.GetTestPartResult(0);}
\DoxyCodeLine{00966\ \ \ \textcolor{keywordflow}{if}\ (r.type()\ !=\ type)\ \{}
\DoxyCodeLine{00967\ \ \ \ \ \textcolor{keywordflow}{return}\ AssertionFailure()\ <<\ \textcolor{stringliteral}{"{}Expected:\ "{}}\ <<\ expected\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{00968\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ \ Actual:\(\backslash\)n"{}}}
\DoxyCodeLine{00969\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ r;}
\DoxyCodeLine{00970\ \ \ \}}
\DoxyCodeLine{00971\ }
\DoxyCodeLine{00972\ \ \ \textcolor{keywordflow}{if}\ (strstr(r.message(),\ substr.c\_str())\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00973\ \ \ \ \ \textcolor{keywordflow}{return}\ AssertionFailure()}
\DoxyCodeLine{00974\ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Expected:\ "{}}\ <<\ expected\ <<\ \textcolor{stringliteral}{"{}\ containing\ \(\backslash\)"{}"{}}\ <<\ substr\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}\(\backslash\)n"{}}}
\DoxyCodeLine{00975\ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ \ Actual:\(\backslash\)n"{}}}
\DoxyCodeLine{00976\ \ \ \ \ \ \ \ \ \ \ \ <<\ r;}
\DoxyCodeLine{00977\ \ \ \}}
\DoxyCodeLine{00978\ }
\DoxyCodeLine{00979\ \ \ \textcolor{keywordflow}{return}\ AssertionSuccess();}
\DoxyCodeLine{00980\ \}}
\DoxyCodeLine{00981\ }
\DoxyCodeLine{00982\ \textcolor{comment}{//\ The\ constructor\ of\ SingleFailureChecker\ remembers\ where\ to\ look\ up}}
\DoxyCodeLine{00983\ \textcolor{comment}{//\ test\ part\ results,\ what\ type\ of\ failure\ we\ expect,\ and\ what}}
\DoxyCodeLine{00984\ \textcolor{comment}{//\ substring\ the\ failure\ message\ should\ contain.}}
\DoxyCodeLine{00985\ SingleFailureChecker::SingleFailureChecker(\textcolor{keyword}{const}\ TestPartResultArray*\ results,}
\DoxyCodeLine{00986\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ TestPartResult::Type\ type,}
\DoxyCodeLine{00987\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ substr)}
\DoxyCodeLine{00988\ \ \ \ \ :\ results\_(results),\ type\_(type),\ substr\_(substr)\ \{\}}
\DoxyCodeLine{00989\ }
\DoxyCodeLine{00990\ \textcolor{comment}{//\ The\ destructor\ of\ SingleFailureChecker\ verifies\ that\ the\ given}}
\DoxyCodeLine{00991\ \textcolor{comment}{//\ TestPartResultArray\ contains\ exactly\ one\ failure\ that\ has\ the\ given}}
\DoxyCodeLine{00992\ \textcolor{comment}{//\ type\ and\ contains\ the\ given\ substring.\ \ If\ that's\ not\ the\ case,\ a}}
\DoxyCodeLine{00993\ \textcolor{comment}{//\ non-\/fatal\ failure\ will\ be\ generated.}}
\DoxyCodeLine{00994\ SingleFailureChecker::\string~SingleFailureChecker()\ \{}
\DoxyCodeLine{00995\ \ \ EXPECT\_PRED\_FORMAT3(HasOneFailure,\ *results\_,\ type\_,\ substr\_);}
\DoxyCodeLine{00996\ \}}
\DoxyCodeLine{00997\ }
\DoxyCodeLine{00998\ DefaultGlobalTestPartResultReporter::DefaultGlobalTestPartResultReporter(}
\DoxyCodeLine{00999\ \ \ \ \ UnitTestImpl*\ unit\_test)}
\DoxyCodeLine{01000\ \ \ \ \ :\ unit\_test\_(unit\_test)\ \{\}}
\DoxyCodeLine{01001\ }
\DoxyCodeLine{01002\ \textcolor{keywordtype}{void}\ DefaultGlobalTestPartResultReporter::ReportTestPartResult(}
\DoxyCodeLine{01003\ \ \ \ \ \textcolor{keyword}{const}\ TestPartResult\&\ result)\ \{}
\DoxyCodeLine{01004\ \ \ unit\_test\_-\/>current\_test\_result()-\/>AddTestPartResult(result);}
\DoxyCodeLine{01005\ \ \ unit\_test\_-\/>listeners()-\/>repeater()-\/>OnTestPartResult(result);}
\DoxyCodeLine{01006\ \}}
\DoxyCodeLine{01007\ }
\DoxyCodeLine{01008\ DefaultPerThreadTestPartResultReporter::DefaultPerThreadTestPartResultReporter(}
\DoxyCodeLine{01009\ \ \ \ \ UnitTestImpl*\ unit\_test)}
\DoxyCodeLine{01010\ \ \ \ \ :\ unit\_test\_(unit\_test)\ \{\}}
\DoxyCodeLine{01011\ }
\DoxyCodeLine{01012\ \textcolor{keywordtype}{void}\ DefaultPerThreadTestPartResultReporter::ReportTestPartResult(}
\DoxyCodeLine{01013\ \ \ \ \ \textcolor{keyword}{const}\ TestPartResult\&\ result)\ \{}
\DoxyCodeLine{01014\ \ \ unit\_test\_-\/>GetGlobalTestPartResultReporter()-\/>ReportTestPartResult(result);}
\DoxyCodeLine{01015\ \}}
\DoxyCodeLine{01016\ }
\DoxyCodeLine{01017\ \textcolor{comment}{//\ Returns\ the\ global\ test\ part\ result\ reporter.}}
\DoxyCodeLine{01018\ TestPartResultReporterInterface*}
\DoxyCodeLine{01019\ UnitTestImpl::GetGlobalTestPartResultReporter()\ \{}
\DoxyCodeLine{01020\ \ \ internal::MutexLock\ lock(\&global\_test\_part\_result\_reporter\_mutex\_);}
\DoxyCodeLine{01021\ \ \ \textcolor{keywordflow}{return}\ global\_test\_part\_result\_reporter\_;}
\DoxyCodeLine{01022\ \}}
\DoxyCodeLine{01023\ }
\DoxyCodeLine{01024\ \textcolor{comment}{//\ Sets\ the\ global\ test\ part\ result\ reporter.}}
\DoxyCodeLine{01025\ \textcolor{keywordtype}{void}\ UnitTestImpl::SetGlobalTestPartResultReporter(}
\DoxyCodeLine{01026\ \ \ \ \ TestPartResultReporterInterface*\ reporter)\ \{}
\DoxyCodeLine{01027\ \ \ internal::MutexLock\ lock(\&global\_test\_part\_result\_reporter\_mutex\_);}
\DoxyCodeLine{01028\ \ \ global\_test\_part\_result\_reporter\_\ =\ reporter;}
\DoxyCodeLine{01029\ \}}
\DoxyCodeLine{01030\ }
\DoxyCodeLine{01031\ \textcolor{comment}{//\ Returns\ the\ test\ part\ result\ reporter\ for\ the\ current\ thread.}}
\DoxyCodeLine{01032\ TestPartResultReporterInterface*}
\DoxyCodeLine{01033\ UnitTestImpl::GetTestPartResultReporterForCurrentThread()\ \{}
\DoxyCodeLine{01034\ \ \ \textcolor{keywordflow}{return}\ per\_thread\_test\_part\_result\_reporter\_.get();}
\DoxyCodeLine{01035\ \}}
\DoxyCodeLine{01036\ }
\DoxyCodeLine{01037\ \textcolor{comment}{//\ Sets\ the\ test\ part\ result\ reporter\ for\ the\ current\ thread.}}
\DoxyCodeLine{01038\ \textcolor{keywordtype}{void}\ UnitTestImpl::SetTestPartResultReporterForCurrentThread(}
\DoxyCodeLine{01039\ \ \ \ \ TestPartResultReporterInterface*\ reporter)\ \{}
\DoxyCodeLine{01040\ \ \ per\_thread\_test\_part\_result\_reporter\_.set(reporter);}
\DoxyCodeLine{01041\ \}}
\DoxyCodeLine{01042\ }
\DoxyCodeLine{01043\ \textcolor{comment}{//\ Gets\ the\ number\ of\ successful\ test\ suites.}}
\DoxyCodeLine{01044\ \textcolor{keywordtype}{int}\ UnitTestImpl::successful\_test\_suite\_count()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01045\ \ \ \textcolor{keywordflow}{return}\ CountIf(test\_suites\_,\ TestSuitePassed);}
\DoxyCodeLine{01046\ \}}
\DoxyCodeLine{01047\ }
\DoxyCodeLine{01048\ \textcolor{comment}{//\ Gets\ the\ number\ of\ failed\ test\ suites.}}
\DoxyCodeLine{01049\ \textcolor{keywordtype}{int}\ UnitTestImpl::failed\_test\_suite\_count()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01050\ \ \ \textcolor{keywordflow}{return}\ CountIf(test\_suites\_,\ TestSuiteFailed);}
\DoxyCodeLine{01051\ \}}
\DoxyCodeLine{01052\ }
\DoxyCodeLine{01053\ \textcolor{comment}{//\ Gets\ the\ number\ of\ all\ test\ suites.}}
\DoxyCodeLine{01054\ \textcolor{keywordtype}{int}\ UnitTestImpl::total\_test\_suite\_count()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01055\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(test\_suites\_.size());}
\DoxyCodeLine{01056\ \}}
\DoxyCodeLine{01057\ }
\DoxyCodeLine{01058\ \textcolor{comment}{//\ Gets\ the\ number\ of\ all\ test\ suites\ that\ contain\ at\ least\ one\ test}}
\DoxyCodeLine{01059\ \textcolor{comment}{//\ that\ should\ run.}}
\DoxyCodeLine{01060\ \textcolor{keywordtype}{int}\ UnitTestImpl::test\_suite\_to\_run\_count()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01061\ \ \ \textcolor{keywordflow}{return}\ CountIf(test\_suites\_,\ ShouldRunTestSuite);}
\DoxyCodeLine{01062\ \}}
\DoxyCodeLine{01063\ }
\DoxyCodeLine{01064\ \textcolor{comment}{//\ Gets\ the\ number\ of\ successful\ tests.}}
\DoxyCodeLine{01065\ \textcolor{keywordtype}{int}\ UnitTestImpl::successful\_test\_count()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01066\ \ \ \textcolor{keywordflow}{return}\ SumOverTestSuiteList(test\_suites\_,\ \&TestSuite::successful\_test\_count);}
\DoxyCodeLine{01067\ \}}
\DoxyCodeLine{01068\ }
\DoxyCodeLine{01069\ \textcolor{comment}{//\ Gets\ the\ number\ of\ skipped\ tests.}}
\DoxyCodeLine{01070\ \textcolor{keywordtype}{int}\ UnitTestImpl::skipped\_test\_count()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01071\ \ \ \textcolor{keywordflow}{return}\ SumOverTestSuiteList(test\_suites\_,\ \&TestSuite::skipped\_test\_count);}
\DoxyCodeLine{01072\ \}}
\DoxyCodeLine{01073\ }
\DoxyCodeLine{01074\ \textcolor{comment}{//\ Gets\ the\ number\ of\ failed\ tests.}}
\DoxyCodeLine{01075\ \textcolor{keywordtype}{int}\ UnitTestImpl::failed\_test\_count()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01076\ \ \ \textcolor{keywordflow}{return}\ SumOverTestSuiteList(test\_suites\_,\ \&TestSuite::failed\_test\_count);}
\DoxyCodeLine{01077\ \}}
\DoxyCodeLine{01078\ }
\DoxyCodeLine{01079\ \textcolor{comment}{//\ Gets\ the\ number\ of\ disabled\ tests\ that\ will\ be\ reported\ in\ the\ XML\ report.}}
\DoxyCodeLine{01080\ \textcolor{keywordtype}{int}\ UnitTestImpl::reportable\_disabled\_test\_count()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01081\ \ \ \textcolor{keywordflow}{return}\ SumOverTestSuiteList(test\_suites\_,}
\DoxyCodeLine{01082\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&TestSuite::reportable\_disabled\_test\_count);}
\DoxyCodeLine{01083\ \}}
\DoxyCodeLine{01084\ }
\DoxyCodeLine{01085\ \textcolor{comment}{//\ Gets\ the\ number\ of\ disabled\ tests.}}
\DoxyCodeLine{01086\ \textcolor{keywordtype}{int}\ UnitTestImpl::disabled\_test\_count()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01087\ \ \ \textcolor{keywordflow}{return}\ SumOverTestSuiteList(test\_suites\_,\ \&TestSuite::disabled\_test\_count);}
\DoxyCodeLine{01088\ \}}
\DoxyCodeLine{01089\ }
\DoxyCodeLine{01090\ \textcolor{comment}{//\ Gets\ the\ number\ of\ tests\ to\ be\ printed\ in\ the\ XML\ report.}}
\DoxyCodeLine{01091\ \textcolor{keywordtype}{int}\ UnitTestImpl::reportable\_test\_count()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01092\ \ \ \textcolor{keywordflow}{return}\ SumOverTestSuiteList(test\_suites\_,\ \&TestSuite::reportable\_test\_count);}
\DoxyCodeLine{01093\ \}}
\DoxyCodeLine{01094\ }
\DoxyCodeLine{01095\ \textcolor{comment}{//\ Gets\ the\ number\ of\ all\ tests.}}
\DoxyCodeLine{01096\ \textcolor{keywordtype}{int}\ UnitTestImpl::total\_test\_count()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01097\ \ \ \textcolor{keywordflow}{return}\ SumOverTestSuiteList(test\_suites\_,\ \&TestSuite::total\_test\_count);}
\DoxyCodeLine{01098\ \}}
\DoxyCodeLine{01099\ }
\DoxyCodeLine{01100\ \textcolor{comment}{//\ Gets\ the\ number\ of\ tests\ that\ should\ run.}}
\DoxyCodeLine{01101\ \textcolor{keywordtype}{int}\ UnitTestImpl::test\_to\_run\_count()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01102\ \ \ \textcolor{keywordflow}{return}\ SumOverTestSuiteList(test\_suites\_,\ \&TestSuite::test\_to\_run\_count);}
\DoxyCodeLine{01103\ \}}
\DoxyCodeLine{01104\ }
\DoxyCodeLine{01105\ \textcolor{comment}{//\ Returns\ the\ current\ OS\ stack\ trace\ as\ an\ std::string.}}
\DoxyCodeLine{01106\ \textcolor{comment}{//}}
\DoxyCodeLine{01107\ \textcolor{comment}{//\ The\ maximum\ number\ of\ stack\ frames\ to\ be\ included\ is\ specified\ by}}
\DoxyCodeLine{01108\ \textcolor{comment}{//\ the\ gtest\_stack\_trace\_depth\ flag.\ \ The\ skip\_count\ parameter}}
\DoxyCodeLine{01109\ \textcolor{comment}{//\ specifies\ the\ number\ of\ top\ frames\ to\ be\ skipped,\ which\ doesn't}}
\DoxyCodeLine{01110\ \textcolor{comment}{//\ count\ against\ the\ number\ of\ frames\ to\ be\ included.}}
\DoxyCodeLine{01111\ \textcolor{comment}{//}}
\DoxyCodeLine{01112\ \textcolor{comment}{//\ For\ example,\ if\ Foo()\ calls\ Bar(),\ which\ in\ turn\ calls}}
\DoxyCodeLine{01113\ \textcolor{comment}{//\ CurrentOsStackTraceExceptTop(1),\ Foo()\ will\ be\ included\ in\ the}}
\DoxyCodeLine{01114\ \textcolor{comment}{//\ trace\ but\ Bar()\ and\ CurrentOsStackTraceExceptTop()\ won't.}}
\DoxyCodeLine{01115\ std::string\ UnitTestImpl::CurrentOsStackTraceExceptTop(\textcolor{keywordtype}{int}\ skip\_count)\ \{}
\DoxyCodeLine{01116\ \ \ \textcolor{keywordflow}{return}\ os\_stack\_trace\_getter()-\/>CurrentStackTrace(}
\DoxyCodeLine{01117\ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(GTEST\_FLAG\_GET(stack\_trace\_depth)),\ skip\_count\ +\ 1}
\DoxyCodeLine{01118\ \ \ \ \ \ \ \textcolor{comment}{//\ Skips\ the\ user-\/specified\ number\ of\ frames\ plus\ this\ function}}
\DoxyCodeLine{01119\ \ \ \ \ \ \ \textcolor{comment}{//\ itself.}}
\DoxyCodeLine{01120\ \ \ );\ \ \textcolor{comment}{//\ NOLINT}}
\DoxyCodeLine{01121\ \}}
\DoxyCodeLine{01122\ }
\DoxyCodeLine{01123\ \textcolor{comment}{//\ A\ helper\ class\ for\ measuring\ elapsed\ times.}}
\DoxyCodeLine{01124\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classtesting_1_1internal_1_1_timer}{Timer}}\ \{}
\DoxyCodeLine{01125\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{01126\ \ \ \mbox{\hyperlink{classtesting_1_1internal_1_1_timer}{Timer}}()\ :\ start\_(std::chrono::steady\_clock::now())\ \{\}}
\DoxyCodeLine{01127\ }
\DoxyCodeLine{01128\ \ \ \textcolor{comment}{//\ Return\ time\ elapsed\ in\ milliseconds\ since\ the\ timer\ was\ created.}}
\DoxyCodeLine{01129\ \ \ TimeInMillis\ Elapsed()\ \{}
\DoxyCodeLine{01130\ \ \ \ \ \textcolor{keywordflow}{return}\ std::chrono::duration\_cast<std::chrono::milliseconds>(}
\DoxyCodeLine{01131\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::chrono::steady\_clock::now()\ -\/\ start\_)}
\DoxyCodeLine{01132\ \ \ \ \ \ \ \ \ .count();}
\DoxyCodeLine{01133\ \ \ \}}
\DoxyCodeLine{01134\ }
\DoxyCodeLine{01135\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{01136\ \ \ std::chrono::steady\_clock::time\_point\ start\_;}
\DoxyCodeLine{01137\ \};}
\DoxyCodeLine{01138\ }
\DoxyCodeLine{01139\ \textcolor{comment}{//\ Returns\ a\ timestamp\ as\ milliseconds\ since\ the\ epoch.\ Note\ this\ time\ may\ jump}}
\DoxyCodeLine{01140\ \textcolor{comment}{//\ around\ subject\ to\ adjustments\ by\ the\ system,\ to\ measure\ elapsed\ time\ use}}
\DoxyCodeLine{01141\ \textcolor{comment}{//\ Timer\ instead.}}
\DoxyCodeLine{01142\ TimeInMillis\ GetTimeInMillis()\ \{}
\DoxyCodeLine{01143\ \ \ \textcolor{keywordflow}{return}\ std::chrono::duration\_cast<std::chrono::milliseconds>(}
\DoxyCodeLine{01144\ \ \ \ \ \ \ \ \ \ \ \ \ \ std::chrono::system\_clock::now()\ -\/}
\DoxyCodeLine{01145\ \ \ \ \ \ \ \ \ \ \ \ \ \ std::chrono::system\_clock::from\_time\_t(0))}
\DoxyCodeLine{01146\ \ \ \ \ \ \ .count();}
\DoxyCodeLine{01147\ \}}
\DoxyCodeLine{01148\ }
\DoxyCodeLine{01149\ \textcolor{comment}{//\ Utilities}}
\DoxyCodeLine{01150\ }
\DoxyCodeLine{01151\ \textcolor{comment}{//\ class\ String.}}
\DoxyCodeLine{01152\ }
\DoxyCodeLine{01153\ \textcolor{preprocessor}{\#if\ GTEST\_OS\_WINDOWS\_MOBILE}}
\DoxyCodeLine{01154\ \textcolor{comment}{//\ Creates\ a\ UTF-\/16\ wide\ string\ from\ the\ given\ ANSI\ string,\ allocating}}
\DoxyCodeLine{01155\ \textcolor{comment}{//\ memory\ using\ new.\ The\ caller\ is\ responsible\ for\ deleting\ the\ return}}
\DoxyCodeLine{01156\ \textcolor{comment}{//\ value\ using\ delete[].\ Returns\ the\ wide\ string,\ or\ NULL\ if\ the}}
\DoxyCodeLine{01157\ \textcolor{comment}{//\ input\ is\ NULL.}}
\DoxyCodeLine{01158\ LPCWSTR\ String::AnsiToUtf16(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ ansi)\ \{}
\DoxyCodeLine{01159\ \ \ \textcolor{keywordflow}{if}\ (!ansi)\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01160\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ length\ =\ strlen(ansi);}
\DoxyCodeLine{01161\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ unicode\_length\ =}
\DoxyCodeLine{01162\ \ \ \ \ \ \ MultiByteToWideChar(CP\_ACP,\ 0,\ ansi,\ length,\ \textcolor{keyword}{nullptr},\ 0);}
\DoxyCodeLine{01163\ \ \ WCHAR*\ unicode\ =\ \textcolor{keyword}{new}\ WCHAR[unicode\_length\ +\ 1];}
\DoxyCodeLine{01164\ \ \ MultiByteToWideChar(CP\_ACP,\ 0,\ ansi,\ length,\ unicode,\ unicode\_length);}
\DoxyCodeLine{01165\ \ \ unicode[unicode\_length]\ =\ 0;}
\DoxyCodeLine{01166\ \ \ \textcolor{keywordflow}{return}\ unicode;}
\DoxyCodeLine{01167\ \}}
\DoxyCodeLine{01168\ }
\DoxyCodeLine{01169\ \textcolor{comment}{//\ Creates\ an\ ANSI\ string\ from\ the\ given\ wide\ string,\ allocating}}
\DoxyCodeLine{01170\ \textcolor{comment}{//\ memory\ using\ new.\ The\ caller\ is\ responsible\ for\ deleting\ the\ return}}
\DoxyCodeLine{01171\ \textcolor{comment}{//\ value\ using\ delete[].\ Returns\ the\ ANSI\ string,\ or\ NULL\ if\ the}}
\DoxyCodeLine{01172\ \textcolor{comment}{//\ input\ is\ NULL.}}
\DoxyCodeLine{01173\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ String::Utf16ToAnsi(LPCWSTR\ utf16\_str)\ \{}
\DoxyCodeLine{01174\ \ \ \textcolor{keywordflow}{if}\ (!utf16\_str)\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01175\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ ansi\_length\ =\ WideCharToMultiByte(CP\_ACP,\ 0,\ utf16\_str,\ -\/1,\ \textcolor{keyword}{nullptr},}
\DoxyCodeLine{01176\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0,\ \textcolor{keyword}{nullptr},\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{01177\ \ \ \textcolor{keywordtype}{char}*\ ansi\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{char}[ansi\_length\ +\ 1];}
\DoxyCodeLine{01178\ \ \ WideCharToMultiByte(CP\_ACP,\ 0,\ utf16\_str,\ -\/1,\ ansi,\ ansi\_length,\ \textcolor{keyword}{nullptr},}
\DoxyCodeLine{01179\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{01180\ \ \ ansi[ansi\_length]\ =\ 0;}
\DoxyCodeLine{01181\ \ \ \textcolor{keywordflow}{return}\ ansi;}
\DoxyCodeLine{01182\ \}}
\DoxyCodeLine{01183\ }
\DoxyCodeLine{01184\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GTEST\_OS\_WINDOWS\_MOBILE}}
\DoxyCodeLine{01185\ }
\DoxyCodeLine{01186\ \textcolor{comment}{//\ Compares\ two\ C\ strings.\ \ Returns\ true\ if\ and\ only\ if\ they\ have\ the\ same}}
\DoxyCodeLine{01187\ \textcolor{comment}{//\ content.}}
\DoxyCodeLine{01188\ \textcolor{comment}{//}}
\DoxyCodeLine{01189\ \textcolor{comment}{//\ Unlike\ strcmp(),\ this\ function\ can\ handle\ NULL\ argument(s).\ \ A\ NULL}}
\DoxyCodeLine{01190\ \textcolor{comment}{//\ C\ string\ is\ considered\ different\ to\ any\ non-\/NULL\ C\ string,}}
\DoxyCodeLine{01191\ \textcolor{comment}{//\ including\ the\ empty\ string.}}
\DoxyCodeLine{01192\ \textcolor{keywordtype}{bool}\ String::CStringEquals(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ lhs,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ rhs)\ \{}
\DoxyCodeLine{01193\ \ \ \textcolor{keywordflow}{if}\ (lhs\ ==\ \textcolor{keyword}{nullptr})\ \textcolor{keywordflow}{return}\ rhs\ ==\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01194\ }
\DoxyCodeLine{01195\ \ \ \textcolor{keywordflow}{if}\ (rhs\ ==\ \textcolor{keyword}{nullptr})\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01196\ }
\DoxyCodeLine{01197\ \ \ \textcolor{keywordflow}{return}\ strcmp(lhs,\ rhs)\ ==\ 0;}
\DoxyCodeLine{01198\ \}}
\DoxyCodeLine{01199\ }
\DoxyCodeLine{01200\ \textcolor{preprocessor}{\#if\ GTEST\_HAS\_STD\_WSTRING}}
\DoxyCodeLine{01201\ }
\DoxyCodeLine{01202\ \textcolor{comment}{//\ Converts\ an\ array\ of\ wide\ chars\ to\ a\ narrow\ string\ using\ the\ UTF-\/8}}
\DoxyCodeLine{01203\ \textcolor{comment}{//\ encoding,\ and\ streams\ the\ result\ to\ the\ given\ Message\ object.}}
\DoxyCodeLine{01204\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ StreamWideCharsToMessage(\textcolor{keyword}{const}\ \textcolor{keywordtype}{wchar\_t}*\ wstr,\ \textcolor{keywordtype}{size\_t}\ length,}
\DoxyCodeLine{01205\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Message*\ msg)\ \{}
\DoxyCodeLine{01206\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ !=\ length;)\ \{\ \ \textcolor{comment}{//\ NOLINT}}
\DoxyCodeLine{01207\ \ \ \ \ \textcolor{keywordflow}{if}\ (wstr[i]\ !=\ L\textcolor{charliteral}{'\(\backslash\)0'})\ \{}
\DoxyCodeLine{01208\ \ \ \ \ \ \ *msg\ <<\ WideStringToUtf8(wstr\ +\ i,\ static\_cast<int>(length\ -\/\ i));}
\DoxyCodeLine{01209\ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (i\ !=\ length\ \&\&\ wstr[i]\ !=\ L\textcolor{charliteral}{'\(\backslash\)0'})\ i++;}
\DoxyCodeLine{01210\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01211\ \ \ \ \ \ \ *msg\ <<\ \textcolor{charliteral}{'\(\backslash\)0'};}
\DoxyCodeLine{01212\ \ \ \ \ \ \ i++;}
\DoxyCodeLine{01213\ \ \ \ \ \}}
\DoxyCodeLine{01214\ \ \ \}}
\DoxyCodeLine{01215\ \}}
\DoxyCodeLine{01216\ }
\DoxyCodeLine{01217\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GTEST\_HAS\_STD\_WSTRING}}
\DoxyCodeLine{01218\ }
\DoxyCodeLine{01219\ \textcolor{keywordtype}{void}\ SplitString(const\ ::std::string\&\ str,\ \textcolor{keywordtype}{char}\ delimiter,}
\DoxyCodeLine{01220\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ::std::vector<\ ::std::string>*\ dest)\ \{}
\DoxyCodeLine{01221\ \ \ ::std::vector<\ ::std::string>\ parsed;}
\DoxyCodeLine{01222\ \ \ ::std::string::size\_type\ pos\ =\ 0;}
\DoxyCodeLine{01223\ \ \ \textcolor{keywordflow}{while}\ (::testing::internal::AlwaysTrue())\ \{}
\DoxyCodeLine{01224\ \ \ \ \ const\ ::std::string::size\_type\ colon\ =\ str.find(delimiter,\ pos);}
\DoxyCodeLine{01225\ \ \ \ \ \textcolor{keywordflow}{if}\ (colon\ ==\ ::std::string::npos)\ \{}
\DoxyCodeLine{01226\ \ \ \ \ \ \ parsed.push\_back(str.substr(pos));}
\DoxyCodeLine{01227\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01228\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01229\ \ \ \ \ \ \ parsed.push\_back(str.substr(pos,\ colon\ -\/\ pos));}
\DoxyCodeLine{01230\ \ \ \ \ \ \ pos\ =\ colon\ +\ 1;}
\DoxyCodeLine{01231\ \ \ \ \ \}}
\DoxyCodeLine{01232\ \ \ \}}
\DoxyCodeLine{01233\ \ \ dest-\/>swap(parsed);}
\DoxyCodeLine{01234\ \}}
\DoxyCodeLine{01235\ }
\DoxyCodeLine{01236\ \}\ \ \textcolor{comment}{//\ namespace\ internal}}
\DoxyCodeLine{01237\ }
\DoxyCodeLine{01238\ \textcolor{comment}{//\ Constructs\ an\ empty\ Message.}}
\DoxyCodeLine{01239\ \textcolor{comment}{//\ We\ allocate\ the\ stringstream\ separately\ because\ otherwise\ each\ use\ of}}
\DoxyCodeLine{01240\ \textcolor{comment}{//\ ASSERT/EXPECT\ in\ a\ procedure\ adds\ over\ 200\ bytes\ to\ the\ procedure's}}
\DoxyCodeLine{01241\ \textcolor{comment}{//\ stack\ frame\ leading\ to\ huge\ stack\ frames\ in\ some\ cases;\ gcc\ does\ not\ reuse}}
\DoxyCodeLine{01242\ \textcolor{comment}{//\ the\ stack\ space.}}
\DoxyCodeLine{01243\ Message::Message()\ :\ ss\_(new\ ::std::stringstream)\ \{}
\DoxyCodeLine{01244\ \ \ \textcolor{comment}{//\ By\ default,\ we\ want\ there\ to\ be\ enough\ precision\ when\ printing}}
\DoxyCodeLine{01245\ \ \ \textcolor{comment}{//\ a\ double\ to\ a\ Message.}}
\DoxyCodeLine{01246\ \ \ *ss\_\ <<\ std::setprecision(std::numeric\_limits<double>::digits10\ +\ 2);}
\DoxyCodeLine{01247\ \}}
\DoxyCodeLine{01248\ }
\DoxyCodeLine{01249\ \textcolor{comment}{//\ These\ two\ overloads\ allow\ streaming\ a\ wide\ C\ string\ to\ a\ Message}}
\DoxyCodeLine{01250\ \textcolor{comment}{//\ using\ the\ UTF-\/8\ encoding.}}
\DoxyCodeLine{01251\ Message\&\ Message::operator<<(\textcolor{keyword}{const}\ \textcolor{keywordtype}{wchar\_t}*\ wide\_c\_str)\ \{}
\DoxyCodeLine{01252\ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this}\ <<\ internal::String::ShowWideCString(wide\_c\_str);}
\DoxyCodeLine{01253\ \}}
\DoxyCodeLine{01254\ Message\&\ Message::operator<<(\textcolor{keywordtype}{wchar\_t}*\ wide\_c\_str)\ \{}
\DoxyCodeLine{01255\ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this}\ <<\ internal::String::ShowWideCString(wide\_c\_str);}
\DoxyCodeLine{01256\ \}}
\DoxyCodeLine{01257\ }
\DoxyCodeLine{01258\ \textcolor{preprocessor}{\#if\ GTEST\_HAS\_STD\_WSTRING}}
\DoxyCodeLine{01259\ \textcolor{comment}{//\ Converts\ the\ given\ wide\ string\ to\ a\ narrow\ string\ using\ the\ UTF-\/8}}
\DoxyCodeLine{01260\ \textcolor{comment}{//\ encoding,\ and\ streams\ the\ result\ to\ this\ Message\ object.}}
\DoxyCodeLine{01261\ Message\&\ Message::operator<<(const\ ::std::wstring\&\ wstr)\ \{}
\DoxyCodeLine{01262\ \ \ internal::StreamWideCharsToMessage(wstr.c\_str(),\ wstr.length(),\ \textcolor{keyword}{this});}
\DoxyCodeLine{01263\ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{01264\ \}}
\DoxyCodeLine{01265\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GTEST\_HAS\_STD\_WSTRING}}
\DoxyCodeLine{01266\ }
\DoxyCodeLine{01267\ \textcolor{comment}{//\ Gets\ the\ text\ streamed\ to\ this\ object\ so\ far\ as\ an\ std::string.}}
\DoxyCodeLine{01268\ \textcolor{comment}{//\ Each\ '\(\backslash\)0'\ character\ in\ the\ buffer\ is\ replaced\ with\ "{}\(\backslash\)\(\backslash\)0"{}.}}
\DoxyCodeLine{01269\ std::string\ Message::GetString()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01270\ \ \ \textcolor{keywordflow}{return}\ internal::StringStreamToString(ss\_.get());}
\DoxyCodeLine{01271\ \}}
\DoxyCodeLine{01272\ }
\DoxyCodeLine{01273\ \textcolor{keyword}{namespace\ }internal\ \{}
\DoxyCodeLine{01274\ }
\DoxyCodeLine{01275\ \textcolor{keyword}{namespace\ }edit\_distance\ \{}
\DoxyCodeLine{01276\ std::vector<EditType>\ CalculateOptimalEdits(\textcolor{keyword}{const}\ std::vector<size\_t>\&\ left,}
\DoxyCodeLine{01277\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::vector<size\_t>\&\ right)\ \{}
\DoxyCodeLine{01278\ \ \ std::vector<std::vector<double>\ >\ costs(}
\DoxyCodeLine{01279\ \ \ \ \ \ \ left.size()\ +\ 1,\ std::vector<double>(right.size()\ +\ 1));}
\DoxyCodeLine{01280\ \ \ std::vector<std::vector<EditType>\ >\ best\_move(}
\DoxyCodeLine{01281\ \ \ \ \ \ \ left.size()\ +\ 1,\ std::vector<EditType>(right.size()\ +\ 1));}
\DoxyCodeLine{01282\ }
\DoxyCodeLine{01283\ \ \ \textcolor{comment}{//\ Populate\ for\ empty\ right.}}
\DoxyCodeLine{01284\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ l\_i\ =\ 0;\ l\_i\ <\ costs.size();\ ++l\_i)\ \{}
\DoxyCodeLine{01285\ \ \ \ \ costs[l\_i][0]\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(l\_i);}
\DoxyCodeLine{01286\ \ \ \ \ best\_move[l\_i][0]\ =\ kRemove;}
\DoxyCodeLine{01287\ \ \ \}}
\DoxyCodeLine{01288\ \ \ \textcolor{comment}{//\ Populate\ for\ empty\ left.}}
\DoxyCodeLine{01289\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ r\_i\ =\ 1;\ r\_i\ <\ costs[0].size();\ ++r\_i)\ \{}
\DoxyCodeLine{01290\ \ \ \ \ costs[0][r\_i]\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{double}\textcolor{keyword}{>}(r\_i);}
\DoxyCodeLine{01291\ \ \ \ \ best\_move[0][r\_i]\ =\ kAdd;}
\DoxyCodeLine{01292\ \ \ \}}
\DoxyCodeLine{01293\ }
\DoxyCodeLine{01294\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ l\_i\ =\ 0;\ l\_i\ <\ left.size();\ ++l\_i)\ \{}
\DoxyCodeLine{01295\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ r\_i\ =\ 0;\ r\_i\ <\ right.size();\ ++r\_i)\ \{}
\DoxyCodeLine{01296\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (left[l\_i]\ ==\ right[r\_i])\ \{}
\DoxyCodeLine{01297\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Found\ a\ match.\ Consume\ it.}}
\DoxyCodeLine{01298\ \ \ \ \ \ \ \ \ costs[l\_i\ +\ 1][r\_i\ +\ 1]\ =\ costs[l\_i][r\_i];}
\DoxyCodeLine{01299\ \ \ \ \ \ \ \ \ best\_move[l\_i\ +\ 1][r\_i\ +\ 1]\ =\ kMatch;}
\DoxyCodeLine{01300\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01301\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01302\ }
\DoxyCodeLine{01303\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ add\ =\ costs[l\_i\ +\ 1][r\_i];}
\DoxyCodeLine{01304\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ remove\ =\ costs[l\_i][r\_i\ +\ 1];}
\DoxyCodeLine{01305\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ replace\ =\ costs[l\_i][r\_i];}
\DoxyCodeLine{01306\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (add\ <\ remove\ \&\&\ add\ <\ replace)\ \{}
\DoxyCodeLine{01307\ \ \ \ \ \ \ \ \ costs[l\_i\ +\ 1][r\_i\ +\ 1]\ =\ add\ +\ 1;}
\DoxyCodeLine{01308\ \ \ \ \ \ \ \ \ best\_move[l\_i\ +\ 1][r\_i\ +\ 1]\ =\ kAdd;}
\DoxyCodeLine{01309\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (remove\ <\ add\ \&\&\ remove\ <\ replace)\ \{}
\DoxyCodeLine{01310\ \ \ \ \ \ \ \ \ costs[l\_i\ +\ 1][r\_i\ +\ 1]\ =\ remove\ +\ 1;}
\DoxyCodeLine{01311\ \ \ \ \ \ \ \ \ best\_move[l\_i\ +\ 1][r\_i\ +\ 1]\ =\ kRemove;}
\DoxyCodeLine{01312\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01313\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ We\ make\ replace\ a\ little\ more\ expensive\ than\ add/remove\ to\ lower}}
\DoxyCodeLine{01314\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ their\ priority.}}
\DoxyCodeLine{01315\ \ \ \ \ \ \ \ \ costs[l\_i\ +\ 1][r\_i\ +\ 1]\ =\ replace\ +\ 1.00001;}
\DoxyCodeLine{01316\ \ \ \ \ \ \ \ \ best\_move[l\_i\ +\ 1][r\_i\ +\ 1]\ =\ kReplace;}
\DoxyCodeLine{01317\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01318\ \ \ \ \ \}}
\DoxyCodeLine{01319\ \ \ \}}
\DoxyCodeLine{01320\ }
\DoxyCodeLine{01321\ \ \ \textcolor{comment}{//\ Reconstruct\ the\ best\ path.\ We\ do\ it\ in\ reverse\ order.}}
\DoxyCodeLine{01322\ \ \ std::vector<EditType>\ best\_path;}
\DoxyCodeLine{01323\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ l\_i\ =\ left.size(),\ r\_i\ =\ right.size();\ l\_i\ >\ 0\ ||\ r\_i\ >\ 0;)\ \{}
\DoxyCodeLine{01324\ \ \ \ \ EditType\ move\ =\ best\_move[l\_i][r\_i];}
\DoxyCodeLine{01325\ \ \ \ \ best\_path.push\_back(move);}
\DoxyCodeLine{01326\ \ \ \ \ l\_i\ -\/=\ move\ !=\ kAdd;}
\DoxyCodeLine{01327\ \ \ \ \ r\_i\ -\/=\ move\ !=\ kRemove;}
\DoxyCodeLine{01328\ \ \ \}}
\DoxyCodeLine{01329\ \ \ std::reverse(best\_path.begin(),\ best\_path.end());}
\DoxyCodeLine{01330\ \ \ \textcolor{keywordflow}{return}\ best\_path;}
\DoxyCodeLine{01331\ \}}
\DoxyCodeLine{01332\ }
\DoxyCodeLine{01333\ \textcolor{keyword}{namespace\ }\{}
\DoxyCodeLine{01334\ }
\DoxyCodeLine{01335\ \textcolor{comment}{//\ Helper\ class\ to\ convert\ string\ into\ ids\ with\ deduplication.}}
\DoxyCodeLine{01336\ \textcolor{keyword}{class\ }InternalStrings\ \{}
\DoxyCodeLine{01337\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{01338\ \ \ \textcolor{keywordtype}{size\_t}\ GetId(\textcolor{keyword}{const}\ std::string\&\ str)\ \{}
\DoxyCodeLine{01339\ \ \ \ \ IdMap::iterator\ it\ =\ ids\_.find(str);}
\DoxyCodeLine{01340\ \ \ \ \ \textcolor{keywordflow}{if}\ (it\ !=\ ids\_.end())\ \textcolor{keywordflow}{return}\ it-\/>second;}
\DoxyCodeLine{01341\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \textcolor{keywordtype}{id}\ =\ ids\_.size();}
\DoxyCodeLine{01342\ \ \ \ \ \textcolor{keywordflow}{return}\ ids\_[str]\ =\ id;}
\DoxyCodeLine{01343\ \ \ \}}
\DoxyCodeLine{01344\ }
\DoxyCodeLine{01345\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{01346\ \ \ \textcolor{keyword}{typedef}\ std::map<std::string,\ size\_t>\ IdMap;}
\DoxyCodeLine{01347\ \ \ IdMap\ ids\_;}
\DoxyCodeLine{01348\ \};}
\DoxyCodeLine{01349\ }
\DoxyCodeLine{01350\ \}\ \ \textcolor{comment}{//\ namespace}}
\DoxyCodeLine{01351\ }
\DoxyCodeLine{01352\ std::vector<EditType>\ CalculateOptimalEdits(}
\DoxyCodeLine{01353\ \ \ \ \ \textcolor{keyword}{const}\ std::vector<std::string>\&\ left,}
\DoxyCodeLine{01354\ \ \ \ \ \textcolor{keyword}{const}\ std::vector<std::string>\&\ right)\ \{}
\DoxyCodeLine{01355\ \ \ std::vector<size\_t>\ left\_ids,\ right\_ids;}
\DoxyCodeLine{01356\ \ \ \{}
\DoxyCodeLine{01357\ \ \ \ \ InternalStrings\ intern\_table;}
\DoxyCodeLine{01358\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ left.size();\ ++i)\ \{}
\DoxyCodeLine{01359\ \ \ \ \ \ \ left\_ids.push\_back(intern\_table.GetId(left[i]));}
\DoxyCodeLine{01360\ \ \ \ \ \}}
\DoxyCodeLine{01361\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ right.size();\ ++i)\ \{}
\DoxyCodeLine{01362\ \ \ \ \ \ \ right\_ids.push\_back(intern\_table.GetId(right[i]));}
\DoxyCodeLine{01363\ \ \ \ \ \}}
\DoxyCodeLine{01364\ \ \ \}}
\DoxyCodeLine{01365\ \ \ \textcolor{keywordflow}{return}\ CalculateOptimalEdits(left\_ids,\ right\_ids);}
\DoxyCodeLine{01366\ \}}
\DoxyCodeLine{01367\ }
\DoxyCodeLine{01368\ \textcolor{keyword}{namespace\ }\{}
\DoxyCodeLine{01369\ }
\DoxyCodeLine{01370\ \textcolor{comment}{//\ Helper\ class\ that\ holds\ the\ state\ for\ one\ hunk\ and\ prints\ it\ out\ to\ the}}
\DoxyCodeLine{01371\ \textcolor{comment}{//\ stream.}}
\DoxyCodeLine{01372\ \textcolor{comment}{//\ It\ reorders\ adds/removes\ when\ possible\ to\ group\ all\ removes\ before\ all}}
\DoxyCodeLine{01373\ \textcolor{comment}{//\ adds.\ It\ also\ adds\ the\ hunk\ header\ before\ printint\ into\ the\ stream.}}
\DoxyCodeLine{01374\ \textcolor{keyword}{class\ }Hunk\ \{}
\DoxyCodeLine{01375\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{01376\ \ \ Hunk(\textcolor{keywordtype}{size\_t}\ left\_start,\ \textcolor{keywordtype}{size\_t}\ right\_start)}
\DoxyCodeLine{01377\ \ \ \ \ \ \ :\ left\_start\_(left\_start),}
\DoxyCodeLine{01378\ \ \ \ \ \ \ \ \ right\_start\_(right\_start),}
\DoxyCodeLine{01379\ \ \ \ \ \ \ \ \ adds\_(),}
\DoxyCodeLine{01380\ \ \ \ \ \ \ \ \ removes\_(),}
\DoxyCodeLine{01381\ \ \ \ \ \ \ \ \ common\_()\ \{\}}
\DoxyCodeLine{01382\ }
\DoxyCodeLine{01383\ \ \ \textcolor{keywordtype}{void}\ PushLine(\textcolor{keywordtype}{char}\ edit,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ line)\ \{}
\DoxyCodeLine{01384\ \ \ \ \ \textcolor{keywordflow}{switch}\ (edit)\ \{}
\DoxyCodeLine{01385\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'\ '}:}
\DoxyCodeLine{01386\ \ \ \ \ \ \ \ \ ++common\_;}
\DoxyCodeLine{01387\ \ \ \ \ \ \ \ \ FlushEdits();}
\DoxyCodeLine{01388\ \ \ \ \ \ \ \ \ hunk\_.push\_back(std::make\_pair(\textcolor{charliteral}{'\ '},\ line));}
\DoxyCodeLine{01389\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01390\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'-\/'}:}
\DoxyCodeLine{01391\ \ \ \ \ \ \ \ \ ++removes\_;}
\DoxyCodeLine{01392\ \ \ \ \ \ \ \ \ hunk\_removes\_.push\_back(std::make\_pair(\textcolor{charliteral}{'-\/'},\ line));}
\DoxyCodeLine{01393\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01394\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'+'}:}
\DoxyCodeLine{01395\ \ \ \ \ \ \ \ \ ++adds\_;}
\DoxyCodeLine{01396\ \ \ \ \ \ \ \ \ hunk\_adds\_.push\_back(std::make\_pair(\textcolor{charliteral}{'+'},\ line));}
\DoxyCodeLine{01397\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01398\ \ \ \ \ \}}
\DoxyCodeLine{01399\ \ \ \}}
\DoxyCodeLine{01400\ }
\DoxyCodeLine{01401\ \ \ \textcolor{keywordtype}{void}\ PrintTo(std::ostream*\ os)\ \{}
\DoxyCodeLine{01402\ \ \ \ \ PrintHeader(os);}
\DoxyCodeLine{01403\ \ \ \ \ FlushEdits();}
\DoxyCodeLine{01404\ \ \ \ \ \textcolor{keywordflow}{for}\ (std::list<std::pair<char,\ const\ char*>\ >::const\_iterator\ it\ =}
\DoxyCodeLine{01405\ \ \ \ \ \ \ \ \ \ \ \ \ \ hunk\_.begin();}
\DoxyCodeLine{01406\ \ \ \ \ \ \ \ \ \ it\ !=\ hunk\_.end();\ ++it)\ \{}
\DoxyCodeLine{01407\ \ \ \ \ \ \ *os\ <<\ it-\/>first\ <<\ it-\/>second\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{01408\ \ \ \ \ \}}
\DoxyCodeLine{01409\ \ \ \}}
\DoxyCodeLine{01410\ }
\DoxyCodeLine{01411\ \ \ \textcolor{keywordtype}{bool}\ has\_edits()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ adds\_\ ||\ removes\_;\ \}}
\DoxyCodeLine{01412\ }
\DoxyCodeLine{01413\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{01414\ \ \ \textcolor{keywordtype}{void}\ FlushEdits()\ \{}
\DoxyCodeLine{01415\ \ \ \ \ hunk\_.splice(hunk\_.end(),\ hunk\_removes\_);}
\DoxyCodeLine{01416\ \ \ \ \ hunk\_.splice(hunk\_.end(),\ hunk\_adds\_);}
\DoxyCodeLine{01417\ \ \ \}}
\DoxyCodeLine{01418\ }
\DoxyCodeLine{01419\ \ \ \textcolor{comment}{//\ Print\ a\ unified\ diff\ header\ for\ one\ hunk.}}
\DoxyCodeLine{01420\ \ \ \textcolor{comment}{//\ The\ format\ is}}
\DoxyCodeLine{01421\ \ \ \textcolor{comment}{//\ \ \ "{}@@\ -\/<left\_start>,<left\_length>\ +<right\_start>,<right\_length>\ @@"{}}}
\DoxyCodeLine{01422\ \ \ \textcolor{comment}{//\ where\ the\ left/right\ parts\ are\ omitted\ if\ unnecessary.}}
\DoxyCodeLine{01423\ \ \ \textcolor{keywordtype}{void}\ PrintHeader(std::ostream*\ ss)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01424\ \ \ \ \ *ss\ <<\ \textcolor{stringliteral}{"{}@@\ "{}};}
\DoxyCodeLine{01425\ \ \ \ \ \textcolor{keywordflow}{if}\ (removes\_)\ \{}
\DoxyCodeLine{01426\ \ \ \ \ \ \ *ss\ <<\ \textcolor{stringliteral}{"{}-\/"{}}\ <<\ left\_start\_\ <<\ \textcolor{stringliteral}{"{},"{}}\ <<\ (removes\_\ +\ common\_);}
\DoxyCodeLine{01427\ \ \ \ \ \}}
\DoxyCodeLine{01428\ \ \ \ \ \textcolor{keywordflow}{if}\ (removes\_\ \&\&\ adds\_)\ \{}
\DoxyCodeLine{01429\ \ \ \ \ \ \ *ss\ <<\ \textcolor{stringliteral}{"{}\ "{}};}
\DoxyCodeLine{01430\ \ \ \ \ \}}
\DoxyCodeLine{01431\ \ \ \ \ \textcolor{keywordflow}{if}\ (adds\_)\ \{}
\DoxyCodeLine{01432\ \ \ \ \ \ \ *ss\ <<\ \textcolor{stringliteral}{"{}+"{}}\ <<\ right\_start\_\ <<\ \textcolor{stringliteral}{"{},"{}}\ <<\ (adds\_\ +\ common\_);}
\DoxyCodeLine{01433\ \ \ \ \ \}}
\DoxyCodeLine{01434\ \ \ \ \ *ss\ <<\ \textcolor{stringliteral}{"{}\ @@\(\backslash\)n"{}};}
\DoxyCodeLine{01435\ \ \ \}}
\DoxyCodeLine{01436\ }
\DoxyCodeLine{01437\ \ \ \textcolor{keywordtype}{size\_t}\ left\_start\_,\ right\_start\_;}
\DoxyCodeLine{01438\ \ \ \textcolor{keywordtype}{size\_t}\ adds\_,\ removes\_,\ common\_;}
\DoxyCodeLine{01439\ \ \ std::list<std::pair<char,\ const\ char*>\ >\ hunk\_,\ hunk\_adds\_,\ hunk\_removes\_;}
\DoxyCodeLine{01440\ \};}
\DoxyCodeLine{01441\ }
\DoxyCodeLine{01442\ \}\ \ \textcolor{comment}{//\ namespace}}
\DoxyCodeLine{01443\ }
\DoxyCodeLine{01444\ \textcolor{comment}{//\ Create\ a\ list\ of\ diff\ hunks\ in\ Unified\ diff\ format.}}
\DoxyCodeLine{01445\ \textcolor{comment}{//\ Each\ hunk\ has\ a\ header\ generated\ by\ PrintHeader\ above\ plus\ a\ body\ with}}
\DoxyCodeLine{01446\ \textcolor{comment}{//\ lines\ prefixed\ with\ '\ '\ for\ no\ change,\ '-\/'\ for\ deletion\ and\ '+'\ for}}
\DoxyCodeLine{01447\ \textcolor{comment}{//\ addition.}}
\DoxyCodeLine{01448\ \textcolor{comment}{//\ 'context'\ represents\ the\ desired\ unchanged\ prefix/suffix\ around\ the\ diff.}}
\DoxyCodeLine{01449\ \textcolor{comment}{//\ If\ two\ hunks\ are\ close\ enough\ that\ their\ contexts\ overlap,\ then\ they\ are}}
\DoxyCodeLine{01450\ \textcolor{comment}{//\ joined\ into\ one\ hunk.}}
\DoxyCodeLine{01451\ std::string\ CreateUnifiedDiff(\textcolor{keyword}{const}\ std::vector<std::string>\&\ left,}
\DoxyCodeLine{01452\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::vector<std::string>\&\ right,}
\DoxyCodeLine{01453\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ context)\ \{}
\DoxyCodeLine{01454\ \ \ \textcolor{keyword}{const}\ std::vector<EditType>\ edits\ =\ CalculateOptimalEdits(left,\ right);}
\DoxyCodeLine{01455\ }
\DoxyCodeLine{01456\ \ \ \textcolor{keywordtype}{size\_t}\ l\_i\ =\ 0,\ r\_i\ =\ 0,\ edit\_i\ =\ 0;}
\DoxyCodeLine{01457\ \ \ std::stringstream\ ss;}
\DoxyCodeLine{01458\ \ \ \textcolor{keywordflow}{while}\ (edit\_i\ <\ edits.size())\ \{}
\DoxyCodeLine{01459\ \ \ \ \ \textcolor{comment}{//\ Find\ first\ edit.}}
\DoxyCodeLine{01460\ \ \ \ \ \textcolor{keywordflow}{while}\ (edit\_i\ <\ edits.size()\ \&\&\ edits[edit\_i]\ ==\ kMatch)\ \{}
\DoxyCodeLine{01461\ \ \ \ \ \ \ ++l\_i;}
\DoxyCodeLine{01462\ \ \ \ \ \ \ ++r\_i;}
\DoxyCodeLine{01463\ \ \ \ \ \ \ ++edit\_i;}
\DoxyCodeLine{01464\ \ \ \ \ \}}
\DoxyCodeLine{01465\ }
\DoxyCodeLine{01466\ \ \ \ \ \textcolor{comment}{//\ Find\ the\ first\ line\ to\ include\ in\ the\ hunk.}}
\DoxyCodeLine{01467\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ prefix\_context\ =\ std::min(l\_i,\ context);}
\DoxyCodeLine{01468\ \ \ \ \ Hunk\ hunk(l\_i\ -\/\ prefix\_context\ +\ 1,\ r\_i\ -\/\ prefix\_context\ +\ 1);}
\DoxyCodeLine{01469\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ prefix\_context;\ i\ >\ 0;\ -\/-\/i)\ \{}
\DoxyCodeLine{01470\ \ \ \ \ \ \ hunk.PushLine(\textcolor{charliteral}{'\ '},\ left[l\_i\ -\/\ i].c\_str());}
\DoxyCodeLine{01471\ \ \ \ \ \}}
\DoxyCodeLine{01472\ }
\DoxyCodeLine{01473\ \ \ \ \ \textcolor{comment}{//\ Iterate\ the\ edits\ until\ we\ found\ enough\ suffix\ for\ the\ hunk\ or\ the\ input}}
\DoxyCodeLine{01474\ \ \ \ \ \textcolor{comment}{//\ is\ over.}}
\DoxyCodeLine{01475\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ n\_suffix\ =\ 0;}
\DoxyCodeLine{01476\ \ \ \ \ \textcolor{keywordflow}{for}\ (;\ edit\_i\ <\ edits.size();\ ++edit\_i)\ \{}
\DoxyCodeLine{01477\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (n\_suffix\ >=\ context)\ \{}
\DoxyCodeLine{01478\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Continue\ only\ if\ the\ next\ hunk\ is\ very\ close.}}
\DoxyCodeLine{01479\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ it\ =\ edits.begin()\ +\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(edit\_i);}
\DoxyCodeLine{01480\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (it\ !=\ edits.end()\ \&\&\ *it\ ==\ kMatch)\ ++it;}
\DoxyCodeLine{01481\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (it\ ==\ edits.end()\ ||}
\DoxyCodeLine{01482\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{size\_t}\textcolor{keyword}{>}(it\ -\/\ edits.begin())\ -\/\ edit\_i\ >=\ context)\ \{}
\DoxyCodeLine{01483\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ There\ is\ no\ next\ edit\ or\ it\ is\ too\ far\ away.}}
\DoxyCodeLine{01484\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01485\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01486\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01487\ }
\DoxyCodeLine{01488\ \ \ \ \ \ \ EditType\ edit\ =\ edits[edit\_i];}
\DoxyCodeLine{01489\ \ \ \ \ \ \ \textcolor{comment}{//\ Reset\ count\ when\ a\ non\ match\ is\ found.}}
\DoxyCodeLine{01490\ \ \ \ \ \ \ n\_suffix\ =\ edit\ ==\ kMatch\ ?\ n\_suffix\ +\ 1\ :\ 0;}
\DoxyCodeLine{01491\ }
\DoxyCodeLine{01492\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (edit\ ==\ kMatch\ ||\ edit\ ==\ kRemove\ ||\ edit\ ==\ kReplace)\ \{}
\DoxyCodeLine{01493\ \ \ \ \ \ \ \ \ hunk.PushLine(edit\ ==\ kMatch\ ?\ \textcolor{charliteral}{'\ '}\ :\ \textcolor{stringliteral}{'-\/'},\ left[l\_i].c\_str());}
\DoxyCodeLine{01494\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01495\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (edit\ ==\ kAdd\ ||\ edit\ ==\ kReplace)\ \{}
\DoxyCodeLine{01496\ \ \ \ \ \ \ \ \ hunk.PushLine(\textcolor{charliteral}{'+'},\ right[r\_i].c\_str());}
\DoxyCodeLine{01497\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01498\ }
\DoxyCodeLine{01499\ \ \ \ \ \ \ \textcolor{comment}{//\ Advance\ indices,\ depending\ on\ edit\ type.}}
\DoxyCodeLine{01500\ \ \ \ \ \ \ l\_i\ +=\ edit\ !=\ kAdd;}
\DoxyCodeLine{01501\ \ \ \ \ \ \ r\_i\ +=\ edit\ !=\ kRemove;}
\DoxyCodeLine{01502\ \ \ \ \ \}}
\DoxyCodeLine{01503\ }
\DoxyCodeLine{01504\ \ \ \ \ \textcolor{keywordflow}{if}\ (!hunk.has\_edits())\ \{}
\DoxyCodeLine{01505\ \ \ \ \ \ \ \textcolor{comment}{//\ We\ are\ done.\ We\ don't\ want\ this\ hunk.}}
\DoxyCodeLine{01506\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01507\ \ \ \ \ \}}
\DoxyCodeLine{01508\ }
\DoxyCodeLine{01509\ \ \ \ \ hunk.PrintTo(\&ss);}
\DoxyCodeLine{01510\ \ \ \}}
\DoxyCodeLine{01511\ \ \ \textcolor{keywordflow}{return}\ ss.str();}
\DoxyCodeLine{01512\ \}}
\DoxyCodeLine{01513\ }
\DoxyCodeLine{01514\ \}\ \ \textcolor{comment}{//\ namespace\ edit\_distance}}
\DoxyCodeLine{01515\ }
\DoxyCodeLine{01516\ \textcolor{keyword}{namespace\ }\{}
\DoxyCodeLine{01517\ }
\DoxyCodeLine{01518\ \textcolor{comment}{//\ The\ string\ representation\ of\ the\ values\ received\ in\ EqFailure()\ are\ already}}
\DoxyCodeLine{01519\ \textcolor{comment}{//\ escaped.\ Split\ them\ on\ escaped\ '\(\backslash\)n'\ boundaries.\ Leave\ all\ other\ escaped}}
\DoxyCodeLine{01520\ \textcolor{comment}{//\ characters\ the\ same.}}
\DoxyCodeLine{01521\ std::vector<std::string>\ SplitEscapedString(\textcolor{keyword}{const}\ std::string\&\ str)\ \{}
\DoxyCodeLine{01522\ \ \ std::vector<std::string>\ lines;}
\DoxyCodeLine{01523\ \ \ \textcolor{keywordtype}{size\_t}\ start\ =\ 0,\ end\ =\ str.size();}
\DoxyCodeLine{01524\ \ \ \textcolor{keywordflow}{if}\ (end\ >\ 2\ \&\&\ str[0]\ ==\ \textcolor{charliteral}{'"{}'}\ \&\&\ str[end\ -\/\ 1]\ ==\ \textcolor{charliteral}{'"{}'})\ \{}
\DoxyCodeLine{01525\ \ \ \ \ ++start;}
\DoxyCodeLine{01526\ \ \ \ \ -\/-\/end;}
\DoxyCodeLine{01527\ \ \ \}}
\DoxyCodeLine{01528\ \ \ \textcolor{keywordtype}{bool}\ escaped\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01529\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ start;\ i\ +\ 1\ <\ end;\ ++i)\ \{}
\DoxyCodeLine{01530\ \ \ \ \ \textcolor{keywordflow}{if}\ (escaped)\ \{}
\DoxyCodeLine{01531\ \ \ \ \ \ \ escaped\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01532\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (str[i]\ ==\ \textcolor{charliteral}{'n'})\ \{}
\DoxyCodeLine{01533\ \ \ \ \ \ \ \ \ lines.push\_back(str.substr(start,\ i\ -\/\ start\ -\/\ 1));}
\DoxyCodeLine{01534\ \ \ \ \ \ \ \ \ start\ =\ i\ +\ 1;}
\DoxyCodeLine{01535\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01536\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01537\ \ \ \ \ \ \ escaped\ =\ str[i]\ ==\ \textcolor{charliteral}{'\(\backslash\)\(\backslash\)'};}
\DoxyCodeLine{01538\ \ \ \ \ \}}
\DoxyCodeLine{01539\ \ \ \}}
\DoxyCodeLine{01540\ \ \ lines.push\_back(str.substr(start,\ end\ -\/\ start));}
\DoxyCodeLine{01541\ \ \ \textcolor{keywordflow}{return}\ lines;}
\DoxyCodeLine{01542\ \}}
\DoxyCodeLine{01543\ }
\DoxyCodeLine{01544\ \}\ \ \textcolor{comment}{//\ namespace}}
\DoxyCodeLine{01545\ }
\DoxyCodeLine{01546\ \textcolor{comment}{//\ Constructs\ and\ returns\ the\ message\ for\ an\ equality\ assertion}}
\DoxyCodeLine{01547\ \textcolor{comment}{//\ (e.g.\ ASSERT\_EQ,\ EXPECT\_STREQ,\ etc)\ failure.}}
\DoxyCodeLine{01548\ \textcolor{comment}{//}}
\DoxyCodeLine{01549\ \textcolor{comment}{//\ The\ first\ four\ parameters\ are\ the\ expressions\ used\ in\ the\ assertion}}
\DoxyCodeLine{01550\ \textcolor{comment}{//\ and\ their\ values,\ as\ strings.\ \ For\ example,\ for\ ASSERT\_EQ(foo,\ bar)}}
\DoxyCodeLine{01551\ \textcolor{comment}{//\ where\ foo\ is\ 5\ and\ bar\ is\ 6,\ we\ have:}}
\DoxyCodeLine{01552\ \textcolor{comment}{//}}
\DoxyCodeLine{01553\ \textcolor{comment}{//\ \ \ lhs\_expression:\ "{}foo"{}}}
\DoxyCodeLine{01554\ \textcolor{comment}{//\ \ \ rhs\_expression:\ "{}bar"{}}}
\DoxyCodeLine{01555\ \textcolor{comment}{//\ \ \ lhs\_value:\ \ \ \ \ \ "{}5"{}}}
\DoxyCodeLine{01556\ \textcolor{comment}{//\ \ \ rhs\_value:\ \ \ \ \ \ "{}6"{}}}
\DoxyCodeLine{01557\ \textcolor{comment}{//}}
\DoxyCodeLine{01558\ \textcolor{comment}{//\ The\ ignoring\_case\ parameter\ is\ true\ if\ and\ only\ if\ the\ assertion\ is\ a}}
\DoxyCodeLine{01559\ \textcolor{comment}{//\ *\_STRCASEEQ*.\ \ When\ it's\ true,\ the\ string\ "{}Ignoring\ case"{}\ will}}
\DoxyCodeLine{01560\ \textcolor{comment}{//\ be\ inserted\ into\ the\ message.}}
\DoxyCodeLine{01561\ AssertionResult\ EqFailure(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ lhs\_expression,}
\DoxyCodeLine{01562\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ rhs\_expression,}
\DoxyCodeLine{01563\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ lhs\_value,}
\DoxyCodeLine{01564\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ rhs\_value,\ \textcolor{keywordtype}{bool}\ ignoring\_case)\ \{}
\DoxyCodeLine{01565\ \ \ Message\ msg;}
\DoxyCodeLine{01566\ \ \ msg\ <<\ \textcolor{stringliteral}{"{}Expected\ equality\ of\ these\ values:"{}};}
\DoxyCodeLine{01567\ \ \ msg\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n\ \ "{}}\ <<\ lhs\_expression;}
\DoxyCodeLine{01568\ \ \ \textcolor{keywordflow}{if}\ (lhs\_value\ !=\ lhs\_expression)\ \{}
\DoxyCodeLine{01569\ \ \ \ \ msg\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n\ \ \ \ Which\ is:\ "{}}\ <<\ lhs\_value;}
\DoxyCodeLine{01570\ \ \ \}}
\DoxyCodeLine{01571\ \ \ msg\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n\ \ "{}}\ <<\ rhs\_expression;}
\DoxyCodeLine{01572\ \ \ \textcolor{keywordflow}{if}\ (rhs\_value\ !=\ rhs\_expression)\ \{}
\DoxyCodeLine{01573\ \ \ \ \ msg\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n\ \ \ \ Which\ is:\ "{}}\ <<\ rhs\_value;}
\DoxyCodeLine{01574\ \ \ \}}
\DoxyCodeLine{01575\ }
\DoxyCodeLine{01576\ \ \ \textcolor{keywordflow}{if}\ (ignoring\_case)\ \{}
\DoxyCodeLine{01577\ \ \ \ \ msg\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)nIgnoring\ case"{}};}
\DoxyCodeLine{01578\ \ \ \}}
\DoxyCodeLine{01579\ }
\DoxyCodeLine{01580\ \ \ \textcolor{keywordflow}{if}\ (!lhs\_value.empty()\ \&\&\ !rhs\_value.empty())\ \{}
\DoxyCodeLine{01581\ \ \ \ \ \textcolor{keyword}{const}\ std::vector<std::string>\ lhs\_lines\ =\ SplitEscapedString(lhs\_value);}
\DoxyCodeLine{01582\ \ \ \ \ \textcolor{keyword}{const}\ std::vector<std::string>\ rhs\_lines\ =\ SplitEscapedString(rhs\_value);}
\DoxyCodeLine{01583\ \ \ \ \ \textcolor{keywordflow}{if}\ (lhs\_lines.size()\ >\ 1\ ||\ rhs\_lines.size()\ >\ 1)\ \{}
\DoxyCodeLine{01584\ \ \ \ \ \ \ msg\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)nWith\ diff:\(\backslash\)n"{}}}
\DoxyCodeLine{01585\ \ \ \ \ \ \ \ \ \ \ <<\ edit\_distance::CreateUnifiedDiff(lhs\_lines,\ rhs\_lines);}
\DoxyCodeLine{01586\ \ \ \ \ \}}
\DoxyCodeLine{01587\ \ \ \}}
\DoxyCodeLine{01588\ }
\DoxyCodeLine{01589\ \ \ \textcolor{keywordflow}{return}\ AssertionFailure()\ <<\ msg;}
\DoxyCodeLine{01590\ \}}
\DoxyCodeLine{01591\ }
\DoxyCodeLine{01592\ \textcolor{comment}{//\ Constructs\ a\ failure\ message\ for\ Boolean\ assertions\ such\ as\ EXPECT\_TRUE.}}
\DoxyCodeLine{01593\ std::string\ GetBoolAssertionFailureMessage(}
\DoxyCodeLine{01594\ \ \ \ \ \textcolor{keyword}{const}\ AssertionResult\&\ assertion\_result,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ expression\_text,}
\DoxyCodeLine{01595\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ actual\_predicate\_value,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ expected\_predicate\_value)\ \{}
\DoxyCodeLine{01596\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ actual\_message\ =\ assertion\_result.message();}
\DoxyCodeLine{01597\ \ \ Message\ msg;}
\DoxyCodeLine{01598\ \ \ msg\ <<\ \textcolor{stringliteral}{"{}Value\ of:\ "{}}\ <<\ expression\_text}
\DoxyCodeLine{01599\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n\ \ Actual:\ "{}}\ <<\ actual\_predicate\_value;}
\DoxyCodeLine{01600\ \ \ \textcolor{keywordflow}{if}\ (actual\_message[0]\ !=\ \textcolor{charliteral}{'\(\backslash\)0'})\ msg\ <<\ \textcolor{stringliteral}{"{}\ ("{}}\ <<\ actual\_message\ <<\ \textcolor{stringliteral}{"{})"{}};}
\DoxyCodeLine{01601\ \ \ msg\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)nExpected:\ "{}}\ <<\ expected\_predicate\_value;}
\DoxyCodeLine{01602\ \ \ \textcolor{keywordflow}{return}\ msg.GetString();}
\DoxyCodeLine{01603\ \}}
\DoxyCodeLine{01604\ }
\DoxyCodeLine{01605\ \textcolor{comment}{//\ Helper\ function\ for\ implementing\ ASSERT\_NEAR.}}
\DoxyCodeLine{01606\ AssertionResult\ DoubleNearPredFormat(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ expr1,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ expr2,}
\DoxyCodeLine{01607\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ abs\_error\_expr,\ \textcolor{keywordtype}{double}\ val1,}
\DoxyCodeLine{01608\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ val2,\ \textcolor{keywordtype}{double}\ abs\_error)\ \{}
\DoxyCodeLine{01609\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ diff\ =\ fabs(val1\ -\/\ val2);}
\DoxyCodeLine{01610\ \ \ \textcolor{keywordflow}{if}\ (diff\ <=\ abs\_error)\ \textcolor{keywordflow}{return}\ AssertionSuccess();}
\DoxyCodeLine{01611\ }
\DoxyCodeLine{01612\ \ \ \textcolor{comment}{//\ Find\ the\ value\ which\ is\ closest\ to\ zero.}}
\DoxyCodeLine{01613\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ min\_abs\ =\ std::min(fabs(val1),\ fabs(val2));}
\DoxyCodeLine{01614\ \ \ \textcolor{comment}{//\ Find\ the\ distance\ to\ the\ next\ double\ from\ that\ value.}}
\DoxyCodeLine{01615\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ epsilon\ =}
\DoxyCodeLine{01616\ \ \ \ \ \ \ nextafter(min\_abs,\ std::numeric\_limits<double>::infinity())\ -\/\ min\_abs;}
\DoxyCodeLine{01617\ \ \ \textcolor{comment}{//\ Detect\ the\ case\ where\ abs\_error\ is\ so\ small\ that\ EXPECT\_NEAR\ is}}
\DoxyCodeLine{01618\ \ \ \textcolor{comment}{//\ effectively\ the\ same\ as\ EXPECT\_EQUAL,\ and\ give\ an\ informative\ error}}
\DoxyCodeLine{01619\ \ \ \textcolor{comment}{//\ message\ so\ that\ the\ situation\ can\ be\ more\ easily\ understood\ without}}
\DoxyCodeLine{01620\ \ \ \textcolor{comment}{//\ requiring\ exotic\ floating-\/point\ knowledge.}}
\DoxyCodeLine{01621\ \ \ \textcolor{comment}{//\ Don't\ do\ an\ epsilon\ check\ if\ abs\_error\ is\ zero\ because\ that\ implies}}
\DoxyCodeLine{01622\ \ \ \textcolor{comment}{//\ that\ an\ equality\ check\ was\ actually\ intended.}}
\DoxyCodeLine{01623\ \ \ \textcolor{keywordflow}{if}\ (!(std::isnan)(val1)\ \&\&\ !(std::isnan)(val2)\ \&\&\ abs\_error\ >\ 0\ \&\&}
\DoxyCodeLine{01624\ \ \ \ \ \ \ abs\_error\ <\ epsilon)\ \{}
\DoxyCodeLine{01625\ \ \ \ \ \textcolor{keywordflow}{return}\ AssertionFailure()}
\DoxyCodeLine{01626\ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}The\ difference\ between\ "{}}\ <<\ expr1\ <<\ \textcolor{stringliteral}{"{}\ and\ "{}}\ <<\ expr2\ <<\ \textcolor{stringliteral}{"{}\ is\ "{}}}
\DoxyCodeLine{01627\ \ \ \ \ \ \ \ \ \ \ \ <<\ diff\ <<\ \textcolor{stringliteral}{"{},\ where\(\backslash\)n"{}}}
\DoxyCodeLine{01628\ \ \ \ \ \ \ \ \ \ \ \ <<\ expr1\ <<\ \textcolor{stringliteral}{"{}\ evaluates\ to\ "{}}\ <<\ val1\ <<\ \textcolor{stringliteral}{"{},\(\backslash\)n"{}}}
\DoxyCodeLine{01629\ \ \ \ \ \ \ \ \ \ \ \ <<\ expr2\ <<\ \textcolor{stringliteral}{"{}\ evaluates\ to\ "{}}\ <<\ val2\ <<\ \textcolor{stringliteral}{"{}.\(\backslash\)nThe\ abs\_error\ parameter\ "{}}}
\DoxyCodeLine{01630\ \ \ \ \ \ \ \ \ \ \ \ <<\ abs\_error\_expr\ <<\ \textcolor{stringliteral}{"{}\ evaluates\ to\ "{}}\ <<\ abs\_error}
\DoxyCodeLine{01631\ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ which\ is\ smaller\ than\ the\ minimum\ distance\ between\ doubles\ for\ "{}}}
\DoxyCodeLine{01632\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}numbers\ of\ this\ magnitude\ which\ is\ "{}}}
\DoxyCodeLine{01633\ \ \ \ \ \ \ \ \ \ \ \ <<\ epsilon}
\DoxyCodeLine{01634\ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{},\ thus\ making\ this\ EXPECT\_NEAR\ check\ equivalent\ to\ "{}}}
\DoxyCodeLine{01635\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}EXPECT\_EQUAL.\ Consider\ using\ EXPECT\_DOUBLE\_EQ\ instead."{}};}
\DoxyCodeLine{01636\ \ \ \}}
\DoxyCodeLine{01637\ \ \ \textcolor{keywordflow}{return}\ AssertionFailure()}
\DoxyCodeLine{01638\ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}The\ difference\ between\ "{}}\ <<\ expr1\ <<\ \textcolor{stringliteral}{"{}\ and\ "{}}\ <<\ expr2\ <<\ \textcolor{stringliteral}{"{}\ is\ "{}}}
\DoxyCodeLine{01639\ \ \ \ \ \ \ \ \ \ <<\ diff\ <<\ \textcolor{stringliteral}{"{},\ which\ exceeds\ "{}}\ <<\ abs\_error\_expr\ <<\ \textcolor{stringliteral}{"{},\ where\(\backslash\)n"{}}}
\DoxyCodeLine{01640\ \ \ \ \ \ \ \ \ \ <<\ expr1\ <<\ \textcolor{stringliteral}{"{}\ evaluates\ to\ "{}}\ <<\ val1\ <<\ \textcolor{stringliteral}{"{},\(\backslash\)n"{}}}
\DoxyCodeLine{01641\ \ \ \ \ \ \ \ \ \ <<\ expr2\ <<\ \textcolor{stringliteral}{"{}\ evaluates\ to\ "{}}\ <<\ val2\ <<\ \textcolor{stringliteral}{"{},\ and\(\backslash\)n"{}}}
\DoxyCodeLine{01642\ \ \ \ \ \ \ \ \ \ <<\ abs\_error\_expr\ <<\ \textcolor{stringliteral}{"{}\ evaluates\ to\ "{}}\ <<\ abs\_error\ <<\ \textcolor{stringliteral}{"{}."{}};}
\DoxyCodeLine{01643\ \}}
\DoxyCodeLine{01644\ }
\DoxyCodeLine{01645\ \textcolor{comment}{//\ Helper\ template\ for\ implementing\ FloatLE()\ and\ DoubleLE().}}
\DoxyCodeLine{01646\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ RawType>}
\DoxyCodeLine{01647\ AssertionResult\ FloatingPointLE(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ expr1,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ expr2,}
\DoxyCodeLine{01648\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ RawType\ val1,\ RawType\ val2)\ \{}
\DoxyCodeLine{01649\ \ \ \textcolor{comment}{//\ Returns\ success\ if\ val1\ is\ less\ than\ val2,}}
\DoxyCodeLine{01650\ \ \ \textcolor{keywordflow}{if}\ (val1\ <\ val2)\ \{}
\DoxyCodeLine{01651\ \ \ \ \ \textcolor{keywordflow}{return}\ AssertionSuccess();}
\DoxyCodeLine{01652\ \ \ \}}
\DoxyCodeLine{01653\ }
\DoxyCodeLine{01654\ \ \ \textcolor{comment}{//\ or\ if\ val1\ is\ almost\ equal\ to\ val2.}}
\DoxyCodeLine{01655\ \ \ \textcolor{keyword}{const}\ FloatingPoint<RawType>\ lhs(val1),\ rhs(val2);}
\DoxyCodeLine{01656\ \ \ \textcolor{keywordflow}{if}\ (lhs.AlmostEquals(rhs))\ \{}
\DoxyCodeLine{01657\ \ \ \ \ \textcolor{keywordflow}{return}\ AssertionSuccess();}
\DoxyCodeLine{01658\ \ \ \}}
\DoxyCodeLine{01659\ }
\DoxyCodeLine{01660\ \ \ \textcolor{comment}{//\ Note\ that\ the\ above\ two\ checks\ will\ both\ fail\ if\ either\ val1\ or}}
\DoxyCodeLine{01661\ \ \ \textcolor{comment}{//\ val2\ is\ NaN,\ as\ the\ IEEE\ floating-\/point\ standard\ requires\ that}}
\DoxyCodeLine{01662\ \ \ \textcolor{comment}{//\ any\ predicate\ involving\ a\ NaN\ must\ return\ false.}}
\DoxyCodeLine{01663\ }
\DoxyCodeLine{01664\ \ \ ::std::stringstream\ val1\_ss;}
\DoxyCodeLine{01665\ \ \ val1\_ss\ <<\ std::setprecision(std::numeric\_limits<RawType>::digits10\ +\ 2)}
\DoxyCodeLine{01666\ \ \ \ \ \ \ \ \ \ \ <<\ val1;}
\DoxyCodeLine{01667\ }
\DoxyCodeLine{01668\ \ \ ::std::stringstream\ val2\_ss;}
\DoxyCodeLine{01669\ \ \ val2\_ss\ <<\ std::setprecision(std::numeric\_limits<RawType>::digits10\ +\ 2)}
\DoxyCodeLine{01670\ \ \ \ \ \ \ \ \ \ \ <<\ val2;}
\DoxyCodeLine{01671\ }
\DoxyCodeLine{01672\ \ \ \textcolor{keywordflow}{return}\ AssertionFailure()}
\DoxyCodeLine{01673\ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Expected:\ ("{}}\ <<\ expr1\ <<\ \textcolor{stringliteral}{"{})\ <=\ ("{}}\ <<\ expr2\ <<\ \textcolor{stringliteral}{"{})\(\backslash\)n"{}}}
\DoxyCodeLine{01674\ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ \ Actual:\ "{}}\ <<\ StringStreamToString(\&val1\_ss)\ <<\ \textcolor{stringliteral}{"{}\ vs\ "{}}}
\DoxyCodeLine{01675\ \ \ \ \ \ \ \ \ \ <<\ StringStreamToString(\&val2\_ss);}
\DoxyCodeLine{01676\ \}}
\DoxyCodeLine{01677\ }
\DoxyCodeLine{01678\ \}\ \ \textcolor{comment}{//\ namespace\ internal}}
\DoxyCodeLine{01679\ }
\DoxyCodeLine{01680\ \textcolor{comment}{//\ Asserts\ that\ val1\ is\ less\ than,\ or\ almost\ equal\ to,\ val2.\ \ Fails}}
\DoxyCodeLine{01681\ \textcolor{comment}{//\ otherwise.\ \ In\ particular,\ it\ fails\ if\ either\ val1\ or\ val2\ is\ NaN.}}
\DoxyCodeLine{01682\ AssertionResult\ FloatLE(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ expr1,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ expr2,\ \textcolor{keywordtype}{float}\ val1,}
\DoxyCodeLine{01683\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ val2)\ \{}
\DoxyCodeLine{01684\ \ \ \textcolor{keywordflow}{return}\ internal::FloatingPointLE<float>(expr1,\ expr2,\ val1,\ val2);}
\DoxyCodeLine{01685\ \}}
\DoxyCodeLine{01686\ }
\DoxyCodeLine{01687\ \textcolor{comment}{//\ Asserts\ that\ val1\ is\ less\ than,\ or\ almost\ equal\ to,\ val2.\ \ Fails}}
\DoxyCodeLine{01688\ \textcolor{comment}{//\ otherwise.\ \ In\ particular,\ it\ fails\ if\ either\ val1\ or\ val2\ is\ NaN.}}
\DoxyCodeLine{01689\ AssertionResult\ DoubleLE(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ expr1,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ expr2,\ \textcolor{keywordtype}{double}\ val1,}
\DoxyCodeLine{01690\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ val2)\ \{}
\DoxyCodeLine{01691\ \ \ \textcolor{keywordflow}{return}\ internal::FloatingPointLE<double>(expr1,\ expr2,\ val1,\ val2);}
\DoxyCodeLine{01692\ \}}
\DoxyCodeLine{01693\ }
\DoxyCodeLine{01694\ \textcolor{keyword}{namespace\ }internal\ \{}
\DoxyCodeLine{01695\ }
\DoxyCodeLine{01696\ \textcolor{comment}{//\ The\ helper\ function\ for\ \{ASSERT|EXPECT\}\_STREQ.}}
\DoxyCodeLine{01697\ AssertionResult\ CmpHelperSTREQ(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ lhs\_expression,}
\DoxyCodeLine{01698\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ rhs\_expression,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ lhs,}
\DoxyCodeLine{01699\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ rhs)\ \{}
\DoxyCodeLine{01700\ \ \ \textcolor{keywordflow}{if}\ (String::CStringEquals(lhs,\ rhs))\ \{}
\DoxyCodeLine{01701\ \ \ \ \ \textcolor{keywordflow}{return}\ AssertionSuccess();}
\DoxyCodeLine{01702\ \ \ \}}
\DoxyCodeLine{01703\ }
\DoxyCodeLine{01704\ \ \ \textcolor{keywordflow}{return}\ EqFailure(lhs\_expression,\ rhs\_expression,\ PrintToString(lhs),}
\DoxyCodeLine{01705\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PrintToString(rhs),\ \textcolor{keyword}{false});}
\DoxyCodeLine{01706\ \}}
\DoxyCodeLine{01707\ }
\DoxyCodeLine{01708\ \textcolor{comment}{//\ The\ helper\ function\ for\ \{ASSERT|EXPECT\}\_STRCASEEQ.}}
\DoxyCodeLine{01709\ AssertionResult\ CmpHelperSTRCASEEQ(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ lhs\_expression,}
\DoxyCodeLine{01710\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ rhs\_expression,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ lhs,}
\DoxyCodeLine{01711\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ rhs)\ \{}
\DoxyCodeLine{01712\ \ \ \textcolor{keywordflow}{if}\ (String::CaseInsensitiveCStringEquals(lhs,\ rhs))\ \{}
\DoxyCodeLine{01713\ \ \ \ \ \textcolor{keywordflow}{return}\ AssertionSuccess();}
\DoxyCodeLine{01714\ \ \ \}}
\DoxyCodeLine{01715\ }
\DoxyCodeLine{01716\ \ \ \textcolor{keywordflow}{return}\ EqFailure(lhs\_expression,\ rhs\_expression,\ PrintToString(lhs),}
\DoxyCodeLine{01717\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PrintToString(rhs),\ \textcolor{keyword}{true});}
\DoxyCodeLine{01718\ \}}
\DoxyCodeLine{01719\ }
\DoxyCodeLine{01720\ \textcolor{comment}{//\ The\ helper\ function\ for\ \{ASSERT|EXPECT\}\_STRNE.}}
\DoxyCodeLine{01721\ AssertionResult\ CmpHelperSTRNE(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ s1\_expression,}
\DoxyCodeLine{01722\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ s2\_expression,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ s1,}
\DoxyCodeLine{01723\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ s2)\ \{}
\DoxyCodeLine{01724\ \ \ \textcolor{keywordflow}{if}\ (!String::CStringEquals(s1,\ s2))\ \{}
\DoxyCodeLine{01725\ \ \ \ \ \textcolor{keywordflow}{return}\ AssertionSuccess();}
\DoxyCodeLine{01726\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01727\ \ \ \ \ \textcolor{keywordflow}{return}\ AssertionFailure()}
\DoxyCodeLine{01728\ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Expected:\ ("{}}\ <<\ s1\_expression\ <<\ \textcolor{stringliteral}{"{})\ !=\ ("{}}\ <<\ s2\_expression}
\DoxyCodeLine{01729\ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}),\ actual:\ \(\backslash\)"{}"{}}\ <<\ s1\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}\ vs\ \(\backslash\)"{}"{}}\ <<\ s2\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}"{}};}
\DoxyCodeLine{01730\ \ \ \}}
\DoxyCodeLine{01731\ \}}
\DoxyCodeLine{01732\ }
\DoxyCodeLine{01733\ \textcolor{comment}{//\ The\ helper\ function\ for\ \{ASSERT|EXPECT\}\_STRCASENE.}}
\DoxyCodeLine{01734\ AssertionResult\ CmpHelperSTRCASENE(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ s1\_expression,}
\DoxyCodeLine{01735\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ s2\_expression,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ s1,}
\DoxyCodeLine{01736\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ s2)\ \{}
\DoxyCodeLine{01737\ \ \ \textcolor{keywordflow}{if}\ (!String::CaseInsensitiveCStringEquals(s1,\ s2))\ \{}
\DoxyCodeLine{01738\ \ \ \ \ \textcolor{keywordflow}{return}\ AssertionSuccess();}
\DoxyCodeLine{01739\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01740\ \ \ \ \ \textcolor{keywordflow}{return}\ AssertionFailure()}
\DoxyCodeLine{01741\ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Expected:\ ("{}}\ <<\ s1\_expression\ <<\ \textcolor{stringliteral}{"{})\ !=\ ("{}}\ <<\ s2\_expression}
\DoxyCodeLine{01742\ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{})\ (ignoring\ case),\ actual:\ \(\backslash\)"{}"{}}\ <<\ s1\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}\ vs\ \(\backslash\)"{}"{}}\ <<\ s2\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}"{}};}
\DoxyCodeLine{01743\ \ \ \}}
\DoxyCodeLine{01744\ \}}
\DoxyCodeLine{01745\ }
\DoxyCodeLine{01746\ \}\ \ \textcolor{comment}{//\ namespace\ internal}}
\DoxyCodeLine{01747\ }
\DoxyCodeLine{01748\ \textcolor{keyword}{namespace\ }\{}
\DoxyCodeLine{01749\ }
\DoxyCodeLine{01750\ \textcolor{comment}{//\ Helper\ functions\ for\ implementing\ IsSubString()\ and\ IsNotSubstring().}}
\DoxyCodeLine{01751\ }
\DoxyCodeLine{01752\ \textcolor{comment}{//\ This\ group\ of\ overloaded\ functions\ return\ true\ if\ and\ only\ if\ needle}}
\DoxyCodeLine{01753\ \textcolor{comment}{//\ is\ a\ substring\ of\ haystack.\ \ NULL\ is\ considered\ a\ substring\ of}}
\DoxyCodeLine{01754\ \textcolor{comment}{//\ itself\ only.}}
\DoxyCodeLine{01755\ }
\DoxyCodeLine{01756\ \textcolor{keywordtype}{bool}\ IsSubstringPred(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ needle,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ haystack)\ \{}
\DoxyCodeLine{01757\ \ \ \textcolor{keywordflow}{if}\ (needle\ ==\ \textcolor{keyword}{nullptr}\ ||\ haystack\ ==\ \textcolor{keyword}{nullptr})\ \textcolor{keywordflow}{return}\ needle\ ==\ haystack;}
\DoxyCodeLine{01758\ }
\DoxyCodeLine{01759\ \ \ \textcolor{keywordflow}{return}\ strstr(haystack,\ needle)\ !=\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01760\ \}}
\DoxyCodeLine{01761\ }
\DoxyCodeLine{01762\ \textcolor{keywordtype}{bool}\ IsSubstringPred(\textcolor{keyword}{const}\ \textcolor{keywordtype}{wchar\_t}*\ needle,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{wchar\_t}*\ haystack)\ \{}
\DoxyCodeLine{01763\ \ \ \textcolor{keywordflow}{if}\ (needle\ ==\ \textcolor{keyword}{nullptr}\ ||\ haystack\ ==\ \textcolor{keyword}{nullptr})\ \textcolor{keywordflow}{return}\ needle\ ==\ haystack;}
\DoxyCodeLine{01764\ }
\DoxyCodeLine{01765\ \ \ \textcolor{keywordflow}{return}\ wcsstr(haystack,\ needle)\ !=\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01766\ \}}
\DoxyCodeLine{01767\ }
\DoxyCodeLine{01768\ \textcolor{comment}{//\ StringType\ here\ can\ be\ either\ ::std::string\ or\ ::std::wstring.}}
\DoxyCodeLine{01769\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ StringType>}
\DoxyCodeLine{01770\ \textcolor{keywordtype}{bool}\ IsSubstringPred(\textcolor{keyword}{const}\ StringType\&\ needle,\ \textcolor{keyword}{const}\ StringType\&\ haystack)\ \{}
\DoxyCodeLine{01771\ \ \ \textcolor{keywordflow}{return}\ haystack.find(needle)\ !=\ StringType::npos;}
\DoxyCodeLine{01772\ \}}
\DoxyCodeLine{01773\ }
\DoxyCodeLine{01774\ \textcolor{comment}{//\ This\ function\ implements\ either\ IsSubstring()\ or\ IsNotSubstring(),}}
\DoxyCodeLine{01775\ \textcolor{comment}{//\ depending\ on\ the\ value\ of\ the\ expected\_to\_be\_substring\ parameter.}}
\DoxyCodeLine{01776\ \textcolor{comment}{//\ StringType\ here\ can\ be\ const\ char*,\ const\ wchar\_t*,\ ::std::string,}}
\DoxyCodeLine{01777\ \textcolor{comment}{//\ or\ ::std::wstring.}}
\DoxyCodeLine{01778\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ StringType>}
\DoxyCodeLine{01779\ AssertionResult\ IsSubstringImpl(\textcolor{keywordtype}{bool}\ expected\_to\_be\_substring,}
\DoxyCodeLine{01780\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ needle\_expr,}
\DoxyCodeLine{01781\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ haystack\_expr,}
\DoxyCodeLine{01782\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ StringType\&\ needle,}
\DoxyCodeLine{01783\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ StringType\&\ haystack)\ \{}
\DoxyCodeLine{01784\ \ \ \textcolor{keywordflow}{if}\ (IsSubstringPred(needle,\ haystack)\ ==\ expected\_to\_be\_substring)}
\DoxyCodeLine{01785\ \ \ \ \ \textcolor{keywordflow}{return}\ AssertionSuccess();}
\DoxyCodeLine{01786\ }
\DoxyCodeLine{01787\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ is\_wide\_string\ =\ \textcolor{keyword}{sizeof}(needle[0])\ >\ 1;}
\DoxyCodeLine{01788\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \textcolor{keyword}{const}\ begin\_string\_quote\ =\ is\_wide\_string\ ?\ \textcolor{stringliteral}{"{}L\(\backslash\)"{}"{}}\ :\ \textcolor{stringliteral}{"{}\(\backslash\)"{}"{}};}
\DoxyCodeLine{01789\ \ \ \textcolor{keywordflow}{return}\ AssertionFailure()}
\DoxyCodeLine{01790\ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Value\ of:\ "{}}\ <<\ needle\_expr\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{01791\ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ \ Actual:\ "{}}\ <<\ begin\_string\_quote\ <<\ needle\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}\(\backslash\)n"{}}}
\DoxyCodeLine{01792\ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Expected:\ "{}}\ <<\ (expected\_to\_be\_substring\ ?\ \textcolor{stringliteral}{"{}"{}}\ :\ \textcolor{stringliteral}{"{}not\ "{}})}
\DoxyCodeLine{01793\ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}a\ substring\ of\ "{}}\ <<\ haystack\_expr\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{01794\ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Which\ is:\ "{}}\ <<\ begin\_string\_quote\ <<\ haystack\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}"{}};}
\DoxyCodeLine{01795\ \}}
\DoxyCodeLine{01796\ }
\DoxyCodeLine{01797\ \}\ \ \textcolor{comment}{//\ namespace}}
\DoxyCodeLine{01798\ }
\DoxyCodeLine{01799\ \textcolor{comment}{//\ IsSubstring()\ and\ IsNotSubstring()\ check\ whether\ needle\ is\ a}}
\DoxyCodeLine{01800\ \textcolor{comment}{//\ substring\ of\ haystack\ (NULL\ is\ considered\ a\ substring\ of\ itself}}
\DoxyCodeLine{01801\ \textcolor{comment}{//\ only),\ and\ return\ an\ appropriate\ error\ message\ when\ they\ fail.}}
\DoxyCodeLine{01802\ }
\DoxyCodeLine{01803\ AssertionResult\ IsSubstring(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ needle\_expr,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ haystack\_expr,}
\DoxyCodeLine{01804\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ needle,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ haystack)\ \{}
\DoxyCodeLine{01805\ \ \ \textcolor{keywordflow}{return}\ IsSubstringImpl(\textcolor{keyword}{true},\ needle\_expr,\ haystack\_expr,\ needle,\ haystack);}
\DoxyCodeLine{01806\ \}}
\DoxyCodeLine{01807\ }
\DoxyCodeLine{01808\ AssertionResult\ IsSubstring(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ needle\_expr,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ haystack\_expr,}
\DoxyCodeLine{01809\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{wchar\_t}*\ needle,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{wchar\_t}*\ haystack)\ \{}
\DoxyCodeLine{01810\ \ \ \textcolor{keywordflow}{return}\ IsSubstringImpl(\textcolor{keyword}{true},\ needle\_expr,\ haystack\_expr,\ needle,\ haystack);}
\DoxyCodeLine{01811\ \}}
\DoxyCodeLine{01812\ }
\DoxyCodeLine{01813\ AssertionResult\ IsNotSubstring(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ needle\_expr,}
\DoxyCodeLine{01814\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ haystack\_expr,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ needle,}
\DoxyCodeLine{01815\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ haystack)\ \{}
\DoxyCodeLine{01816\ \ \ \textcolor{keywordflow}{return}\ IsSubstringImpl(\textcolor{keyword}{false},\ needle\_expr,\ haystack\_expr,\ needle,\ haystack);}
\DoxyCodeLine{01817\ \}}
\DoxyCodeLine{01818\ }
\DoxyCodeLine{01819\ AssertionResult\ IsNotSubstring(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ needle\_expr,}
\DoxyCodeLine{01820\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ haystack\_expr,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{wchar\_t}*\ needle,}
\DoxyCodeLine{01821\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{wchar\_t}*\ haystack)\ \{}
\DoxyCodeLine{01822\ \ \ \textcolor{keywordflow}{return}\ IsSubstringImpl(\textcolor{keyword}{false},\ needle\_expr,\ haystack\_expr,\ needle,\ haystack);}
\DoxyCodeLine{01823\ \}}
\DoxyCodeLine{01824\ }
\DoxyCodeLine{01825\ AssertionResult\ IsSubstring(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ needle\_expr,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ haystack\_expr,}
\DoxyCodeLine{01826\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ ::std::string\&\ needle,}
\DoxyCodeLine{01827\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ ::std::string\&\ haystack)\ \{}
\DoxyCodeLine{01828\ \ \ \textcolor{keywordflow}{return}\ IsSubstringImpl(\textcolor{keyword}{true},\ needle\_expr,\ haystack\_expr,\ needle,\ haystack);}
\DoxyCodeLine{01829\ \}}
\DoxyCodeLine{01830\ }
\DoxyCodeLine{01831\ AssertionResult\ IsNotSubstring(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ needle\_expr,}
\DoxyCodeLine{01832\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ haystack\_expr,}
\DoxyCodeLine{01833\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ ::std::string\&\ needle,}
\DoxyCodeLine{01834\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ ::std::string\&\ haystack)\ \{}
\DoxyCodeLine{01835\ \ \ \textcolor{keywordflow}{return}\ IsSubstringImpl(\textcolor{keyword}{false},\ needle\_expr,\ haystack\_expr,\ needle,\ haystack);}
\DoxyCodeLine{01836\ \}}
\DoxyCodeLine{01837\ }
\DoxyCodeLine{01838\ \textcolor{preprocessor}{\#if\ GTEST\_HAS\_STD\_WSTRING}}
\DoxyCodeLine{01839\ AssertionResult\ IsSubstring(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ needle\_expr,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ haystack\_expr,}
\DoxyCodeLine{01840\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ ::std::wstring\&\ needle,}
\DoxyCodeLine{01841\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ ::std::wstring\&\ haystack)\ \{}
\DoxyCodeLine{01842\ \ \ \textcolor{keywordflow}{return}\ IsSubstringImpl(\textcolor{keyword}{true},\ needle\_expr,\ haystack\_expr,\ needle,\ haystack);}
\DoxyCodeLine{01843\ \}}
\DoxyCodeLine{01844\ }
\DoxyCodeLine{01845\ AssertionResult\ IsNotSubstring(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ needle\_expr,}
\DoxyCodeLine{01846\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ haystack\_expr,}
\DoxyCodeLine{01847\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ ::std::wstring\&\ needle,}
\DoxyCodeLine{01848\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ ::std::wstring\&\ haystack)\ \{}
\DoxyCodeLine{01849\ \ \ \textcolor{keywordflow}{return}\ IsSubstringImpl(\textcolor{keyword}{false},\ needle\_expr,\ haystack\_expr,\ needle,\ haystack);}
\DoxyCodeLine{01850\ \}}
\DoxyCodeLine{01851\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GTEST\_HAS\_STD\_WSTRING}}
\DoxyCodeLine{01852\ }
\DoxyCodeLine{01853\ \textcolor{keyword}{namespace\ }internal\ \{}
\DoxyCodeLine{01854\ }
\DoxyCodeLine{01855\ \textcolor{preprocessor}{\#if\ GTEST\_OS\_WINDOWS}}
\DoxyCodeLine{01856\ }
\DoxyCodeLine{01857\ \textcolor{keyword}{namespace\ }\{}
\DoxyCodeLine{01858\ }
\DoxyCodeLine{01859\ \textcolor{comment}{//\ Helper\ function\ for\ IsHRESULT\{SuccessFailure\}\ predicates}}
\DoxyCodeLine{01860\ AssertionResult\ HRESULTFailureHelper(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ expr,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ expected,}
\DoxyCodeLine{01861\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{long}\ hr)\ \{\ \ \textcolor{comment}{//\ NOLINT}}
\DoxyCodeLine{01862\ \textcolor{preprocessor}{\#if\ GTEST\_OS\_WINDOWS\_MOBILE\ ||\ GTEST\_OS\_WINDOWS\_TV\_TITLE}}
\DoxyCodeLine{01863\ }
\DoxyCodeLine{01864\ \ \ \textcolor{comment}{//\ Windows\ CE\ doesn't\ support\ FormatMessage.}}
\DoxyCodeLine{01865\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ error\_text[]\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{01866\ }
\DoxyCodeLine{01867\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{01868\ }
\DoxyCodeLine{01869\ \ \ \textcolor{comment}{//\ Looks\ up\ the\ human-\/readable\ system\ message\ for\ the\ HRESULT\ code}}
\DoxyCodeLine{01870\ \ \ \textcolor{comment}{//\ and\ since\ we're\ not\ passing\ any\ params\ to\ FormatMessage,\ we\ don't}}
\DoxyCodeLine{01871\ \ \ \textcolor{comment}{//\ want\ inserts\ expanded.}}
\DoxyCodeLine{01872\ \ \ \textcolor{keyword}{const}\ DWORD\ kFlags\ =}
\DoxyCodeLine{01873\ \ \ \ \ \ \ FORMAT\_MESSAGE\_FROM\_SYSTEM\ |\ FORMAT\_MESSAGE\_IGNORE\_INSERTS;}
\DoxyCodeLine{01874\ \ \ \textcolor{keyword}{const}\ DWORD\ kBufSize\ =\ 4096;}
\DoxyCodeLine{01875\ \ \ \textcolor{comment}{//\ Gets\ the\ system's\ human\ readable\ message\ string\ for\ this\ HRESULT.}}
\DoxyCodeLine{01876\ \ \ \textcolor{keywordtype}{char}\ error\_text[kBufSize]\ =\ \{\textcolor{charliteral}{'\(\backslash\)0'}\};}
\DoxyCodeLine{01877\ \ \ DWORD\ message\_length\ =\ ::FormatMessageA(kFlags,}
\DoxyCodeLine{01878\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0,\ \ \textcolor{comment}{//\ no\ source,\ we're\ asking\ system}}
\DoxyCodeLine{01879\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}DWORD\textcolor{keyword}{>}(hr),\ \ \textcolor{comment}{//\ the\ error}}
\DoxyCodeLine{01880\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0,\ \ \textcolor{comment}{//\ no\ line\ width\ restrictions}}
\DoxyCodeLine{01881\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ error\_text,\ \ \textcolor{comment}{//\ output\ buffer}}
\DoxyCodeLine{01882\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ kBufSize,\ \ \ \ \textcolor{comment}{//\ buf\ size}}
\DoxyCodeLine{01883\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{nullptr});\ \ \textcolor{comment}{//\ no\ arguments\ for\ inserts}}
\DoxyCodeLine{01884\ \ \ \textcolor{comment}{//\ Trims\ tailing\ white\ space\ (FormatMessage\ leaves\ a\ trailing\ CR-\/LF)}}
\DoxyCodeLine{01885\ \ \ \textcolor{keywordflow}{for}\ (;\ message\_length\ \&\&\ IsSpace(error\_text[message\_length\ -\/\ 1]);}
\DoxyCodeLine{01886\ \ \ \ \ \ \ \ -\/-\/message\_length)\ \{}
\DoxyCodeLine{01887\ \ \ \ \ error\_text[message\_length\ -\/\ 1]\ =\ \textcolor{charliteral}{'\(\backslash\)0'};}
\DoxyCodeLine{01888\ \ \ \}}
\DoxyCodeLine{01889\ }
\DoxyCodeLine{01890\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GTEST\_OS\_WINDOWS\_MOBILE}}
\DoxyCodeLine{01891\ }
\DoxyCodeLine{01892\ \ \ \textcolor{keyword}{const}\ std::string\ error\_hex(\textcolor{stringliteral}{"{}0x"{}}\ +\ String::FormatHexInt(hr));}
\DoxyCodeLine{01893\ \ \ return\ ::testing::AssertionFailure()}
\DoxyCodeLine{01894\ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Expected:\ "{}}\ <<\ expr\ <<\ \textcolor{stringliteral}{"{}\ "{}}\ <<\ expected\ <<\ \textcolor{stringliteral}{"{}.\(\backslash\)n"{}}}
\DoxyCodeLine{01895\ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ \ Actual:\ "{}}\ <<\ error\_hex\ <<\ \textcolor{stringliteral}{"{}\ "{}}\ <<\ error\_text\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{01896\ \}}
\DoxyCodeLine{01897\ }
\DoxyCodeLine{01898\ \}\ \ \textcolor{comment}{//\ namespace}}
\DoxyCodeLine{01899\ }
\DoxyCodeLine{01900\ AssertionResult\ IsHRESULTSuccess(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ expr,\ \textcolor{keywordtype}{long}\ hr)\ \{\ \ \textcolor{comment}{//\ NOLINT}}
\DoxyCodeLine{01901\ \ \ \textcolor{keywordflow}{if}\ (SUCCEEDED(hr))\ \{}
\DoxyCodeLine{01902\ \ \ \ \ \textcolor{keywordflow}{return}\ AssertionSuccess();}
\DoxyCodeLine{01903\ \ \ \}}
\DoxyCodeLine{01904\ \ \ \textcolor{keywordflow}{return}\ HRESULTFailureHelper(expr,\ \textcolor{stringliteral}{"{}succeeds"{}},\ hr);}
\DoxyCodeLine{01905\ \}}
\DoxyCodeLine{01906\ }
\DoxyCodeLine{01907\ AssertionResult\ IsHRESULTFailure(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ expr,\ \textcolor{keywordtype}{long}\ hr)\ \{\ \ \textcolor{comment}{//\ NOLINT}}
\DoxyCodeLine{01908\ \ \ \textcolor{keywordflow}{if}\ (FAILED(hr))\ \{}
\DoxyCodeLine{01909\ \ \ \ \ \textcolor{keywordflow}{return}\ AssertionSuccess();}
\DoxyCodeLine{01910\ \ \ \}}
\DoxyCodeLine{01911\ \ \ \textcolor{keywordflow}{return}\ HRESULTFailureHelper(expr,\ \textcolor{stringliteral}{"{}fails"{}},\ hr);}
\DoxyCodeLine{01912\ \}}
\DoxyCodeLine{01913\ }
\DoxyCodeLine{01914\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GTEST\_OS\_WINDOWS}}
\DoxyCodeLine{01915\ }
\DoxyCodeLine{01916\ \textcolor{comment}{//\ Utility\ functions\ for\ encoding\ Unicode\ text\ (wide\ strings)\ in}}
\DoxyCodeLine{01917\ \textcolor{comment}{//\ UTF-\/8.}}
\DoxyCodeLine{01918\ }
\DoxyCodeLine{01919\ \textcolor{comment}{//\ A\ Unicode\ code-\/point\ can\ have\ up\ to\ 21\ bits,\ and\ is\ encoded\ in\ UTF-\/8}}
\DoxyCodeLine{01920\ \textcolor{comment}{//\ like\ this:}}
\DoxyCodeLine{01921\ \textcolor{comment}{//}}
\DoxyCodeLine{01922\ \textcolor{comment}{//\ Code-\/point\ length\ \ \ Encoding}}
\DoxyCodeLine{01923\ \textcolor{comment}{//\ \ \ 0\ -\/\ \ 7\ bits\ \ \ \ \ \ \ 0xxxxxxx}}
\DoxyCodeLine{01924\ \textcolor{comment}{//\ \ \ 8\ -\/\ 11\ bits\ \ \ \ \ \ \ 110xxxxx\ 10xxxxxx}}
\DoxyCodeLine{01925\ \textcolor{comment}{//\ \ 12\ -\/\ 16\ bits\ \ \ \ \ \ \ 1110xxxx\ 10xxxxxx\ 10xxxxxx}}
\DoxyCodeLine{01926\ \textcolor{comment}{//\ \ 17\ -\/\ 21\ bits\ \ \ \ \ \ \ 11110xxx\ 10xxxxxx\ 10xxxxxx\ 10xxxxxx}}
\DoxyCodeLine{01927\ }
\DoxyCodeLine{01928\ \textcolor{comment}{//\ The\ maximum\ code-\/point\ a\ one-\/byte\ UTF-\/8\ sequence\ can\ represent.}}
\DoxyCodeLine{01929\ \textcolor{keyword}{constexpr}\ uint32\_t\ kMaxCodePoint1\ =\ (\textcolor{keyword}{static\_cast<}uint32\_t\textcolor{keyword}{>}(1)\ <<\ 7)\ -\/\ 1;}
\DoxyCodeLine{01930\ }
\DoxyCodeLine{01931\ \textcolor{comment}{//\ The\ maximum\ code-\/point\ a\ two-\/byte\ UTF-\/8\ sequence\ can\ represent.}}
\DoxyCodeLine{01932\ \textcolor{keyword}{constexpr}\ uint32\_t\ kMaxCodePoint2\ =\ (\textcolor{keyword}{static\_cast<}uint32\_t\textcolor{keyword}{>}(1)\ <<\ (5\ +\ 6))\ -\/\ 1;}
\DoxyCodeLine{01933\ }
\DoxyCodeLine{01934\ \textcolor{comment}{//\ The\ maximum\ code-\/point\ a\ three-\/byte\ UTF-\/8\ sequence\ can\ represent.}}
\DoxyCodeLine{01935\ \textcolor{keyword}{constexpr}\ uint32\_t\ kMaxCodePoint3\ =}
\DoxyCodeLine{01936\ \ \ \ \ (\textcolor{keyword}{static\_cast<}uint32\_t\textcolor{keyword}{>}(1)\ <<\ (4\ +\ 2\ *\ 6))\ -\/\ 1;}
\DoxyCodeLine{01937\ }
\DoxyCodeLine{01938\ \textcolor{comment}{//\ The\ maximum\ code-\/point\ a\ four-\/byte\ UTF-\/8\ sequence\ can\ represent.}}
\DoxyCodeLine{01939\ \textcolor{keyword}{constexpr}\ uint32\_t\ kMaxCodePoint4\ =}
\DoxyCodeLine{01940\ \ \ \ \ (\textcolor{keyword}{static\_cast<}uint32\_t\textcolor{keyword}{>}(1)\ <<\ (3\ +\ 3\ *\ 6))\ -\/\ 1;}
\DoxyCodeLine{01941\ }
\DoxyCodeLine{01942\ \textcolor{comment}{//\ Chops\ off\ the\ n\ lowest\ bits\ from\ a\ bit\ pattern.\ \ Returns\ the\ n}}
\DoxyCodeLine{01943\ \textcolor{comment}{//\ lowest\ bits.\ \ As\ a\ side\ effect,\ the\ original\ bit\ pattern\ will\ be}}
\DoxyCodeLine{01944\ \textcolor{comment}{//\ shifted\ to\ the\ right\ by\ n\ bits.}}
\DoxyCodeLine{01945\ \textcolor{keyword}{inline}\ uint32\_t\ ChopLowBits(uint32\_t*\ bits,\ \textcolor{keywordtype}{int}\ n)\ \{}
\DoxyCodeLine{01946\ \ \ \textcolor{keyword}{const}\ uint32\_t\ low\_bits\ =\ *bits\ \&\ ((\textcolor{keyword}{static\_cast<}uint32\_t\textcolor{keyword}{>}(1)\ <<\ n)\ -\/\ 1);}
\DoxyCodeLine{01947\ \ \ *bits\ >>=\ n;}
\DoxyCodeLine{01948\ \ \ \textcolor{keywordflow}{return}\ low\_bits;}
\DoxyCodeLine{01949\ \}}
\DoxyCodeLine{01950\ }
\DoxyCodeLine{01951\ \textcolor{comment}{//\ Converts\ a\ Unicode\ code\ point\ to\ a\ narrow\ string\ in\ UTF-\/8\ encoding.}}
\DoxyCodeLine{01952\ \textcolor{comment}{//\ code\_point\ parameter\ is\ of\ type\ uint32\_t\ because\ wchar\_t\ may\ not\ be}}
\DoxyCodeLine{01953\ \textcolor{comment}{//\ wide\ enough\ to\ contain\ a\ code\ point.}}
\DoxyCodeLine{01954\ \textcolor{comment}{//\ If\ the\ code\_point\ is\ not\ a\ valid\ Unicode\ code\ point}}
\DoxyCodeLine{01955\ \textcolor{comment}{//\ (i.e.\ outside\ of\ Unicode\ range\ U+0\ to\ U+10FFFF)\ it\ will\ be\ converted}}
\DoxyCodeLine{01956\ \textcolor{comment}{//\ to\ "{}(Invalid\ Unicode\ 0xXXXXXXXX)"{}.}}
\DoxyCodeLine{01957\ std::string\ CodePointToUtf8(uint32\_t\ code\_point)\ \{}
\DoxyCodeLine{01958\ \ \ \textcolor{keywordflow}{if}\ (code\_point\ >\ kMaxCodePoint4)\ \{}
\DoxyCodeLine{01959\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}(Invalid\ Unicode\ 0x"{}}\ +\ String::FormatHexUInt32(code\_point)\ +\ \textcolor{stringliteral}{"{})"{}};}
\DoxyCodeLine{01960\ \ \ \}}
\DoxyCodeLine{01961\ }
\DoxyCodeLine{01962\ \ \ \textcolor{keywordtype}{char}\ str[5];\ \ \textcolor{comment}{//\ Big\ enough\ for\ the\ largest\ valid\ code\ point.}}
\DoxyCodeLine{01963\ \ \ \textcolor{keywordflow}{if}\ (code\_point\ <=\ kMaxCodePoint1)\ \{}
\DoxyCodeLine{01964\ \ \ \ \ str[1]\ =\ \textcolor{charliteral}{'\(\backslash\)0'};}
\DoxyCodeLine{01965\ \ \ \ \ str[0]\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{char}\textcolor{keyword}{>}(code\_point);\ \ \textcolor{comment}{//\ 0xxxxxxx}}
\DoxyCodeLine{01966\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (code\_point\ <=\ kMaxCodePoint2)\ \{}
\DoxyCodeLine{01967\ \ \ \ \ str[2]\ =\ \textcolor{charliteral}{'\(\backslash\)0'};}
\DoxyCodeLine{01968\ \ \ \ \ str[1]\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{char}\textcolor{keyword}{>}(0x80\ |\ ChopLowBits(\&code\_point,\ 6));\ \ \textcolor{comment}{//\ 10xxxxxx}}
\DoxyCodeLine{01969\ \ \ \ \ str[0]\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{char}\textcolor{keyword}{>}(0xC0\ |\ code\_point);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ 110xxxxx}}
\DoxyCodeLine{01970\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (code\_point\ <=\ kMaxCodePoint3)\ \{}
\DoxyCodeLine{01971\ \ \ \ \ str[3]\ =\ \textcolor{charliteral}{'\(\backslash\)0'};}
\DoxyCodeLine{01972\ \ \ \ \ str[2]\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{char}\textcolor{keyword}{>}(0x80\ |\ ChopLowBits(\&code\_point,\ 6));\ \ \textcolor{comment}{//\ 10xxxxxx}}
\DoxyCodeLine{01973\ \ \ \ \ str[1]\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{char}\textcolor{keyword}{>}(0x80\ |\ ChopLowBits(\&code\_point,\ 6));\ \ \textcolor{comment}{//\ 10xxxxxx}}
\DoxyCodeLine{01974\ \ \ \ \ str[0]\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{char}\textcolor{keyword}{>}(0xE0\ |\ code\_point);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ 1110xxxx}}
\DoxyCodeLine{01975\ \ \ \}\ \textcolor{keywordflow}{else}\ \{\ \ \textcolor{comment}{//\ code\_point\ <=\ kMaxCodePoint4}}
\DoxyCodeLine{01976\ \ \ \ \ str[4]\ =\ \textcolor{charliteral}{'\(\backslash\)0'};}
\DoxyCodeLine{01977\ \ \ \ \ str[3]\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{char}\textcolor{keyword}{>}(0x80\ |\ ChopLowBits(\&code\_point,\ 6));\ \ \textcolor{comment}{//\ 10xxxxxx}}
\DoxyCodeLine{01978\ \ \ \ \ str[2]\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{char}\textcolor{keyword}{>}(0x80\ |\ ChopLowBits(\&code\_point,\ 6));\ \ \textcolor{comment}{//\ 10xxxxxx}}
\DoxyCodeLine{01979\ \ \ \ \ str[1]\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{char}\textcolor{keyword}{>}(0x80\ |\ ChopLowBits(\&code\_point,\ 6));\ \ \textcolor{comment}{//\ 10xxxxxx}}
\DoxyCodeLine{01980\ \ \ \ \ str[0]\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{char}\textcolor{keyword}{>}(0xF0\ |\ code\_point);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ 11110xxx}}
\DoxyCodeLine{01981\ \ \ \}}
\DoxyCodeLine{01982\ \ \ \textcolor{keywordflow}{return}\ str;}
\DoxyCodeLine{01983\ \}}
\DoxyCodeLine{01984\ }
\DoxyCodeLine{01985\ \textcolor{comment}{//\ The\ following\ two\ functions\ only\ make\ sense\ if\ the\ system}}
\DoxyCodeLine{01986\ \textcolor{comment}{//\ uses\ UTF-\/16\ for\ wide\ string\ encoding.\ All\ supported\ systems}}
\DoxyCodeLine{01987\ \textcolor{comment}{//\ with\ 16\ bit\ wchar\_t\ (Windows,\ Cygwin)\ do\ use\ UTF-\/16.}}
\DoxyCodeLine{01988\ }
\DoxyCodeLine{01989\ \textcolor{comment}{//\ Determines\ if\ the\ arguments\ constitute\ UTF-\/16\ surrogate\ pair}}
\DoxyCodeLine{01990\ \textcolor{comment}{//\ and\ thus\ should\ be\ combined\ into\ a\ single\ Unicode\ code\ point}}
\DoxyCodeLine{01991\ \textcolor{comment}{//\ using\ CreateCodePointFromUtf16SurrogatePair.}}
\DoxyCodeLine{01992\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ IsUtf16SurrogatePair(\textcolor{keywordtype}{wchar\_t}\ first,\ \textcolor{keywordtype}{wchar\_t}\ second)\ \{}
\DoxyCodeLine{01993\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{sizeof}(wchar\_t)\ ==\ 2\ \&\&\ (first\ \&\ 0xFC00)\ ==\ 0xD800\ \&\&}
\DoxyCodeLine{01994\ \ \ \ \ \ \ \ \ \ (second\ \&\ 0xFC00)\ ==\ 0xDC00;}
\DoxyCodeLine{01995\ \}}
\DoxyCodeLine{01996\ }
\DoxyCodeLine{01997\ \textcolor{comment}{//\ Creates\ a\ Unicode\ code\ point\ from\ UTF16\ surrogate\ pair.}}
\DoxyCodeLine{01998\ \textcolor{keyword}{inline}\ uint32\_t\ CreateCodePointFromUtf16SurrogatePair(\textcolor{keywordtype}{wchar\_t}\ first,}
\DoxyCodeLine{01999\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{wchar\_t}\ second)\ \{}
\DoxyCodeLine{02000\ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ first\_u\ =\ \textcolor{keyword}{static\_cast<}uint32\_t\textcolor{keyword}{>}(first);}
\DoxyCodeLine{02001\ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ second\_u\ =\ \textcolor{keyword}{static\_cast<}uint32\_t\textcolor{keyword}{>}(second);}
\DoxyCodeLine{02002\ \ \ \textcolor{keyword}{const}\ uint32\_t\ mask\ =\ (1\ <<\ 10)\ -\/\ 1;}
\DoxyCodeLine{02003\ \ \ \textcolor{keywordflow}{return}\ (\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{wchar\_t})\ ==\ 2)}
\DoxyCodeLine{02004\ \ \ \ \ \ \ \ \ \ \ \ \ \ ?\ (((first\_u\ \&\ mask)\ <<\ 10)\ |\ (second\_u\ \&\ mask))\ +\ 0x10000}
\DoxyCodeLine{02005\ \ \ \ \ \ \ \ \ \ \ \ \ \ :}
\DoxyCodeLine{02006\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ This\ function\ should\ not\ be\ called\ when\ the\ condition\ is}}
\DoxyCodeLine{02007\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ false,\ but\ we\ provide\ a\ sensible\ default\ in\ case\ it\ is.}}
\DoxyCodeLine{02008\ \ \ \ \ \ \ \ \ \ \ \ \ \ first\_u;}
\DoxyCodeLine{02009\ \}}
\DoxyCodeLine{02010\ }
\DoxyCodeLine{02011\ \textcolor{comment}{//\ Converts\ a\ wide\ string\ to\ a\ narrow\ string\ in\ UTF-\/8\ encoding.}}
\DoxyCodeLine{02012\ \textcolor{comment}{//\ The\ wide\ string\ is\ assumed\ to\ have\ the\ following\ encoding:}}
\DoxyCodeLine{02013\ \textcolor{comment}{//\ \ \ UTF-\/16\ if\ sizeof(wchar\_t)\ ==\ 2\ (on\ Windows,\ Cygwin)}}
\DoxyCodeLine{02014\ \textcolor{comment}{//\ \ \ UTF-\/32\ if\ sizeof(wchar\_t)\ ==\ 4\ (on\ Linux)}}
\DoxyCodeLine{02015\ \textcolor{comment}{//\ Parameter\ str\ points\ to\ a\ null-\/terminated\ wide\ string.}}
\DoxyCodeLine{02016\ \textcolor{comment}{//\ Parameter\ num\_chars\ may\ additionally\ limit\ the\ number}}
\DoxyCodeLine{02017\ \textcolor{comment}{//\ of\ wchar\_t\ characters\ processed.\ -\/1\ is\ used\ when\ the\ entire\ string}}
\DoxyCodeLine{02018\ \textcolor{comment}{//\ should\ be\ processed.}}
\DoxyCodeLine{02019\ \textcolor{comment}{//\ If\ the\ string\ contains\ code\ points\ that\ are\ not\ valid\ Unicode\ code\ points}}
\DoxyCodeLine{02020\ \textcolor{comment}{//\ (i.e.\ outside\ of\ Unicode\ range\ U+0\ to\ U+10FFFF)\ they\ will\ be\ output}}
\DoxyCodeLine{02021\ \textcolor{comment}{//\ as\ '(Invalid\ Unicode\ 0xXXXXXXXX)'.\ If\ the\ string\ is\ in\ UTF16\ encoding}}
\DoxyCodeLine{02022\ \textcolor{comment}{//\ and\ contains\ invalid\ UTF-\/16\ surrogate\ pairs,\ values\ in\ those\ pairs}}
\DoxyCodeLine{02023\ \textcolor{comment}{//\ will\ be\ encoded\ as\ individual\ Unicode\ characters\ from\ Basic\ Normal\ Plane.}}
\DoxyCodeLine{02024\ std::string\ WideStringToUtf8(\textcolor{keyword}{const}\ \textcolor{keywordtype}{wchar\_t}*\ str,\ \textcolor{keywordtype}{int}\ num\_chars)\ \{}
\DoxyCodeLine{02025\ \ \ \textcolor{keywordflow}{if}\ (num\_chars\ ==\ -\/1)\ num\_chars\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(wcslen(str));}
\DoxyCodeLine{02026\ }
\DoxyCodeLine{02027\ \ \ ::std::stringstream\ stream;}
\DoxyCodeLine{02028\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_chars;\ ++i)\ \{}
\DoxyCodeLine{02029\ \ \ \ \ uint32\_t\ unicode\_code\_point;}
\DoxyCodeLine{02030\ }
\DoxyCodeLine{02031\ \ \ \ \ \textcolor{keywordflow}{if}\ (str[i]\ ==\ L\textcolor{charliteral}{'\(\backslash\)0'})\ \{}
\DoxyCodeLine{02032\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02033\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (i\ +\ 1\ <\ num\_chars\ \&\&\ IsUtf16SurrogatePair(str[i],\ str[i\ +\ 1]))\ \{}
\DoxyCodeLine{02034\ \ \ \ \ \ \ unicode\_code\_point\ =}
\DoxyCodeLine{02035\ \ \ \ \ \ \ \ \ \ \ CreateCodePointFromUtf16SurrogatePair(str[i],\ str[i\ +\ 1]);}
\DoxyCodeLine{02036\ \ \ \ \ \ \ i++;}
\DoxyCodeLine{02037\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02038\ \ \ \ \ \ \ unicode\_code\_point\ =\ \textcolor{keyword}{static\_cast<}uint32\_t\textcolor{keyword}{>}(str[i]);}
\DoxyCodeLine{02039\ \ \ \ \ \}}
\DoxyCodeLine{02040\ }
\DoxyCodeLine{02041\ \ \ \ \ stream\ <<\ CodePointToUtf8(unicode\_code\_point);}
\DoxyCodeLine{02042\ \ \ \}}
\DoxyCodeLine{02043\ \ \ \textcolor{keywordflow}{return}\ StringStreamToString(\&stream);}
\DoxyCodeLine{02044\ \}}
\DoxyCodeLine{02045\ }
\DoxyCodeLine{02046\ \textcolor{comment}{//\ Converts\ a\ wide\ C\ string\ to\ an\ std::string\ using\ the\ UTF-\/8\ encoding.}}
\DoxyCodeLine{02047\ \textcolor{comment}{//\ NULL\ will\ be\ converted\ to\ "{}(null)"{}.}}
\DoxyCodeLine{02048\ std::string\ String::ShowWideCString(\textcolor{keyword}{const}\ \textcolor{keywordtype}{wchar\_t}*\ wide\_c\_str)\ \{}
\DoxyCodeLine{02049\ \ \ \textcolor{keywordflow}{if}\ (wide\_c\_str\ ==\ \textcolor{keyword}{nullptr})\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}(null)"{}};}
\DoxyCodeLine{02050\ }
\DoxyCodeLine{02051\ \ \ \textcolor{keywordflow}{return}\ internal::WideStringToUtf8(wide\_c\_str,\ -\/1);}
\DoxyCodeLine{02052\ \}}
\DoxyCodeLine{02053\ }
\DoxyCodeLine{02054\ \textcolor{comment}{//\ Compares\ two\ wide\ C\ strings.\ \ Returns\ true\ if\ and\ only\ if\ they\ have\ the}}
\DoxyCodeLine{02055\ \textcolor{comment}{//\ same\ content.}}
\DoxyCodeLine{02056\ \textcolor{comment}{//}}
\DoxyCodeLine{02057\ \textcolor{comment}{//\ Unlike\ wcscmp(),\ this\ function\ can\ handle\ NULL\ argument(s).\ \ A\ NULL}}
\DoxyCodeLine{02058\ \textcolor{comment}{//\ C\ string\ is\ considered\ different\ to\ any\ non-\/NULL\ C\ string,}}
\DoxyCodeLine{02059\ \textcolor{comment}{//\ including\ the\ empty\ string.}}
\DoxyCodeLine{02060\ \textcolor{keywordtype}{bool}\ String::WideCStringEquals(\textcolor{keyword}{const}\ \textcolor{keywordtype}{wchar\_t}*\ lhs,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{wchar\_t}*\ rhs)\ \{}
\DoxyCodeLine{02061\ \ \ \textcolor{keywordflow}{if}\ (lhs\ ==\ \textcolor{keyword}{nullptr})\ \textcolor{keywordflow}{return}\ rhs\ ==\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{02062\ }
\DoxyCodeLine{02063\ \ \ \textcolor{keywordflow}{if}\ (rhs\ ==\ \textcolor{keyword}{nullptr})\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02064\ }
\DoxyCodeLine{02065\ \ \ \textcolor{keywordflow}{return}\ wcscmp(lhs,\ rhs)\ ==\ 0;}
\DoxyCodeLine{02066\ \}}
\DoxyCodeLine{02067\ }
\DoxyCodeLine{02068\ \textcolor{comment}{//\ Helper\ function\ for\ *\_STREQ\ on\ wide\ strings.}}
\DoxyCodeLine{02069\ AssertionResult\ CmpHelperSTREQ(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ lhs\_expression,}
\DoxyCodeLine{02070\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ rhs\_expression,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{wchar\_t}*\ lhs,}
\DoxyCodeLine{02071\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{wchar\_t}*\ rhs)\ \{}
\DoxyCodeLine{02072\ \ \ \textcolor{keywordflow}{if}\ (String::WideCStringEquals(lhs,\ rhs))\ \{}
\DoxyCodeLine{02073\ \ \ \ \ \textcolor{keywordflow}{return}\ AssertionSuccess();}
\DoxyCodeLine{02074\ \ \ \}}
\DoxyCodeLine{02075\ }
\DoxyCodeLine{02076\ \ \ \textcolor{keywordflow}{return}\ EqFailure(lhs\_expression,\ rhs\_expression,\ PrintToString(lhs),}
\DoxyCodeLine{02077\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PrintToString(rhs),\ \textcolor{keyword}{false});}
\DoxyCodeLine{02078\ \}}
\DoxyCodeLine{02079\ }
\DoxyCodeLine{02080\ \textcolor{comment}{//\ Helper\ function\ for\ *\_STRNE\ on\ wide\ strings.}}
\DoxyCodeLine{02081\ AssertionResult\ CmpHelperSTRNE(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ s1\_expression,}
\DoxyCodeLine{02082\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ s2\_expression,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{wchar\_t}*\ s1,}
\DoxyCodeLine{02083\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{wchar\_t}*\ s2)\ \{}
\DoxyCodeLine{02084\ \ \ \textcolor{keywordflow}{if}\ (!String::WideCStringEquals(s1,\ s2))\ \{}
\DoxyCodeLine{02085\ \ \ \ \ \textcolor{keywordflow}{return}\ AssertionSuccess();}
\DoxyCodeLine{02086\ \ \ \}}
\DoxyCodeLine{02087\ }
\DoxyCodeLine{02088\ \ \ \textcolor{keywordflow}{return}\ AssertionFailure()}
\DoxyCodeLine{02089\ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Expected:\ ("{}}\ <<\ s1\_expression\ <<\ \textcolor{stringliteral}{"{})\ !=\ ("{}}\ <<\ s2\_expression}
\DoxyCodeLine{02090\ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}),\ actual:\ "{}}\ <<\ PrintToString(s1)\ <<\ \textcolor{stringliteral}{"{}\ vs\ "{}}\ <<\ PrintToString(s2);}
\DoxyCodeLine{02091\ \}}
\DoxyCodeLine{02092\ }
\DoxyCodeLine{02093\ \textcolor{comment}{//\ Compares\ two\ C\ strings,\ ignoring\ case.\ \ Returns\ true\ if\ and\ only\ if\ they\ have}}
\DoxyCodeLine{02094\ \textcolor{comment}{//\ the\ same\ content.}}
\DoxyCodeLine{02095\ \textcolor{comment}{//}}
\DoxyCodeLine{02096\ \textcolor{comment}{//\ Unlike\ strcasecmp(),\ this\ function\ can\ handle\ NULL\ argument(s).\ \ A}}
\DoxyCodeLine{02097\ \textcolor{comment}{//\ NULL\ C\ string\ is\ considered\ different\ to\ any\ non-\/NULL\ C\ string,}}
\DoxyCodeLine{02098\ \textcolor{comment}{//\ including\ the\ empty\ string.}}
\DoxyCodeLine{02099\ \textcolor{keywordtype}{bool}\ String::CaseInsensitiveCStringEquals(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ lhs,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ rhs)\ \{}
\DoxyCodeLine{02100\ \ \ \textcolor{keywordflow}{if}\ (lhs\ ==\ \textcolor{keyword}{nullptr})\ \textcolor{keywordflow}{return}\ rhs\ ==\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{02101\ \ \ \textcolor{keywordflow}{if}\ (rhs\ ==\ \textcolor{keyword}{nullptr})\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02102\ \ \ \textcolor{keywordflow}{return}\ posix::StrCaseCmp(lhs,\ rhs)\ ==\ 0;}
\DoxyCodeLine{02103\ \}}
\DoxyCodeLine{02104\ }
\DoxyCodeLine{02105\ \textcolor{comment}{//\ Compares\ two\ wide\ C\ strings,\ ignoring\ case.\ \ Returns\ true\ if\ and\ only\ if\ they}}
\DoxyCodeLine{02106\ \textcolor{comment}{//\ have\ the\ same\ content.}}
\DoxyCodeLine{02107\ \textcolor{comment}{//}}
\DoxyCodeLine{02108\ \textcolor{comment}{//\ Unlike\ wcscasecmp(),\ this\ function\ can\ handle\ NULL\ argument(s).}}
\DoxyCodeLine{02109\ \textcolor{comment}{//\ A\ NULL\ C\ string\ is\ considered\ different\ to\ any\ non-\/NULL\ wide\ C\ string,}}
\DoxyCodeLine{02110\ \textcolor{comment}{//\ including\ the\ empty\ string.}}
\DoxyCodeLine{02111\ \textcolor{comment}{//\ NB:\ The\ implementations\ on\ different\ platforms\ slightly\ differ.}}
\DoxyCodeLine{02112\ \textcolor{comment}{//\ On\ windows,\ this\ method\ uses\ \_wcsicmp\ which\ compares\ according\ to\ LC\_CTYPE}}
\DoxyCodeLine{02113\ \textcolor{comment}{//\ environment\ variable.\ On\ GNU\ platform\ this\ method\ uses\ wcscasecmp}}
\DoxyCodeLine{02114\ \textcolor{comment}{//\ which\ compares\ according\ to\ LC\_CTYPE\ category\ of\ the\ current\ locale.}}
\DoxyCodeLine{02115\ \textcolor{comment}{//\ On\ MacOS\ X,\ it\ uses\ towlower,\ which\ also\ uses\ LC\_CTYPE\ category\ of\ the}}
\DoxyCodeLine{02116\ \textcolor{comment}{//\ current\ locale.}}
\DoxyCodeLine{02117\ \textcolor{keywordtype}{bool}\ String::CaseInsensitiveWideCStringEquals(\textcolor{keyword}{const}\ \textcolor{keywordtype}{wchar\_t}*\ lhs,}
\DoxyCodeLine{02118\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{wchar\_t}*\ rhs)\ \{}
\DoxyCodeLine{02119\ \ \ \textcolor{keywordflow}{if}\ (lhs\ ==\ \textcolor{keyword}{nullptr})\ \textcolor{keywordflow}{return}\ rhs\ ==\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{02120\ }
\DoxyCodeLine{02121\ \ \ \textcolor{keywordflow}{if}\ (rhs\ ==\ \textcolor{keyword}{nullptr})\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02122\ }
\DoxyCodeLine{02123\ \textcolor{preprocessor}{\#if\ GTEST\_OS\_WINDOWS}}
\DoxyCodeLine{02124\ \ \ \textcolor{keywordflow}{return}\ \_wcsicmp(lhs,\ rhs)\ ==\ 0;}
\DoxyCodeLine{02125\ \textcolor{preprocessor}{\#elif\ GTEST\_OS\_LINUX\ \&\&\ !GTEST\_OS\_LINUX\_ANDROID}}
\DoxyCodeLine{02126\ \ \ \textcolor{keywordflow}{return}\ wcscasecmp(lhs,\ rhs)\ ==\ 0;}
\DoxyCodeLine{02127\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{02128\ \ \ \textcolor{comment}{//\ Android,\ Mac\ OS\ X\ and\ Cygwin\ don't\ define\ wcscasecmp.}}
\DoxyCodeLine{02129\ \ \ \textcolor{comment}{//\ Other\ unknown\ OSes\ may\ not\ define\ it\ either.}}
\DoxyCodeLine{02130\ \ \ wint\_t\ left,\ right;}
\DoxyCodeLine{02131\ \ \ \textcolor{keywordflow}{do}\ \{}
\DoxyCodeLine{02132\ \ \ \ \ left\ =\ towlower(\textcolor{keyword}{static\_cast<}wint\_t\textcolor{keyword}{>}(*lhs++));}
\DoxyCodeLine{02133\ \ \ \ \ right\ =\ towlower(\textcolor{keyword}{static\_cast<}wint\_t\textcolor{keyword}{>}(*rhs++));}
\DoxyCodeLine{02134\ \ \ \}\ \textcolor{keywordflow}{while}\ (left\ \&\&\ left\ ==\ right);}
\DoxyCodeLine{02135\ \ \ \textcolor{keywordflow}{return}\ left\ ==\ right;}
\DoxyCodeLine{02136\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OS\ selector}}
\DoxyCodeLine{02137\ \}}
\DoxyCodeLine{02138\ }
\DoxyCodeLine{02139\ \textcolor{comment}{//\ Returns\ true\ if\ and\ only\ if\ str\ ends\ with\ the\ given\ suffix,\ ignoring\ case.}}
\DoxyCodeLine{02140\ \textcolor{comment}{//\ Any\ string\ is\ considered\ to\ end\ with\ an\ empty\ suffix.}}
\DoxyCodeLine{02141\ \textcolor{keywordtype}{bool}\ String::EndsWithCaseInsensitive(\textcolor{keyword}{const}\ std::string\&\ str,}
\DoxyCodeLine{02142\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ suffix)\ \{}
\DoxyCodeLine{02143\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ str\_len\ =\ str.length();}
\DoxyCodeLine{02144\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ suffix\_len\ =\ suffix.length();}
\DoxyCodeLine{02145\ \ \ \textcolor{keywordflow}{return}\ (str\_len\ >=\ suffix\_len)\ \&\&}
\DoxyCodeLine{02146\ \ \ \ \ \ \ \ \ \ CaseInsensitiveCStringEquals(str.c\_str()\ +\ str\_len\ -\/\ suffix\_len,}
\DoxyCodeLine{02147\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ suffix.c\_str());}
\DoxyCodeLine{02148\ \}}
\DoxyCodeLine{02149\ }
\DoxyCodeLine{02150\ \textcolor{comment}{//\ Formats\ an\ int\ value\ as\ "{}\%02d"{}.}}
\DoxyCodeLine{02151\ std::string\ String::FormatIntWidth2(\textcolor{keywordtype}{int}\ value)\ \{}
\DoxyCodeLine{02152\ \ \ \textcolor{keywordflow}{return}\ FormatIntWidthN(value,\ 2);}
\DoxyCodeLine{02153\ \}}
\DoxyCodeLine{02154\ }
\DoxyCodeLine{02155\ \textcolor{comment}{//\ Formats\ an\ int\ value\ to\ given\ width\ with\ leading\ zeros.}}
\DoxyCodeLine{02156\ std::string\ String::FormatIntWidthN(\textcolor{keywordtype}{int}\ value,\ \textcolor{keywordtype}{int}\ width)\ \{}
\DoxyCodeLine{02157\ \ \ std::stringstream\ ss;}
\DoxyCodeLine{02158\ \ \ ss\ <<\ std::setfill(\textcolor{charliteral}{'0'})\ <<\ std::setw(width)\ <<\ value;}
\DoxyCodeLine{02159\ \ \ \textcolor{keywordflow}{return}\ ss.str();}
\DoxyCodeLine{02160\ \}}
\DoxyCodeLine{02161\ }
\DoxyCodeLine{02162\ \textcolor{comment}{//\ Formats\ an\ int\ value\ as\ "{}\%X"{}.}}
\DoxyCodeLine{02163\ std::string\ String::FormatHexUInt32(uint32\_t\ value)\ \{}
\DoxyCodeLine{02164\ \ \ std::stringstream\ ss;}
\DoxyCodeLine{02165\ \ \ ss\ <<\ std::hex\ <<\ std::uppercase\ <<\ value;}
\DoxyCodeLine{02166\ \ \ \textcolor{keywordflow}{return}\ ss.str();}
\DoxyCodeLine{02167\ \}}
\DoxyCodeLine{02168\ }
\DoxyCodeLine{02169\ \textcolor{comment}{//\ Formats\ an\ int\ value\ as\ "{}\%X"{}.}}
\DoxyCodeLine{02170\ std::string\ String::FormatHexInt(\textcolor{keywordtype}{int}\ value)\ \{}
\DoxyCodeLine{02171\ \ \ \textcolor{keywordflow}{return}\ FormatHexUInt32(\textcolor{keyword}{static\_cast<}uint32\_t\textcolor{keyword}{>}(value));}
\DoxyCodeLine{02172\ \}}
\DoxyCodeLine{02173\ }
\DoxyCodeLine{02174\ \textcolor{comment}{//\ Formats\ a\ byte\ as\ "{}\%02X"{}.}}
\DoxyCodeLine{02175\ std::string\ String::FormatByte(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ value)\ \{}
\DoxyCodeLine{02176\ \ \ std::stringstream\ ss;}
\DoxyCodeLine{02177\ \ \ ss\ <<\ std::setfill(\textcolor{charliteral}{'0'})\ <<\ std::setw(2)\ <<\ std::hex\ <<\ std::uppercase}
\DoxyCodeLine{02178\ \ \ \ \ \ <<\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\textcolor{keyword}{>}(value);}
\DoxyCodeLine{02179\ \ \ \textcolor{keywordflow}{return}\ ss.str();}
\DoxyCodeLine{02180\ \}}
\DoxyCodeLine{02181\ }
\DoxyCodeLine{02182\ \textcolor{comment}{//\ Converts\ the\ buffer\ in\ a\ stringstream\ to\ an\ std::string,\ converting\ NUL}}
\DoxyCodeLine{02183\ \textcolor{comment}{//\ bytes\ to\ "{}\(\backslash\)\(\backslash\)0"{}\ along\ the\ way.}}
\DoxyCodeLine{02184\ std::string\ StringStreamToString(::std::stringstream*\ ss)\ \{}
\DoxyCodeLine{02185\ \ \ const\ ::std::string\&\ str\ =\ ss-\/>str();}
\DoxyCodeLine{02186\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \textcolor{keyword}{const}\ start\ =\ str.c\_str();}
\DoxyCodeLine{02187\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \textcolor{keyword}{const}\ end\ =\ start\ +\ str.length();}
\DoxyCodeLine{02188\ }
\DoxyCodeLine{02189\ \ \ std::string\ result;}
\DoxyCodeLine{02190\ \ \ result.reserve(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{size\_t}\textcolor{keyword}{>}(2\ *\ (end\ -\/\ start)));}
\DoxyCodeLine{02191\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ ch\ =\ start;\ ch\ !=\ end;\ ++ch)\ \{}
\DoxyCodeLine{02192\ \ \ \ \ \textcolor{keywordflow}{if}\ (*ch\ ==\ \textcolor{charliteral}{'\(\backslash\)0'})\ \{}
\DoxyCodeLine{02193\ \ \ \ \ \ \ result\ +=\ \textcolor{stringliteral}{"{}\(\backslash\)\(\backslash\)0"{}};\ \ \textcolor{comment}{//\ Replaces\ NUL\ with\ "{}\(\backslash\)\(\backslash\)0"{};}}
\DoxyCodeLine{02194\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02195\ \ \ \ \ \ \ result\ +=\ *ch;}
\DoxyCodeLine{02196\ \ \ \ \ \}}
\DoxyCodeLine{02197\ \ \ \}}
\DoxyCodeLine{02198\ }
\DoxyCodeLine{02199\ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{02200\ \}}
\DoxyCodeLine{02201\ }
\DoxyCodeLine{02202\ \textcolor{comment}{//\ Appends\ the\ user-\/supplied\ message\ to\ the\ Google-\/Test-\/generated\ message.}}
\DoxyCodeLine{02203\ std::string\ AppendUserMessage(\textcolor{keyword}{const}\ std::string\&\ gtest\_msg,}
\DoxyCodeLine{02204\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Message\&\ user\_msg)\ \{}
\DoxyCodeLine{02205\ \ \ \textcolor{comment}{//\ Appends\ the\ user\ message\ if\ it's\ non-\/empty.}}
\DoxyCodeLine{02206\ \ \ \textcolor{keyword}{const}\ std::string\ user\_msg\_string\ =\ user\_msg.GetString();}
\DoxyCodeLine{02207\ \ \ \textcolor{keywordflow}{if}\ (user\_msg\_string.empty())\ \{}
\DoxyCodeLine{02208\ \ \ \ \ \textcolor{keywordflow}{return}\ gtest\_msg;}
\DoxyCodeLine{02209\ \ \ \}}
\DoxyCodeLine{02210\ \ \ \textcolor{keywordflow}{if}\ (gtest\_msg.empty())\ \{}
\DoxyCodeLine{02211\ \ \ \ \ \textcolor{keywordflow}{return}\ user\_msg\_string;}
\DoxyCodeLine{02212\ \ \ \}}
\DoxyCodeLine{02213\ \ \ \textcolor{keywordflow}{return}\ gtest\_msg\ +\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}\ +\ user\_msg\_string;}
\DoxyCodeLine{02214\ \}}
\DoxyCodeLine{02215\ }
\DoxyCodeLine{02216\ \}\ \ \textcolor{comment}{//\ namespace\ internal}}
\DoxyCodeLine{02217\ }
\DoxyCodeLine{02218\ \textcolor{comment}{//\ class\ TestResult}}
\DoxyCodeLine{02219\ }
\DoxyCodeLine{02220\ \textcolor{comment}{//\ Creates\ an\ empty\ TestResult.}}
\DoxyCodeLine{02221\ TestResult::TestResult()}
\DoxyCodeLine{02222\ \ \ \ \ :\ death\_test\_count\_(0),\ start\_timestamp\_(0),\ elapsed\_time\_(0)\ \{\}}
\DoxyCodeLine{02223\ }
\DoxyCodeLine{02224\ \textcolor{comment}{//\ D'tor.}}
\DoxyCodeLine{02225\ TestResult::\string~TestResult()\ \{\}}
\DoxyCodeLine{02226\ }
\DoxyCodeLine{02227\ \textcolor{comment}{//\ Returns\ the\ i-\/th\ test\ part\ result\ among\ all\ the\ results.\ i\ can}}
\DoxyCodeLine{02228\ \textcolor{comment}{//\ range\ from\ 0\ to\ total\_part\_count()\ -\/\ 1.\ If\ i\ is\ not\ in\ that\ range,}}
\DoxyCodeLine{02229\ \textcolor{comment}{//\ aborts\ the\ program.}}
\DoxyCodeLine{02230\ \textcolor{keyword}{const}\ TestPartResult\&\ TestResult::GetTestPartResult(\textcolor{keywordtype}{int}\ i)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02231\ \ \ \textcolor{keywordflow}{if}\ (i\ <\ 0\ ||\ i\ >=\ total\_part\_count())\ internal::posix::Abort();}
\DoxyCodeLine{02232\ \ \ \textcolor{keywordflow}{return}\ test\_part\_results\_.at(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{size\_t}\textcolor{keyword}{>}(i));}
\DoxyCodeLine{02233\ \}}
\DoxyCodeLine{02234\ }
\DoxyCodeLine{02235\ \textcolor{comment}{//\ Returns\ the\ i-\/th\ test\ property.\ i\ can\ range\ from\ 0\ to}}
\DoxyCodeLine{02236\ \textcolor{comment}{//\ test\_property\_count()\ -\/\ 1.\ If\ i\ is\ not\ in\ that\ range,\ aborts\ the}}
\DoxyCodeLine{02237\ \textcolor{comment}{//\ program.}}
\DoxyCodeLine{02238\ \textcolor{keyword}{const}\ TestProperty\&\ TestResult::GetTestProperty(\textcolor{keywordtype}{int}\ i)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02239\ \ \ \textcolor{keywordflow}{if}\ (i\ <\ 0\ ||\ i\ >=\ test\_property\_count())\ internal::posix::Abort();}
\DoxyCodeLine{02240\ \ \ \textcolor{keywordflow}{return}\ test\_properties\_.at(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{size\_t}\textcolor{keyword}{>}(i));}
\DoxyCodeLine{02241\ \}}
\DoxyCodeLine{02242\ }
\DoxyCodeLine{02243\ \textcolor{comment}{//\ Clears\ the\ test\ part\ results.}}
\DoxyCodeLine{02244\ \textcolor{keywordtype}{void}\ TestResult::ClearTestPartResults()\ \{\ test\_part\_results\_.clear();\ \}}
\DoxyCodeLine{02245\ }
\DoxyCodeLine{02246\ \textcolor{comment}{//\ Adds\ a\ test\ part\ result\ to\ the\ list.}}
\DoxyCodeLine{02247\ \textcolor{keywordtype}{void}\ TestResult::AddTestPartResult(\textcolor{keyword}{const}\ TestPartResult\&\ test\_part\_result)\ \{}
\DoxyCodeLine{02248\ \ \ test\_part\_results\_.push\_back(test\_part\_result);}
\DoxyCodeLine{02249\ \}}
\DoxyCodeLine{02250\ }
\DoxyCodeLine{02251\ \textcolor{comment}{//\ Adds\ a\ test\ property\ to\ the\ list.\ If\ a\ property\ with\ the\ same\ key\ as\ the}}
\DoxyCodeLine{02252\ \textcolor{comment}{//\ supplied\ property\ is\ already\ represented,\ the\ value\ of\ this\ test\_property}}
\DoxyCodeLine{02253\ \textcolor{comment}{//\ replaces\ the\ old\ value\ for\ that\ key.}}
\DoxyCodeLine{02254\ \textcolor{keywordtype}{void}\ TestResult::RecordProperty(\textcolor{keyword}{const}\ std::string\&\ xml\_element,}
\DoxyCodeLine{02255\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ TestProperty\&\ test\_property)\ \{}
\DoxyCodeLine{02256\ \ \ \textcolor{keywordflow}{if}\ (!ValidateTestProperty(xml\_element,\ test\_property))\ \{}
\DoxyCodeLine{02257\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02258\ \ \ \}}
\DoxyCodeLine{02259\ \ \ internal::MutexLock\ lock(\&test\_properties\_mutex\_);}
\DoxyCodeLine{02260\ \ \ \textcolor{keyword}{const}\ std::vector<TestProperty>::iterator\ property\_with\_matching\_key\ =}
\DoxyCodeLine{02261\ \ \ \ \ \ \ std::find\_if(test\_properties\_.begin(),\ test\_properties\_.end(),}
\DoxyCodeLine{02262\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ internal::TestPropertyKeyIs(test\_property.key()));}
\DoxyCodeLine{02263\ \ \ \textcolor{keywordflow}{if}\ (property\_with\_matching\_key\ ==\ test\_properties\_.end())\ \{}
\DoxyCodeLine{02264\ \ \ \ \ test\_properties\_.push\_back(test\_property);}
\DoxyCodeLine{02265\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02266\ \ \ \}}
\DoxyCodeLine{02267\ \ \ property\_with\_matching\_key-\/>SetValue(test\_property.value());}
\DoxyCodeLine{02268\ \}}
\DoxyCodeLine{02269\ }
\DoxyCodeLine{02270\ \textcolor{comment}{//\ The\ list\ of\ reserved\ attributes\ used\ in\ the\ <testsuites>\ element\ of\ XML}}
\DoxyCodeLine{02271\ \textcolor{comment}{//\ output.}}
\DoxyCodeLine{02272\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \textcolor{keyword}{const}\ kReservedTestSuitesAttributes[]\ =\ \{}
\DoxyCodeLine{02273\ \ \ \ \ \textcolor{stringliteral}{"{}disabled"{}},\ \ \ \ \textcolor{stringliteral}{"{}errors"{}},\ \textcolor{stringliteral}{"{}failures"{}},\ \textcolor{stringliteral}{"{}name"{}},}
\DoxyCodeLine{02274\ \ \ \ \ \textcolor{stringliteral}{"{}random\_seed"{}},\ \textcolor{stringliteral}{"{}tests"{}},\ \ \textcolor{stringliteral}{"{}time"{}},\ \ \ \ \ \textcolor{stringliteral}{"{}timestamp"{}}\};}
\DoxyCodeLine{02275\ }
\DoxyCodeLine{02276\ \textcolor{comment}{//\ The\ list\ of\ reserved\ attributes\ used\ in\ the\ <testsuite>\ element\ of\ XML}}
\DoxyCodeLine{02277\ \textcolor{comment}{//\ output.}}
\DoxyCodeLine{02278\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \textcolor{keyword}{const}\ kReservedTestSuiteAttributes[]\ =\ \{}
\DoxyCodeLine{02279\ \ \ \ \ \textcolor{stringliteral}{"{}disabled"{}},\ \textcolor{stringliteral}{"{}errors"{}},\ \textcolor{stringliteral}{"{}failures"{}},\ \ \textcolor{stringliteral}{"{}name"{}},}
\DoxyCodeLine{02280\ \ \ \ \ \textcolor{stringliteral}{"{}tests"{}},\ \ \ \ \textcolor{stringliteral}{"{}time"{}},\ \ \ \textcolor{stringliteral}{"{}timestamp"{}},\ \textcolor{stringliteral}{"{}skipped"{}}\};}
\DoxyCodeLine{02281\ }
\DoxyCodeLine{02282\ \textcolor{comment}{//\ The\ list\ of\ reserved\ attributes\ used\ in\ the\ <testcase>\ element\ of\ XML\ output.}}
\DoxyCodeLine{02283\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \textcolor{keyword}{const}\ kReservedTestCaseAttributes[]\ =\ \{}
\DoxyCodeLine{02284\ \ \ \ \ \textcolor{stringliteral}{"{}classname"{}},\ \ \textcolor{stringliteral}{"{}name"{}},\ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}status"{}},\ \textcolor{stringliteral}{"{}time"{}},}
\DoxyCodeLine{02285\ \ \ \ \ \textcolor{stringliteral}{"{}type\_param"{}},\ \textcolor{stringliteral}{"{}value\_param"{}},\ \textcolor{stringliteral}{"{}file"{}},\ \ \ \textcolor{stringliteral}{"{}line"{}}\};}
\DoxyCodeLine{02286\ }
\DoxyCodeLine{02287\ \textcolor{comment}{//\ Use\ a\ slightly\ different\ set\ for\ allowed\ output\ to\ ensure\ existing\ tests\ can}}
\DoxyCodeLine{02288\ \textcolor{comment}{//\ still\ RecordProperty("{}result"{})\ or\ "{}RecordProperty(timestamp"{})}}
\DoxyCodeLine{02289\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \textcolor{keyword}{const}\ kReservedOutputTestCaseAttributes[]\ =\ \{}
\DoxyCodeLine{02290\ \ \ \ \ \textcolor{stringliteral}{"{}classname"{}},\ \ \ \textcolor{stringliteral}{"{}name"{}},\ \textcolor{stringliteral}{"{}status"{}},\ \textcolor{stringliteral}{"{}time"{}},\ \ \ \textcolor{stringliteral}{"{}type\_param"{}},}
\DoxyCodeLine{02291\ \ \ \ \ \textcolor{stringliteral}{"{}value\_param"{}},\ \textcolor{stringliteral}{"{}file"{}},\ \textcolor{stringliteral}{"{}line"{}},\ \ \ \textcolor{stringliteral}{"{}result"{}},\ \textcolor{stringliteral}{"{}timestamp"{}}\};}
\DoxyCodeLine{02292\ }
\DoxyCodeLine{02293\ \textcolor{keyword}{template}\ <\textcolor{keywordtype}{size\_t}\ kSize>}
\DoxyCodeLine{02294\ std::vector<std::string>\ ArrayAsVector(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \textcolor{keyword}{const}\ (\&array)[kSize])\ \{}
\DoxyCodeLine{02295\ \ \ \textcolor{keywordflow}{return}\ std::vector<std::string>(array,\ array\ +\ kSize);}
\DoxyCodeLine{02296\ \}}
\DoxyCodeLine{02297\ }
\DoxyCodeLine{02298\ \textcolor{keyword}{static}\ std::vector<std::string>\ GetReservedAttributesForElement(}
\DoxyCodeLine{02299\ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ xml\_element)\ \{}
\DoxyCodeLine{02300\ \ \ \textcolor{keywordflow}{if}\ (xml\_element\ ==\ \textcolor{stringliteral}{"{}testsuites"{}})\ \{}
\DoxyCodeLine{02301\ \ \ \ \ \textcolor{keywordflow}{return}\ ArrayAsVector(kReservedTestSuitesAttributes);}
\DoxyCodeLine{02302\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (xml\_element\ ==\ \textcolor{stringliteral}{"{}testsuite"{}})\ \{}
\DoxyCodeLine{02303\ \ \ \ \ \textcolor{keywordflow}{return}\ ArrayAsVector(kReservedTestSuiteAttributes);}
\DoxyCodeLine{02304\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (xml\_element\ ==\ \textcolor{stringliteral}{"{}testcase"{}})\ \{}
\DoxyCodeLine{02305\ \ \ \ \ \textcolor{keywordflow}{return}\ ArrayAsVector(kReservedTestCaseAttributes);}
\DoxyCodeLine{02306\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02307\ \ \ \ \ GTEST\_CHECK\_(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}Unrecognized\ xml\_element\ provided:\ "{}}\ <<\ xml\_element;}
\DoxyCodeLine{02308\ \ \ \}}
\DoxyCodeLine{02309\ \ \ \textcolor{comment}{//\ This\ code\ is\ unreachable\ but\ some\ compilers\ may\ not\ realizes\ that.}}
\DoxyCodeLine{02310\ \ \ \textcolor{keywordflow}{return}\ std::vector<std::string>();}
\DoxyCodeLine{02311\ \}}
\DoxyCodeLine{02312\ }
\DoxyCodeLine{02313\ \textcolor{comment}{//\ TODO(jdesprez):\ Merge\ the\ two\ getReserved\ attributes\ once\ skip\ is\ improved}}
\DoxyCodeLine{02314\ \textcolor{keyword}{static}\ std::vector<std::string>\ GetReservedOutputAttributesForElement(}
\DoxyCodeLine{02315\ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ xml\_element)\ \{}
\DoxyCodeLine{02316\ \ \ \textcolor{keywordflow}{if}\ (xml\_element\ ==\ \textcolor{stringliteral}{"{}testsuites"{}})\ \{}
\DoxyCodeLine{02317\ \ \ \ \ \textcolor{keywordflow}{return}\ ArrayAsVector(kReservedTestSuitesAttributes);}
\DoxyCodeLine{02318\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (xml\_element\ ==\ \textcolor{stringliteral}{"{}testsuite"{}})\ \{}
\DoxyCodeLine{02319\ \ \ \ \ \textcolor{keywordflow}{return}\ ArrayAsVector(kReservedTestSuiteAttributes);}
\DoxyCodeLine{02320\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (xml\_element\ ==\ \textcolor{stringliteral}{"{}testcase"{}})\ \{}
\DoxyCodeLine{02321\ \ \ \ \ \textcolor{keywordflow}{return}\ ArrayAsVector(kReservedOutputTestCaseAttributes);}
\DoxyCodeLine{02322\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02323\ \ \ \ \ GTEST\_CHECK\_(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}Unrecognized\ xml\_element\ provided:\ "{}}\ <<\ xml\_element;}
\DoxyCodeLine{02324\ \ \ \}}
\DoxyCodeLine{02325\ \ \ \textcolor{comment}{//\ This\ code\ is\ unreachable\ but\ some\ compilers\ may\ not\ realizes\ that.}}
\DoxyCodeLine{02326\ \ \ \textcolor{keywordflow}{return}\ std::vector<std::string>();}
\DoxyCodeLine{02327\ \}}
\DoxyCodeLine{02328\ }
\DoxyCodeLine{02329\ \textcolor{keyword}{static}\ std::string\ FormatWordList(\textcolor{keyword}{const}\ std::vector<std::string>\&\ words)\ \{}
\DoxyCodeLine{02330\ \ \ Message\ word\_list;}
\DoxyCodeLine{02331\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ words.size();\ ++i)\ \{}
\DoxyCodeLine{02332\ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ >\ 0\ \&\&\ words.size()\ >\ 2)\ \{}
\DoxyCodeLine{02333\ \ \ \ \ \ \ word\_list\ <<\ \textcolor{stringliteral}{"{},\ "{}};}
\DoxyCodeLine{02334\ \ \ \ \ \}}
\DoxyCodeLine{02335\ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ ==\ words.size()\ -\/\ 1)\ \{}
\DoxyCodeLine{02336\ \ \ \ \ \ \ word\_list\ <<\ \textcolor{stringliteral}{"{}and\ "{}};}
\DoxyCodeLine{02337\ \ \ \ \ \}}
\DoxyCodeLine{02338\ \ \ \ \ word\_list\ <<\ \textcolor{stringliteral}{"{}'"{}}\ <<\ words[i]\ <<\ \textcolor{stringliteral}{"{}'"{}};}
\DoxyCodeLine{02339\ \ \ \}}
\DoxyCodeLine{02340\ \ \ \textcolor{keywordflow}{return}\ word\_list.GetString();}
\DoxyCodeLine{02341\ \}}
\DoxyCodeLine{02342\ }
\DoxyCodeLine{02343\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ ValidateTestPropertyName(}
\DoxyCodeLine{02344\ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ property\_name,}
\DoxyCodeLine{02345\ \ \ \ \ \textcolor{keyword}{const}\ std::vector<std::string>\&\ reserved\_names)\ \{}
\DoxyCodeLine{02346\ \ \ \textcolor{keywordflow}{if}\ (std::find(reserved\_names.begin(),\ reserved\_names.end(),\ property\_name)\ !=}
\DoxyCodeLine{02347\ \ \ \ \ \ \ reserved\_names.end())\ \{}
\DoxyCodeLine{02348\ \ \ \ \ ADD\_FAILURE()\ <<\ \textcolor{stringliteral}{"{}Reserved\ key\ used\ in\ RecordProperty():\ "{}}\ <<\ property\_name}
\DoxyCodeLine{02349\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ ("{}}\ <<\ FormatWordList(reserved\_names)}
\DoxyCodeLine{02350\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ are\ reserved\ by\ "{}}\ <<\ GTEST\_NAME\_\ <<\ \textcolor{stringliteral}{"{})"{}};}
\DoxyCodeLine{02351\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02352\ \ \ \}}
\DoxyCodeLine{02353\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02354\ \}}
\DoxyCodeLine{02355\ }
\DoxyCodeLine{02356\ \textcolor{comment}{//\ Adds\ a\ failure\ if\ the\ key\ is\ a\ reserved\ attribute\ of\ the\ element\ named}}
\DoxyCodeLine{02357\ \textcolor{comment}{//\ xml\_element.\ \ Returns\ true\ if\ the\ property\ is\ valid.}}
\DoxyCodeLine{02358\ \textcolor{keywordtype}{bool}\ TestResult::ValidateTestProperty(\textcolor{keyword}{const}\ std::string\&\ xml\_element,}
\DoxyCodeLine{02359\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ TestProperty\&\ test\_property)\ \{}
\DoxyCodeLine{02360\ \ \ \textcolor{keywordflow}{return}\ ValidateTestPropertyName(test\_property.key(),}
\DoxyCodeLine{02361\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ GetReservedAttributesForElement(xml\_element));}
\DoxyCodeLine{02362\ \}}
\DoxyCodeLine{02363\ }
\DoxyCodeLine{02364\ \textcolor{comment}{//\ Clears\ the\ object.}}
\DoxyCodeLine{02365\ \textcolor{keywordtype}{void}\ TestResult::Clear()\ \{}
\DoxyCodeLine{02366\ \ \ test\_part\_results\_.clear();}
\DoxyCodeLine{02367\ \ \ test\_properties\_.clear();}
\DoxyCodeLine{02368\ \ \ death\_test\_count\_\ =\ 0;}
\DoxyCodeLine{02369\ \ \ elapsed\_time\_\ =\ 0;}
\DoxyCodeLine{02370\ \}}
\DoxyCodeLine{02371\ }
\DoxyCodeLine{02372\ \textcolor{comment}{//\ Returns\ true\ off\ the\ test\ part\ was\ skipped.}}
\DoxyCodeLine{02373\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ TestPartSkipped(\textcolor{keyword}{const}\ TestPartResult\&\ result)\ \{}
\DoxyCodeLine{02374\ \ \ \textcolor{keywordflow}{return}\ result.skipped();}
\DoxyCodeLine{02375\ \}}
\DoxyCodeLine{02376\ }
\DoxyCodeLine{02377\ \textcolor{comment}{//\ Returns\ true\ if\ and\ only\ if\ the\ test\ was\ skipped.}}
\DoxyCodeLine{02378\ \textcolor{keywordtype}{bool}\ TestResult::Skipped()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02379\ \ \ \textcolor{keywordflow}{return}\ !Failed()\ \&\&\ CountIf(test\_part\_results\_,\ TestPartSkipped)\ >\ 0;}
\DoxyCodeLine{02380\ \}}
\DoxyCodeLine{02381\ }
\DoxyCodeLine{02382\ \textcolor{comment}{//\ Returns\ true\ if\ and\ only\ if\ the\ test\ failed.}}
\DoxyCodeLine{02383\ \textcolor{keywordtype}{bool}\ TestResult::Failed()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02384\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ total\_part\_count();\ ++i)\ \{}
\DoxyCodeLine{02385\ \ \ \ \ \textcolor{keywordflow}{if}\ (GetTestPartResult(i).failed())\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02386\ \ \ \}}
\DoxyCodeLine{02387\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02388\ \}}
\DoxyCodeLine{02389\ }
\DoxyCodeLine{02390\ \textcolor{comment}{//\ Returns\ true\ if\ and\ only\ if\ the\ test\ part\ fatally\ failed.}}
\DoxyCodeLine{02391\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ TestPartFatallyFailed(\textcolor{keyword}{const}\ TestPartResult\&\ result)\ \{}
\DoxyCodeLine{02392\ \ \ \textcolor{keywordflow}{return}\ result.fatally\_failed();}
\DoxyCodeLine{02393\ \}}
\DoxyCodeLine{02394\ }
\DoxyCodeLine{02395\ \textcolor{comment}{//\ Returns\ true\ if\ and\ only\ if\ the\ test\ fatally\ failed.}}
\DoxyCodeLine{02396\ \textcolor{keywordtype}{bool}\ TestResult::HasFatalFailure()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02397\ \ \ \textcolor{keywordflow}{return}\ CountIf(test\_part\_results\_,\ TestPartFatallyFailed)\ >\ 0;}
\DoxyCodeLine{02398\ \}}
\DoxyCodeLine{02399\ }
\DoxyCodeLine{02400\ \textcolor{comment}{//\ Returns\ true\ if\ and\ only\ if\ the\ test\ part\ non-\/fatally\ failed.}}
\DoxyCodeLine{02401\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ TestPartNonfatallyFailed(\textcolor{keyword}{const}\ TestPartResult\&\ result)\ \{}
\DoxyCodeLine{02402\ \ \ \textcolor{keywordflow}{return}\ result.nonfatally\_failed();}
\DoxyCodeLine{02403\ \}}
\DoxyCodeLine{02404\ }
\DoxyCodeLine{02405\ \textcolor{comment}{//\ Returns\ true\ if\ and\ only\ if\ the\ test\ has\ a\ non-\/fatal\ failure.}}
\DoxyCodeLine{02406\ \textcolor{keywordtype}{bool}\ TestResult::HasNonfatalFailure()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02407\ \ \ \textcolor{keywordflow}{return}\ CountIf(test\_part\_results\_,\ TestPartNonfatallyFailed)\ >\ 0;}
\DoxyCodeLine{02408\ \}}
\DoxyCodeLine{02409\ }
\DoxyCodeLine{02410\ \textcolor{comment}{//\ Gets\ the\ number\ of\ all\ test\ parts.\ \ This\ is\ the\ sum\ of\ the\ number}}
\DoxyCodeLine{02411\ \textcolor{comment}{//\ of\ successful\ test\ parts\ and\ the\ number\ of\ failed\ test\ parts.}}
\DoxyCodeLine{02412\ \textcolor{keywordtype}{int}\ TestResult::total\_part\_count()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02413\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(test\_part\_results\_.size());}
\DoxyCodeLine{02414\ \}}
\DoxyCodeLine{02415\ }
\DoxyCodeLine{02416\ \textcolor{comment}{//\ Returns\ the\ number\ of\ the\ test\ properties.}}
\DoxyCodeLine{02417\ \textcolor{keywordtype}{int}\ TestResult::test\_property\_count()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02418\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(test\_properties\_.size());}
\DoxyCodeLine{02419\ \}}
\DoxyCodeLine{02420\ }
\DoxyCodeLine{02421\ \textcolor{comment}{//\ class\ Test}}
\DoxyCodeLine{02422\ }
\DoxyCodeLine{02423\ \textcolor{comment}{//\ Creates\ a\ Test\ object.}}
\DoxyCodeLine{02424\ }
\DoxyCodeLine{02425\ \textcolor{comment}{//\ The\ c'tor\ saves\ the\ states\ of\ all\ flags.}}
\DoxyCodeLine{02426\ Test::Test()\ :\ gtest\_flag\_saver\_(new\ GTEST\_FLAG\_SAVER\_)\ \{\}}
\DoxyCodeLine{02427\ }
\DoxyCodeLine{02428\ \textcolor{comment}{//\ The\ d'tor\ restores\ the\ states\ of\ all\ flags.\ \ The\ actual\ work\ is}}
\DoxyCodeLine{02429\ \textcolor{comment}{//\ done\ by\ the\ d'tor\ of\ the\ gtest\_flag\_saver\_\ field,\ and\ thus\ not}}
\DoxyCodeLine{02430\ \textcolor{comment}{//\ visible\ here.}}
\DoxyCodeLine{02431\ Test::\string~Test()\ \{\}}
\DoxyCodeLine{02432\ }
\DoxyCodeLine{02433\ \textcolor{comment}{//\ Sets\ up\ the\ test\ fixture.}}
\DoxyCodeLine{02434\ \textcolor{comment}{//}}
\DoxyCodeLine{02435\ \textcolor{comment}{//\ A\ sub-\/class\ may\ override\ this.}}
\DoxyCodeLine{02436\ \textcolor{keywordtype}{void}\ Test::SetUp()\ \{\}}
\DoxyCodeLine{02437\ }
\DoxyCodeLine{02438\ \textcolor{comment}{//\ Tears\ down\ the\ test\ fixture.}}
\DoxyCodeLine{02439\ \textcolor{comment}{//}}
\DoxyCodeLine{02440\ \textcolor{comment}{//\ A\ sub-\/class\ may\ override\ this.}}
\DoxyCodeLine{02441\ \textcolor{keywordtype}{void}\ Test::TearDown()\ \{\}}
\DoxyCodeLine{02442\ }
\DoxyCodeLine{02443\ \textcolor{comment}{//\ Allows\ user\ supplied\ key\ value\ pairs\ to\ be\ recorded\ for\ later\ output.}}
\DoxyCodeLine{02444\ \textcolor{keywordtype}{void}\ Test::RecordProperty(\textcolor{keyword}{const}\ std::string\&\ key,\ \textcolor{keyword}{const}\ std::string\&\ value)\ \{}
\DoxyCodeLine{02445\ \ \ UnitTest::GetInstance()-\/>RecordProperty(key,\ value);}
\DoxyCodeLine{02446\ \}}
\DoxyCodeLine{02447\ }
\DoxyCodeLine{02448\ \textcolor{comment}{//\ Allows\ user\ supplied\ key\ value\ pairs\ to\ be\ recorded\ for\ later\ output.}}
\DoxyCodeLine{02449\ \textcolor{keywordtype}{void}\ Test::RecordProperty(\textcolor{keyword}{const}\ std::string\&\ key,\ \textcolor{keywordtype}{int}\ value)\ \{}
\DoxyCodeLine{02450\ \ \ Message\ value\_message;}
\DoxyCodeLine{02451\ \ \ value\_message\ <<\ value;}
\DoxyCodeLine{02452\ \ \ RecordProperty(key,\ value\_message.GetString().c\_str());}
\DoxyCodeLine{02453\ \}}
\DoxyCodeLine{02454\ }
\DoxyCodeLine{02455\ \textcolor{keyword}{namespace\ }internal\ \{}
\DoxyCodeLine{02456\ }
\DoxyCodeLine{02457\ \textcolor{keywordtype}{void}\ ReportFailureInUnknownLocation(TestPartResult::Type\ result\_type,}
\DoxyCodeLine{02458\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ message)\ \{}
\DoxyCodeLine{02459\ \ \ \textcolor{comment}{//\ This\ function\ is\ a\ friend\ of\ UnitTest\ and\ as\ such\ has\ access\ to}}
\DoxyCodeLine{02460\ \ \ \textcolor{comment}{//\ AddTestPartResult.}}
\DoxyCodeLine{02461\ \ \ UnitTest::GetInstance()-\/>AddTestPartResult(}
\DoxyCodeLine{02462\ \ \ \ \ \ \ result\_type,}
\DoxyCodeLine{02463\ \ \ \ \ \ \ \textcolor{keyword}{nullptr},\ \ \textcolor{comment}{//\ No\ info\ about\ the\ source\ file\ where\ the\ exception\ occurred.}}
\DoxyCodeLine{02464\ \ \ \ \ \ \ -\/1,\ \ \ \ \ \ \ \textcolor{comment}{//\ We\ have\ no\ info\ on\ which\ line\ caused\ the\ exception.}}
\DoxyCodeLine{02465\ \ \ \ \ \ \ message,}
\DoxyCodeLine{02466\ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}});\ \ \textcolor{comment}{//\ No\ stack\ trace,\ either.}}
\DoxyCodeLine{02467\ \}}
\DoxyCodeLine{02468\ }
\DoxyCodeLine{02469\ \}\ \ \textcolor{comment}{//\ namespace\ internal}}
\DoxyCodeLine{02470\ }
\DoxyCodeLine{02471\ \textcolor{comment}{//\ Google\ Test\ requires\ all\ tests\ in\ the\ same\ test\ suite\ to\ use\ the\ same\ test}}
\DoxyCodeLine{02472\ \textcolor{comment}{//\ fixture\ class.\ \ This\ function\ checks\ if\ the\ current\ test\ has\ the}}
\DoxyCodeLine{02473\ \textcolor{comment}{//\ same\ fixture\ class\ as\ the\ first\ test\ in\ the\ current\ test\ suite.\ \ If}}
\DoxyCodeLine{02474\ \textcolor{comment}{//\ yes,\ it\ returns\ true;\ otherwise\ it\ generates\ a\ Google\ Test\ failure\ and}}
\DoxyCodeLine{02475\ \textcolor{comment}{//\ returns\ false.}}
\DoxyCodeLine{02476\ \textcolor{keywordtype}{bool}\ Test::HasSameFixtureClass()\ \{}
\DoxyCodeLine{02477\ \ \ internal::UnitTestImpl*\ \textcolor{keyword}{const}\ impl\ =\ internal::GetUnitTestImpl();}
\DoxyCodeLine{02478\ \ \ \textcolor{keyword}{const}\ TestSuite*\ \textcolor{keyword}{const}\ test\_suite\ =\ impl-\/>current\_test\_suite();}
\DoxyCodeLine{02479\ }
\DoxyCodeLine{02480\ \ \ \textcolor{comment}{//\ Info\ about\ the\ first\ test\ in\ the\ current\ test\ suite.}}
\DoxyCodeLine{02481\ \ \ \textcolor{keyword}{const}\ TestInfo*\ \textcolor{keyword}{const}\ first\_test\_info\ =\ test\_suite-\/>test\_info\_list()[0];}
\DoxyCodeLine{02482\ \ \ \textcolor{keyword}{const}\ internal::TypeId\ first\_fixture\_id\ =\ first\_test\_info-\/>fixture\_class\_id\_;}
\DoxyCodeLine{02483\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \textcolor{keyword}{const}\ first\_test\_name\ =\ first\_test\_info-\/>name();}
\DoxyCodeLine{02484\ }
\DoxyCodeLine{02485\ \ \ \textcolor{comment}{//\ Info\ about\ the\ current\ test.}}
\DoxyCodeLine{02486\ \ \ \textcolor{keyword}{const}\ TestInfo*\ \textcolor{keyword}{const}\ this\_test\_info\ =\ impl-\/>current\_test\_info();}
\DoxyCodeLine{02487\ \ \ \textcolor{keyword}{const}\ internal::TypeId\ this\_fixture\_id\ =\ this\_test\_info-\/>fixture\_class\_id\_;}
\DoxyCodeLine{02488\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \textcolor{keyword}{const}\ this\_test\_name\ =\ this\_test\_info-\/>name();}
\DoxyCodeLine{02489\ }
\DoxyCodeLine{02490\ \ \ \textcolor{keywordflow}{if}\ (this\_fixture\_id\ !=\ first\_fixture\_id)\ \{}
\DoxyCodeLine{02491\ \ \ \ \ \textcolor{comment}{//\ Is\ the\ first\ test\ defined\ using\ TEST?}}
\DoxyCodeLine{02492\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ first\_is\_TEST\ =\ first\_fixture\_id\ ==\ internal::GetTestTypeId();}
\DoxyCodeLine{02493\ \ \ \ \ \textcolor{comment}{//\ Is\ this\ test\ defined\ using\ TEST?}}
\DoxyCodeLine{02494\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ this\_is\_TEST\ =\ this\_fixture\_id\ ==\ internal::GetTestTypeId();}
\DoxyCodeLine{02495\ }
\DoxyCodeLine{02496\ \ \ \ \ \textcolor{keywordflow}{if}\ (first\_is\_TEST\ ||\ this\_is\_TEST)\ \{}
\DoxyCodeLine{02497\ \ \ \ \ \ \ \textcolor{comment}{//\ Both\ TEST\ and\ TEST\_F\ appear\ in\ same\ test\ suite,\ which\ is\ incorrect.}}
\DoxyCodeLine{02498\ \ \ \ \ \ \ \textcolor{comment}{//\ Tell\ the\ user\ how\ to\ fix\ this.}}
\DoxyCodeLine{02499\ }
\DoxyCodeLine{02500\ \ \ \ \ \ \ \textcolor{comment}{//\ Gets\ the\ name\ of\ the\ TEST\ and\ the\ name\ of\ the\ TEST\_F.\ \ Note}}
\DoxyCodeLine{02501\ \ \ \ \ \ \ \textcolor{comment}{//\ that\ first\_is\_TEST\ and\ this\_is\_TEST\ cannot\ both\ be\ true,\ as}}
\DoxyCodeLine{02502\ \ \ \ \ \ \ \textcolor{comment}{//\ the\ fixture\ IDs\ are\ different\ for\ the\ two\ tests.}}
\DoxyCodeLine{02503\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \textcolor{keyword}{const}\ TEST\_name\ =}
\DoxyCodeLine{02504\ \ \ \ \ \ \ \ \ \ \ first\_is\_TEST\ ?\ first\_test\_name\ :\ this\_test\_name;}
\DoxyCodeLine{02505\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \textcolor{keyword}{const}\ TEST\_F\_name\ =}
\DoxyCodeLine{02506\ \ \ \ \ \ \ \ \ \ \ first\_is\_TEST\ ?\ this\_test\_name\ :\ first\_test\_name;}
\DoxyCodeLine{02507\ }
\DoxyCodeLine{02508\ \ \ \ \ \ \ ADD\_FAILURE()}
\DoxyCodeLine{02509\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}All\ tests\ in\ the\ same\ test\ suite\ must\ use\ the\ same\ test\ fixture\(\backslash\)n"{}}}
\DoxyCodeLine{02510\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}class,\ so\ mixing\ TEST\_F\ and\ TEST\ in\ the\ same\ test\ suite\ is\(\backslash\)n"{}}}
\DoxyCodeLine{02511\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}illegal.\ \ In\ test\ suite\ "{}}\ <<\ this\_test\_info-\/>test\_suite\_name()}
\DoxyCodeLine{02512\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{},\(\backslash\)n"{}}}
\DoxyCodeLine{02513\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}test\ "{}}\ <<\ TEST\_F\_name\ <<\ \textcolor{stringliteral}{"{}\ is\ defined\ using\ TEST\_F\ but\(\backslash\)n"{}}}
\DoxyCodeLine{02514\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}test\ "{}}\ <<\ TEST\_name\ <<\ \textcolor{stringliteral}{"{}\ is\ defined\ using\ TEST.\ \ You\ probably\(\backslash\)n"{}}}
\DoxyCodeLine{02515\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}want\ to\ change\ the\ TEST\ to\ TEST\_F\ or\ move\ it\ to\ another\ test\(\backslash\)n"{}}}
\DoxyCodeLine{02516\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}case."{}};}
\DoxyCodeLine{02517\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02518\ \ \ \ \ \ \ \textcolor{comment}{//\ Two\ fixture\ classes\ with\ the\ same\ name\ appear\ in\ two\ different}}
\DoxyCodeLine{02519\ \ \ \ \ \ \ \textcolor{comment}{//\ namespaces,\ which\ is\ not\ allowed.\ Tell\ the\ user\ how\ to\ fix\ this.}}
\DoxyCodeLine{02520\ \ \ \ \ \ \ ADD\_FAILURE()}
\DoxyCodeLine{02521\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}All\ tests\ in\ the\ same\ test\ suite\ must\ use\ the\ same\ test\ fixture\(\backslash\)n"{}}}
\DoxyCodeLine{02522\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}class.\ \ However,\ in\ test\ suite\ "{}}}
\DoxyCodeLine{02523\ \ \ \ \ \ \ \ \ \ \ <<\ this\_test\_info-\/>test\_suite\_name()\ <<\ \textcolor{stringliteral}{"{},\(\backslash\)n"{}}}
\DoxyCodeLine{02524\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}you\ defined\ test\ "{}}\ <<\ first\_test\_name\ <<\ \textcolor{stringliteral}{"{}\ and\ test\ "{}}}
\DoxyCodeLine{02525\ \ \ \ \ \ \ \ \ \ \ <<\ this\_test\_name\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{02526\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}using\ two\ different\ test\ fixture\ classes.\ \ This\ can\ happen\ if\(\backslash\)n"{}}}
\DoxyCodeLine{02527\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}the\ two\ classes\ are\ from\ different\ namespaces\ or\ translation\(\backslash\)n"{}}}
\DoxyCodeLine{02528\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}units\ and\ have\ the\ same\ name.\ \ You\ should\ probably\ rename\ one\(\backslash\)n"{}}}
\DoxyCodeLine{02529\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}of\ the\ classes\ to\ put\ the\ tests\ into\ different\ test\ suites."{}};}
\DoxyCodeLine{02530\ \ \ \ \ \}}
\DoxyCodeLine{02531\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02532\ \ \ \}}
\DoxyCodeLine{02533\ }
\DoxyCodeLine{02534\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02535\ \}}
\DoxyCodeLine{02536\ }
\DoxyCodeLine{02537\ \textcolor{preprocessor}{\#if\ GTEST\_HAS\_SEH}}
\DoxyCodeLine{02538\ }
\DoxyCodeLine{02539\ \textcolor{comment}{//\ Adds\ an\ "{}exception\ thrown"{}\ fatal\ failure\ to\ the\ current\ test.\ \ This}}
\DoxyCodeLine{02540\ \textcolor{comment}{//\ function\ returns\ its\ result\ via\ an\ output\ parameter\ pointer\ because\ VC++}}
\DoxyCodeLine{02541\ \textcolor{comment}{//\ prohibits\ creation\ of\ objects\ with\ destructors\ on\ stack\ in\ functions}}
\DoxyCodeLine{02542\ \textcolor{comment}{//\ using\ \_\_try\ (see\ error\ C2712).}}
\DoxyCodeLine{02543\ \textcolor{keyword}{static}\ std::string*\ FormatSehExceptionMessage(DWORD\ exception\_code,}
\DoxyCodeLine{02544\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ location)\ \{}
\DoxyCodeLine{02545\ \ \ Message\ message;}
\DoxyCodeLine{02546\ \ \ message\ <<\ \textcolor{stringliteral}{"{}SEH\ exception\ with\ code\ 0x"{}}\ <<\ std::setbase(16)\ <<\ exception\_code}
\DoxyCodeLine{02547\ \ \ \ \ \ \ \ \ \ \ <<\ std::setbase(10)\ <<\ \textcolor{stringliteral}{"{}\ thrown\ in\ "{}}\ <<\ location\ <<\ \textcolor{stringliteral}{"{}."{}};}
\DoxyCodeLine{02548\ }
\DoxyCodeLine{02549\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{new}\ std::string(message.GetString());}
\DoxyCodeLine{02550\ \}}
\DoxyCodeLine{02551\ }
\DoxyCodeLine{02552\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GTEST\_HAS\_SEH}}
\DoxyCodeLine{02553\ }
\DoxyCodeLine{02554\ \textcolor{keyword}{namespace\ }internal\ \{}
\DoxyCodeLine{02555\ }
\DoxyCodeLine{02556\ \textcolor{preprocessor}{\#if\ GTEST\_HAS\_EXCEPTIONS}}
\DoxyCodeLine{02557\ }
\DoxyCodeLine{02558\ \textcolor{comment}{//\ Adds\ an\ "{}exception\ thrown"{}\ fatal\ failure\ to\ the\ current\ test.}}
\DoxyCodeLine{02559\ \textcolor{keyword}{static}\ std::string\ FormatCxxExceptionMessage(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ description,}
\DoxyCodeLine{02560\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ location)\ \{}
\DoxyCodeLine{02561\ \ \ Message\ message;}
\DoxyCodeLine{02562\ \ \ \textcolor{keywordflow}{if}\ (description\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{02563\ \ \ \ \ message\ <<\ \textcolor{stringliteral}{"{}C++\ exception\ with\ description\ \(\backslash\)"{}"{}}\ <<\ description\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}"{}};}
\DoxyCodeLine{02564\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02565\ \ \ \ \ message\ <<\ \textcolor{stringliteral}{"{}Unknown\ C++\ exception"{}};}
\DoxyCodeLine{02566\ \ \ \}}
\DoxyCodeLine{02567\ \ \ message\ <<\ \textcolor{stringliteral}{"{}\ thrown\ in\ "{}}\ <<\ location\ <<\ \textcolor{stringliteral}{"{}."{}};}
\DoxyCodeLine{02568\ }
\DoxyCodeLine{02569\ \ \ \textcolor{keywordflow}{return}\ message.GetString();}
\DoxyCodeLine{02570\ \}}
\DoxyCodeLine{02571\ }
\DoxyCodeLine{02572\ \textcolor{keyword}{static}\ std::string\ PrintTestPartResultToString(}
\DoxyCodeLine{02573\ \ \ \ \ \textcolor{keyword}{const}\ TestPartResult\&\ test\_part\_result);}
\DoxyCodeLine{02574\ }
\DoxyCodeLine{02575\ GoogleTestFailureException::GoogleTestFailureException(}
\DoxyCodeLine{02576\ \ \ \ \ \textcolor{keyword}{const}\ TestPartResult\&\ failure)}
\DoxyCodeLine{02577\ \ \ \ \ :\ ::std::runtime\_error(PrintTestPartResultToString(failure).c\_str())\ \{\}}
\DoxyCodeLine{02578\ }
\DoxyCodeLine{02579\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GTEST\_HAS\_EXCEPTIONS}}
\DoxyCodeLine{02580\ }
\DoxyCodeLine{02581\ \textcolor{comment}{//\ We\ put\ these\ helper\ functions\ in\ the\ internal\ namespace\ as\ IBM's\ xlC}}
\DoxyCodeLine{02582\ \textcolor{comment}{//\ compiler\ rejects\ the\ code\ if\ they\ were\ declared\ static.}}
\DoxyCodeLine{02583\ }
\DoxyCodeLine{02584\ \textcolor{comment}{//\ Runs\ the\ given\ method\ and\ handles\ SEH\ exceptions\ it\ throws,\ when}}
\DoxyCodeLine{02585\ \textcolor{comment}{//\ SEH\ is\ supported;\ returns\ the\ 0-\/value\ for\ type\ Result\ in\ case\ of\ an}}
\DoxyCodeLine{02586\ \textcolor{comment}{//\ SEH\ exception.\ \ (Microsoft\ compilers\ cannot\ handle\ SEH\ and\ C++}}
\DoxyCodeLine{02587\ \textcolor{comment}{//\ exceptions\ in\ the\ same\ function.\ \ Therefore,\ we\ provide\ a\ separate}}
\DoxyCodeLine{02588\ \textcolor{comment}{//\ wrapper\ function\ for\ handling\ SEH\ exceptions.)}}
\DoxyCodeLine{02589\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T,\ \textcolor{keyword}{typename}\ Result>}
\DoxyCodeLine{02590\ Result\ HandleSehExceptionsInMethodIfSupported(T*\ \textcolor{keywordtype}{object},\ Result\ (T::*method)(),}
\DoxyCodeLine{02591\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ char*\ location)\ \{}
\DoxyCodeLine{02592\ \textcolor{preprocessor}{\#if\ GTEST\_HAS\_SEH}}
\DoxyCodeLine{02593\ \ \ \_\_try\ \{}
\DoxyCodeLine{02594\ \ \ \ \ \textcolor{keywordflow}{return}\ (object-\/>*method)();}
\DoxyCodeLine{02595\ \ \ \}\ \_\_except\ (internal::UnitTestOptions::GTestShouldProcessSEH(\ \ \textcolor{comment}{//\ NOLINT}}
\DoxyCodeLine{02596\ \ \ \ \ \ \ GetExceptionCode()))\ \{}
\DoxyCodeLine{02597\ \ \ \ \ \textcolor{comment}{//\ We\ create\ the\ exception\ message\ on\ the\ heap\ because\ VC++\ prohibits}}
\DoxyCodeLine{02598\ \ \ \ \ \textcolor{comment}{//\ creation\ of\ objects\ with\ destructors\ on\ stack\ in\ functions\ using\ \_\_try}}
\DoxyCodeLine{02599\ \ \ \ \ \textcolor{comment}{//\ (see\ error\ C2712).}}
\DoxyCodeLine{02600\ \ \ \ \ std::string*\ exception\_message\ =}
\DoxyCodeLine{02601\ \ \ \ \ \ \ \ \ FormatSehExceptionMessage(GetExceptionCode(),\ location);}
\DoxyCodeLine{02602\ \ \ \ \ internal::ReportFailureInUnknownLocation(TestPartResult::kFatalFailure,}
\DoxyCodeLine{02603\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *exception\_message);}
\DoxyCodeLine{02604\ \ \ \ \ \textcolor{keyword}{delete}\ exception\_message;}
\DoxyCodeLine{02605\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}Result\textcolor{keyword}{>}(0);}
\DoxyCodeLine{02606\ \ \ \}}
\DoxyCodeLine{02607\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{02608\ \ \ (void)location;}
\DoxyCodeLine{02609\ \ \ \textcolor{keywordflow}{return}\ (object-\/>*method)();}
\DoxyCodeLine{02610\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GTEST\_HAS\_SEH}}
\DoxyCodeLine{02611\ \}}
\DoxyCodeLine{02612\ }
\DoxyCodeLine{02613\ \textcolor{comment}{//\ Runs\ the\ given\ method\ and\ catches\ and\ reports\ C++\ and/or\ SEH-\/style}}
\DoxyCodeLine{02614\ \textcolor{comment}{//\ exceptions,\ if\ they\ are\ supported;\ returns\ the\ 0-\/value\ for\ type}}
\DoxyCodeLine{02615\ \textcolor{comment}{//\ Result\ in\ case\ of\ an\ SEH\ exception.}}
\DoxyCodeLine{02616\ \textcolor{keyword}{template}\ <\textcolor{keyword}{class}\ T,\ \textcolor{keyword}{typename}\ Result>}
\DoxyCodeLine{02617\ Result\ HandleExceptionsInMethodIfSupported(T*\ \textcolor{keywordtype}{object},\ Result\ (T::*method)(),}
\DoxyCodeLine{02618\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ char*\ location)\ \{}
\DoxyCodeLine{02619\ \ \ \textcolor{comment}{//\ NOTE:\ The\ user\ code\ can\ affect\ the\ way\ in\ which\ Google\ Test\ handles}}
\DoxyCodeLine{02620\ \ \ \textcolor{comment}{//\ exceptions\ by\ setting\ GTEST\_FLAG(catch\_exceptions),\ but\ only\ before}}
\DoxyCodeLine{02621\ \ \ \textcolor{comment}{//\ RUN\_ALL\_TESTS()\ starts.\ It\ is\ technically\ possible\ to\ check\ the\ flag}}
\DoxyCodeLine{02622\ \ \ \textcolor{comment}{//\ after\ the\ exception\ is\ caught\ and\ either\ report\ or\ re-\/throw\ the}}
\DoxyCodeLine{02623\ \ \ \textcolor{comment}{//\ exception\ based\ on\ the\ flag's\ value:}}
\DoxyCodeLine{02624\ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{02625\ \ \ \textcolor{comment}{//\ try\ \{}}
\DoxyCodeLine{02626\ \ \ \textcolor{comment}{//\ \ \ //\ Perform\ the\ test\ method.}}
\DoxyCodeLine{02627\ \ \ \textcolor{comment}{//\ \}\ catch\ (...)\ \{}}
\DoxyCodeLine{02628\ \ \ \textcolor{comment}{//\ \ \ if\ (GTEST\_FLAG\_GET(catch\_exceptions))}}
\DoxyCodeLine{02629\ \ \ \textcolor{comment}{//\ \ \ \ \ //\ Report\ the\ exception\ as\ failure.}}
\DoxyCodeLine{02630\ \ \ \textcolor{comment}{//\ \ \ else}}
\DoxyCodeLine{02631\ \ \ \textcolor{comment}{//\ \ \ \ \ throw;\ \ //\ Re-\/throws\ the\ original\ exception.}}
\DoxyCodeLine{02632\ \ \ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02633\ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{02634\ \ \ \textcolor{comment}{//\ However,\ the\ purpose\ of\ this\ flag\ is\ to\ allow\ the\ program\ to\ drop\ into}}
\DoxyCodeLine{02635\ \ \ \textcolor{comment}{//\ the\ debugger\ when\ the\ exception\ is\ thrown.\ On\ most\ platforms,\ once\ the}}
\DoxyCodeLine{02636\ \ \ \textcolor{comment}{//\ control\ enters\ the\ catch\ block,\ the\ exception\ origin\ information\ is}}
\DoxyCodeLine{02637\ \ \ \textcolor{comment}{//\ lost\ and\ the\ debugger\ will\ stop\ the\ program\ at\ the\ point\ of\ the}}
\DoxyCodeLine{02638\ \ \ \textcolor{comment}{//\ re-\/throw\ in\ this\ function\ -\/-\/\ instead\ of\ at\ the\ point\ of\ the\ original}}
\DoxyCodeLine{02639\ \ \ \textcolor{comment}{//\ throw\ statement\ in\ the\ code\ under\ test.\ \ For\ this\ reason,\ we\ perform}}
\DoxyCodeLine{02640\ \ \ \textcolor{comment}{//\ the\ check\ early,\ sacrificing\ the\ ability\ to\ affect\ Google\ Test's}}
\DoxyCodeLine{02641\ \ \ \textcolor{comment}{//\ exception\ handling\ in\ the\ method\ where\ the\ exception\ is\ thrown.}}
\DoxyCodeLine{02642\ \ \ \textcolor{keywordflow}{if}\ (internal::GetUnitTestImpl()-\/>catch\_exceptions())\ \{}
\DoxyCodeLine{02643\ \textcolor{preprocessor}{\#if\ GTEST\_HAS\_EXCEPTIONS}}
\DoxyCodeLine{02644\ \ \ \ \ \textcolor{keywordflow}{try}\ \{}
\DoxyCodeLine{02645\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ HandleSehExceptionsInMethodIfSupported(\textcolor{keywordtype}{object},\ method,\ location);}
\DoxyCodeLine{02646\ \ \ \ \ \}\ \textcolor{keywordflow}{catch}\ (\textcolor{keyword}{const}\ AssertionException\&)\ \{\ \ \textcolor{comment}{//\ NOLINT}}
\DoxyCodeLine{02647\ \ \ \ \ \ \ \textcolor{comment}{//\ This\ failure\ was\ reported\ already.}}
\DoxyCodeLine{02648\ \ \ \ \ \}\ \textcolor{keywordflow}{catch}\ (\textcolor{keyword}{const}\ internal::GoogleTestFailureException\&)\ \{\ \ \textcolor{comment}{//\ NOLINT}}
\DoxyCodeLine{02649\ \ \ \ \ \ \ \textcolor{comment}{//\ This\ exception\ type\ can\ only\ be\ thrown\ by\ a\ failed\ Google}}
\DoxyCodeLine{02650\ \ \ \ \ \ \ \textcolor{comment}{//\ Test\ assertion\ with\ the\ intention\ of\ letting\ another\ testing}}
\DoxyCodeLine{02651\ \ \ \ \ \ \ \textcolor{comment}{//\ framework\ catch\ it.\ \ Therefore\ we\ just\ re-\/throw\ it.}}
\DoxyCodeLine{02652\ \ \ \ \ \ \ \textcolor{keywordflow}{throw};}
\DoxyCodeLine{02653\ \ \ \ \ \}\ \textcolor{keywordflow}{catch}\ (\textcolor{keyword}{const}\ std::exception\&\ e)\ \{\ \ \textcolor{comment}{//\ NOLINT}}
\DoxyCodeLine{02654\ \ \ \ \ \ \ internal::ReportFailureInUnknownLocation(}
\DoxyCodeLine{02655\ \ \ \ \ \ \ \ \ \ \ TestPartResult::kFatalFailure,}
\DoxyCodeLine{02656\ \ \ \ \ \ \ \ \ \ \ FormatCxxExceptionMessage(e.what(),\ location));}
\DoxyCodeLine{02657\ \ \ \ \ \}\ \textcolor{keywordflow}{catch}\ (...)\ \{\ \ \textcolor{comment}{//\ NOLINT}}
\DoxyCodeLine{02658\ \ \ \ \ \ \ internal::ReportFailureInUnknownLocation(}
\DoxyCodeLine{02659\ \ \ \ \ \ \ \ \ \ \ TestPartResult::kFatalFailure,}
\DoxyCodeLine{02660\ \ \ \ \ \ \ \ \ \ \ FormatCxxExceptionMessage(\textcolor{keyword}{nullptr},\ location));}
\DoxyCodeLine{02661\ \ \ \ \ \}}
\DoxyCodeLine{02662\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}Result\textcolor{keyword}{>}(0);}
\DoxyCodeLine{02663\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{02664\ \ \ \ \ \textcolor{keywordflow}{return}\ HandleSehExceptionsInMethodIfSupported(\textcolor{keywordtype}{object},\ method,\ location);}
\DoxyCodeLine{02665\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GTEST\_HAS\_EXCEPTIONS}}
\DoxyCodeLine{02666\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02667\ \ \ \ \ \textcolor{keywordflow}{return}\ (object-\/>*method)();}
\DoxyCodeLine{02668\ \ \ \}}
\DoxyCodeLine{02669\ \}}
\DoxyCodeLine{02670\ }
\DoxyCodeLine{02671\ \}\ \ \textcolor{comment}{//\ namespace\ internal}}
\DoxyCodeLine{02672\ }
\DoxyCodeLine{02673\ \textcolor{comment}{//\ Runs\ the\ test\ and\ updates\ the\ test\ result.}}
\DoxyCodeLine{02674\ \textcolor{keywordtype}{void}\ Test::Run()\ \{}
\DoxyCodeLine{02675\ \ \ \textcolor{keywordflow}{if}\ (!HasSameFixtureClass())\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02676\ }
\DoxyCodeLine{02677\ \ \ internal::UnitTestImpl*\ \textcolor{keyword}{const}\ impl\ =\ internal::GetUnitTestImpl();}
\DoxyCodeLine{02678\ \ \ impl-\/>os\_stack\_trace\_getter()-\/>UponLeavingGTest();}
\DoxyCodeLine{02679\ \ \ internal::HandleExceptionsInMethodIfSupported(\textcolor{keyword}{this},\ \&Test::SetUp,\ \textcolor{stringliteral}{"{}SetUp()"{}});}
\DoxyCodeLine{02680\ \ \ \textcolor{comment}{//\ We\ will\ run\ the\ test\ only\ if\ SetUp()\ was\ successful\ and\ didn't\ call}}
\DoxyCodeLine{02681\ \ \ \textcolor{comment}{//\ GTEST\_SKIP().}}
\DoxyCodeLine{02682\ \ \ \textcolor{keywordflow}{if}\ (!HasFatalFailure()\ \&\&\ !IsSkipped())\ \{}
\DoxyCodeLine{02683\ \ \ \ \ impl-\/>os\_stack\_trace\_getter()-\/>UponLeavingGTest();}
\DoxyCodeLine{02684\ \ \ \ \ internal::HandleExceptionsInMethodIfSupported(\textcolor{keyword}{this},\ \&Test::TestBody,}
\DoxyCodeLine{02685\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}the\ test\ body"{}});}
\DoxyCodeLine{02686\ \ \ \}}
\DoxyCodeLine{02687\ }
\DoxyCodeLine{02688\ \ \ \textcolor{comment}{//\ However,\ we\ want\ to\ clean\ up\ as\ much\ as\ possible.\ \ Hence\ we\ will}}
\DoxyCodeLine{02689\ \ \ \textcolor{comment}{//\ always\ call\ TearDown(),\ even\ if\ SetUp()\ or\ the\ test\ body\ has}}
\DoxyCodeLine{02690\ \ \ \textcolor{comment}{//\ failed.}}
\DoxyCodeLine{02691\ \ \ impl-\/>os\_stack\_trace\_getter()-\/>UponLeavingGTest();}
\DoxyCodeLine{02692\ \ \ internal::HandleExceptionsInMethodIfSupported(\textcolor{keyword}{this},\ \&Test::TearDown,}
\DoxyCodeLine{02693\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}TearDown()"{}});}
\DoxyCodeLine{02694\ \}}
\DoxyCodeLine{02695\ }
\DoxyCodeLine{02696\ \textcolor{comment}{//\ Returns\ true\ if\ and\ only\ if\ the\ current\ test\ has\ a\ fatal\ failure.}}
\DoxyCodeLine{02697\ \textcolor{keywordtype}{bool}\ Test::HasFatalFailure()\ \{}
\DoxyCodeLine{02698\ \ \ \textcolor{keywordflow}{return}\ internal::GetUnitTestImpl()-\/>current\_test\_result()-\/>HasFatalFailure();}
\DoxyCodeLine{02699\ \}}
\DoxyCodeLine{02700\ }
\DoxyCodeLine{02701\ \textcolor{comment}{//\ Returns\ true\ if\ and\ only\ if\ the\ current\ test\ has\ a\ non-\/fatal\ failure.}}
\DoxyCodeLine{02702\ \textcolor{keywordtype}{bool}\ Test::HasNonfatalFailure()\ \{}
\DoxyCodeLine{02703\ \ \ \textcolor{keywordflow}{return}\ internal::GetUnitTestImpl()}
\DoxyCodeLine{02704\ \ \ \ \ \ \ -\/>current\_test\_result()}
\DoxyCodeLine{02705\ \ \ \ \ \ \ -\/>HasNonfatalFailure();}
\DoxyCodeLine{02706\ \}}
\DoxyCodeLine{02707\ }
\DoxyCodeLine{02708\ \textcolor{comment}{//\ Returns\ true\ if\ and\ only\ if\ the\ current\ test\ was\ skipped.}}
\DoxyCodeLine{02709\ \textcolor{keywordtype}{bool}\ Test::IsSkipped()\ \{}
\DoxyCodeLine{02710\ \ \ \textcolor{keywordflow}{return}\ internal::GetUnitTestImpl()-\/>current\_test\_result()-\/>Skipped();}
\DoxyCodeLine{02711\ \}}
\DoxyCodeLine{02712\ }
\DoxyCodeLine{02713\ \textcolor{comment}{//\ class\ TestInfo}}
\DoxyCodeLine{02714\ }
\DoxyCodeLine{02715\ \textcolor{comment}{//\ Constructs\ a\ TestInfo\ object.\ It\ assumes\ ownership\ of\ the\ test\ factory}}
\DoxyCodeLine{02716\ \textcolor{comment}{//\ object.}}
\DoxyCodeLine{02717\ TestInfo::TestInfo(\textcolor{keyword}{const}\ std::string\&\ a\_test\_suite\_name,}
\DoxyCodeLine{02718\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ a\_name,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ a\_type\_param,}
\DoxyCodeLine{02719\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ a\_value\_param,}
\DoxyCodeLine{02720\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ internal::CodeLocation\ a\_code\_location,}
\DoxyCodeLine{02721\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ internal::TypeId\ fixture\_class\_id,}
\DoxyCodeLine{02722\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ internal::TestFactoryBase*\ factory)}
\DoxyCodeLine{02723\ \ \ \ \ :\ test\_suite\_name\_(a\_test\_suite\_name),}
\DoxyCodeLine{02724\ \ \ \ \ \ \ \textcolor{comment}{//\ begin()/end()\ is\ MSVC\ 17.3.3\ ASAN\ crash\ workaround\ (GitHub\ issue\ \#3997)}}
\DoxyCodeLine{02725\ \ \ \ \ \ \ name\_(a\_name.begin(),\ a\_name.end()),}
\DoxyCodeLine{02726\ \ \ \ \ \ \ type\_param\_(a\_type\_param\ ?\ new\ std::string(a\_type\_param)\ :\ nullptr),}
\DoxyCodeLine{02727\ \ \ \ \ \ \ value\_param\_(a\_value\_param\ ?\ new\ std::string(a\_value\_param)\ :\ nullptr),}
\DoxyCodeLine{02728\ \ \ \ \ \ \ location\_(a\_code\_location),}
\DoxyCodeLine{02729\ \ \ \ \ \ \ fixture\_class\_id\_(fixture\_class\_id),}
\DoxyCodeLine{02730\ \ \ \ \ \ \ should\_run\_(false),}
\DoxyCodeLine{02731\ \ \ \ \ \ \ is\_disabled\_(false),}
\DoxyCodeLine{02732\ \ \ \ \ \ \ matches\_filter\_(false),}
\DoxyCodeLine{02733\ \ \ \ \ \ \ is\_in\_another\_shard\_(false),}
\DoxyCodeLine{02734\ \ \ \ \ \ \ factory\_(factory),}
\DoxyCodeLine{02735\ \ \ \ \ \ \ result\_()\ \{\}}
\DoxyCodeLine{02736\ }
\DoxyCodeLine{02737\ \textcolor{comment}{//\ Destructs\ a\ TestInfo\ object.}}
\DoxyCodeLine{02738\ TestInfo::\string~TestInfo()\ \{\ \textcolor{keyword}{delete}\ factory\_;\ \}}
\DoxyCodeLine{02739\ }
\DoxyCodeLine{02740\ \textcolor{keyword}{namespace\ }internal\ \{}
\DoxyCodeLine{02741\ }
\DoxyCodeLine{02742\ \textcolor{comment}{//\ Creates\ a\ new\ TestInfo\ object\ and\ registers\ it\ with\ Google\ Test;}}
\DoxyCodeLine{02743\ \textcolor{comment}{//\ returns\ the\ created\ object.}}
\DoxyCodeLine{02744\ \textcolor{comment}{//}}
\DoxyCodeLine{02745\ \textcolor{comment}{//\ Arguments:}}
\DoxyCodeLine{02746\ \textcolor{comment}{//}}
\DoxyCodeLine{02747\ \textcolor{comment}{//\ \ \ test\_suite\_name:\ \ name\ of\ the\ test\ suite}}
\DoxyCodeLine{02748\ \textcolor{comment}{//\ \ \ name:\ \ \ \ \ \ \ \ \ \ \ \ \ name\ of\ the\ test}}
\DoxyCodeLine{02749\ \textcolor{comment}{//\ \ \ type\_param:\ \ \ \ \ \ \ the\ name\ of\ the\ test's\ type\ parameter,\ or\ NULL\ if}}
\DoxyCodeLine{02750\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this\ is\ not\ a\ typed\ or\ a\ type-\/parameterized\ test.}}
\DoxyCodeLine{02751\ \textcolor{comment}{//\ \ \ value\_param:\ \ \ \ \ \ text\ representation\ of\ the\ test's\ value\ parameter,}}
\DoxyCodeLine{02752\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ or\ NULL\ if\ this\ is\ not\ a\ value-\/parameterized\ test.}}
\DoxyCodeLine{02753\ \textcolor{comment}{//\ \ \ code\_location:\ \ \ \ code\ location\ where\ the\ test\ is\ defined}}
\DoxyCodeLine{02754\ \textcolor{comment}{//\ \ \ fixture\_class\_id:\ ID\ of\ the\ test\ fixture\ class}}
\DoxyCodeLine{02755\ \textcolor{comment}{//\ \ \ set\_up\_tc:\ \ \ \ \ \ \ \ pointer\ to\ the\ function\ that\ sets\ up\ the\ test\ suite}}
\DoxyCodeLine{02756\ \textcolor{comment}{//\ \ \ tear\_down\_tc:\ \ \ \ \ pointer\ to\ the\ function\ that\ tears\ down\ the\ test\ suite}}
\DoxyCodeLine{02757\ \textcolor{comment}{//\ \ \ factory:\ \ \ \ \ \ \ \ \ \ pointer\ to\ the\ factory\ that\ creates\ a\ test\ object.}}
\DoxyCodeLine{02758\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ The\ newly\ created\ TestInfo\ instance\ will\ assume}}
\DoxyCodeLine{02759\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ownership\ of\ the\ factory\ object.}}
\DoxyCodeLine{02760\ TestInfo*\ MakeAndRegisterTestInfo(}
\DoxyCodeLine{02761\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ test\_suite\_name,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ name,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ type\_param,}
\DoxyCodeLine{02762\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ value\_param,\ CodeLocation\ code\_location,}
\DoxyCodeLine{02763\ \ \ \ \ TypeId\ fixture\_class\_id,\ SetUpTestSuiteFunc\ set\_up\_tc,}
\DoxyCodeLine{02764\ \ \ \ \ TearDownTestSuiteFunc\ tear\_down\_tc,\ TestFactoryBase*\ factory)\ \{}
\DoxyCodeLine{02765\ \ \ TestInfo*\ \textcolor{keyword}{const}\ test\_info\ =}
\DoxyCodeLine{02766\ \ \ \ \ \ \ \textcolor{keyword}{new}\ TestInfo(test\_suite\_name,\ name,\ type\_param,\ value\_param,}
\DoxyCodeLine{02767\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ code\_location,\ fixture\_class\_id,\ factory);}
\DoxyCodeLine{02768\ \ \ GetUnitTestImpl()-\/>AddTestInfo(set\_up\_tc,\ tear\_down\_tc,\ test\_info);}
\DoxyCodeLine{02769\ \ \ \textcolor{keywordflow}{return}\ test\_info;}
\DoxyCodeLine{02770\ \}}
\DoxyCodeLine{02771\ }
\DoxyCodeLine{02772\ \textcolor{keywordtype}{void}\ ReportInvalidTestSuiteType(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ test\_suite\_name,}
\DoxyCodeLine{02773\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ CodeLocation\ code\_location)\ \{}
\DoxyCodeLine{02774\ \ \ Message\ errors;}
\DoxyCodeLine{02775\ \ \ errors}
\DoxyCodeLine{02776\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Attempted\ redefinition\ of\ test\ suite\ "{}}\ <<\ test\_suite\_name\ <<\ \textcolor{stringliteral}{"{}.\(\backslash\)n"{}}}
\DoxyCodeLine{02777\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}All\ tests\ in\ the\ same\ test\ suite\ must\ use\ the\ same\ test\ fixture\(\backslash\)n"{}}}
\DoxyCodeLine{02778\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}class.\ \ However,\ in\ test\ suite\ "{}}\ <<\ test\_suite\_name\ <<\ \textcolor{stringliteral}{"{},\ you\ tried\(\backslash\)n"{}}}
\DoxyCodeLine{02779\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}to\ define\ a\ test\ using\ a\ fixture\ class\ different\ from\ the\ one\(\backslash\)n"{}}}
\DoxyCodeLine{02780\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}used\ earlier.\ This\ can\ happen\ if\ the\ two\ fixture\ classes\ are\(\backslash\)n"{}}}
\DoxyCodeLine{02781\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}from\ different\ namespaces\ and\ have\ the\ same\ name.\ You\ should\(\backslash\)n"{}}}
\DoxyCodeLine{02782\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}probably\ rename\ one\ of\ the\ classes\ to\ put\ the\ tests\ into\ different\(\backslash\)n"{}}}
\DoxyCodeLine{02783\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}test\ suites."{}};}
\DoxyCodeLine{02784\ }
\DoxyCodeLine{02785\ \ \ GTEST\_LOG\_(ERROR)\ <<\ FormatFileLocation(code\_location.file.c\_str(),}
\DoxyCodeLine{02786\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ code\_location.line)}
\DoxyCodeLine{02787\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ "{}}\ <<\ errors.GetString();}
\DoxyCodeLine{02788\ \}}
\DoxyCodeLine{02789\ \}\ \ \textcolor{comment}{//\ namespace\ internal}}
\DoxyCodeLine{02790\ }
\DoxyCodeLine{02791\ \textcolor{keyword}{namespace\ }\{}
\DoxyCodeLine{02792\ }
\DoxyCodeLine{02793\ \textcolor{comment}{//\ A\ predicate\ that\ checks\ the\ test\ name\ of\ a\ TestInfo\ against\ a\ known}}
\DoxyCodeLine{02794\ \textcolor{comment}{//\ value.}}
\DoxyCodeLine{02795\ \textcolor{comment}{//}}
\DoxyCodeLine{02796\ \textcolor{comment}{//\ This\ is\ used\ for\ implementation\ of\ the\ TestSuite\ class\ only.\ \ We\ put}}
\DoxyCodeLine{02797\ \textcolor{comment}{//\ it\ in\ the\ anonymous\ namespace\ to\ prevent\ polluting\ the\ outer}}
\DoxyCodeLine{02798\ \textcolor{comment}{//\ namespace.}}
\DoxyCodeLine{02799\ \textcolor{comment}{//}}
\DoxyCodeLine{02800\ \textcolor{comment}{//\ TestNameIs\ is\ copyable.}}
\DoxyCodeLine{02801\ \textcolor{keyword}{class\ }TestNameIs\ \{}
\DoxyCodeLine{02802\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{02803\ \ \ \textcolor{comment}{//\ Constructor.}}
\DoxyCodeLine{02804\ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{02805\ \ \ \textcolor{comment}{//\ TestNameIs\ has\ NO\ default\ constructor.}}
\DoxyCodeLine{02806\ \ \ \textcolor{keyword}{explicit}\ TestNameIs(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ name)\ :\ name\_(name)\ \{\}}
\DoxyCodeLine{02807\ }
\DoxyCodeLine{02808\ \ \ \textcolor{comment}{//\ Returns\ true\ if\ and\ only\ if\ the\ test\ name\ of\ test\_info\ matches\ name\_.}}
\DoxyCodeLine{02809\ \ \ \textcolor{keywordtype}{bool}\ operator()(\textcolor{keyword}{const}\ TestInfo*\ test\_info)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02810\ \ \ \ \ \textcolor{keywordflow}{return}\ test\_info\ \&\&\ test\_info-\/>name()\ ==\ name\_;}
\DoxyCodeLine{02811\ \ \ \}}
\DoxyCodeLine{02812\ }
\DoxyCodeLine{02813\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{02814\ \ \ std::string\ name\_;}
\DoxyCodeLine{02815\ \};}
\DoxyCodeLine{02816\ }
\DoxyCodeLine{02817\ \}\ \ \textcolor{comment}{//\ namespace}}
\DoxyCodeLine{02818\ }
\DoxyCodeLine{02819\ \textcolor{keyword}{namespace\ }internal\ \{}
\DoxyCodeLine{02820\ }
\DoxyCodeLine{02821\ \textcolor{comment}{//\ This\ method\ expands\ all\ parameterized\ tests\ registered\ with\ macros\ TEST\_P}}
\DoxyCodeLine{02822\ \textcolor{comment}{//\ and\ INSTANTIATE\_TEST\_SUITE\_P\ into\ regular\ tests\ and\ registers\ those.}}
\DoxyCodeLine{02823\ \textcolor{comment}{//\ This\ will\ be\ done\ just\ once\ during\ the\ program\ runtime.}}
\DoxyCodeLine{02824\ \textcolor{keywordtype}{void}\ UnitTestImpl::RegisterParameterizedTests()\ \{}
\DoxyCodeLine{02825\ \ \ \textcolor{keywordflow}{if}\ (!parameterized\_tests\_registered\_)\ \{}
\DoxyCodeLine{02826\ \ \ \ \ parameterized\_test\_registry\_.RegisterTests();}
\DoxyCodeLine{02827\ \ \ \ \ type\_parameterized\_test\_registry\_.CheckForInstantiations();}
\DoxyCodeLine{02828\ \ \ \ \ parameterized\_tests\_registered\_\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02829\ \ \ \}}
\DoxyCodeLine{02830\ \}}
\DoxyCodeLine{02831\ }
\DoxyCodeLine{02832\ \}\ \ \textcolor{comment}{//\ namespace\ internal}}
\DoxyCodeLine{02833\ }
\DoxyCodeLine{02834\ \textcolor{comment}{//\ Creates\ the\ test\ object,\ runs\ it,\ records\ its\ result,\ and\ then}}
\DoxyCodeLine{02835\ \textcolor{comment}{//\ deletes\ it.}}
\DoxyCodeLine{02836\ \textcolor{keywordtype}{void}\ TestInfo::Run()\ \{}
\DoxyCodeLine{02837\ \ \ TestEventListener*\ repeater\ =\ UnitTest::GetInstance()-\/>listeners().repeater();}
\DoxyCodeLine{02838\ \ \ \textcolor{keywordflow}{if}\ (!should\_run\_)\ \{}
\DoxyCodeLine{02839\ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_disabled\_\ \&\&\ matches\_filter\_)\ repeater-\/>OnTestDisabled(*\textcolor{keyword}{this});}
\DoxyCodeLine{02840\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02841\ \ \ \}}
\DoxyCodeLine{02842\ }
\DoxyCodeLine{02843\ \ \ \textcolor{comment}{//\ Tells\ UnitTest\ where\ to\ store\ test\ result.}}
\DoxyCodeLine{02844\ \ \ internal::UnitTestImpl*\ \textcolor{keyword}{const}\ impl\ =\ internal::GetUnitTestImpl();}
\DoxyCodeLine{02845\ \ \ impl-\/>set\_current\_test\_info(\textcolor{keyword}{this});}
\DoxyCodeLine{02846\ }
\DoxyCodeLine{02847\ \ \ \textcolor{comment}{//\ Notifies\ the\ unit\ test\ event\ listeners\ that\ a\ test\ is\ about\ to\ start.}}
\DoxyCodeLine{02848\ \ \ repeater-\/>OnTestStart(*\textcolor{keyword}{this});}
\DoxyCodeLine{02849\ \ \ result\_.set\_start\_timestamp(internal::GetTimeInMillis());}
\DoxyCodeLine{02850\ \ \ internal::Timer\ timer;}
\DoxyCodeLine{02851\ \ \ impl-\/>os\_stack\_trace\_getter()-\/>UponLeavingGTest();}
\DoxyCodeLine{02852\ }
\DoxyCodeLine{02853\ \ \ \textcolor{comment}{//\ Creates\ the\ test\ object.}}
\DoxyCodeLine{02854\ \ \ Test*\ \textcolor{keyword}{const}\ test\ =\ internal::HandleExceptionsInMethodIfSupported(}
\DoxyCodeLine{02855\ \ \ \ \ \ \ factory\_,\ \&internal::TestFactoryBase::CreateTest,}
\DoxyCodeLine{02856\ \ \ \ \ \ \ \textcolor{stringliteral}{"{}the\ test\ fixture's\ constructor"{}});}
\DoxyCodeLine{02857\ }
\DoxyCodeLine{02858\ \ \ \textcolor{comment}{//\ Runs\ the\ test\ if\ the\ constructor\ didn't\ generate\ a\ fatal\ failure\ or\ invoke}}
\DoxyCodeLine{02859\ \ \ \textcolor{comment}{//\ GTEST\_SKIP().}}
\DoxyCodeLine{02860\ \ \ \textcolor{comment}{//\ Note\ that\ the\ object\ will\ not\ be\ null}}
\DoxyCodeLine{02861\ \ \ \textcolor{keywordflow}{if}\ (!Test::HasFatalFailure()\ \&\&\ !Test::IsSkipped())\ \{}
\DoxyCodeLine{02862\ \ \ \ \ \textcolor{comment}{//\ This\ doesn't\ throw\ as\ all\ user\ code\ that\ can\ throw\ are\ wrapped\ into}}
\DoxyCodeLine{02863\ \ \ \ \ \textcolor{comment}{//\ exception\ handling\ code.}}
\DoxyCodeLine{02864\ \ \ \ \ test-\/>Run();}
\DoxyCodeLine{02865\ \ \ \}}
\DoxyCodeLine{02866\ }
\DoxyCodeLine{02867\ \ \ \textcolor{keywordflow}{if}\ (test\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{02868\ \ \ \ \ \textcolor{comment}{//\ Deletes\ the\ test\ object.}}
\DoxyCodeLine{02869\ \ \ \ \ impl-\/>os\_stack\_trace\_getter()-\/>UponLeavingGTest();}
\DoxyCodeLine{02870\ \ \ \ \ internal::HandleExceptionsInMethodIfSupported(}
\DoxyCodeLine{02871\ \ \ \ \ \ \ \ \ test,\ \&Test::DeleteSelf\_,\ \textcolor{stringliteral}{"{}the\ test\ fixture's\ destructor"{}});}
\DoxyCodeLine{02872\ \ \ \}}
\DoxyCodeLine{02873\ }
\DoxyCodeLine{02874\ \ \ result\_.set\_elapsed\_time(timer.Elapsed());}
\DoxyCodeLine{02875\ }
\DoxyCodeLine{02876\ \ \ \textcolor{comment}{//\ Notifies\ the\ unit\ test\ event\ listener\ that\ a\ test\ has\ just\ finished.}}
\DoxyCodeLine{02877\ \ \ repeater-\/>OnTestEnd(*\textcolor{keyword}{this});}
\DoxyCodeLine{02878\ }
\DoxyCodeLine{02879\ \ \ \textcolor{comment}{//\ Tells\ UnitTest\ to\ stop\ associating\ assertion\ results\ to\ this}}
\DoxyCodeLine{02880\ \ \ \textcolor{comment}{//\ test.}}
\DoxyCodeLine{02881\ \ \ impl-\/>set\_current\_test\_info(\textcolor{keyword}{nullptr});}
\DoxyCodeLine{02882\ \}}
\DoxyCodeLine{02883\ }
\DoxyCodeLine{02884\ \textcolor{comment}{//\ Skip\ and\ records\ a\ skipped\ test\ result\ for\ this\ object.}}
\DoxyCodeLine{02885\ \textcolor{keywordtype}{void}\ TestInfo::Skip()\ \{}
\DoxyCodeLine{02886\ \ \ \textcolor{keywordflow}{if}\ (!should\_run\_)\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02887\ }
\DoxyCodeLine{02888\ \ \ internal::UnitTestImpl*\ \textcolor{keyword}{const}\ impl\ =\ internal::GetUnitTestImpl();}
\DoxyCodeLine{02889\ \ \ impl-\/>set\_current\_test\_info(\textcolor{keyword}{this});}
\DoxyCodeLine{02890\ }
\DoxyCodeLine{02891\ \ \ TestEventListener*\ repeater\ =\ UnitTest::GetInstance()-\/>listeners().repeater();}
\DoxyCodeLine{02892\ }
\DoxyCodeLine{02893\ \ \ \textcolor{comment}{//\ Notifies\ the\ unit\ test\ event\ listeners\ that\ a\ test\ is\ about\ to\ start.}}
\DoxyCodeLine{02894\ \ \ repeater-\/>OnTestStart(*\textcolor{keyword}{this});}
\DoxyCodeLine{02895\ }
\DoxyCodeLine{02896\ \ \ \textcolor{keyword}{const}\ TestPartResult\ test\_part\_result\ =}
\DoxyCodeLine{02897\ \ \ \ \ \ \ TestPartResult(TestPartResult::kSkip,\ this-\/>file(),\ this-\/>line(),\ \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{02898\ \ \ impl-\/>GetTestPartResultReporterForCurrentThread()-\/>ReportTestPartResult(}
\DoxyCodeLine{02899\ \ \ \ \ \ \ test\_part\_result);}
\DoxyCodeLine{02900\ }
\DoxyCodeLine{02901\ \ \ \textcolor{comment}{//\ Notifies\ the\ unit\ test\ event\ listener\ that\ a\ test\ has\ just\ finished.}}
\DoxyCodeLine{02902\ \ \ repeater-\/>OnTestEnd(*\textcolor{keyword}{this});}
\DoxyCodeLine{02903\ \ \ impl-\/>set\_current\_test\_info(\textcolor{keyword}{nullptr});}
\DoxyCodeLine{02904\ \}}
\DoxyCodeLine{02905\ }
\DoxyCodeLine{02906\ \textcolor{comment}{//\ class\ TestSuite}}
\DoxyCodeLine{02907\ }
\DoxyCodeLine{02908\ \textcolor{comment}{//\ Gets\ the\ number\ of\ successful\ tests\ in\ this\ test\ suite.}}
\DoxyCodeLine{02909\ \textcolor{keywordtype}{int}\ TestSuite::successful\_test\_count()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02910\ \ \ \textcolor{keywordflow}{return}\ CountIf(test\_info\_list\_,\ TestPassed);}
\DoxyCodeLine{02911\ \}}
\DoxyCodeLine{02912\ }
\DoxyCodeLine{02913\ \textcolor{comment}{//\ Gets\ the\ number\ of\ successful\ tests\ in\ this\ test\ suite.}}
\DoxyCodeLine{02914\ \textcolor{keywordtype}{int}\ TestSuite::skipped\_test\_count()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02915\ \ \ \textcolor{keywordflow}{return}\ CountIf(test\_info\_list\_,\ TestSkipped);}
\DoxyCodeLine{02916\ \}}
\DoxyCodeLine{02917\ }
\DoxyCodeLine{02918\ \textcolor{comment}{//\ Gets\ the\ number\ of\ failed\ tests\ in\ this\ test\ suite.}}
\DoxyCodeLine{02919\ \textcolor{keywordtype}{int}\ TestSuite::failed\_test\_count()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02920\ \ \ \textcolor{keywordflow}{return}\ CountIf(test\_info\_list\_,\ TestFailed);}
\DoxyCodeLine{02921\ \}}
\DoxyCodeLine{02922\ }
\DoxyCodeLine{02923\ \textcolor{comment}{//\ Gets\ the\ number\ of\ disabled\ tests\ that\ will\ be\ reported\ in\ the\ XML\ report.}}
\DoxyCodeLine{02924\ \textcolor{keywordtype}{int}\ TestSuite::reportable\_disabled\_test\_count()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02925\ \ \ \textcolor{keywordflow}{return}\ CountIf(test\_info\_list\_,\ TestReportableDisabled);}
\DoxyCodeLine{02926\ \}}
\DoxyCodeLine{02927\ }
\DoxyCodeLine{02928\ \textcolor{comment}{//\ Gets\ the\ number\ of\ disabled\ tests\ in\ this\ test\ suite.}}
\DoxyCodeLine{02929\ \textcolor{keywordtype}{int}\ TestSuite::disabled\_test\_count()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02930\ \ \ \textcolor{keywordflow}{return}\ CountIf(test\_info\_list\_,\ TestDisabled);}
\DoxyCodeLine{02931\ \}}
\DoxyCodeLine{02932\ }
\DoxyCodeLine{02933\ \textcolor{comment}{//\ Gets\ the\ number\ of\ tests\ to\ be\ printed\ in\ the\ XML\ report.}}
\DoxyCodeLine{02934\ \textcolor{keywordtype}{int}\ TestSuite::reportable\_test\_count()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02935\ \ \ \textcolor{keywordflow}{return}\ CountIf(test\_info\_list\_,\ TestReportable);}
\DoxyCodeLine{02936\ \}}
\DoxyCodeLine{02937\ }
\DoxyCodeLine{02938\ \textcolor{comment}{//\ Get\ the\ number\ of\ tests\ in\ this\ test\ suite\ that\ should\ run.}}
\DoxyCodeLine{02939\ \textcolor{keywordtype}{int}\ TestSuite::test\_to\_run\_count()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02940\ \ \ \textcolor{keywordflow}{return}\ CountIf(test\_info\_list\_,\ ShouldRunTest);}
\DoxyCodeLine{02941\ \}}
\DoxyCodeLine{02942\ }
\DoxyCodeLine{02943\ \textcolor{comment}{//\ Gets\ the\ number\ of\ all\ tests.}}
\DoxyCodeLine{02944\ \textcolor{keywordtype}{int}\ TestSuite::total\_test\_count()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02945\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(test\_info\_list\_.size());}
\DoxyCodeLine{02946\ \}}
\DoxyCodeLine{02947\ }
\DoxyCodeLine{02948\ \textcolor{comment}{//\ Creates\ a\ TestSuite\ with\ the\ given\ name.}}
\DoxyCodeLine{02949\ \textcolor{comment}{//}}
\DoxyCodeLine{02950\ \textcolor{comment}{//\ Arguments:}}
\DoxyCodeLine{02951\ \textcolor{comment}{//}}
\DoxyCodeLine{02952\ \textcolor{comment}{//\ \ \ a\_name:\ \ \ \ \ \ \ name\ of\ the\ test\ suite}}
\DoxyCodeLine{02953\ \textcolor{comment}{//\ \ \ a\_type\_param:\ the\ name\ of\ the\ test\ suite's\ type\ parameter,\ or\ NULL\ if}}
\DoxyCodeLine{02954\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this\ is\ not\ a\ typed\ or\ a\ type-\/parameterized\ test\ suite.}}
\DoxyCodeLine{02955\ \textcolor{comment}{//\ \ \ set\_up\_tc:\ \ \ \ pointer\ to\ the\ function\ that\ sets\ up\ the\ test\ suite}}
\DoxyCodeLine{02956\ \textcolor{comment}{//\ \ \ tear\_down\_tc:\ pointer\ to\ the\ function\ that\ tears\ down\ the\ test\ suite}}
\DoxyCodeLine{02957\ TestSuite::TestSuite(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ a\_name,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ a\_type\_param,}
\DoxyCodeLine{02958\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ internal::SetUpTestSuiteFunc\ set\_up\_tc,}
\DoxyCodeLine{02959\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ internal::TearDownTestSuiteFunc\ tear\_down\_tc)}
\DoxyCodeLine{02960\ \ \ \ \ :\ name\_(a\_name),}
\DoxyCodeLine{02961\ \ \ \ \ \ \ type\_param\_(a\_type\_param\ ?\ new\ std::string(a\_type\_param)\ :\ nullptr),}
\DoxyCodeLine{02962\ \ \ \ \ \ \ set\_up\_tc\_(set\_up\_tc),}
\DoxyCodeLine{02963\ \ \ \ \ \ \ tear\_down\_tc\_(tear\_down\_tc),}
\DoxyCodeLine{02964\ \ \ \ \ \ \ should\_run\_(false),}
\DoxyCodeLine{02965\ \ \ \ \ \ \ start\_timestamp\_(0),}
\DoxyCodeLine{02966\ \ \ \ \ \ \ elapsed\_time\_(0)\ \{\}}
\DoxyCodeLine{02967\ }
\DoxyCodeLine{02968\ \textcolor{comment}{//\ Destructor\ of\ TestSuite.}}
\DoxyCodeLine{02969\ TestSuite::\string~TestSuite()\ \{}
\DoxyCodeLine{02970\ \ \ \textcolor{comment}{//\ Deletes\ every\ Test\ in\ the\ collection.}}
\DoxyCodeLine{02971\ \ \ ForEach(test\_info\_list\_,\ internal::Delete<TestInfo>);}
\DoxyCodeLine{02972\ \}}
\DoxyCodeLine{02973\ }
\DoxyCodeLine{02974\ \textcolor{comment}{//\ Returns\ the\ i-\/th\ test\ among\ all\ the\ tests.\ i\ can\ range\ from\ 0\ to}}
\DoxyCodeLine{02975\ \textcolor{comment}{//\ total\_test\_count()\ -\/\ 1.\ If\ i\ is\ not\ in\ that\ range,\ returns\ NULL.}}
\DoxyCodeLine{02976\ \textcolor{keyword}{const}\ TestInfo*\ TestSuite::GetTestInfo(\textcolor{keywordtype}{int}\ i)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02977\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ index\ =\ GetElementOr(test\_indices\_,\ i,\ -\/1);}
\DoxyCodeLine{02978\ \ \ \textcolor{keywordflow}{return}\ index\ <\ 0\ ?\ nullptr\ :\ test\_info\_list\_[static\_cast<size\_t>(index)];}
\DoxyCodeLine{02979\ \}}
\DoxyCodeLine{02980\ }
\DoxyCodeLine{02981\ \textcolor{comment}{//\ Returns\ the\ i-\/th\ test\ among\ all\ the\ tests.\ i\ can\ range\ from\ 0\ to}}
\DoxyCodeLine{02982\ \textcolor{comment}{//\ total\_test\_count()\ -\/\ 1.\ If\ i\ is\ not\ in\ that\ range,\ returns\ NULL.}}
\DoxyCodeLine{02983\ TestInfo*\ TestSuite::GetMutableTestInfo(\textcolor{keywordtype}{int}\ i)\ \{}
\DoxyCodeLine{02984\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ index\ =\ GetElementOr(test\_indices\_,\ i,\ -\/1);}
\DoxyCodeLine{02985\ \ \ \textcolor{keywordflow}{return}\ index\ <\ 0\ ?\ nullptr\ :\ test\_info\_list\_[static\_cast<size\_t>(index)];}
\DoxyCodeLine{02986\ \}}
\DoxyCodeLine{02987\ }
\DoxyCodeLine{02988\ \textcolor{comment}{//\ Adds\ a\ test\ to\ this\ test\ suite.\ \ Will\ delete\ the\ test\ upon}}
\DoxyCodeLine{02989\ \textcolor{comment}{//\ destruction\ of\ the\ TestSuite\ object.}}
\DoxyCodeLine{02990\ \textcolor{keywordtype}{void}\ TestSuite::AddTestInfo(TestInfo*\ test\_info)\ \{}
\DoxyCodeLine{02991\ \ \ test\_info\_list\_.push\_back(test\_info);}
\DoxyCodeLine{02992\ \ \ test\_indices\_.push\_back(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(test\_indices\_.size()));}
\DoxyCodeLine{02993\ \}}
\DoxyCodeLine{02994\ }
\DoxyCodeLine{02995\ \textcolor{comment}{//\ Runs\ every\ test\ in\ this\ TestSuite.}}
\DoxyCodeLine{02996\ \textcolor{keywordtype}{void}\ TestSuite::Run()\ \{}
\DoxyCodeLine{02997\ \ \ \textcolor{keywordflow}{if}\ (!should\_run\_)\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02998\ }
\DoxyCodeLine{02999\ \ \ internal::UnitTestImpl*\ \textcolor{keyword}{const}\ impl\ =\ internal::GetUnitTestImpl();}
\DoxyCodeLine{03000\ \ \ impl-\/>set\_current\_test\_suite(\textcolor{keyword}{this});}
\DoxyCodeLine{03001\ }
\DoxyCodeLine{03002\ \ \ TestEventListener*\ repeater\ =\ UnitTest::GetInstance()-\/>listeners().repeater();}
\DoxyCodeLine{03003\ }
\DoxyCodeLine{03004\ \ \ \textcolor{comment}{//\ Call\ both\ legacy\ and\ the\ new\ API}}
\DoxyCodeLine{03005\ \ \ repeater-\/>OnTestSuiteStart(*\textcolor{keyword}{this});}
\DoxyCodeLine{03006\ \textcolor{comment}{//\ \ Legacy\ API\ is\ deprecated\ but\ still\ available}}
\DoxyCodeLine{03007\ \textcolor{preprocessor}{\#ifndef\ GTEST\_REMOVE\_LEGACY\_TEST\_CASEAPI\_}}
\DoxyCodeLine{03008\ \ \ repeater-\/>OnTestCaseStart(*\textcolor{keyword}{this});}
\DoxyCodeLine{03009\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ \ GTEST\_REMOVE\_LEGACY\_TEST\_CASEAPI\_}}
\DoxyCodeLine{03010\ }
\DoxyCodeLine{03011\ \ \ impl-\/>os\_stack\_trace\_getter()-\/>UponLeavingGTest();}
\DoxyCodeLine{03012\ \ \ internal::HandleExceptionsInMethodIfSupported(}
\DoxyCodeLine{03013\ \ \ \ \ \ \ \textcolor{keyword}{this},\ \&TestSuite::RunSetUpTestSuite,\ \textcolor{stringliteral}{"{}SetUpTestSuite()"{}});}
\DoxyCodeLine{03014\ }
\DoxyCodeLine{03015\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ skip\_all\ =\ ad\_hoc\_test\_result().Failed();}
\DoxyCodeLine{03016\ }
\DoxyCodeLine{03017\ \ \ start\_timestamp\_\ =\ internal::GetTimeInMillis();}
\DoxyCodeLine{03018\ \ \ internal::Timer\ timer;}
\DoxyCodeLine{03019\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ total\_test\_count();\ i++)\ \{}
\DoxyCodeLine{03020\ \ \ \ \ \textcolor{keywordflow}{if}\ (skip\_all)\ \{}
\DoxyCodeLine{03021\ \ \ \ \ \ \ GetMutableTestInfo(i)-\/>Skip();}
\DoxyCodeLine{03022\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03023\ \ \ \ \ \ \ GetMutableTestInfo(i)-\/>Run();}
\DoxyCodeLine{03024\ \ \ \ \ \}}
\DoxyCodeLine{03025\ \ \ \ \ \textcolor{keywordflow}{if}\ (GTEST\_FLAG\_GET(fail\_fast)\ \&\&}
\DoxyCodeLine{03026\ \ \ \ \ \ \ \ \ GetMutableTestInfo(i)-\/>result()-\/>Failed())\ \{}
\DoxyCodeLine{03027\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ i\ +\ 1;\ j\ <\ total\_test\_count();\ j++)\ \{}
\DoxyCodeLine{03028\ \ \ \ \ \ \ \ \ GetMutableTestInfo(j)-\/>Skip();}
\DoxyCodeLine{03029\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03030\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03031\ \ \ \ \ \}}
\DoxyCodeLine{03032\ \ \ \}}
\DoxyCodeLine{03033\ \ \ elapsed\_time\_\ =\ timer.Elapsed();}
\DoxyCodeLine{03034\ }
\DoxyCodeLine{03035\ \ \ impl-\/>os\_stack\_trace\_getter()-\/>UponLeavingGTest();}
\DoxyCodeLine{03036\ \ \ internal::HandleExceptionsInMethodIfSupported(}
\DoxyCodeLine{03037\ \ \ \ \ \ \ \textcolor{keyword}{this},\ \&TestSuite::RunTearDownTestSuite,\ \textcolor{stringliteral}{"{}TearDownTestSuite()"{}});}
\DoxyCodeLine{03038\ }
\DoxyCodeLine{03039\ \ \ \textcolor{comment}{//\ Call\ both\ legacy\ and\ the\ new\ API}}
\DoxyCodeLine{03040\ \ \ repeater-\/>OnTestSuiteEnd(*\textcolor{keyword}{this});}
\DoxyCodeLine{03041\ \textcolor{comment}{//\ \ Legacy\ API\ is\ deprecated\ but\ still\ available}}
\DoxyCodeLine{03042\ \textcolor{preprocessor}{\#ifndef\ GTEST\_REMOVE\_LEGACY\_TEST\_CASEAPI\_}}
\DoxyCodeLine{03043\ \ \ repeater-\/>OnTestCaseEnd(*\textcolor{keyword}{this});}
\DoxyCodeLine{03044\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ \ GTEST\_REMOVE\_LEGACY\_TEST\_CASEAPI\_}}
\DoxyCodeLine{03045\ }
\DoxyCodeLine{03046\ \ \ impl-\/>set\_current\_test\_suite(\textcolor{keyword}{nullptr});}
\DoxyCodeLine{03047\ \}}
\DoxyCodeLine{03048\ }
\DoxyCodeLine{03049\ \textcolor{comment}{//\ Skips\ all\ tests\ under\ this\ TestSuite.}}
\DoxyCodeLine{03050\ \textcolor{keywordtype}{void}\ TestSuite::Skip()\ \{}
\DoxyCodeLine{03051\ \ \ \textcolor{keywordflow}{if}\ (!should\_run\_)\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{03052\ }
\DoxyCodeLine{03053\ \ \ internal::UnitTestImpl*\ \textcolor{keyword}{const}\ impl\ =\ internal::GetUnitTestImpl();}
\DoxyCodeLine{03054\ \ \ impl-\/>set\_current\_test\_suite(\textcolor{keyword}{this});}
\DoxyCodeLine{03055\ }
\DoxyCodeLine{03056\ \ \ TestEventListener*\ repeater\ =\ UnitTest::GetInstance()-\/>listeners().repeater();}
\DoxyCodeLine{03057\ }
\DoxyCodeLine{03058\ \ \ \textcolor{comment}{//\ Call\ both\ legacy\ and\ the\ new\ API}}
\DoxyCodeLine{03059\ \ \ repeater-\/>OnTestSuiteStart(*\textcolor{keyword}{this});}
\DoxyCodeLine{03060\ \textcolor{comment}{//\ \ Legacy\ API\ is\ deprecated\ but\ still\ available}}
\DoxyCodeLine{03061\ \textcolor{preprocessor}{\#ifndef\ GTEST\_REMOVE\_LEGACY\_TEST\_CASEAPI\_}}
\DoxyCodeLine{03062\ \ \ repeater-\/>OnTestCaseStart(*\textcolor{keyword}{this});}
\DoxyCodeLine{03063\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ \ GTEST\_REMOVE\_LEGACY\_TEST\_CASEAPI\_}}
\DoxyCodeLine{03064\ }
\DoxyCodeLine{03065\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ total\_test\_count();\ i++)\ \{}
\DoxyCodeLine{03066\ \ \ \ \ GetMutableTestInfo(i)-\/>Skip();}
\DoxyCodeLine{03067\ \ \ \}}
\DoxyCodeLine{03068\ }
\DoxyCodeLine{03069\ \ \ \textcolor{comment}{//\ Call\ both\ legacy\ and\ the\ new\ API}}
\DoxyCodeLine{03070\ \ \ repeater-\/>OnTestSuiteEnd(*\textcolor{keyword}{this});}
\DoxyCodeLine{03071\ \ \ \textcolor{comment}{//\ Legacy\ API\ is\ deprecated\ but\ still\ available}}
\DoxyCodeLine{03072\ \textcolor{preprocessor}{\#ifndef\ GTEST\_REMOVE\_LEGACY\_TEST\_CASEAPI\_}}
\DoxyCodeLine{03073\ \ \ repeater-\/>OnTestCaseEnd(*\textcolor{keyword}{this});}
\DoxyCodeLine{03074\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ \ GTEST\_REMOVE\_LEGACY\_TEST\_CASEAPI\_}}
\DoxyCodeLine{03075\ }
\DoxyCodeLine{03076\ \ \ impl-\/>set\_current\_test\_suite(\textcolor{keyword}{nullptr});}
\DoxyCodeLine{03077\ \}}
\DoxyCodeLine{03078\ }
\DoxyCodeLine{03079\ \textcolor{comment}{//\ Clears\ the\ results\ of\ all\ tests\ in\ this\ test\ suite.}}
\DoxyCodeLine{03080\ \textcolor{keywordtype}{void}\ TestSuite::ClearResult()\ \{}
\DoxyCodeLine{03081\ \ \ ad\_hoc\_test\_result\_.Clear();}
\DoxyCodeLine{03082\ \ \ ForEach(test\_info\_list\_,\ TestInfo::ClearTestResult);}
\DoxyCodeLine{03083\ \}}
\DoxyCodeLine{03084\ }
\DoxyCodeLine{03085\ \textcolor{comment}{//\ Shuffles\ the\ tests\ in\ this\ test\ suite.}}
\DoxyCodeLine{03086\ \textcolor{keywordtype}{void}\ TestSuite::ShuffleTests(internal::Random*\ random)\ \{}
\DoxyCodeLine{03087\ \ \ Shuffle(random,\ \&test\_indices\_);}
\DoxyCodeLine{03088\ \}}
\DoxyCodeLine{03089\ }
\DoxyCodeLine{03090\ \textcolor{comment}{//\ Restores\ the\ test\ order\ to\ before\ the\ first\ shuffle.}}
\DoxyCodeLine{03091\ \textcolor{keywordtype}{void}\ TestSuite::UnshuffleTests()\ \{}
\DoxyCodeLine{03092\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ test\_indices\_.size();\ i++)\ \{}
\DoxyCodeLine{03093\ \ \ \ \ test\_indices\_[i]\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(i);}
\DoxyCodeLine{03094\ \ \ \}}
\DoxyCodeLine{03095\ \}}
\DoxyCodeLine{03096\ }
\DoxyCodeLine{03097\ \textcolor{comment}{//\ Formats\ a\ countable\ noun.\ \ Depending\ on\ its\ quantity,\ either\ the}}
\DoxyCodeLine{03098\ \textcolor{comment}{//\ singular\ form\ or\ the\ plural\ form\ is\ used.\ e.g.}}
\DoxyCodeLine{03099\ \textcolor{comment}{//}}
\DoxyCodeLine{03100\ \textcolor{comment}{//\ FormatCountableNoun(1,\ "{}formula"{},\ "{}formuli"{})\ returns\ "{}1\ formula"{}.}}
\DoxyCodeLine{03101\ \textcolor{comment}{//\ FormatCountableNoun(5,\ "{}book"{},\ "{}books"{})\ returns\ "{}5\ books"{}.}}
\DoxyCodeLine{03102\ \textcolor{keyword}{static}\ std::string\ FormatCountableNoun(\textcolor{keywordtype}{int}\ count,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ singular\_form,}
\DoxyCodeLine{03103\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ plural\_form)\ \{}
\DoxyCodeLine{03104\ \ \ \textcolor{keywordflow}{return}\ internal::StreamableToString(count)\ +\ \textcolor{stringliteral}{"{}\ "{}}\ +}
\DoxyCodeLine{03105\ \ \ \ \ \ \ \ \ \ (count\ ==\ 1\ ?\ singular\_form\ :\ plural\_form);}
\DoxyCodeLine{03106\ \}}
\DoxyCodeLine{03107\ }
\DoxyCodeLine{03108\ \textcolor{comment}{//\ Formats\ the\ count\ of\ tests.}}
\DoxyCodeLine{03109\ \textcolor{keyword}{static}\ std::string\ FormatTestCount(\textcolor{keywordtype}{int}\ test\_count)\ \{}
\DoxyCodeLine{03110\ \ \ \textcolor{keywordflow}{return}\ FormatCountableNoun(test\_count,\ \textcolor{stringliteral}{"{}test"{}},\ \textcolor{stringliteral}{"{}tests"{}});}
\DoxyCodeLine{03111\ \}}
\DoxyCodeLine{03112\ }
\DoxyCodeLine{03113\ \textcolor{comment}{//\ Formats\ the\ count\ of\ test\ suites.}}
\DoxyCodeLine{03114\ \textcolor{keyword}{static}\ std::string\ FormatTestSuiteCount(\textcolor{keywordtype}{int}\ test\_suite\_count)\ \{}
\DoxyCodeLine{03115\ \ \ \textcolor{keywordflow}{return}\ FormatCountableNoun(test\_suite\_count,\ \textcolor{stringliteral}{"{}test\ suite"{}},\ \textcolor{stringliteral}{"{}test\ suites"{}});}
\DoxyCodeLine{03116\ \}}
\DoxyCodeLine{03117\ }
\DoxyCodeLine{03118\ \textcolor{comment}{//\ Converts\ a\ TestPartResult::Type\ enum\ to\ human-\/friendly\ string}}
\DoxyCodeLine{03119\ \textcolor{comment}{//\ representation.\ \ Both\ kNonFatalFailure\ and\ kFatalFailure\ are\ translated}}
\DoxyCodeLine{03120\ \textcolor{comment}{//\ to\ "{}Failure"{},\ as\ the\ user\ usually\ doesn't\ care\ about\ the\ difference}}
\DoxyCodeLine{03121\ \textcolor{comment}{//\ between\ the\ two\ when\ viewing\ the\ test\ result.}}
\DoxyCodeLine{03122\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ TestPartResultTypeToString(TestPartResult::Type\ type)\ \{}
\DoxyCodeLine{03123\ \ \ \textcolor{keywordflow}{switch}\ (type)\ \{}
\DoxyCodeLine{03124\ \ \ \ \ \textcolor{keywordflow}{case}\ TestPartResult::kSkip:}
\DoxyCodeLine{03125\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}Skipped\(\backslash\)n"{}};}
\DoxyCodeLine{03126\ \ \ \ \ \textcolor{keywordflow}{case}\ TestPartResult::kSuccess:}
\DoxyCodeLine{03127\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}Success"{}};}
\DoxyCodeLine{03128\ }
\DoxyCodeLine{03129\ \ \ \ \ \textcolor{keywordflow}{case}\ TestPartResult::kNonFatalFailure:}
\DoxyCodeLine{03130\ \ \ \ \ \textcolor{keywordflow}{case}\ TestPartResult::kFatalFailure:}
\DoxyCodeLine{03131\ \textcolor{preprocessor}{\#ifdef\ \_MSC\_VER}}
\DoxyCodeLine{03132\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}error:\ "{}};}
\DoxyCodeLine{03133\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03134\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}Failure\(\backslash\)n"{}};}
\DoxyCodeLine{03135\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03136\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{03137\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}Unknown\ result\ type"{}};}
\DoxyCodeLine{03138\ \ \ \}}
\DoxyCodeLine{03139\ \}}
\DoxyCodeLine{03140\ }
\DoxyCodeLine{03141\ \textcolor{keyword}{namespace\ }internal\ \{}
\DoxyCodeLine{03142\ \textcolor{keyword}{namespace\ }\{}
\DoxyCodeLine{03143\ \textcolor{keyword}{enum\ class}\ GTestColor\ \{\ kDefault,\ kRed,\ kGreen,\ kYellow\ \};}
\DoxyCodeLine{03144\ \}\ \ \textcolor{comment}{//\ namespace}}
\DoxyCodeLine{03145\ }
\DoxyCodeLine{03146\ \textcolor{comment}{//\ Prints\ a\ TestPartResult\ to\ an\ std::string.}}
\DoxyCodeLine{03147\ \textcolor{keyword}{static}\ std::string\ PrintTestPartResultToString(}
\DoxyCodeLine{03148\ \ \ \ \ \textcolor{keyword}{const}\ TestPartResult\&\ test\_part\_result)\ \{}
\DoxyCodeLine{03149\ \ \ \textcolor{keywordflow}{return}\ (Message()\ <<\ internal::FormatFileLocation(}
\DoxyCodeLine{03150\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ test\_part\_result.file\_name(),}
\DoxyCodeLine{03151\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ test\_part\_result.line\_number())}
\DoxyCodeLine{03152\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ "{}}}
\DoxyCodeLine{03153\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ TestPartResultTypeToString(test\_part\_result.type())}
\DoxyCodeLine{03154\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ test\_part\_result.message())}
\DoxyCodeLine{03155\ \ \ \ \ \ \ .GetString();}
\DoxyCodeLine{03156\ \}}
\DoxyCodeLine{03157\ }
\DoxyCodeLine{03158\ \textcolor{comment}{//\ Prints\ a\ TestPartResult.}}
\DoxyCodeLine{03159\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ PrintTestPartResult(\textcolor{keyword}{const}\ TestPartResult\&\ test\_part\_result)\ \{}
\DoxyCodeLine{03160\ \ \ \textcolor{keyword}{const}\ std::string\&\ result\ =\ PrintTestPartResultToString(test\_part\_result);}
\DoxyCodeLine{03161\ \ \ printf(\textcolor{stringliteral}{"{}\%s\(\backslash\)n"{}},\ result.c\_str());}
\DoxyCodeLine{03162\ \ \ fflush(stdout);}
\DoxyCodeLine{03163\ \ \ \textcolor{comment}{//\ If\ the\ test\ program\ runs\ in\ Visual\ Studio\ or\ a\ debugger,\ the}}
\DoxyCodeLine{03164\ \ \ \textcolor{comment}{//\ following\ statements\ add\ the\ test\ part\ result\ message\ to\ the\ Output}}
\DoxyCodeLine{03165\ \ \ \textcolor{comment}{//\ window\ such\ that\ the\ user\ can\ double-\/click\ on\ it\ to\ jump\ to\ the}}
\DoxyCodeLine{03166\ \ \ \textcolor{comment}{//\ corresponding\ source\ code\ location;\ otherwise\ they\ do\ nothing.}}
\DoxyCodeLine{03167\ \textcolor{preprocessor}{\#if\ GTEST\_OS\_WINDOWS\ \&\&\ !GTEST\_OS\_WINDOWS\_MOBILE}}
\DoxyCodeLine{03168\ \ \ \textcolor{comment}{//\ We\ don't\ call\ OutputDebugString*()\ on\ Windows\ Mobile,\ as\ printing}}
\DoxyCodeLine{03169\ \ \ \textcolor{comment}{//\ to\ stdout\ is\ done\ by\ OutputDebugString()\ there\ already\ -\/\ we\ don't}}
\DoxyCodeLine{03170\ \ \ \textcolor{comment}{//\ want\ the\ same\ message\ printed\ twice.}}
\DoxyCodeLine{03171\ \ \ ::OutputDebugStringA(result.c\_str());}
\DoxyCodeLine{03172\ \ \ ::OutputDebugStringA(\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{03173\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03174\ \}}
\DoxyCodeLine{03175\ }
\DoxyCodeLine{03176\ \textcolor{comment}{//\ class\ PrettyUnitTestResultPrinter}}
\DoxyCodeLine{03177\ \textcolor{preprocessor}{\#if\ GTEST\_OS\_WINDOWS\ \&\&\ !GTEST\_OS\_WINDOWS\_MOBILE\ \&\&\ !GTEST\_OS\_WINDOWS\_PHONE\ \&\&\ \(\backslash\)}}
\DoxyCodeLine{03178\ \textcolor{preprocessor}{\ \ \ \ !GTEST\_OS\_WINDOWS\_RT\ \&\&\ !GTEST\_OS\_WINDOWS\_MINGW}}
\DoxyCodeLine{03179\ }
\DoxyCodeLine{03180\ \textcolor{comment}{//\ Returns\ the\ character\ attribute\ for\ the\ given\ color.}}
\DoxyCodeLine{03181\ \textcolor{keyword}{static}\ WORD\ GetColorAttribute(GTestColor\ color)\ \{}
\DoxyCodeLine{03182\ \ \ \textcolor{keywordflow}{switch}\ (color)\ \{}
\DoxyCodeLine{03183\ \ \ \ \ \textcolor{keywordflow}{case}\ GTestColor::kRed:}
\DoxyCodeLine{03184\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ FOREGROUND\_RED;}
\DoxyCodeLine{03185\ \ \ \ \ \textcolor{keywordflow}{case}\ GTestColor::kGreen:}
\DoxyCodeLine{03186\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ FOREGROUND\_GREEN;}
\DoxyCodeLine{03187\ \ \ \ \ \textcolor{keywordflow}{case}\ GTestColor::kYellow:}
\DoxyCodeLine{03188\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ FOREGROUND\_RED\ |\ FOREGROUND\_GREEN;}
\DoxyCodeLine{03189\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{03190\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{03191\ \ \ \}}
\DoxyCodeLine{03192\ \}}
\DoxyCodeLine{03193\ }
\DoxyCodeLine{03194\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{int}\ GetBitOffset(WORD\ color\_mask)\ \{}
\DoxyCodeLine{03195\ \ \ \textcolor{keywordflow}{if}\ (color\_mask\ ==\ 0)\ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{03196\ }
\DoxyCodeLine{03197\ \ \ \textcolor{keywordtype}{int}\ bitOffset\ =\ 0;}
\DoxyCodeLine{03198\ \ \ \textcolor{keywordflow}{while}\ ((color\_mask\ \&\ 1)\ ==\ 0)\ \{}
\DoxyCodeLine{03199\ \ \ \ \ color\_mask\ >>=\ 1;}
\DoxyCodeLine{03200\ \ \ \ \ ++bitOffset;}
\DoxyCodeLine{03201\ \ \ \}}
\DoxyCodeLine{03202\ \ \ \textcolor{keywordflow}{return}\ bitOffset;}
\DoxyCodeLine{03203\ \}}
\DoxyCodeLine{03204\ }
\DoxyCodeLine{03205\ \textcolor{keyword}{static}\ WORD\ GetNewColor(GTestColor\ color,\ WORD\ old\_color\_attrs)\ \{}
\DoxyCodeLine{03206\ \ \ \textcolor{comment}{//\ Let's\ reuse\ the\ BG}}
\DoxyCodeLine{03207\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ WORD\ background\_mask\ =\ BACKGROUND\_BLUE\ |\ BACKGROUND\_GREEN\ |}
\DoxyCodeLine{03208\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ BACKGROUND\_RED\ |\ BACKGROUND\_INTENSITY;}
\DoxyCodeLine{03209\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ WORD\ foreground\_mask\ =\ FOREGROUND\_BLUE\ |\ FOREGROUND\_GREEN\ |}
\DoxyCodeLine{03210\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FOREGROUND\_RED\ |\ FOREGROUND\_INTENSITY;}
\DoxyCodeLine{03211\ \ \ \textcolor{keyword}{const}\ WORD\ existing\_bg\ =\ old\_color\_attrs\ \&\ background\_mask;}
\DoxyCodeLine{03212\ }
\DoxyCodeLine{03213\ \ \ WORD\ new\_color\ =}
\DoxyCodeLine{03214\ \ \ \ \ \ \ GetColorAttribute(color)\ |\ existing\_bg\ |\ FOREGROUND\_INTENSITY;}
\DoxyCodeLine{03215\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ bg\_bitOffset\ =\ GetBitOffset(background\_mask);}
\DoxyCodeLine{03216\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ fg\_bitOffset\ =\ GetBitOffset(foreground\_mask);}
\DoxyCodeLine{03217\ }
\DoxyCodeLine{03218\ \ \ \textcolor{keywordflow}{if}\ (((new\_color\ \&\ background\_mask)\ >>\ bg\_bitOffset)\ ==}
\DoxyCodeLine{03219\ \ \ \ \ \ \ ((new\_color\ \&\ foreground\_mask)\ >>\ fg\_bitOffset))\ \{}
\DoxyCodeLine{03220\ \ \ \ \ new\_color\ \string^=\ FOREGROUND\_INTENSITY;\ \ \textcolor{comment}{//\ invert\ intensity}}
\DoxyCodeLine{03221\ \ \ \}}
\DoxyCodeLine{03222\ \ \ \textcolor{keywordflow}{return}\ new\_color;}
\DoxyCodeLine{03223\ \}}
\DoxyCodeLine{03224\ }
\DoxyCodeLine{03225\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03226\ }
\DoxyCodeLine{03227\ \textcolor{comment}{//\ Returns\ the\ ANSI\ color\ code\ for\ the\ given\ color.\ GTestColor::kDefault\ is}}
\DoxyCodeLine{03228\ \textcolor{comment}{//\ an\ invalid\ input.}}
\DoxyCodeLine{03229\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ GetAnsiColorCode(GTestColor\ color)\ \{}
\DoxyCodeLine{03230\ \ \ \textcolor{keywordflow}{switch}\ (color)\ \{}
\DoxyCodeLine{03231\ \ \ \ \ \textcolor{keywordflow}{case}\ GTestColor::kRed:}
\DoxyCodeLine{03232\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}1"{}};}
\DoxyCodeLine{03233\ \ \ \ \ \textcolor{keywordflow}{case}\ GTestColor::kGreen:}
\DoxyCodeLine{03234\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}2"{}};}
\DoxyCodeLine{03235\ \ \ \ \ \textcolor{keywordflow}{case}\ GTestColor::kYellow:}
\DoxyCodeLine{03236\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}3"{}};}
\DoxyCodeLine{03237\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{03238\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{03239\ \ \ \}}
\DoxyCodeLine{03240\ \}}
\DoxyCodeLine{03241\ }
\DoxyCodeLine{03242\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GTEST\_OS\_WINDOWS\ \&\&\ !GTEST\_OS\_WINDOWS\_MOBILE}}
\DoxyCodeLine{03243\ }
\DoxyCodeLine{03244\ \textcolor{comment}{//\ Returns\ true\ if\ and\ only\ if\ Google\ Test\ should\ use\ colors\ in\ the\ output.}}
\DoxyCodeLine{03245\ \textcolor{keywordtype}{bool}\ ShouldUseColor(\textcolor{keywordtype}{bool}\ stdout\_is\_tty)\ \{}
\DoxyCodeLine{03246\ \ \ std::string\ c\ =\ GTEST\_FLAG\_GET(color);}
\DoxyCodeLine{03247\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \textcolor{keyword}{const}\ gtest\_color\ =\ c.c\_str();}
\DoxyCodeLine{03248\ }
\DoxyCodeLine{03249\ \ \ \textcolor{keywordflow}{if}\ (String::CaseInsensitiveCStringEquals(gtest\_color,\ \textcolor{stringliteral}{"{}auto"{}}))\ \{}
\DoxyCodeLine{03250\ \textcolor{preprocessor}{\#if\ GTEST\_OS\_WINDOWS\ \&\&\ !GTEST\_OS\_WINDOWS\_MINGW}}
\DoxyCodeLine{03251\ \ \ \ \ \textcolor{comment}{//\ On\ Windows\ the\ TERM\ variable\ is\ usually\ not\ set,\ but\ the}}
\DoxyCodeLine{03252\ \ \ \ \ \textcolor{comment}{//\ console\ there\ does\ support\ colors.}}
\DoxyCodeLine{03253\ \ \ \ \ \textcolor{keywordflow}{return}\ stdout\_is\_tty;}
\DoxyCodeLine{03254\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03255\ \ \ \ \ \textcolor{comment}{//\ On\ non-\/Windows\ platforms,\ we\ rely\ on\ the\ TERM\ variable.}}
\DoxyCodeLine{03256\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \textcolor{keyword}{const}\ term\ =\ posix::GetEnv(\textcolor{stringliteral}{"{}TERM"{}});}
\DoxyCodeLine{03257\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ term\_supports\_color\ =\ term\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ (}
\DoxyCodeLine{03258\ \ \ \ \ \ \ \ \ String::CStringEquals(term,\ \textcolor{stringliteral}{"{}xterm"{}})\ ||}
\DoxyCodeLine{03259\ \ \ \ \ \ \ \ \ String::CStringEquals(term,\ \textcolor{stringliteral}{"{}xterm-\/color"{}})\ ||}
\DoxyCodeLine{03260\ \ \ \ \ \ \ \ \ String::CStringEquals(term,\ \textcolor{stringliteral}{"{}screen"{}})\ ||}
\DoxyCodeLine{03261\ \ \ \ \ \ \ \ \ String::CStringEquals(term,\ \textcolor{stringliteral}{"{}tmux"{}})\ ||}
\DoxyCodeLine{03262\ \ \ \ \ \ \ \ \ String::CStringEquals(term,\ \textcolor{stringliteral}{"{}rxvt-\/unicode"{}})\ ||}
\DoxyCodeLine{03263\ \ \ \ \ \ \ \ \ String::CStringEquals(term,\ \textcolor{stringliteral}{"{}linux"{}})\ ||}
\DoxyCodeLine{03264\ \ \ \ \ \ \ \ \ String::CStringEquals(term,\ \textcolor{stringliteral}{"{}cygwin"{}})\ ||}
\DoxyCodeLine{03265\ \ \ \ \ \ \ \ \ String::EndsWithCaseInsensitive(term,\ \textcolor{stringliteral}{"{}-\/256color"{}}));}
\DoxyCodeLine{03266\ \ \ \ \ \textcolor{keywordflow}{return}\ stdout\_is\_tty\ \&\&\ term\_supports\_color;}
\DoxyCodeLine{03267\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GTEST\_OS\_WINDOWS}}
\DoxyCodeLine{03268\ \ \ \}}
\DoxyCodeLine{03269\ }
\DoxyCodeLine{03270\ \ \ \textcolor{keywordflow}{return}\ String::CaseInsensitiveCStringEquals(gtest\_color,\ \textcolor{stringliteral}{"{}yes"{}})\ ||}
\DoxyCodeLine{03271\ \ \ \ \ \ \ \ \ \ String::CaseInsensitiveCStringEquals(gtest\_color,\ \textcolor{stringliteral}{"{}true"{}})\ ||}
\DoxyCodeLine{03272\ \ \ \ \ \ \ \ \ \ String::CaseInsensitiveCStringEquals(gtest\_color,\ \textcolor{stringliteral}{"{}t"{}})\ ||}
\DoxyCodeLine{03273\ \ \ \ \ \ \ \ \ \ String::CStringEquals(gtest\_color,\ \textcolor{stringliteral}{"{}1"{}});}
\DoxyCodeLine{03274\ \ \ \textcolor{comment}{//\ We\ take\ "{}yes"{},\ "{}true"{},\ "{}t"{},\ and\ "{}1"{}\ as\ meaning\ "{}yes"{}.\ \ If\ the}}
\DoxyCodeLine{03275\ \ \ \textcolor{comment}{//\ value\ is\ neither\ one\ of\ these\ nor\ "{}auto"{},\ we\ treat\ it\ as\ "{}no"{}\ to}}
\DoxyCodeLine{03276\ \ \ \textcolor{comment}{//\ be\ conservative.}}
\DoxyCodeLine{03277\ \}}
\DoxyCodeLine{03278\ }
\DoxyCodeLine{03279\ \textcolor{comment}{//\ Helpers\ for\ printing\ colored\ strings\ to\ stdout.\ Note\ that\ on\ Windows,\ we}}
\DoxyCodeLine{03280\ \textcolor{comment}{//\ cannot\ simply\ emit\ special\ characters\ and\ have\ the\ terminal\ change\ colors.}}
\DoxyCodeLine{03281\ \textcolor{comment}{//\ This\ routine\ must\ actually\ emit\ the\ characters\ rather\ than\ return\ a\ string}}
\DoxyCodeLine{03282\ \textcolor{comment}{//\ that\ would\ be\ colored\ when\ printed,\ as\ can\ be\ done\ on\ Linux.}}
\DoxyCodeLine{03283\ }
\DoxyCodeLine{03284\ GTEST\_ATTRIBUTE\_PRINTF\_(2,\ 3)}
\DoxyCodeLine{03285\ static\ \textcolor{keywordtype}{void}\ ColoredPrintf(GTestColor\ color,\ const\ \textcolor{keywordtype}{char}*\ fmt,\ ...)\ \{}
\DoxyCodeLine{03286\ \ \ va\_list\ args;}
\DoxyCodeLine{03287\ \ \ va\_start(args,\ fmt);}
\DoxyCodeLine{03288\ }
\DoxyCodeLine{03289\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ in\_color\_mode\ =}
\DoxyCodeLine{03290\ \ \ \ \ \ \ ShouldUseColor(posix::IsATTY(posix::FileNo(stdout))\ !=\ 0);}
\DoxyCodeLine{03291\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ use\_color\ =\ in\_color\_mode\ \&\&\ (color\ !=\ GTestColor::kDefault);}
\DoxyCodeLine{03292\ }
\DoxyCodeLine{03293\ \ \ \textcolor{keywordflow}{if}\ (!use\_color)\ \{}
\DoxyCodeLine{03294\ \ \ \ \ vprintf(fmt,\ args);}
\DoxyCodeLine{03295\ \ \ \ \ va\_end(args);}
\DoxyCodeLine{03296\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{03297\ \ \ \}}
\DoxyCodeLine{03298\ }
\DoxyCodeLine{03299\ \textcolor{preprocessor}{\#if\ GTEST\_OS\_WINDOWS\ \&\&\ !GTEST\_OS\_WINDOWS\_MOBILE\ \&\&\ !GTEST\_OS\_WINDOWS\_PHONE\ \&\&\ \(\backslash\)}}
\DoxyCodeLine{03300\ \textcolor{preprocessor}{\ \ \ \ !GTEST\_OS\_WINDOWS\_RT\ \&\&\ !GTEST\_OS\_WINDOWS\_MINGW}}
\DoxyCodeLine{03301\ \ \ \textcolor{keyword}{const}\ HANDLE\ stdout\_handle\ =\ GetStdHandle(STD\_OUTPUT\_HANDLE);}
\DoxyCodeLine{03302\ }
\DoxyCodeLine{03303\ \ \ \textcolor{comment}{//\ Gets\ the\ current\ text\ color.}}
\DoxyCodeLine{03304\ \ \ CONSOLE\_SCREEN\_BUFFER\_INFO\ buffer\_info;}
\DoxyCodeLine{03305\ \ \ GetConsoleScreenBufferInfo(stdout\_handle,\ \&buffer\_info);}
\DoxyCodeLine{03306\ \ \ \textcolor{keyword}{const}\ WORD\ old\_color\_attrs\ =\ buffer\_info.wAttributes;}
\DoxyCodeLine{03307\ \ \ \textcolor{keyword}{const}\ WORD\ new\_color\ =\ GetNewColor(color,\ old\_color\_attrs);}
\DoxyCodeLine{03308\ }
\DoxyCodeLine{03309\ \ \ \textcolor{comment}{//\ We\ need\ to\ flush\ the\ stream\ buffers\ into\ the\ console\ before\ each}}
\DoxyCodeLine{03310\ \ \ \textcolor{comment}{//\ SetConsoleTextAttribute\ call\ lest\ it\ affect\ the\ text\ that\ is\ already}}
\DoxyCodeLine{03311\ \ \ \textcolor{comment}{//\ printed\ but\ has\ not\ yet\ reached\ the\ console.}}
\DoxyCodeLine{03312\ \ \ fflush(stdout);}
\DoxyCodeLine{03313\ \ \ SetConsoleTextAttribute(stdout\_handle,\ new\_color);}
\DoxyCodeLine{03314\ }
\DoxyCodeLine{03315\ \ \ vprintf(fmt,\ args);}
\DoxyCodeLine{03316\ }
\DoxyCodeLine{03317\ \ \ fflush(stdout);}
\DoxyCodeLine{03318\ \ \ \textcolor{comment}{//\ Restores\ the\ text\ color.}}
\DoxyCodeLine{03319\ \ \ SetConsoleTextAttribute(stdout\_handle,\ old\_color\_attrs);}
\DoxyCodeLine{03320\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03321\ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)033[0;3\%sm"{}},\ GetAnsiColorCode(color));}
\DoxyCodeLine{03322\ \ \ vprintf(fmt,\ args);}
\DoxyCodeLine{03323\ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)033[m"{}});\ \ \textcolor{comment}{//\ Resets\ the\ terminal\ to\ default.}}
\DoxyCodeLine{03324\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GTEST\_OS\_WINDOWS\ \&\&\ !GTEST\_OS\_WINDOWS\_MOBILE}}
\DoxyCodeLine{03325\ \ \ va\_end(args);}
\DoxyCodeLine{03326\ \}}
\DoxyCodeLine{03327\ }
\DoxyCodeLine{03328\ \textcolor{comment}{//\ Text\ printed\ in\ Google\ Test's\ text\ output\ and\ -\/-\/gtest\_list\_tests}}
\DoxyCodeLine{03329\ \textcolor{comment}{//\ output\ to\ label\ the\ type\ parameter\ and\ value\ parameter\ for\ a\ test.}}
\DoxyCodeLine{03330\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ kTypeParamLabel[]\ =\ \textcolor{stringliteral}{"{}TypeParam"{}};}
\DoxyCodeLine{03331\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ kValueParamLabel[]\ =\ \textcolor{stringliteral}{"{}GetParam()"{}};}
\DoxyCodeLine{03332\ }
\DoxyCodeLine{03333\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ PrintFullTestCommentIfPresent(\textcolor{keyword}{const}\ TestInfo\&\ test\_info)\ \{}
\DoxyCodeLine{03334\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \textcolor{keyword}{const}\ type\_param\ =\ test\_info.type\_param();}
\DoxyCodeLine{03335\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \textcolor{keyword}{const}\ value\_param\ =\ test\_info.value\_param();}
\DoxyCodeLine{03336\ }
\DoxyCodeLine{03337\ \ \ \textcolor{keywordflow}{if}\ (type\_param\ !=\ \textcolor{keyword}{nullptr}\ ||\ value\_param\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{03338\ \ \ \ \ printf(\textcolor{stringliteral}{"{},\ where\ "{}});}
\DoxyCodeLine{03339\ \ \ \ \ \textcolor{keywordflow}{if}\ (type\_param\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{03340\ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\%s\ =\ \%s"{}},\ kTypeParamLabel,\ type\_param);}
\DoxyCodeLine{03341\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (value\_param\ !=\ \textcolor{keyword}{nullptr})\ printf(\textcolor{stringliteral}{"{}\ and\ "{}});}
\DoxyCodeLine{03342\ \ \ \ \ \}}
\DoxyCodeLine{03343\ \ \ \ \ \textcolor{keywordflow}{if}\ (value\_param\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{03344\ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\%s\ =\ \%s"{}},\ kValueParamLabel,\ value\_param);}
\DoxyCodeLine{03345\ \ \ \ \ \}}
\DoxyCodeLine{03346\ \ \ \}}
\DoxyCodeLine{03347\ \}}
\DoxyCodeLine{03348\ }
\DoxyCodeLine{03349\ \textcolor{comment}{//\ This\ class\ implements\ the\ TestEventListener\ interface.}}
\DoxyCodeLine{03350\ \textcolor{comment}{//}}
\DoxyCodeLine{03351\ \textcolor{comment}{//\ Class\ PrettyUnitTestResultPrinter\ is\ copyable.}}
\DoxyCodeLine{03352\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classtesting_1_1internal_1_1_pretty_unit_test_result_printer}{PrettyUnitTestResultPrinter}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classtesting_1_1_test_event_listener}{TestEventListener}}\ \{}
\DoxyCodeLine{03353\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{03354\ \ \ \mbox{\hyperlink{classtesting_1_1internal_1_1_pretty_unit_test_result_printer}{PrettyUnitTestResultPrinter}}()\ \{\}}
\DoxyCodeLine{03355\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ PrintTestName(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ test\_suite,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ test)\ \{}
\DoxyCodeLine{03356\ \ \ \ \ printf(\textcolor{stringliteral}{"{}\%s.\%s"{}},\ test\_suite,\ test);}
\DoxyCodeLine{03357\ \ \ \}}
\DoxyCodeLine{03358\ }
\DoxyCodeLine{03359\ \ \ \textcolor{comment}{//\ The\ following\ methods\ override\ what's\ in\ the\ TestEventListener\ class.}}
\DoxyCodeLine{03360\ \ \ \textcolor{keywordtype}{void}\ OnTestProgramStart(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_unit_test}{UnitTest}}\&\ \textcolor{comment}{/*unit\_test*/})\textcolor{keyword}{\ override\ }\{\}}
\DoxyCodeLine{03361\ \ \ \textcolor{keywordtype}{void}\ OnTestIterationStart(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_unit_test}{UnitTest}}\&\ unit\_test,\ \textcolor{keywordtype}{int}\ iteration)\ \textcolor{keyword}{override};}
\DoxyCodeLine{03362\ \ \ \textcolor{keywordtype}{void}\ OnEnvironmentsSetUpStart(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_unit_test}{UnitTest}}\&\ unit\_test)\ \textcolor{keyword}{override};}
\DoxyCodeLine{03363\ \ \ \textcolor{keywordtype}{void}\ OnEnvironmentsSetUpEnd(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_unit_test}{UnitTest}}\&\ \textcolor{comment}{/*unit\_test*/})\textcolor{keyword}{\ override\ }\{\}}
\DoxyCodeLine{03364\ \textcolor{preprocessor}{\#ifndef\ GTEST\_REMOVE\_LEGACY\_TEST\_CASEAPI\_}}
\DoxyCodeLine{03365\ \ \ \textcolor{keywordtype}{void}\ OnTestCaseStart(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_test_suite}{TestCase}}\&\ test\_case)\ \textcolor{keyword}{override};}
\DoxyCodeLine{03366\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03367\ \ \ \textcolor{keywordtype}{void}\ OnTestSuiteStart(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_test_suite}{TestSuite}}\&\ test\_suite)\ \textcolor{keyword}{override};}
\DoxyCodeLine{03368\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OnTestCaseStart}}
\DoxyCodeLine{03369\ }
\DoxyCodeLine{03370\ \ \ \textcolor{keywordtype}{void}\ OnTestStart(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_test_info}{TestInfo}}\&\ test\_info)\ \textcolor{keyword}{override};}
\DoxyCodeLine{03371\ \ \ \textcolor{keywordtype}{void}\ OnTestDisabled(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_test_info}{TestInfo}}\&\ test\_info)\ \textcolor{keyword}{override};}
\DoxyCodeLine{03372\ }
\DoxyCodeLine{03373\ \ \ \textcolor{keywordtype}{void}\ OnTestPartResult(\textcolor{keyword}{const}\ TestPartResult\&\ result)\ \textcolor{keyword}{override};}
\DoxyCodeLine{03374\ \ \ \textcolor{keywordtype}{void}\ OnTestEnd(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_test_info}{TestInfo}}\&\ test\_info)\ \textcolor{keyword}{override};}
\DoxyCodeLine{03375\ \textcolor{preprocessor}{\#ifndef\ GTEST\_REMOVE\_LEGACY\_TEST\_CASEAPI\_}}
\DoxyCodeLine{03376\ \ \ \textcolor{keywordtype}{void}\ OnTestCaseEnd(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_test_suite}{TestCase}}\&\ test\_case)\ \textcolor{keyword}{override};}
\DoxyCodeLine{03377\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03378\ \ \ \textcolor{keywordtype}{void}\ OnTestSuiteEnd(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_test_suite}{TestSuite}}\&\ test\_suite)\ \textcolor{keyword}{override};}
\DoxyCodeLine{03379\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GTEST\_REMOVE\_LEGACY\_TEST\_CASEAPI\_}}
\DoxyCodeLine{03380\ }
\DoxyCodeLine{03381\ \ \ \textcolor{keywordtype}{void}\ OnEnvironmentsTearDownStart(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_unit_test}{UnitTest}}\&\ unit\_test)\ \textcolor{keyword}{override};}
\DoxyCodeLine{03382\ \ \ \textcolor{keywordtype}{void}\ OnEnvironmentsTearDownEnd(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_unit_test}{UnitTest}}\&\ \textcolor{comment}{/*unit\_test*/})\textcolor{keyword}{\ override\ }\{\}}
\DoxyCodeLine{03383\ \ \ \textcolor{keywordtype}{void}\ OnTestIterationEnd(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_unit_test}{UnitTest}}\&\ unit\_test,\ \textcolor{keywordtype}{int}\ iteration)\ \textcolor{keyword}{override};}
\DoxyCodeLine{03384\ \ \ \textcolor{keywordtype}{void}\ OnTestProgramEnd(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_unit_test}{UnitTest}}\&\ \textcolor{comment}{/*unit\_test*/})\textcolor{keyword}{\ override\ }\{\}}
\DoxyCodeLine{03385\ }
\DoxyCodeLine{03386\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{03387\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ PrintFailedTests(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_unit_test}{UnitTest}}\&\ unit\_test);}
\DoxyCodeLine{03388\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ PrintFailedTestSuites(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_unit_test}{UnitTest}}\&\ unit\_test);}
\DoxyCodeLine{03389\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ PrintSkippedTests(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_unit_test}{UnitTest}}\&\ unit\_test);}
\DoxyCodeLine{03390\ \};}
\DoxyCodeLine{03391\ }
\DoxyCodeLine{03392\ \textcolor{comment}{//\ Fired\ before\ each\ iteration\ of\ tests\ starts.}}
\DoxyCodeLine{03393\ \textcolor{keywordtype}{void}\ PrettyUnitTestResultPrinter::OnTestIterationStart(}
\DoxyCodeLine{03394\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_unit_test}{UnitTest}}\&\ unit\_test,\ \textcolor{keywordtype}{int}\ iteration)\ \{}
\DoxyCodeLine{03395\ \ \ \textcolor{keywordflow}{if}\ (GTEST\_FLAG\_GET(repeat)\ !=\ 1)}
\DoxyCodeLine{03396\ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)nRepeating\ all\ tests\ (iteration\ \%d)\ .\ .\ .\(\backslash\)n\(\backslash\)n"{}},\ iteration\ +\ 1);}
\DoxyCodeLine{03397\ }
\DoxyCodeLine{03398\ \ \ std::string\ f\ =\ GTEST\_FLAG\_GET(filter);}
\DoxyCodeLine{03399\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \textcolor{keyword}{const}\ filter\ =\ f.c\_str();}
\DoxyCodeLine{03400\ }
\DoxyCodeLine{03401\ \ \ \textcolor{comment}{//\ Prints\ the\ filter\ if\ it's\ not\ *.\ \ This\ reminds\ the\ user\ that\ some}}
\DoxyCodeLine{03402\ \ \ \textcolor{comment}{//\ tests\ may\ be\ skipped.}}
\DoxyCodeLine{03403\ \ \ \textcolor{keywordflow}{if}\ (!String::CStringEquals(filter,\ kUniversalFilter))\ \{}
\DoxyCodeLine{03404\ \ \ \ \ ColoredPrintf(GTestColor::kYellow,\ \textcolor{stringliteral}{"{}Note:\ \%s\ filter\ =\ \%s\(\backslash\)n"{}},\ GTEST\_NAME\_,}
\DoxyCodeLine{03405\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ filter);}
\DoxyCodeLine{03406\ \ \ \}}
\DoxyCodeLine{03407\ }
\DoxyCodeLine{03408\ \ \ \textcolor{keywordflow}{if}\ (internal::ShouldShard(kTestTotalShards,\ kTestShardIndex,\ \textcolor{keyword}{false}))\ \{}
\DoxyCodeLine{03409\ \ \ \ \ \textcolor{keyword}{const}\ int32\_t\ shard\_index\ =\ Int32FromEnvOrDie(kTestShardIndex,\ -\/1);}
\DoxyCodeLine{03410\ \ \ \ \ ColoredPrintf(GTestColor::kYellow,\ \textcolor{stringliteral}{"{}Note:\ This\ is\ test\ shard\ \%d\ of\ \%s.\(\backslash\)n"{}},}
\DoxyCodeLine{03411\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(shard\_index)\ +\ 1,}
\DoxyCodeLine{03412\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ internal::posix::GetEnv(kTestTotalShards));}
\DoxyCodeLine{03413\ \ \ \}}
\DoxyCodeLine{03414\ }
\DoxyCodeLine{03415\ \ \ \textcolor{keywordflow}{if}\ (GTEST\_FLAG\_GET(shuffle))\ \{}
\DoxyCodeLine{03416\ \ \ \ \ ColoredPrintf(GTestColor::kYellow,}
\DoxyCodeLine{03417\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Note:\ Randomizing\ tests'\ orders\ with\ a\ seed\ of\ \%d\ .\(\backslash\)n"{}},}
\DoxyCodeLine{03418\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ unit\_test.random\_seed());}
\DoxyCodeLine{03419\ \ \ \}}
\DoxyCodeLine{03420\ }
\DoxyCodeLine{03421\ \ \ ColoredPrintf(GTestColor::kGreen,\ \textcolor{stringliteral}{"{}[==========]\ "{}});}
\DoxyCodeLine{03422\ \ \ printf(\textcolor{stringliteral}{"{}Running\ \%s\ from\ \%s.\(\backslash\)n"{}},}
\DoxyCodeLine{03423\ \ \ \ \ \ \ \ \ \ FormatTestCount(unit\_test.test\_to\_run\_count()).c\_str(),}
\DoxyCodeLine{03424\ \ \ \ \ \ \ \ \ \ FormatTestSuiteCount(unit\_test.test\_suite\_to\_run\_count()).c\_str());}
\DoxyCodeLine{03425\ \ \ fflush(stdout);}
\DoxyCodeLine{03426\ \}}
\DoxyCodeLine{03427\ }
\DoxyCodeLine{03428\ \textcolor{keywordtype}{void}\ PrettyUnitTestResultPrinter::OnEnvironmentsSetUpStart(}
\DoxyCodeLine{03429\ \ \ \ \ \textcolor{keyword}{const}\ UnitTest\&\ \textcolor{comment}{/*unit\_test*/})\ \{}
\DoxyCodeLine{03430\ \ \ ColoredPrintf(GTestColor::kGreen,\ \textcolor{stringliteral}{"{}[-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/]\ "{}});}
\DoxyCodeLine{03431\ \ \ printf(\textcolor{stringliteral}{"{}Global\ test\ environment\ set-\/up.\(\backslash\)n"{}});}
\DoxyCodeLine{03432\ \ \ fflush(stdout);}
\DoxyCodeLine{03433\ \}}
\DoxyCodeLine{03434\ }
\DoxyCodeLine{03435\ \textcolor{preprocessor}{\#ifndef\ GTEST\_REMOVE\_LEGACY\_TEST\_CASEAPI\_}}
\DoxyCodeLine{03436\ \textcolor{keywordtype}{void}\ PrettyUnitTestResultPrinter::OnTestCaseStart(\textcolor{keyword}{const}\ TestCase\&\ test\_case)\ \{}
\DoxyCodeLine{03437\ \ \ \textcolor{keyword}{const}\ std::string\ counts\ =}
\DoxyCodeLine{03438\ \ \ \ \ \ \ FormatCountableNoun(test\_case.test\_to\_run\_count(),\ \textcolor{stringliteral}{"{}test"{}},\ \textcolor{stringliteral}{"{}tests"{}});}
\DoxyCodeLine{03439\ \ \ ColoredPrintf(GTestColor::kGreen,\ \textcolor{stringliteral}{"{}[-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/]\ "{}});}
\DoxyCodeLine{03440\ \ \ printf(\textcolor{stringliteral}{"{}\%s\ from\ \%s"{}},\ counts.c\_str(),\ test\_case.name());}
\DoxyCodeLine{03441\ \ \ \textcolor{keywordflow}{if}\ (test\_case.type\_param()\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{03442\ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{03443\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03444\ \ \ \ \ printf(\textcolor{stringliteral}{"{},\ where\ \%s\ =\ \%s\(\backslash\)n"{}},\ kTypeParamLabel,\ test\_case.type\_param());}
\DoxyCodeLine{03445\ \ \ \}}
\DoxyCodeLine{03446\ \ \ fflush(stdout);}
\DoxyCodeLine{03447\ \}}
\DoxyCodeLine{03448\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03449\ \textcolor{keywordtype}{void}\ PrettyUnitTestResultPrinter::OnTestSuiteStart(}
\DoxyCodeLine{03450\ \ \ \ \ \textcolor{keyword}{const}\ TestSuite\&\ test\_suite)\ \{}
\DoxyCodeLine{03451\ \ \ \textcolor{keyword}{const}\ std::string\ counts\ =}
\DoxyCodeLine{03452\ \ \ \ \ \ \ FormatCountableNoun(test\_suite.test\_to\_run\_count(),\ \textcolor{stringliteral}{"{}test"{}},\ \textcolor{stringliteral}{"{}tests"{}});}
\DoxyCodeLine{03453\ \ \ ColoredPrintf(GTestColor::kGreen,\ \textcolor{stringliteral}{"{}[-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/]\ "{}});}
\DoxyCodeLine{03454\ \ \ printf(\textcolor{stringliteral}{"{}\%s\ from\ \%s"{}},\ counts.c\_str(),\ test\_suite.name());}
\DoxyCodeLine{03455\ \ \ \textcolor{keywordflow}{if}\ (test\_suite.type\_param()\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{03456\ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{03457\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03458\ \ \ \ \ printf(\textcolor{stringliteral}{"{},\ where\ \%s\ =\ \%s\(\backslash\)n"{}},\ kTypeParamLabel,\ test\_suite.type\_param());}
\DoxyCodeLine{03459\ \ \ \}}
\DoxyCodeLine{03460\ \ \ fflush(stdout);}
\DoxyCodeLine{03461\ \}}
\DoxyCodeLine{03462\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GTEST\_REMOVE\_LEGACY\_TEST\_CASEAPI\_}}
\DoxyCodeLine{03463\ }
\DoxyCodeLine{03464\ \textcolor{keywordtype}{void}\ PrettyUnitTestResultPrinter::OnTestStart(\textcolor{keyword}{const}\ TestInfo\&\ test\_info)\ \{}
\DoxyCodeLine{03465\ \ \ ColoredPrintf(GTestColor::kGreen,\ \textcolor{stringliteral}{"{}[\ RUN\ \ \ \ \ \ ]\ "{}});}
\DoxyCodeLine{03466\ \ \ PrintTestName(test\_info.test\_suite\_name(),\ test\_info.name());}
\DoxyCodeLine{03467\ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{03468\ \ \ fflush(stdout);}
\DoxyCodeLine{03469\ \}}
\DoxyCodeLine{03470\ }
\DoxyCodeLine{03471\ \textcolor{keywordtype}{void}\ PrettyUnitTestResultPrinter::OnTestDisabled(\textcolor{keyword}{const}\ TestInfo\&\ test\_info)\ \{}
\DoxyCodeLine{03472\ \ \ ColoredPrintf(GTestColor::kYellow,\ \textcolor{stringliteral}{"{}[\ DISABLED\ ]\ "{}});}
\DoxyCodeLine{03473\ \ \ PrintTestName(test\_info.test\_suite\_name(),\ test\_info.name());}
\DoxyCodeLine{03474\ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{03475\ \ \ fflush(stdout);}
\DoxyCodeLine{03476\ \}}
\DoxyCodeLine{03477\ }
\DoxyCodeLine{03478\ \textcolor{comment}{//\ Called\ after\ an\ assertion\ failure.}}
\DoxyCodeLine{03479\ \textcolor{keywordtype}{void}\ PrettyUnitTestResultPrinter::OnTestPartResult(}
\DoxyCodeLine{03480\ \ \ \ \ \textcolor{keyword}{const}\ TestPartResult\&\ result)\ \{}
\DoxyCodeLine{03481\ \ \ \textcolor{keywordflow}{switch}\ (result.type())\ \{}
\DoxyCodeLine{03482\ \ \ \ \ \textcolor{comment}{//\ If\ the\ test\ part\ succeeded,\ we\ don't\ need\ to\ do\ anything.}}
\DoxyCodeLine{03483\ \ \ \ \ \textcolor{keywordflow}{case}\ TestPartResult::kSuccess:}
\DoxyCodeLine{03484\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{03485\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{03486\ \ \ \ \ \ \ \textcolor{comment}{//\ Print\ failure\ message\ from\ the\ assertion}}
\DoxyCodeLine{03487\ \ \ \ \ \ \ \textcolor{comment}{//\ (e.g.\ expected\ this\ and\ got\ that).}}
\DoxyCodeLine{03488\ \ \ \ \ \ \ PrintTestPartResult(result);}
\DoxyCodeLine{03489\ \ \ \ \ \ \ fflush(stdout);}
\DoxyCodeLine{03490\ \ \ \}}
\DoxyCodeLine{03491\ \}}
\DoxyCodeLine{03492\ }
\DoxyCodeLine{03493\ \textcolor{keywordtype}{void}\ PrettyUnitTestResultPrinter::OnTestEnd(\textcolor{keyword}{const}\ TestInfo\&\ test\_info)\ \{}
\DoxyCodeLine{03494\ \ \ \textcolor{keywordflow}{if}\ (test\_info.result()-\/>Passed())\ \{}
\DoxyCodeLine{03495\ \ \ \ \ ColoredPrintf(GTestColor::kGreen,\ \textcolor{stringliteral}{"{}[\ \ \ \ \ \ \ OK\ ]\ "{}});}
\DoxyCodeLine{03496\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (test\_info.result()-\/>Skipped())\ \{}
\DoxyCodeLine{03497\ \ \ \ \ ColoredPrintf(GTestColor::kGreen,\ \textcolor{stringliteral}{"{}[\ \ SKIPPED\ ]\ "{}});}
\DoxyCodeLine{03498\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03499\ \ \ \ \ ColoredPrintf(GTestColor::kRed,\ \textcolor{stringliteral}{"{}[\ \ FAILED\ \ ]\ "{}});}
\DoxyCodeLine{03500\ \ \ \}}
\DoxyCodeLine{03501\ \ \ PrintTestName(test\_info.test\_suite\_name(),\ test\_info.name());}
\DoxyCodeLine{03502\ \ \ \textcolor{keywordflow}{if}\ (test\_info.result()-\/>Failed())\ PrintFullTestCommentIfPresent(test\_info);}
\DoxyCodeLine{03503\ }
\DoxyCodeLine{03504\ \ \ \textcolor{keywordflow}{if}\ (GTEST\_FLAG\_GET(print\_time))\ \{}
\DoxyCodeLine{03505\ \ \ \ \ printf(\textcolor{stringliteral}{"{}\ (\%s\ ms)\(\backslash\)n"{}},}
\DoxyCodeLine{03506\ \ \ \ \ \ \ \ \ \ \ \ internal::StreamableToString(test\_info.result()-\/>elapsed\_time())}
\DoxyCodeLine{03507\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ .c\_str());}
\DoxyCodeLine{03508\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03509\ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{03510\ \ \ \}}
\DoxyCodeLine{03511\ \ \ fflush(stdout);}
\DoxyCodeLine{03512\ \}}
\DoxyCodeLine{03513\ }
\DoxyCodeLine{03514\ \textcolor{preprocessor}{\#ifndef\ GTEST\_REMOVE\_LEGACY\_TEST\_CASEAPI\_}}
\DoxyCodeLine{03515\ \textcolor{keywordtype}{void}\ PrettyUnitTestResultPrinter::OnTestCaseEnd(\textcolor{keyword}{const}\ TestCase\&\ test\_case)\ \{}
\DoxyCodeLine{03516\ \ \ \textcolor{keywordflow}{if}\ (!GTEST\_FLAG\_GET(print\_time))\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{03517\ }
\DoxyCodeLine{03518\ \ \ \textcolor{keyword}{const}\ std::string\ counts\ =}
\DoxyCodeLine{03519\ \ \ \ \ \ \ FormatCountableNoun(test\_case.test\_to\_run\_count(),\ \textcolor{stringliteral}{"{}test"{}},\ \textcolor{stringliteral}{"{}tests"{}});}
\DoxyCodeLine{03520\ \ \ ColoredPrintf(GTestColor::kGreen,\ \textcolor{stringliteral}{"{}[-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/]\ "{}});}
\DoxyCodeLine{03521\ \ \ printf(\textcolor{stringliteral}{"{}\%s\ from\ \%s\ (\%s\ ms\ total)\(\backslash\)n\(\backslash\)n"{}},\ counts.c\_str(),\ test\_case.name(),}
\DoxyCodeLine{03522\ \ \ \ \ \ \ \ \ \ internal::StreamableToString(test\_case.elapsed\_time()).c\_str());}
\DoxyCodeLine{03523\ \ \ fflush(stdout);}
\DoxyCodeLine{03524\ \}}
\DoxyCodeLine{03525\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03526\ \textcolor{keywordtype}{void}\ PrettyUnitTestResultPrinter::OnTestSuiteEnd(\textcolor{keyword}{const}\ TestSuite\&\ test\_suite)\ \{}
\DoxyCodeLine{03527\ \ \ \textcolor{keywordflow}{if}\ (!GTEST\_FLAG\_GET(print\_time))\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{03528\ }
\DoxyCodeLine{03529\ \ \ \textcolor{keyword}{const}\ std::string\ counts\ =}
\DoxyCodeLine{03530\ \ \ \ \ \ \ FormatCountableNoun(test\_suite.test\_to\_run\_count(),\ \textcolor{stringliteral}{"{}test"{}},\ \textcolor{stringliteral}{"{}tests"{}});}
\DoxyCodeLine{03531\ \ \ ColoredPrintf(GTestColor::kGreen,\ \textcolor{stringliteral}{"{}[-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/]\ "{}});}
\DoxyCodeLine{03532\ \ \ printf(\textcolor{stringliteral}{"{}\%s\ from\ \%s\ (\%s\ ms\ total)\(\backslash\)n\(\backslash\)n"{}},\ counts.c\_str(),\ test\_suite.name(),}
\DoxyCodeLine{03533\ \ \ \ \ \ \ \ \ \ internal::StreamableToString(test\_suite.elapsed\_time()).c\_str());}
\DoxyCodeLine{03534\ \ \ fflush(stdout);}
\DoxyCodeLine{03535\ \}}
\DoxyCodeLine{03536\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GTEST\_REMOVE\_LEGACY\_TEST\_CASEAPI\_}}
\DoxyCodeLine{03537\ }
\DoxyCodeLine{03538\ \textcolor{keywordtype}{void}\ PrettyUnitTestResultPrinter::OnEnvironmentsTearDownStart(}
\DoxyCodeLine{03539\ \ \ \ \ \textcolor{keyword}{const}\ UnitTest\&\ \textcolor{comment}{/*unit\_test*/})\ \{}
\DoxyCodeLine{03540\ \ \ ColoredPrintf(GTestColor::kGreen,\ \textcolor{stringliteral}{"{}[-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/]\ "{}});}
\DoxyCodeLine{03541\ \ \ printf(\textcolor{stringliteral}{"{}Global\ test\ environment\ tear-\/down\(\backslash\)n"{}});}
\DoxyCodeLine{03542\ \ \ fflush(stdout);}
\DoxyCodeLine{03543\ \}}
\DoxyCodeLine{03544\ }
\DoxyCodeLine{03545\ \textcolor{comment}{//\ Internal\ helper\ for\ printing\ the\ list\ of\ failed\ tests.}}
\DoxyCodeLine{03546\ \textcolor{keywordtype}{void}\ PrettyUnitTestResultPrinter::PrintFailedTests(\textcolor{keyword}{const}\ UnitTest\&\ unit\_test)\ \{}
\DoxyCodeLine{03547\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ failed\_test\_count\ =\ unit\_test.failed\_test\_count();}
\DoxyCodeLine{03548\ \ \ ColoredPrintf(GTestColor::kRed,\ \textcolor{stringliteral}{"{}[\ \ FAILED\ \ ]\ "{}});}
\DoxyCodeLine{03549\ \ \ printf(\textcolor{stringliteral}{"{}\%s,\ listed\ below:\(\backslash\)n"{}},\ FormatTestCount(failed\_test\_count).c\_str());}
\DoxyCodeLine{03550\ }
\DoxyCodeLine{03551\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ unit\_test.total\_test\_suite\_count();\ ++i)\ \{}
\DoxyCodeLine{03552\ \ \ \ \ \textcolor{keyword}{const}\ TestSuite\&\ test\_suite\ =\ *unit\_test.GetTestSuite(i);}
\DoxyCodeLine{03553\ \ \ \ \ \textcolor{keywordflow}{if}\ (!test\_suite.should\_run()\ ||\ (test\_suite.failed\_test\_count()\ ==\ 0))\ \{}
\DoxyCodeLine{03554\ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{03555\ \ \ \ \ \}}
\DoxyCodeLine{03556\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ test\_suite.total\_test\_count();\ ++j)\ \{}
\DoxyCodeLine{03557\ \ \ \ \ \ \ \textcolor{keyword}{const}\ TestInfo\&\ test\_info\ =\ *test\_suite.GetTestInfo(j);}
\DoxyCodeLine{03558\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!test\_info.should\_run()\ ||\ !test\_info.result()-\/>Failed())\ \{}
\DoxyCodeLine{03559\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{03560\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03561\ \ \ \ \ \ \ ColoredPrintf(GTestColor::kRed,\ \textcolor{stringliteral}{"{}[\ \ FAILED\ \ ]\ "{}});}
\DoxyCodeLine{03562\ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\%s.\%s"{}},\ test\_suite.name(),\ test\_info.name());}
\DoxyCodeLine{03563\ \ \ \ \ \ \ PrintFullTestCommentIfPresent(test\_info);}
\DoxyCodeLine{03564\ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{03565\ \ \ \ \ \}}
\DoxyCodeLine{03566\ \ \ \}}
\DoxyCodeLine{03567\ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n\%2d\ FAILED\ \%s\(\backslash\)n"{}},\ failed\_test\_count,}
\DoxyCodeLine{03568\ \ \ \ \ \ \ \ \ \ failed\_test\_count\ ==\ 1\ ?\ \textcolor{stringliteral}{"{}TEST"{}}\ :\ \textcolor{stringliteral}{"{}TESTS"{}});}
\DoxyCodeLine{03569\ \}}
\DoxyCodeLine{03570\ }
\DoxyCodeLine{03571\ \textcolor{comment}{//\ Internal\ helper\ for\ printing\ the\ list\ of\ test\ suite\ failures\ not\ covered\ by}}
\DoxyCodeLine{03572\ \textcolor{comment}{//\ PrintFailedTests.}}
\DoxyCodeLine{03573\ \textcolor{keywordtype}{void}\ PrettyUnitTestResultPrinter::PrintFailedTestSuites(}
\DoxyCodeLine{03574\ \ \ \ \ \textcolor{keyword}{const}\ UnitTest\&\ unit\_test)\ \{}
\DoxyCodeLine{03575\ \ \ \textcolor{keywordtype}{int}\ suite\_failure\_count\ =\ 0;}
\DoxyCodeLine{03576\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ unit\_test.total\_test\_suite\_count();\ ++i)\ \{}
\DoxyCodeLine{03577\ \ \ \ \ \textcolor{keyword}{const}\ TestSuite\&\ test\_suite\ =\ *unit\_test.GetTestSuite(i);}
\DoxyCodeLine{03578\ \ \ \ \ \textcolor{keywordflow}{if}\ (!test\_suite.should\_run())\ \{}
\DoxyCodeLine{03579\ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{03580\ \ \ \ \ \}}
\DoxyCodeLine{03581\ \ \ \ \ \textcolor{keywordflow}{if}\ (test\_suite.ad\_hoc\_test\_result().Failed())\ \{}
\DoxyCodeLine{03582\ \ \ \ \ \ \ ColoredPrintf(GTestColor::kRed,\ \textcolor{stringliteral}{"{}[\ \ FAILED\ \ ]\ "{}});}
\DoxyCodeLine{03583\ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\%s:\ SetUpTestSuite\ or\ TearDownTestSuite\(\backslash\)n"{}},\ test\_suite.name());}
\DoxyCodeLine{03584\ \ \ \ \ \ \ ++suite\_failure\_count;}
\DoxyCodeLine{03585\ \ \ \ \ \}}
\DoxyCodeLine{03586\ \ \ \}}
\DoxyCodeLine{03587\ \ \ \textcolor{keywordflow}{if}\ (suite\_failure\_count\ >\ 0)\ \{}
\DoxyCodeLine{03588\ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n\%2d\ FAILED\ TEST\ \%s\(\backslash\)n"{}},\ suite\_failure\_count,}
\DoxyCodeLine{03589\ \ \ \ \ \ \ \ \ \ \ \ suite\_failure\_count\ ==\ 1\ ?\ \textcolor{stringliteral}{"{}SUITE"{}}\ :\ \textcolor{stringliteral}{"{}SUITES"{}});}
\DoxyCodeLine{03590\ \ \ \}}
\DoxyCodeLine{03591\ \}}
\DoxyCodeLine{03592\ }
\DoxyCodeLine{03593\ \textcolor{comment}{//\ Internal\ helper\ for\ printing\ the\ list\ of\ skipped\ tests.}}
\DoxyCodeLine{03594\ \textcolor{keywordtype}{void}\ PrettyUnitTestResultPrinter::PrintSkippedTests(\textcolor{keyword}{const}\ UnitTest\&\ unit\_test)\ \{}
\DoxyCodeLine{03595\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ skipped\_test\_count\ =\ unit\_test.skipped\_test\_count();}
\DoxyCodeLine{03596\ \ \ \textcolor{keywordflow}{if}\ (skipped\_test\_count\ ==\ 0)\ \{}
\DoxyCodeLine{03597\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{03598\ \ \ \}}
\DoxyCodeLine{03599\ }
\DoxyCodeLine{03600\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ unit\_test.total\_test\_suite\_count();\ ++i)\ \{}
\DoxyCodeLine{03601\ \ \ \ \ \textcolor{keyword}{const}\ TestSuite\&\ test\_suite\ =\ *unit\_test.GetTestSuite(i);}
\DoxyCodeLine{03602\ \ \ \ \ \textcolor{keywordflow}{if}\ (!test\_suite.should\_run()\ ||\ (test\_suite.skipped\_test\_count()\ ==\ 0))\ \{}
\DoxyCodeLine{03603\ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{03604\ \ \ \ \ \}}
\DoxyCodeLine{03605\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ test\_suite.total\_test\_count();\ ++j)\ \{}
\DoxyCodeLine{03606\ \ \ \ \ \ \ \textcolor{keyword}{const}\ TestInfo\&\ test\_info\ =\ *test\_suite.GetTestInfo(j);}
\DoxyCodeLine{03607\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!test\_info.should\_run()\ ||\ !test\_info.result()-\/>Skipped())\ \{}
\DoxyCodeLine{03608\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{03609\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03610\ \ \ \ \ \ \ ColoredPrintf(GTestColor::kGreen,\ \textcolor{stringliteral}{"{}[\ \ SKIPPED\ ]\ "{}});}
\DoxyCodeLine{03611\ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\%s.\%s"{}},\ test\_suite.name(),\ test\_info.name());}
\DoxyCodeLine{03612\ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{03613\ \ \ \ \ \}}
\DoxyCodeLine{03614\ \ \ \}}
\DoxyCodeLine{03615\ \}}
\DoxyCodeLine{03616\ }
\DoxyCodeLine{03617\ \textcolor{keywordtype}{void}\ PrettyUnitTestResultPrinter::OnTestIterationEnd(\textcolor{keyword}{const}\ UnitTest\&\ unit\_test,}
\DoxyCodeLine{03618\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \textcolor{comment}{/*iteration*/})\ \{}
\DoxyCodeLine{03619\ \ \ ColoredPrintf(GTestColor::kGreen,\ \textcolor{stringliteral}{"{}[==========]\ "{}});}
\DoxyCodeLine{03620\ \ \ printf(\textcolor{stringliteral}{"{}\%s\ from\ \%s\ ran."{}},}
\DoxyCodeLine{03621\ \ \ \ \ \ \ \ \ \ FormatTestCount(unit\_test.test\_to\_run\_count()).c\_str(),}
\DoxyCodeLine{03622\ \ \ \ \ \ \ \ \ \ FormatTestSuiteCount(unit\_test.test\_suite\_to\_run\_count()).c\_str());}
\DoxyCodeLine{03623\ \ \ \textcolor{keywordflow}{if}\ (GTEST\_FLAG\_GET(print\_time))\ \{}
\DoxyCodeLine{03624\ \ \ \ \ printf(\textcolor{stringliteral}{"{}\ (\%s\ ms\ total)"{}},}
\DoxyCodeLine{03625\ \ \ \ \ \ \ \ \ \ \ \ internal::StreamableToString(unit\_test.elapsed\_time()).c\_str());}
\DoxyCodeLine{03626\ \ \ \}}
\DoxyCodeLine{03627\ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{03628\ \ \ ColoredPrintf(GTestColor::kGreen,\ \textcolor{stringliteral}{"{}[\ \ PASSED\ \ ]\ "{}});}
\DoxyCodeLine{03629\ \ \ printf(\textcolor{stringliteral}{"{}\%s.\(\backslash\)n"{}},\ FormatTestCount(unit\_test.successful\_test\_count()).c\_str());}
\DoxyCodeLine{03630\ }
\DoxyCodeLine{03631\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ skipped\_test\_count\ =\ unit\_test.skipped\_test\_count();}
\DoxyCodeLine{03632\ \ \ \textcolor{keywordflow}{if}\ (skipped\_test\_count\ >\ 0)\ \{}
\DoxyCodeLine{03633\ \ \ \ \ ColoredPrintf(GTestColor::kGreen,\ \textcolor{stringliteral}{"{}[\ \ SKIPPED\ ]\ "{}});}
\DoxyCodeLine{03634\ \ \ \ \ printf(\textcolor{stringliteral}{"{}\%s,\ listed\ below:\(\backslash\)n"{}},\ FormatTestCount(skipped\_test\_count).c\_str());}
\DoxyCodeLine{03635\ \ \ \ \ PrintSkippedTests(unit\_test);}
\DoxyCodeLine{03636\ \ \ \}}
\DoxyCodeLine{03637\ }
\DoxyCodeLine{03638\ \ \ \textcolor{keywordflow}{if}\ (!unit\_test.Passed())\ \{}
\DoxyCodeLine{03639\ \ \ \ \ PrintFailedTests(unit\_test);}
\DoxyCodeLine{03640\ \ \ \ \ PrintFailedTestSuites(unit\_test);}
\DoxyCodeLine{03641\ \ \ \}}
\DoxyCodeLine{03642\ }
\DoxyCodeLine{03643\ \ \ \textcolor{keywordtype}{int}\ num\_disabled\ =\ unit\_test.reportable\_disabled\_test\_count();}
\DoxyCodeLine{03644\ \ \ \textcolor{keywordflow}{if}\ (num\_disabled\ \&\&\ !GTEST\_FLAG\_GET(also\_run\_disabled\_tests))\ \{}
\DoxyCodeLine{03645\ \ \ \ \ \textcolor{keywordflow}{if}\ (unit\_test.Passed())\ \{}
\DoxyCodeLine{03646\ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n"{}});\ \ \textcolor{comment}{//\ Add\ a\ spacer\ if\ no\ FAILURE\ banner\ is\ displayed.}}
\DoxyCodeLine{03647\ \ \ \ \ \}}
\DoxyCodeLine{03648\ \ \ \ \ ColoredPrintf(GTestColor::kYellow,\ \textcolor{stringliteral}{"{}\ \ YOU\ HAVE\ \%d\ DISABLED\ \%s\(\backslash\)n\(\backslash\)n"{}},}
\DoxyCodeLine{03649\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ num\_disabled,\ num\_disabled\ ==\ 1\ ?\ \textcolor{stringliteral}{"{}TEST"{}}\ :\ \textcolor{stringliteral}{"{}TESTS"{}});}
\DoxyCodeLine{03650\ \ \ \}}
\DoxyCodeLine{03651\ \ \ \textcolor{comment}{//\ Ensure\ that\ Google\ Test\ output\ is\ printed\ before,\ e.g.,\ heapchecker\ output.}}
\DoxyCodeLine{03652\ \ \ fflush(stdout);}
\DoxyCodeLine{03653\ \}}
\DoxyCodeLine{03654\ }
\DoxyCodeLine{03655\ \textcolor{comment}{//\ End\ PrettyUnitTestResultPrinter}}
\DoxyCodeLine{03656\ }
\DoxyCodeLine{03657\ \textcolor{comment}{//\ This\ class\ implements\ the\ TestEventListener\ interface.}}
\DoxyCodeLine{03658\ \textcolor{comment}{//}}
\DoxyCodeLine{03659\ \textcolor{comment}{//\ Class\ BriefUnitTestResultPrinter\ is\ copyable.}}
\DoxyCodeLine{03660\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classtesting_1_1internal_1_1_brief_unit_test_result_printer}{BriefUnitTestResultPrinter}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classtesting_1_1_test_event_listener}{TestEventListener}}\ \{}
\DoxyCodeLine{03661\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{03662\ \ \ \mbox{\hyperlink{classtesting_1_1internal_1_1_brief_unit_test_result_printer}{BriefUnitTestResultPrinter}}()\ \{\}}
\DoxyCodeLine{03663\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ PrintTestName(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ test\_suite,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ test)\ \{}
\DoxyCodeLine{03664\ \ \ \ \ printf(\textcolor{stringliteral}{"{}\%s.\%s"{}},\ test\_suite,\ test);}
\DoxyCodeLine{03665\ \ \ \}}
\DoxyCodeLine{03666\ }
\DoxyCodeLine{03667\ \ \ \textcolor{comment}{//\ The\ following\ methods\ override\ what's\ in\ the\ TestEventListener\ class.}}
\DoxyCodeLine{03668\ \ \ \textcolor{keywordtype}{void}\ OnTestProgramStart(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_unit_test}{UnitTest}}\&\ \textcolor{comment}{/*unit\_test*/})\textcolor{keyword}{\ override\ }\{\}}
\DoxyCodeLine{03669\ \ \ \textcolor{keywordtype}{void}\ OnTestIterationStart(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_unit_test}{UnitTest}}\&\ \textcolor{comment}{/*unit\_test*/},}
\DoxyCodeLine{03670\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \textcolor{comment}{/*iteration*/})\textcolor{keyword}{\ override\ }\{\}}
\DoxyCodeLine{03671\ \ \ \textcolor{keywordtype}{void}\ OnEnvironmentsSetUpStart(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_unit_test}{UnitTest}}\&\ \textcolor{comment}{/*unit\_test*/})\textcolor{keyword}{\ override\ }\{\}}
\DoxyCodeLine{03672\ \ \ \textcolor{keywordtype}{void}\ OnEnvironmentsSetUpEnd(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_unit_test}{UnitTest}}\&\ \textcolor{comment}{/*unit\_test*/})\textcolor{keyword}{\ override\ }\{\}}
\DoxyCodeLine{03673\ \textcolor{preprocessor}{\#ifndef\ GTEST\_REMOVE\_LEGACY\_TEST\_CASEAPI\_}}
\DoxyCodeLine{03674\ \ \ \textcolor{keywordtype}{void}\ OnTestCaseStart(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_test_suite}{TestCase}}\&\ \textcolor{comment}{/*test\_case*/})\textcolor{keyword}{\ override\ }\{\}}
\DoxyCodeLine{03675\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03676\ \ \ \textcolor{keywordtype}{void}\ OnTestSuiteStart(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_test_suite}{TestSuite}}\&\ \textcolor{comment}{/*test\_suite*/})\textcolor{keyword}{\ override\ }\{\}}
\DoxyCodeLine{03677\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OnTestCaseStart}}
\DoxyCodeLine{03678\ }
\DoxyCodeLine{03679\ \ \ \textcolor{keywordtype}{void}\ OnTestStart(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_test_info}{TestInfo}}\&\ \textcolor{comment}{/*test\_info*/})\textcolor{keyword}{\ override\ }\{\}}
\DoxyCodeLine{03680\ \ \ \textcolor{keywordtype}{void}\ OnTestDisabled(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_test_info}{TestInfo}}\&\ \textcolor{comment}{/*test\_info*/})\textcolor{keyword}{\ override\ }\{\}}
\DoxyCodeLine{03681\ }
\DoxyCodeLine{03682\ \ \ \textcolor{keywordtype}{void}\ OnTestPartResult(\textcolor{keyword}{const}\ TestPartResult\&\ result)\ \textcolor{keyword}{override};}
\DoxyCodeLine{03683\ \ \ \textcolor{keywordtype}{void}\ OnTestEnd(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_test_info}{TestInfo}}\&\ test\_info)\ \textcolor{keyword}{override};}
\DoxyCodeLine{03684\ \textcolor{preprocessor}{\#ifndef\ GTEST\_REMOVE\_LEGACY\_TEST\_CASEAPI\_}}
\DoxyCodeLine{03685\ \ \ \textcolor{keywordtype}{void}\ OnTestCaseEnd(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_test_suite}{TestCase}}\&\ \textcolor{comment}{/*test\_case*/})\textcolor{keyword}{\ override\ }\{\}}
\DoxyCodeLine{03686\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03687\ \ \ \textcolor{keywordtype}{void}\ OnTestSuiteEnd(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_test_suite}{TestSuite}}\&\ \textcolor{comment}{/*test\_suite*/})\textcolor{keyword}{\ override\ }\{\}}
\DoxyCodeLine{03688\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GTEST\_REMOVE\_LEGACY\_TEST\_CASEAPI\_}}
\DoxyCodeLine{03689\ }
\DoxyCodeLine{03690\ \ \ \textcolor{keywordtype}{void}\ OnEnvironmentsTearDownStart(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_unit_test}{UnitTest}}\&\ \textcolor{comment}{/*unit\_test*/})\textcolor{keyword}{\ override\ }\{\}}
\DoxyCodeLine{03691\ \ \ \textcolor{keywordtype}{void}\ OnEnvironmentsTearDownEnd(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_unit_test}{UnitTest}}\&\ \textcolor{comment}{/*unit\_test*/})\textcolor{keyword}{\ override\ }\{\}}
\DoxyCodeLine{03692\ \ \ \textcolor{keywordtype}{void}\ OnTestIterationEnd(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_unit_test}{UnitTest}}\&\ unit\_test,\ \textcolor{keywordtype}{int}\ iteration)\ \textcolor{keyword}{override};}
\DoxyCodeLine{03693\ \ \ \textcolor{keywordtype}{void}\ OnTestProgramEnd(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_unit_test}{UnitTest}}\&\ \textcolor{comment}{/*unit\_test*/})\textcolor{keyword}{\ override\ }\{\}}
\DoxyCodeLine{03694\ \};}
\DoxyCodeLine{03695\ }
\DoxyCodeLine{03696\ \textcolor{comment}{//\ Called\ after\ an\ assertion\ failure.}}
\DoxyCodeLine{03697\ \textcolor{keywordtype}{void}\ BriefUnitTestResultPrinter::OnTestPartResult(}
\DoxyCodeLine{03698\ \ \ \ \ \textcolor{keyword}{const}\ TestPartResult\&\ result)\ \{}
\DoxyCodeLine{03699\ \ \ \textcolor{keywordflow}{switch}\ (result.type())\ \{}
\DoxyCodeLine{03700\ \ \ \ \ \textcolor{comment}{//\ If\ the\ test\ part\ succeeded,\ we\ don't\ need\ to\ do\ anything.}}
\DoxyCodeLine{03701\ \ \ \ \ \textcolor{keywordflow}{case}\ TestPartResult::kSuccess:}
\DoxyCodeLine{03702\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{03703\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{03704\ \ \ \ \ \ \ \textcolor{comment}{//\ Print\ failure\ message\ from\ the\ assertion}}
\DoxyCodeLine{03705\ \ \ \ \ \ \ \textcolor{comment}{//\ (e.g.\ expected\ this\ and\ got\ that).}}
\DoxyCodeLine{03706\ \ \ \ \ \ \ PrintTestPartResult(result);}
\DoxyCodeLine{03707\ \ \ \ \ \ \ fflush(stdout);}
\DoxyCodeLine{03708\ \ \ \}}
\DoxyCodeLine{03709\ \}}
\DoxyCodeLine{03710\ }
\DoxyCodeLine{03711\ \textcolor{keywordtype}{void}\ BriefUnitTestResultPrinter::OnTestEnd(\textcolor{keyword}{const}\ TestInfo\&\ test\_info)\ \{}
\DoxyCodeLine{03712\ \ \ \textcolor{keywordflow}{if}\ (test\_info.result()-\/>Failed())\ \{}
\DoxyCodeLine{03713\ \ \ \ \ ColoredPrintf(GTestColor::kRed,\ \textcolor{stringliteral}{"{}[\ \ FAILED\ \ ]\ "{}});}
\DoxyCodeLine{03714\ \ \ \ \ PrintTestName(test\_info.test\_suite\_name(),\ test\_info.name());}
\DoxyCodeLine{03715\ \ \ \ \ PrintFullTestCommentIfPresent(test\_info);}
\DoxyCodeLine{03716\ }
\DoxyCodeLine{03717\ \ \ \ \ \textcolor{keywordflow}{if}\ (GTEST\_FLAG\_GET(print\_time))\ \{}
\DoxyCodeLine{03718\ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\ (\%s\ ms)\(\backslash\)n"{}},}
\DoxyCodeLine{03719\ \ \ \ \ \ \ \ \ \ \ \ \ \ internal::StreamableToString(test\_info.result()-\/>elapsed\_time())}
\DoxyCodeLine{03720\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ .c\_str());}
\DoxyCodeLine{03721\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03722\ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{03723\ \ \ \ \ \}}
\DoxyCodeLine{03724\ \ \ \ \ fflush(stdout);}
\DoxyCodeLine{03725\ \ \ \}}
\DoxyCodeLine{03726\ \}}
\DoxyCodeLine{03727\ }
\DoxyCodeLine{03728\ \textcolor{keywordtype}{void}\ BriefUnitTestResultPrinter::OnTestIterationEnd(\textcolor{keyword}{const}\ UnitTest\&\ unit\_test,}
\DoxyCodeLine{03729\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \textcolor{comment}{/*iteration*/})\ \{}
\DoxyCodeLine{03730\ \ \ ColoredPrintf(GTestColor::kGreen,\ \textcolor{stringliteral}{"{}[==========]\ "{}});}
\DoxyCodeLine{03731\ \ \ printf(\textcolor{stringliteral}{"{}\%s\ from\ \%s\ ran."{}},}
\DoxyCodeLine{03732\ \ \ \ \ \ \ \ \ \ FormatTestCount(unit\_test.test\_to\_run\_count()).c\_str(),}
\DoxyCodeLine{03733\ \ \ \ \ \ \ \ \ \ FormatTestSuiteCount(unit\_test.test\_suite\_to\_run\_count()).c\_str());}
\DoxyCodeLine{03734\ \ \ \textcolor{keywordflow}{if}\ (GTEST\_FLAG\_GET(print\_time))\ \{}
\DoxyCodeLine{03735\ \ \ \ \ printf(\textcolor{stringliteral}{"{}\ (\%s\ ms\ total)"{}},}
\DoxyCodeLine{03736\ \ \ \ \ \ \ \ \ \ \ \ internal::StreamableToString(unit\_test.elapsed\_time()).c\_str());}
\DoxyCodeLine{03737\ \ \ \}}
\DoxyCodeLine{03738\ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{03739\ \ \ ColoredPrintf(GTestColor::kGreen,\ \textcolor{stringliteral}{"{}[\ \ PASSED\ \ ]\ "{}});}
\DoxyCodeLine{03740\ \ \ printf(\textcolor{stringliteral}{"{}\%s.\(\backslash\)n"{}},\ FormatTestCount(unit\_test.successful\_test\_count()).c\_str());}
\DoxyCodeLine{03741\ }
\DoxyCodeLine{03742\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ skipped\_test\_count\ =\ unit\_test.skipped\_test\_count();}
\DoxyCodeLine{03743\ \ \ \textcolor{keywordflow}{if}\ (skipped\_test\_count\ >\ 0)\ \{}
\DoxyCodeLine{03744\ \ \ \ \ ColoredPrintf(GTestColor::kGreen,\ \textcolor{stringliteral}{"{}[\ \ SKIPPED\ ]\ "{}});}
\DoxyCodeLine{03745\ \ \ \ \ printf(\textcolor{stringliteral}{"{}\%s.\(\backslash\)n"{}},\ FormatTestCount(skipped\_test\_count).c\_str());}
\DoxyCodeLine{03746\ \ \ \}}
\DoxyCodeLine{03747\ }
\DoxyCodeLine{03748\ \ \ \textcolor{keywordtype}{int}\ num\_disabled\ =\ unit\_test.reportable\_disabled\_test\_count();}
\DoxyCodeLine{03749\ \ \ \textcolor{keywordflow}{if}\ (num\_disabled\ \&\&\ !GTEST\_FLAG\_GET(also\_run\_disabled\_tests))\ \{}
\DoxyCodeLine{03750\ \ \ \ \ \textcolor{keywordflow}{if}\ (unit\_test.Passed())\ \{}
\DoxyCodeLine{03751\ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n"{}});\ \ \textcolor{comment}{//\ Add\ a\ spacer\ if\ no\ FAILURE\ banner\ is\ displayed.}}
\DoxyCodeLine{03752\ \ \ \ \ \}}
\DoxyCodeLine{03753\ \ \ \ \ ColoredPrintf(GTestColor::kYellow,\ \textcolor{stringliteral}{"{}\ \ YOU\ HAVE\ \%d\ DISABLED\ \%s\(\backslash\)n\(\backslash\)n"{}},}
\DoxyCodeLine{03754\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ num\_disabled,\ num\_disabled\ ==\ 1\ ?\ \textcolor{stringliteral}{"{}TEST"{}}\ :\ \textcolor{stringliteral}{"{}TESTS"{}});}
\DoxyCodeLine{03755\ \ \ \}}
\DoxyCodeLine{03756\ \ \ \textcolor{comment}{//\ Ensure\ that\ Google\ Test\ output\ is\ printed\ before,\ e.g.,\ heapchecker\ output.}}
\DoxyCodeLine{03757\ \ \ fflush(stdout);}
\DoxyCodeLine{03758\ \}}
\DoxyCodeLine{03759\ }
\DoxyCodeLine{03760\ \textcolor{comment}{//\ End\ BriefUnitTestResultPrinter}}
\DoxyCodeLine{03761\ }
\DoxyCodeLine{03762\ \textcolor{comment}{//\ class\ TestEventRepeater}}
\DoxyCodeLine{03763\ \textcolor{comment}{//}}
\DoxyCodeLine{03764\ \textcolor{comment}{//\ This\ class\ forwards\ events\ to\ other\ event\ listeners.}}
\DoxyCodeLine{03765\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classtesting_1_1internal_1_1_test_event_repeater}{TestEventRepeater}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classtesting_1_1_test_event_listener}{TestEventListener}}\ \{}
\DoxyCodeLine{03766\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{03767\ \ \ \mbox{\hyperlink{classtesting_1_1internal_1_1_test_event_repeater}{TestEventRepeater}}()\ :\ forwarding\_enabled\_(\textcolor{keyword}{true})\ \{\}}
\DoxyCodeLine{03768\ \ \ \mbox{\hyperlink{classtesting_1_1internal_1_1_test_event_repeater}{\string~TestEventRepeater}}()\ \textcolor{keyword}{override};}
\DoxyCodeLine{03769\ \ \ \textcolor{keywordtype}{void}\ Append(\mbox{\hyperlink{classtesting_1_1_test_event_listener}{TestEventListener}}*\ listener);}
\DoxyCodeLine{03770\ \ \ \mbox{\hyperlink{classtesting_1_1_test_event_listener}{TestEventListener}}*\ Release(\mbox{\hyperlink{classtesting_1_1_test_event_listener}{TestEventListener}}*\ listener);}
\DoxyCodeLine{03771\ }
\DoxyCodeLine{03772\ \ \ \textcolor{comment}{//\ Controls\ whether\ events\ will\ be\ forwarded\ to\ listeners\_.\ Set\ to\ false}}
\DoxyCodeLine{03773\ \ \ \textcolor{comment}{//\ in\ death\ test\ child\ processes.}}
\DoxyCodeLine{03774\ \ \ \textcolor{keywordtype}{bool}\ forwarding\_enabled()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ forwarding\_enabled\_;\ \}}
\DoxyCodeLine{03775\ \ \ \textcolor{keywordtype}{void}\ set\_forwarding\_enabled(\textcolor{keywordtype}{bool}\ enable)\ \{\ forwarding\_enabled\_\ =\ enable;\ \}}
\DoxyCodeLine{03776\ }
\DoxyCodeLine{03777\ \ \ \textcolor{keywordtype}{void}\ OnTestProgramStart(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_unit_test}{UnitTest}}\&\ unit\_test)\ \textcolor{keyword}{override};}
\DoxyCodeLine{03778\ \ \ \textcolor{keywordtype}{void}\ OnTestIterationStart(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_unit_test}{UnitTest}}\&\ unit\_test,\ \textcolor{keywordtype}{int}\ iteration)\ \textcolor{keyword}{override};}
\DoxyCodeLine{03779\ \ \ \textcolor{keywordtype}{void}\ OnEnvironmentsSetUpStart(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_unit_test}{UnitTest}}\&\ unit\_test)\ \textcolor{keyword}{override};}
\DoxyCodeLine{03780\ \ \ \textcolor{keywordtype}{void}\ OnEnvironmentsSetUpEnd(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_unit_test}{UnitTest}}\&\ unit\_test)\ \textcolor{keyword}{override};}
\DoxyCodeLine{03781\ \textcolor{comment}{//\ \ Legacy\ API\ is\ deprecated\ but\ still\ available}}
\DoxyCodeLine{03782\ \textcolor{preprocessor}{\#ifndef\ GTEST\_REMOVE\_LEGACY\_TEST\_CASEAPI\_}}
\DoxyCodeLine{03783\ \ \ \textcolor{keywordtype}{void}\ OnTestCaseStart(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_test_suite}{TestSuite}}\&\ parameter)\ \textcolor{keyword}{override};}
\DoxyCodeLine{03784\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ \ GTEST\_REMOVE\_LEGACY\_TEST\_CASEAPI\_}}
\DoxyCodeLine{03785\ \ \ \textcolor{keywordtype}{void}\ OnTestSuiteStart(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_test_suite}{TestSuite}}\&\ parameter)\ \textcolor{keyword}{override};}
\DoxyCodeLine{03786\ \ \ \textcolor{keywordtype}{void}\ OnTestStart(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_test_info}{TestInfo}}\&\ test\_info)\ \textcolor{keyword}{override};}
\DoxyCodeLine{03787\ \ \ \textcolor{keywordtype}{void}\ OnTestDisabled(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_test_info}{TestInfo}}\&\ test\_info)\ \textcolor{keyword}{override};}
\DoxyCodeLine{03788\ \ \ \textcolor{keywordtype}{void}\ OnTestPartResult(\textcolor{keyword}{const}\ TestPartResult\&\ result)\ \textcolor{keyword}{override};}
\DoxyCodeLine{03789\ \ \ \textcolor{keywordtype}{void}\ OnTestEnd(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_test_info}{TestInfo}}\&\ test\_info)\ \textcolor{keyword}{override};}
\DoxyCodeLine{03790\ \textcolor{comment}{//\ \ Legacy\ API\ is\ deprecated\ but\ still\ available}}
\DoxyCodeLine{03791\ \textcolor{preprocessor}{\#ifndef\ GTEST\_REMOVE\_LEGACY\_TEST\_CASEAPI\_}}
\DoxyCodeLine{03792\ \ \ \textcolor{keywordtype}{void}\ OnTestCaseEnd(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_test_suite}{TestCase}}\&\ parameter)\ \textcolor{keyword}{override};}
\DoxyCodeLine{03793\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ \ GTEST\_REMOVE\_LEGACY\_TEST\_CASEAPI\_}}
\DoxyCodeLine{03794\ \ \ \textcolor{keywordtype}{void}\ OnTestSuiteEnd(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_test_suite}{TestSuite}}\&\ parameter)\ \textcolor{keyword}{override};}
\DoxyCodeLine{03795\ \ \ \textcolor{keywordtype}{void}\ OnEnvironmentsTearDownStart(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_unit_test}{UnitTest}}\&\ unit\_test)\ \textcolor{keyword}{override};}
\DoxyCodeLine{03796\ \ \ \textcolor{keywordtype}{void}\ OnEnvironmentsTearDownEnd(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_unit_test}{UnitTest}}\&\ unit\_test)\ \textcolor{keyword}{override};}
\DoxyCodeLine{03797\ \ \ \textcolor{keywordtype}{void}\ OnTestIterationEnd(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_unit_test}{UnitTest}}\&\ unit\_test,\ \textcolor{keywordtype}{int}\ iteration)\ \textcolor{keyword}{override};}
\DoxyCodeLine{03798\ \ \ \textcolor{keywordtype}{void}\ OnTestProgramEnd(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_unit_test}{UnitTest}}\&\ unit\_test)\ \textcolor{keyword}{override};}
\DoxyCodeLine{03799\ }
\DoxyCodeLine{03800\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{03801\ \ \ \textcolor{comment}{//\ Controls\ whether\ events\ will\ be\ forwarded\ to\ listeners\_.\ Set\ to\ false}}
\DoxyCodeLine{03802\ \ \ \textcolor{comment}{//\ in\ death\ test\ child\ processes.}}
\DoxyCodeLine{03803\ \ \ \textcolor{keywordtype}{bool}\ forwarding\_enabled\_;}
\DoxyCodeLine{03804\ \ \ \textcolor{comment}{//\ The\ list\ of\ listeners\ that\ receive\ events.}}
\DoxyCodeLine{03805\ \ \ std::vector<TestEventListener*>\ listeners\_;}
\DoxyCodeLine{03806\ }
\DoxyCodeLine{03807\ \ \ \mbox{\hyperlink{classtesting_1_1internal_1_1_test_event_repeater}{TestEventRepeater}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1internal_1_1_test_event_repeater}{TestEventRepeater}}\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{03808\ \ \ \mbox{\hyperlink{classtesting_1_1internal_1_1_test_event_repeater}{TestEventRepeater}}\&\ operator=(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1internal_1_1_test_event_repeater}{TestEventRepeater}}\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{03809\ \};}
\DoxyCodeLine{03810\ }
\DoxyCodeLine{03811\ TestEventRepeater::\string~TestEventRepeater()\ \{}
\DoxyCodeLine{03812\ \ \ ForEach(listeners\_,\ Delete<TestEventListener>);}
\DoxyCodeLine{03813\ \}}
\DoxyCodeLine{03814\ }
\DoxyCodeLine{03815\ \textcolor{keywordtype}{void}\ TestEventRepeater::Append(\mbox{\hyperlink{classtesting_1_1_test_event_listener}{TestEventListener}}*\ listener)\ \{}
\DoxyCodeLine{03816\ \ \ listeners\_.push\_back(listener);}
\DoxyCodeLine{03817\ \}}
\DoxyCodeLine{03818\ }
\DoxyCodeLine{03819\ TestEventListener*\ TestEventRepeater::Release(TestEventListener*\ listener)\ \{}
\DoxyCodeLine{03820\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ listeners\_.size();\ ++i)\ \{}
\DoxyCodeLine{03821\ \ \ \ \ \textcolor{keywordflow}{if}\ (listeners\_[i]\ ==\ listener)\ \{}
\DoxyCodeLine{03822\ \ \ \ \ \ \ listeners\_.erase(listeners\_.begin()\ +\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(i));}
\DoxyCodeLine{03823\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ listener;}
\DoxyCodeLine{03824\ \ \ \ \ \}}
\DoxyCodeLine{03825\ \ \ \}}
\DoxyCodeLine{03826\ }
\DoxyCodeLine{03827\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{03828\ \}}
\DoxyCodeLine{03829\ }
\DoxyCodeLine{03830\ \textcolor{comment}{//\ Since\ most\ methods\ are\ very\ similar,\ use\ macros\ to\ reduce\ boilerplate.}}
\DoxyCodeLine{03831\ \textcolor{comment}{//\ This\ defines\ a\ member\ that\ forwards\ the\ call\ to\ all\ listeners.}}
\DoxyCodeLine{03832\ \textcolor{preprocessor}{\#define\ GTEST\_REPEATER\_METHOD\_(Name,\ Type)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{03833\ \textcolor{preprocessor}{\ \ void\ TestEventRepeater::Name(const\ Type\&\ parameter)\ \{\ \(\backslash\)}}
\DoxyCodeLine{03834\ \textcolor{preprocessor}{\ \ \ \ if\ (forwarding\_enabled\_)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{03835\ \textcolor{preprocessor}{\ \ \ \ \ \ for\ (size\_t\ i\ =\ 0;\ i\ <\ listeners\_.size();\ i++)\ \{\ \ \(\backslash\)}}
\DoxyCodeLine{03836\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ listeners\_[i]-\/>Name(parameter);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{03837\ \textcolor{preprocessor}{\ \ \ \ \ \ \}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{03838\ \textcolor{preprocessor}{\ \ \ \ \}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{03839\ \textcolor{preprocessor}{\ \ \}}}
\DoxyCodeLine{03840\ \textcolor{comment}{//\ This\ defines\ a\ member\ that\ forwards\ the\ call\ to\ all\ listeners\ in\ reverse}}
\DoxyCodeLine{03841\ \textcolor{comment}{//\ order.}}
\DoxyCodeLine{03842\ \textcolor{preprocessor}{\#define\ GTEST\_REVERSE\_REPEATER\_METHOD\_(Name,\ Type)\ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{03843\ \textcolor{preprocessor}{\ \ void\ TestEventRepeater::Name(const\ Type\&\ parameter)\ \{\ \(\backslash\)}}
\DoxyCodeLine{03844\ \textcolor{preprocessor}{\ \ \ \ if\ (forwarding\_enabled\_)\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{03845\ \textcolor{preprocessor}{\ \ \ \ \ \ for\ (size\_t\ i\ =\ listeners\_.size();\ i\ !=\ 0;\ i-\/-\/)\ \{\ \(\backslash\)}}
\DoxyCodeLine{03846\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ listeners\_[i\ -\/\ 1]-\/>Name(parameter);\ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{03847\ \textcolor{preprocessor}{\ \ \ \ \ \ \}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{03848\ \textcolor{preprocessor}{\ \ \ \ \}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{03849\ \textcolor{preprocessor}{\ \ \}}}
\DoxyCodeLine{03850\ }
\DoxyCodeLine{03851\ GTEST\_REPEATER\_METHOD\_(OnTestProgramStart,\ UnitTest)}
\DoxyCodeLine{03852\ GTEST\_REPEATER\_METHOD\_(OnEnvironmentsSetUpStart,\ UnitTest)}
\DoxyCodeLine{03853\ \textcolor{comment}{//\ \ Legacy\ API\ is\ deprecated\ but\ still\ available}}
\DoxyCodeLine{03854\ \textcolor{preprocessor}{\#ifndef\ GTEST\_REMOVE\_LEGACY\_TEST\_CASEAPI\_}}
\DoxyCodeLine{03855\ GTEST\_REPEATER\_METHOD\_(OnTestCaseStart,\ TestSuite)}
\DoxyCodeLine{03856\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ \ GTEST\_REMOVE\_LEGACY\_TEST\_CASEAPI\_}}
\DoxyCodeLine{03857\ GTEST\_REPEATER\_METHOD\_(OnTestSuiteStart,\ TestSuite)}
\DoxyCodeLine{03858\ GTEST\_REPEATER\_METHOD\_(OnTestStart,\ TestInfo)}
\DoxyCodeLine{03859\ GTEST\_REPEATER\_METHOD\_(OnTestDisabled,\ TestInfo)}
\DoxyCodeLine{03860\ GTEST\_REPEATER\_METHOD\_(OnTestPartResult,\ TestPartResult)}
\DoxyCodeLine{03861\ GTEST\_REPEATER\_METHOD\_(OnEnvironmentsTearDownStart,\ UnitTest)}
\DoxyCodeLine{03862\ GTEST\_REVERSE\_REPEATER\_METHOD\_(OnEnvironmentsSetUpEnd,\ UnitTest)}
\DoxyCodeLine{03863\ GTEST\_REVERSE\_REPEATER\_METHOD\_(OnEnvironmentsTearDownEnd,\ UnitTest)}
\DoxyCodeLine{03864\ GTEST\_REVERSE\_REPEATER\_METHOD\_(OnTestEnd,\ TestInfo)}
\DoxyCodeLine{03865\ \textcolor{comment}{//\ \ Legacy\ API\ is\ deprecated\ but\ still\ available}}
\DoxyCodeLine{03866\ \textcolor{preprocessor}{\#ifndef\ GTEST\_REMOVE\_LEGACY\_TEST\_CASEAPI\_}}
\DoxyCodeLine{03867\ GTEST\_REVERSE\_REPEATER\_METHOD\_(OnTestCaseEnd,\ TestSuite)}
\DoxyCodeLine{03868\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ \ GTEST\_REMOVE\_LEGACY\_TEST\_CASEAPI\_}}
\DoxyCodeLine{03869\ GTEST\_REVERSE\_REPEATER\_METHOD\_(OnTestSuiteEnd,\ TestSuite)}
\DoxyCodeLine{03870\ GTEST\_REVERSE\_REPEATER\_METHOD\_(OnTestProgramEnd,\ UnitTest)}
\DoxyCodeLine{03871\ }
\DoxyCodeLine{03872\ \textcolor{preprocessor}{\#undef\ GTEST\_REPEATER\_METHOD\_}}
\DoxyCodeLine{03873\ \textcolor{preprocessor}{\#undef\ GTEST\_REVERSE\_REPEATER\_METHOD\_}}
\DoxyCodeLine{03874\ }
\DoxyCodeLine{03875\ \textcolor{keywordtype}{void}\ TestEventRepeater::OnTestIterationStart(\textcolor{keyword}{const}\ UnitTest\&\ unit\_test,}
\DoxyCodeLine{03876\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ iteration)\ \{}
\DoxyCodeLine{03877\ \ \ \textcolor{keywordflow}{if}\ (forwarding\_enabled\_)\ \{}
\DoxyCodeLine{03878\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ listeners\_.size();\ i++)\ \{}
\DoxyCodeLine{03879\ \ \ \ \ \ \ listeners\_[i]-\/>OnTestIterationStart(unit\_test,\ iteration);}
\DoxyCodeLine{03880\ \ \ \ \ \}}
\DoxyCodeLine{03881\ \ \ \}}
\DoxyCodeLine{03882\ \}}
\DoxyCodeLine{03883\ }
\DoxyCodeLine{03884\ \textcolor{keywordtype}{void}\ TestEventRepeater::OnTestIterationEnd(\textcolor{keyword}{const}\ UnitTest\&\ unit\_test,}
\DoxyCodeLine{03885\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ iteration)\ \{}
\DoxyCodeLine{03886\ \ \ \textcolor{keywordflow}{if}\ (forwarding\_enabled\_)\ \{}
\DoxyCodeLine{03887\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ listeners\_.size();\ i\ >\ 0;\ i-\/-\/)\ \{}
\DoxyCodeLine{03888\ \ \ \ \ \ \ listeners\_[i\ -\/\ 1]-\/>OnTestIterationEnd(unit\_test,\ iteration);}
\DoxyCodeLine{03889\ \ \ \ \ \}}
\DoxyCodeLine{03890\ \ \ \}}
\DoxyCodeLine{03891\ \}}
\DoxyCodeLine{03892\ }
\DoxyCodeLine{03893\ \textcolor{comment}{//\ End\ TestEventRepeater}}
\DoxyCodeLine{03894\ }
\DoxyCodeLine{03895\ \textcolor{comment}{//\ This\ class\ generates\ an\ XML\ output\ file.}}
\DoxyCodeLine{03896\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classtesting_1_1internal_1_1_xml_unit_test_result_printer}{XmlUnitTestResultPrinter}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classtesting_1_1_empty_test_event_listener}{EmptyTestEventListener}}\ \{}
\DoxyCodeLine{03897\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{03898\ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{classtesting_1_1internal_1_1_xml_unit_test_result_printer}{XmlUnitTestResultPrinter}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ output\_file);}
\DoxyCodeLine{03899\ }
\DoxyCodeLine{03900\ \ \ \textcolor{keywordtype}{void}\ OnTestIterationEnd(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_unit_test}{UnitTest}}\&\ unit\_test,\ \textcolor{keywordtype}{int}\ iteration)\ \textcolor{keyword}{override};}
\DoxyCodeLine{03901\ \ \ \textcolor{keywordtype}{void}\ ListTestsMatchingFilter(\textcolor{keyword}{const}\ std::vector<TestSuite*>\&\ test\_suites);}
\DoxyCodeLine{03902\ }
\DoxyCodeLine{03903\ \ \ \textcolor{comment}{//\ Prints\ an\ XML\ summary\ of\ all\ unit\ tests.}}
\DoxyCodeLine{03904\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ PrintXmlTestsList(std::ostream*\ stream,}
\DoxyCodeLine{03905\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::vector<TestSuite*>\&\ test\_suites);}
\DoxyCodeLine{03906\ }
\DoxyCodeLine{03907\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{03908\ \ \ \textcolor{comment}{//\ Is\ c\ a\ whitespace\ character\ that\ is\ normalized\ to\ a\ space\ character}}
\DoxyCodeLine{03909\ \ \ \textcolor{comment}{//\ when\ it\ appears\ in\ an\ XML\ attribute\ value?}}
\DoxyCodeLine{03910\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ IsNormalizableWhitespace(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ c)\ \{}
\DoxyCodeLine{03911\ \ \ \ \ \textcolor{keywordflow}{return}\ c\ ==\ \textcolor{charliteral}{'\(\backslash\)t'}\ ||\ c\ ==\ \textcolor{charliteral}{'\(\backslash\)n'}\ ||\ c\ ==\ \textcolor{charliteral}{'\(\backslash\)r'};}
\DoxyCodeLine{03912\ \ \ \}}
\DoxyCodeLine{03913\ }
\DoxyCodeLine{03914\ \ \ \textcolor{comment}{//\ May\ c\ appear\ in\ a\ well-\/formed\ XML\ document?}}
\DoxyCodeLine{03915\ \ \ \textcolor{comment}{//\ https://www.w3.org/TR/REC-\/xml/\#charsets}}
\DoxyCodeLine{03916\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ IsValidXmlCharacter(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ c)\ \{}
\DoxyCodeLine{03917\ \ \ \ \ \textcolor{keywordflow}{return}\ IsNormalizableWhitespace(c)\ ||\ c\ >=\ 0x20;}
\DoxyCodeLine{03918\ \ \ \}}
\DoxyCodeLine{03919\ }
\DoxyCodeLine{03920\ \ \ \textcolor{comment}{//\ Returns\ an\ XML-\/escaped\ copy\ of\ the\ input\ string\ str.\ \ If}}
\DoxyCodeLine{03921\ \ \ \textcolor{comment}{//\ is\_attribute\ is\ true,\ the\ text\ is\ meant\ to\ appear\ as\ an\ attribute}}
\DoxyCodeLine{03922\ \ \ \textcolor{comment}{//\ value,\ and\ normalizable\ whitespace\ is\ preserved\ by\ replacing\ it}}
\DoxyCodeLine{03923\ \ \ \textcolor{comment}{//\ with\ character\ references.}}
\DoxyCodeLine{03924\ \ \ \textcolor{keyword}{static}\ std::string\ EscapeXml(\textcolor{keyword}{const}\ std::string\&\ str,\ \textcolor{keywordtype}{bool}\ is\_attribute);}
\DoxyCodeLine{03925\ }
\DoxyCodeLine{03926\ \ \ \textcolor{comment}{//\ Returns\ the\ given\ string\ with\ all\ characters\ invalid\ in\ XML\ removed.}}
\DoxyCodeLine{03927\ \ \ \textcolor{keyword}{static}\ std::string\ RemoveInvalidXmlCharacters(\textcolor{keyword}{const}\ std::string\&\ str);}
\DoxyCodeLine{03928\ }
\DoxyCodeLine{03929\ \ \ \textcolor{comment}{//\ Convenience\ wrapper\ around\ EscapeXml\ when\ str\ is\ an\ attribute\ value.}}
\DoxyCodeLine{03930\ \ \ \textcolor{keyword}{static}\ std::string\ EscapeXmlAttribute(\textcolor{keyword}{const}\ std::string\&\ str)\ \{}
\DoxyCodeLine{03931\ \ \ \ \ \textcolor{keywordflow}{return}\ EscapeXml(str,\ \textcolor{keyword}{true});}
\DoxyCodeLine{03932\ \ \ \}}
\DoxyCodeLine{03933\ }
\DoxyCodeLine{03934\ \ \ \textcolor{comment}{//\ Convenience\ wrapper\ around\ EscapeXml\ when\ str\ is\ not\ an\ attribute\ value.}}
\DoxyCodeLine{03935\ \ \ \textcolor{keyword}{static}\ std::string\ EscapeXmlText(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ str)\ \{}
\DoxyCodeLine{03936\ \ \ \ \ \textcolor{keywordflow}{return}\ EscapeXml(str,\ \textcolor{keyword}{false});}
\DoxyCodeLine{03937\ \ \ \}}
\DoxyCodeLine{03938\ }
\DoxyCodeLine{03939\ \ \ \textcolor{comment}{//\ Verifies\ that\ the\ given\ attribute\ belongs\ to\ the\ given\ element\ and}}
\DoxyCodeLine{03940\ \ \ \textcolor{comment}{//\ streams\ the\ attribute\ as\ XML.}}
\DoxyCodeLine{03941\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ OutputXmlAttribute(std::ostream*\ stream,}
\DoxyCodeLine{03942\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ element\_name,}
\DoxyCodeLine{03943\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ name,}
\DoxyCodeLine{03944\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ value);}
\DoxyCodeLine{03945\ }
\DoxyCodeLine{03946\ \ \ \textcolor{comment}{//\ Streams\ an\ XML\ CDATA\ section,\ escaping\ invalid\ CDATA\ sequences\ as\ needed.}}
\DoxyCodeLine{03947\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ OutputXmlCDataSection(::std::ostream*\ stream,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ data);}
\DoxyCodeLine{03948\ }
\DoxyCodeLine{03949\ \ \ \textcolor{comment}{//\ Streams\ a\ test\ suite\ XML\ stanza\ containing\ the\ given\ test\ result.}}
\DoxyCodeLine{03950\ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{03951\ \ \ \textcolor{comment}{//\ Requires:\ result.Failed()}}
\DoxyCodeLine{03952\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ OutputXmlTestSuiteForTestResult(::std::ostream*\ stream,}
\DoxyCodeLine{03953\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_test_result}{TestResult}}\&\ result);}
\DoxyCodeLine{03954\ }
\DoxyCodeLine{03955\ \ \ \textcolor{comment}{//\ Streams\ an\ XML\ representation\ of\ a\ TestResult\ object.}}
\DoxyCodeLine{03956\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ OutputXmlTestResult(::std::ostream*\ stream,}
\DoxyCodeLine{03957\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_test_result}{TestResult}}\&\ result);}
\DoxyCodeLine{03958\ }
\DoxyCodeLine{03959\ \ \ \textcolor{comment}{//\ Streams\ an\ XML\ representation\ of\ a\ TestInfo\ object.}}
\DoxyCodeLine{03960\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ OutputXmlTestInfo(::std::ostream*\ stream,}
\DoxyCodeLine{03961\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ test\_suite\_name,}
\DoxyCodeLine{03962\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_test_info}{TestInfo}}\&\ test\_info);}
\DoxyCodeLine{03963\ }
\DoxyCodeLine{03964\ \ \ \textcolor{comment}{//\ Prints\ an\ XML\ representation\ of\ a\ TestSuite\ object}}
\DoxyCodeLine{03965\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ PrintXmlTestSuite(::std::ostream*\ stream,}
\DoxyCodeLine{03966\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_test_suite}{TestSuite}}\&\ test\_suite);}
\DoxyCodeLine{03967\ }
\DoxyCodeLine{03968\ \ \ \textcolor{comment}{//\ Prints\ an\ XML\ summary\ of\ unit\_test\ to\ output\ stream\ out.}}
\DoxyCodeLine{03969\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ PrintXmlUnitTest(::std::ostream*\ stream,}
\DoxyCodeLine{03970\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_unit_test}{UnitTest}}\&\ unit\_test);}
\DoxyCodeLine{03971\ }
\DoxyCodeLine{03972\ \ \ \textcolor{comment}{//\ Produces\ a\ string\ representing\ the\ test\ properties\ in\ a\ result\ as\ space}}
\DoxyCodeLine{03973\ \ \ \textcolor{comment}{//\ delimited\ XML\ attributes\ based\ on\ the\ property\ key="{}value"{}\ pairs.}}
\DoxyCodeLine{03974\ \ \ \textcolor{comment}{//\ When\ the\ std::string\ is\ not\ empty,\ it\ includes\ a\ space\ at\ the\ beginning,}}
\DoxyCodeLine{03975\ \ \ \textcolor{comment}{//\ to\ delimit\ this\ attribute\ from\ prior\ attributes.}}
\DoxyCodeLine{03976\ \ \ \textcolor{keyword}{static}\ std::string\ TestPropertiesAsXmlAttributes(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_test_result}{TestResult}}\&\ result);}
\DoxyCodeLine{03977\ }
\DoxyCodeLine{03978\ \ \ \textcolor{comment}{//\ Streams\ an\ XML\ representation\ of\ the\ test\ properties\ of\ a\ TestResult}}
\DoxyCodeLine{03979\ \ \ \textcolor{comment}{//\ object.}}
\DoxyCodeLine{03980\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ OutputXmlTestProperties(std::ostream*\ stream,}
\DoxyCodeLine{03981\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_test_result}{TestResult}}\&\ result);}
\DoxyCodeLine{03982\ }
\DoxyCodeLine{03983\ \ \ \textcolor{comment}{//\ The\ output\ file.}}
\DoxyCodeLine{03984\ \ \ \textcolor{keyword}{const}\ std::string\ output\_file\_;}
\DoxyCodeLine{03985\ }
\DoxyCodeLine{03986\ \ \ \mbox{\hyperlink{classtesting_1_1internal_1_1_xml_unit_test_result_printer}{XmlUnitTestResultPrinter}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1internal_1_1_xml_unit_test_result_printer}{XmlUnitTestResultPrinter}}\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{03987\ \ \ \mbox{\hyperlink{classtesting_1_1internal_1_1_xml_unit_test_result_printer}{XmlUnitTestResultPrinter}}\&\ operator=(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1internal_1_1_xml_unit_test_result_printer}{XmlUnitTestResultPrinter}}\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{03988\ \};}
\DoxyCodeLine{03989\ }
\DoxyCodeLine{03990\ \textcolor{comment}{//\ Creates\ a\ new\ XmlUnitTestResultPrinter.}}
\DoxyCodeLine{03991\ XmlUnitTestResultPrinter::XmlUnitTestResultPrinter(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ output\_file)}
\DoxyCodeLine{03992\ \ \ \ \ :\ output\_file\_(output\_file)\ \{}
\DoxyCodeLine{03993\ \ \ \textcolor{keywordflow}{if}\ (output\_file\_.empty())\ \{}
\DoxyCodeLine{03994\ \ \ \ \ GTEST\_LOG\_(FATAL)\ <<\ \textcolor{stringliteral}{"{}XML\ output\ file\ may\ not\ be\ null"{}};}
\DoxyCodeLine{03995\ \ \ \}}
\DoxyCodeLine{03996\ \}}
\DoxyCodeLine{03997\ }
\DoxyCodeLine{03998\ \textcolor{comment}{//\ Called\ after\ the\ unit\ test\ ends.}}
\DoxyCodeLine{03999\ \textcolor{keywordtype}{void}\ XmlUnitTestResultPrinter::OnTestIterationEnd(\textcolor{keyword}{const}\ UnitTest\&\ unit\_test,}
\DoxyCodeLine{04000\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \textcolor{comment}{/*iteration*/})\ \{}
\DoxyCodeLine{04001\ \ \ FILE*\ xmlout\ =\ OpenFileForWriting(output\_file\_);}
\DoxyCodeLine{04002\ \ \ std::stringstream\ stream;}
\DoxyCodeLine{04003\ \ \ PrintXmlUnitTest(\&stream,\ unit\_test);}
\DoxyCodeLine{04004\ \ \ fprintf(xmlout,\ \textcolor{stringliteral}{"{}\%s"{}},\ StringStreamToString(\&stream).c\_str());}
\DoxyCodeLine{04005\ \ \ fclose(xmlout);}
\DoxyCodeLine{04006\ \}}
\DoxyCodeLine{04007\ }
\DoxyCodeLine{04008\ \textcolor{keywordtype}{void}\ XmlUnitTestResultPrinter::ListTestsMatchingFilter(}
\DoxyCodeLine{04009\ \ \ \ \ \textcolor{keyword}{const}\ std::vector<TestSuite*>\&\ test\_suites)\ \{}
\DoxyCodeLine{04010\ \ \ FILE*\ xmlout\ =\ OpenFileForWriting(output\_file\_);}
\DoxyCodeLine{04011\ \ \ std::stringstream\ stream;}
\DoxyCodeLine{04012\ \ \ PrintXmlTestsList(\&stream,\ test\_suites);}
\DoxyCodeLine{04013\ \ \ fprintf(xmlout,\ \textcolor{stringliteral}{"{}\%s"{}},\ StringStreamToString(\&stream).c\_str());}
\DoxyCodeLine{04014\ \ \ fclose(xmlout);}
\DoxyCodeLine{04015\ \}}
\DoxyCodeLine{04016\ }
\DoxyCodeLine{04017\ \textcolor{comment}{//\ Returns\ an\ XML-\/escaped\ copy\ of\ the\ input\ string\ str.\ \ If\ is\_attribute}}
\DoxyCodeLine{04018\ \textcolor{comment}{//\ is\ true,\ the\ text\ is\ meant\ to\ appear\ as\ an\ attribute\ value,\ and}}
\DoxyCodeLine{04019\ \textcolor{comment}{//\ normalizable\ whitespace\ is\ preserved\ by\ replacing\ it\ with\ character}}
\DoxyCodeLine{04020\ \textcolor{comment}{//\ references.}}
\DoxyCodeLine{04021\ \textcolor{comment}{//}}
\DoxyCodeLine{04022\ \textcolor{comment}{//\ Invalid\ XML\ characters\ in\ str,\ if\ any,\ are\ stripped\ from\ the\ output.}}
\DoxyCodeLine{04023\ \textcolor{comment}{//\ It\ is\ expected\ that\ most,\ if\ not\ all,\ of\ the\ text\ processed\ by\ this}}
\DoxyCodeLine{04024\ \textcolor{comment}{//\ module\ will\ consist\ of\ ordinary\ English\ text.}}
\DoxyCodeLine{04025\ \textcolor{comment}{//\ If\ this\ module\ is\ ever\ modified\ to\ produce\ version\ 1.1\ XML\ output,}}
\DoxyCodeLine{04026\ \textcolor{comment}{//\ most\ invalid\ characters\ can\ be\ retained\ using\ character\ references.}}
\DoxyCodeLine{04027\ std::string\ XmlUnitTestResultPrinter::EscapeXml(\textcolor{keyword}{const}\ std::string\&\ str,}
\DoxyCodeLine{04028\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ is\_attribute)\ \{}
\DoxyCodeLine{04029\ \ \ Message\ m;}
\DoxyCodeLine{04030\ }
\DoxyCodeLine{04031\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ str.size();\ ++i)\ \{}
\DoxyCodeLine{04032\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ ch\ =\ str[i];}
\DoxyCodeLine{04033\ \ \ \ \ \textcolor{keywordflow}{switch}\ (ch)\ \{}
\DoxyCodeLine{04034\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'<'}:}
\DoxyCodeLine{04035\ \ \ \ \ \ \ \ \ m\ <<\ \textcolor{stringliteral}{"{}\&lt;"{}};}
\DoxyCodeLine{04036\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04037\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'>'}:}
\DoxyCodeLine{04038\ \ \ \ \ \ \ \ \ m\ <<\ \textcolor{stringliteral}{"{}\&gt;"{}};}
\DoxyCodeLine{04039\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04040\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'\&'}:}
\DoxyCodeLine{04041\ \ \ \ \ \ \ \ \ m\ <<\ \textcolor{stringliteral}{"{}\&amp;"{}};}
\DoxyCodeLine{04042\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04043\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'\(\backslash\)''}:}
\DoxyCodeLine{04044\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_attribute)}
\DoxyCodeLine{04045\ \ \ \ \ \ \ \ \ \ \ m\ <<\ \textcolor{stringliteral}{"{}\&apos;"{}};}
\DoxyCodeLine{04046\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{04047\ \ \ \ \ \ \ \ \ \ \ m\ <<\ \textcolor{charliteral}{'\(\backslash\)''};}
\DoxyCodeLine{04048\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04049\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'"{}'}:}
\DoxyCodeLine{04050\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_attribute)}
\DoxyCodeLine{04051\ \ \ \ \ \ \ \ \ \ \ m\ <<\ \textcolor{stringliteral}{"{}\&quot;"{}};}
\DoxyCodeLine{04052\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{04053\ \ \ \ \ \ \ \ \ \ \ m\ <<\ \textcolor{charliteral}{'"{}'};}
\DoxyCodeLine{04054\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04055\ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{04056\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (IsValidXmlCharacter(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\textcolor{keyword}{>}(ch)))\ \{}
\DoxyCodeLine{04057\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_attribute\ \&\&}
\DoxyCodeLine{04058\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ IsNormalizableWhitespace(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\textcolor{keyword}{>}(ch)))}
\DoxyCodeLine{04059\ \ \ \ \ \ \ \ \ \ \ \ \ m\ <<\ \textcolor{stringliteral}{"{}\&\#x"{}}\ <<\ String::FormatByte(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\textcolor{keyword}{>}(ch))}
\DoxyCodeLine{04060\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{};"{}};}
\DoxyCodeLine{04061\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{04062\ \ \ \ \ \ \ \ \ \ \ \ \ m\ <<\ ch;}
\DoxyCodeLine{04063\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04064\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04065\ \ \ \ \ \}}
\DoxyCodeLine{04066\ \ \ \}}
\DoxyCodeLine{04067\ }
\DoxyCodeLine{04068\ \ \ \textcolor{keywordflow}{return}\ m.GetString();}
\DoxyCodeLine{04069\ \}}
\DoxyCodeLine{04070\ }
\DoxyCodeLine{04071\ \textcolor{comment}{//\ Returns\ the\ given\ string\ with\ all\ characters\ invalid\ in\ XML\ removed.}}
\DoxyCodeLine{04072\ \textcolor{comment}{//\ Currently\ invalid\ characters\ are\ dropped\ from\ the\ string.\ An}}
\DoxyCodeLine{04073\ \textcolor{comment}{//\ alternative\ is\ to\ replace\ them\ with\ certain\ characters\ such\ as\ .\ or\ ?.}}
\DoxyCodeLine{04074\ std::string\ XmlUnitTestResultPrinter::RemoveInvalidXmlCharacters(}
\DoxyCodeLine{04075\ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ str)\ \{}
\DoxyCodeLine{04076\ \ \ std::string\ output;}
\DoxyCodeLine{04077\ \ \ output.reserve(str.size());}
\DoxyCodeLine{04078\ \ \ \textcolor{keywordflow}{for}\ (std::string::const\_iterator\ it\ =\ str.begin();\ it\ !=\ str.end();\ ++it)}
\DoxyCodeLine{04079\ \ \ \ \ \textcolor{keywordflow}{if}\ (IsValidXmlCharacter(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\textcolor{keyword}{>}(*it)))}
\DoxyCodeLine{04080\ \ \ \ \ \ \ output.push\_back(*it);}
\DoxyCodeLine{04081\ }
\DoxyCodeLine{04082\ \ \ \textcolor{keywordflow}{return}\ output;}
\DoxyCodeLine{04083\ \}}
\DoxyCodeLine{04084\ }
\DoxyCodeLine{04085\ \textcolor{comment}{//\ The\ following\ routines\ generate\ an\ XML\ representation\ of\ a\ UnitTest}}
\DoxyCodeLine{04086\ \textcolor{comment}{//\ object.}}
\DoxyCodeLine{04087\ \textcolor{comment}{//}}
\DoxyCodeLine{04088\ \textcolor{comment}{//\ This\ is\ how\ Google\ Test\ concepts\ map\ to\ the\ DTD:}}
\DoxyCodeLine{04089\ \textcolor{comment}{//}}
\DoxyCodeLine{04090\ \textcolor{comment}{//\ <testsuites\ name="{}AllTests"{}>\ \ \ \ \ \ \ \ <-\/-\/\ corresponds\ to\ a\ UnitTest\ object}}
\DoxyCodeLine{04091\ \textcolor{comment}{//\ \ \ <testsuite\ name="{}testcase-\/name"{}>\ \ <-\/-\/\ corresponds\ to\ a\ TestSuite\ object}}
\DoxyCodeLine{04092\ \textcolor{comment}{//\ \ \ \ \ <testcase\ name="{}test-\/name"{}>\ \ \ \ \ <-\/-\/\ corresponds\ to\ a\ TestInfo\ object}}
\DoxyCodeLine{04093\ \textcolor{comment}{//\ \ \ \ \ \ \ <failure\ message="{}..."{}>...</failure>}}
\DoxyCodeLine{04094\ \textcolor{comment}{//\ \ \ \ \ \ \ <failure\ message="{}..."{}>...</failure>}}
\DoxyCodeLine{04095\ \textcolor{comment}{//\ \ \ \ \ \ \ <failure\ message="{}..."{}>...</failure>}}
\DoxyCodeLine{04096\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <-\/-\/\ individual\ assertion\ failures}}
\DoxyCodeLine{04097\ \textcolor{comment}{//\ \ \ \ \ </testcase>}}
\DoxyCodeLine{04098\ \textcolor{comment}{//\ \ \ </testsuite>}}
\DoxyCodeLine{04099\ \textcolor{comment}{//\ </testsuites>}}
\DoxyCodeLine{04100\ }
\DoxyCodeLine{04101\ \textcolor{comment}{//\ Formats\ the\ given\ time\ in\ milliseconds\ as\ seconds.}}
\DoxyCodeLine{04102\ std::string\ FormatTimeInMillisAsSeconds(TimeInMillis\ ms)\ \{}
\DoxyCodeLine{04103\ \ \ ::std::stringstream\ ss;}
\DoxyCodeLine{04104\ \ \ ss\ <<\ (static\_cast<double>(ms)\ *\ 1e-\/3);}
\DoxyCodeLine{04105\ \ \ \textcolor{keywordflow}{return}\ ss.str();}
\DoxyCodeLine{04106\ \}}
\DoxyCodeLine{04107\ }
\DoxyCodeLine{04108\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ PortableLocaltime(time\_t\ seconds,\ \textcolor{keyword}{struct}\ tm*\ out)\ \{}
\DoxyCodeLine{04109\ \textcolor{preprocessor}{\#if\ defined(\_MSC\_VER)}}
\DoxyCodeLine{04110\ \ \ \textcolor{keywordflow}{return}\ localtime\_s(out,\ \&seconds)\ ==\ 0;}
\DoxyCodeLine{04111\ \textcolor{preprocessor}{\#elif\ defined(\_\_MINGW32\_\_)\ ||\ defined(\_\_MINGW64\_\_)}}
\DoxyCodeLine{04112\ \ \ \textcolor{comment}{//\ MINGW\ <time.h>\ provides\ neither\ localtime\_r\ nor\ localtime\_s,\ but\ uses}}
\DoxyCodeLine{04113\ \ \ \textcolor{comment}{//\ Windows'\ localtime(),\ which\ has\ a\ thread-\/local\ tm\ buffer.}}
\DoxyCodeLine{04114\ \ \ \textcolor{keyword}{struct\ }tm*\ tm\_ptr\ =\ localtime(\&seconds);\ \ \textcolor{comment}{//\ NOLINT}}
\DoxyCodeLine{04115\ \ \ \textcolor{keywordflow}{if}\ (tm\_ptr\ ==\ \textcolor{keyword}{nullptr})\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{04116\ \ \ *out\ =\ *tm\_ptr;}
\DoxyCodeLine{04117\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{04118\ \textcolor{preprocessor}{\#elif\ defined(\_\_STDC\_LIB\_EXT1\_\_)}}
\DoxyCodeLine{04119\ \ \ \textcolor{comment}{//\ Uses\ localtime\_s\ when\ available\ as\ localtime\_r\ is\ only\ available\ from}}
\DoxyCodeLine{04120\ \ \ \textcolor{comment}{//\ C23\ standard.}}
\DoxyCodeLine{04121\ \ \ \textcolor{keywordflow}{return}\ localtime\_s(\&seconds,\ out)\ !=\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{04122\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{04123\ \ \ \textcolor{keywordflow}{return}\ localtime\_r(\&seconds,\ out)\ !=\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{04124\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{04125\ \}}
\DoxyCodeLine{04126\ }
\DoxyCodeLine{04127\ \textcolor{comment}{//\ Converts\ the\ given\ epoch\ time\ in\ milliseconds\ to\ a\ date\ string\ in\ the\ ISO}}
\DoxyCodeLine{04128\ \textcolor{comment}{//\ 8601\ format,\ without\ the\ timezone\ information.}}
\DoxyCodeLine{04129\ std::string\ FormatEpochTimeInMillisAsIso8601(TimeInMillis\ ms)\ \{}
\DoxyCodeLine{04130\ \ \ \textcolor{keyword}{struct\ }tm\ time\_struct;}
\DoxyCodeLine{04131\ \ \ \textcolor{keywordflow}{if}\ (!PortableLocaltime(\textcolor{keyword}{static\_cast<}time\_t\textcolor{keyword}{>}(ms\ /\ 1000),\ \&time\_struct))}
\DoxyCodeLine{04132\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{04133\ \ \ \textcolor{comment}{//\ YYYY-\/MM-\/DDThh:mm:ss.sss}}
\DoxyCodeLine{04134\ \ \ \textcolor{keywordflow}{return}\ StreamableToString(time\_struct.tm\_year\ +\ 1900)\ +\ \textcolor{stringliteral}{"{}-\/"{}}\ +}
\DoxyCodeLine{04135\ \ \ \ \ \ \ \ \ \ String::FormatIntWidth2(time\_struct.tm\_mon\ +\ 1)\ +\ \textcolor{stringliteral}{"{}-\/"{}}\ +}
\DoxyCodeLine{04136\ \ \ \ \ \ \ \ \ \ String::FormatIntWidth2(time\_struct.tm\_mday)\ +\ \textcolor{stringliteral}{"{}T"{}}\ +}
\DoxyCodeLine{04137\ \ \ \ \ \ \ \ \ \ String::FormatIntWidth2(time\_struct.tm\_hour)\ +\ \textcolor{stringliteral}{"{}:"{}}\ +}
\DoxyCodeLine{04138\ \ \ \ \ \ \ \ \ \ String::FormatIntWidth2(time\_struct.tm\_min)\ +\ \textcolor{stringliteral}{"{}:"{}}\ +}
\DoxyCodeLine{04139\ \ \ \ \ \ \ \ \ \ String::FormatIntWidth2(time\_struct.tm\_sec)\ +\ \textcolor{stringliteral}{"{}."{}}\ +}
\DoxyCodeLine{04140\ \ \ \ \ \ \ \ \ \ String::FormatIntWidthN(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(ms\ \%\ 1000),\ 3);}
\DoxyCodeLine{04141\ \}}
\DoxyCodeLine{04142\ }
\DoxyCodeLine{04143\ \textcolor{comment}{//\ Streams\ an\ XML\ CDATA\ section,\ escaping\ invalid\ CDATA\ sequences\ as\ needed.}}
\DoxyCodeLine{04144\ \textcolor{keywordtype}{void}\ XmlUnitTestResultPrinter::OutputXmlCDataSection(::std::ostream*\ stream,}
\DoxyCodeLine{04145\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ data)\ \{}
\DoxyCodeLine{04146\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ segment\ =\ data;}
\DoxyCodeLine{04147\ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}<![CDATA["{}};}
\DoxyCodeLine{04148\ \ \ \textcolor{keywordflow}{for}\ (;;)\ \{}
\DoxyCodeLine{04149\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \textcolor{keyword}{const}\ next\_segment\ =\ strstr(segment,\ \textcolor{stringliteral}{"{}]]>"{}});}
\DoxyCodeLine{04150\ \ \ \ \ \textcolor{keywordflow}{if}\ (next\_segment\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{04151\ \ \ \ \ \ \ stream-\/>write(segment,}
\DoxyCodeLine{04152\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}std::streamsize\textcolor{keyword}{>}(next\_segment\ -\/\ segment));}
\DoxyCodeLine{04153\ \ \ \ \ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}]]>]]\&gt;<![CDATA["{}};}
\DoxyCodeLine{04154\ \ \ \ \ \ \ segment\ =\ next\_segment\ +\ strlen(\textcolor{stringliteral}{"{}]]>"{}});}
\DoxyCodeLine{04155\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{04156\ \ \ \ \ \ \ *stream\ <<\ segment;}
\DoxyCodeLine{04157\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04158\ \ \ \ \ \}}
\DoxyCodeLine{04159\ \ \ \}}
\DoxyCodeLine{04160\ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}]]>"{}};}
\DoxyCodeLine{04161\ \}}
\DoxyCodeLine{04162\ }
\DoxyCodeLine{04163\ \textcolor{keywordtype}{void}\ XmlUnitTestResultPrinter::OutputXmlAttribute(}
\DoxyCodeLine{04164\ \ \ \ \ std::ostream*\ stream,\ \textcolor{keyword}{const}\ std::string\&\ element\_name,}
\DoxyCodeLine{04165\ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ name,\ \textcolor{keyword}{const}\ std::string\&\ value)\ \{}
\DoxyCodeLine{04166\ \ \ \textcolor{keyword}{const}\ std::vector<std::string>\&\ allowed\_names\ =}
\DoxyCodeLine{04167\ \ \ \ \ \ \ GetReservedOutputAttributesForElement(element\_name);}
\DoxyCodeLine{04168\ }
\DoxyCodeLine{04169\ \ \ GTEST\_CHECK\_(std::find(allowed\_names.begin(),\ allowed\_names.end(),\ name)\ !=}
\DoxyCodeLine{04170\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ allowed\_names.end())}
\DoxyCodeLine{04171\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Attribute\ "{}}\ <<\ name\ <<\ \textcolor{stringliteral}{"{}\ is\ not\ allowed\ for\ element\ <"{}}\ <<\ element\_name}
\DoxyCodeLine{04172\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}>."{}};}
\DoxyCodeLine{04173\ }
\DoxyCodeLine{04174\ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}\ "{}}\ <<\ name\ <<\ \textcolor{stringliteral}{"{}=\(\backslash\)"{}"{}}\ <<\ EscapeXmlAttribute(value)\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}"{}};}
\DoxyCodeLine{04175\ \}}
\DoxyCodeLine{04176\ }
\DoxyCodeLine{04177\ \textcolor{comment}{//\ Streams\ a\ test\ suite\ XML\ stanza\ containing\ the\ given\ test\ result.}}
\DoxyCodeLine{04178\ \textcolor{keywordtype}{void}\ XmlUnitTestResultPrinter::OutputXmlTestSuiteForTestResult(}
\DoxyCodeLine{04179\ \ \ \ \ ::std::ostream*\ stream,\ \textcolor{keyword}{const}\ TestResult\&\ result)\ \{}
\DoxyCodeLine{04180\ \ \ \textcolor{comment}{//\ Output\ the\ boilerplate\ for\ a\ minimal\ test\ suite\ with\ one\ test.}}
\DoxyCodeLine{04181\ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}\ \ <testsuite"{}};}
\DoxyCodeLine{04182\ \ \ OutputXmlAttribute(stream,\ \textcolor{stringliteral}{"{}testsuite"{}},\ \textcolor{stringliteral}{"{}name"{}},\ \textcolor{stringliteral}{"{}NonTestSuiteFailure"{}});}
\DoxyCodeLine{04183\ \ \ OutputXmlAttribute(stream,\ \textcolor{stringliteral}{"{}testsuite"{}},\ \textcolor{stringliteral}{"{}tests"{}},\ \textcolor{stringliteral}{"{}1"{}});}
\DoxyCodeLine{04184\ \ \ OutputXmlAttribute(stream,\ \textcolor{stringliteral}{"{}testsuite"{}},\ \textcolor{stringliteral}{"{}failures"{}},\ \textcolor{stringliteral}{"{}1"{}});}
\DoxyCodeLine{04185\ \ \ OutputXmlAttribute(stream,\ \textcolor{stringliteral}{"{}testsuite"{}},\ \textcolor{stringliteral}{"{}disabled"{}},\ \textcolor{stringliteral}{"{}0"{}});}
\DoxyCodeLine{04186\ \ \ OutputXmlAttribute(stream,\ \textcolor{stringliteral}{"{}testsuite"{}},\ \textcolor{stringliteral}{"{}skipped"{}},\ \textcolor{stringliteral}{"{}0"{}});}
\DoxyCodeLine{04187\ \ \ OutputXmlAttribute(stream,\ \textcolor{stringliteral}{"{}testsuite"{}},\ \textcolor{stringliteral}{"{}errors"{}},\ \textcolor{stringliteral}{"{}0"{}});}
\DoxyCodeLine{04188\ \ \ OutputXmlAttribute(stream,\ \textcolor{stringliteral}{"{}testsuite"{}},\ \textcolor{stringliteral}{"{}time"{}},}
\DoxyCodeLine{04189\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FormatTimeInMillisAsSeconds(result.elapsed\_time()));}
\DoxyCodeLine{04190\ \ \ OutputXmlAttribute(}
\DoxyCodeLine{04191\ \ \ \ \ \ \ stream,\ \textcolor{stringliteral}{"{}testsuite"{}},\ \textcolor{stringliteral}{"{}timestamp"{}},}
\DoxyCodeLine{04192\ \ \ \ \ \ \ FormatEpochTimeInMillisAsIso8601(result.start\_timestamp()));}
\DoxyCodeLine{04193\ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}>"{}};}
\DoxyCodeLine{04194\ }
\DoxyCodeLine{04195\ \ \ \textcolor{comment}{//\ Output\ the\ boilerplate\ for\ a\ minimal\ test\ case\ with\ a\ single\ test.}}
\DoxyCodeLine{04196\ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}\ \ \ \ <testcase"{}};}
\DoxyCodeLine{04197\ \ \ OutputXmlAttribute(stream,\ \textcolor{stringliteral}{"{}testcase"{}},\ \textcolor{stringliteral}{"{}name"{}},\ \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{04198\ \ \ OutputXmlAttribute(stream,\ \textcolor{stringliteral}{"{}testcase"{}},\ \textcolor{stringliteral}{"{}status"{}},\ \textcolor{stringliteral}{"{}run"{}});}
\DoxyCodeLine{04199\ \ \ OutputXmlAttribute(stream,\ \textcolor{stringliteral}{"{}testcase"{}},\ \textcolor{stringliteral}{"{}result"{}},\ \textcolor{stringliteral}{"{}completed"{}});}
\DoxyCodeLine{04200\ \ \ OutputXmlAttribute(stream,\ \textcolor{stringliteral}{"{}testcase"{}},\ \textcolor{stringliteral}{"{}classname"{}},\ \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{04201\ \ \ OutputXmlAttribute(stream,\ \textcolor{stringliteral}{"{}testcase"{}},\ \textcolor{stringliteral}{"{}time"{}},}
\DoxyCodeLine{04202\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FormatTimeInMillisAsSeconds(result.elapsed\_time()));}
\DoxyCodeLine{04203\ \ \ OutputXmlAttribute(}
\DoxyCodeLine{04204\ \ \ \ \ \ \ stream,\ \textcolor{stringliteral}{"{}testcase"{}},\ \textcolor{stringliteral}{"{}timestamp"{}},}
\DoxyCodeLine{04205\ \ \ \ \ \ \ FormatEpochTimeInMillisAsIso8601(result.start\_timestamp()));}
\DoxyCodeLine{04206\ }
\DoxyCodeLine{04207\ \ \ \textcolor{comment}{//\ Output\ the\ actual\ test\ result.}}
\DoxyCodeLine{04208\ \ \ OutputXmlTestResult(stream,\ result);}
\DoxyCodeLine{04209\ }
\DoxyCodeLine{04210\ \ \ \textcolor{comment}{//\ Complete\ the\ test\ suite.}}
\DoxyCodeLine{04211\ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}\ \ </testsuite>\(\backslash\)n"{}};}
\DoxyCodeLine{04212\ \}}
\DoxyCodeLine{04213\ }
\DoxyCodeLine{04214\ \textcolor{comment}{//\ Prints\ an\ XML\ representation\ of\ a\ TestInfo\ object.}}
\DoxyCodeLine{04215\ \textcolor{keywordtype}{void}\ XmlUnitTestResultPrinter::OutputXmlTestInfo(::std::ostream*\ stream,}
\DoxyCodeLine{04216\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ test\_suite\_name,}
\DoxyCodeLine{04217\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ TestInfo\&\ test\_info)\ \{}
\DoxyCodeLine{04218\ \ \ \textcolor{keyword}{const}\ TestResult\&\ result\ =\ *test\_info.result();}
\DoxyCodeLine{04219\ \ \ \textcolor{keyword}{const}\ std::string\ kTestsuite\ =\ \textcolor{stringliteral}{"{}testcase"{}};}
\DoxyCodeLine{04220\ }
\DoxyCodeLine{04221\ \ \ \textcolor{keywordflow}{if}\ (test\_info.is\_in\_another\_shard())\ \{}
\DoxyCodeLine{04222\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{04223\ \ \ \}}
\DoxyCodeLine{04224\ }
\DoxyCodeLine{04225\ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}\ \ \ \ <testcase"{}};}
\DoxyCodeLine{04226\ \ \ OutputXmlAttribute(stream,\ kTestsuite,\ \textcolor{stringliteral}{"{}name"{}},\ test\_info.name());}
\DoxyCodeLine{04227\ }
\DoxyCodeLine{04228\ \ \ \textcolor{keywordflow}{if}\ (test\_info.value\_param()\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{04229\ \ \ \ \ OutputXmlAttribute(stream,\ kTestsuite,\ \textcolor{stringliteral}{"{}value\_param"{}},}
\DoxyCodeLine{04230\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ test\_info.value\_param());}
\DoxyCodeLine{04231\ \ \ \}}
\DoxyCodeLine{04232\ \ \ \textcolor{keywordflow}{if}\ (test\_info.type\_param()\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{04233\ \ \ \ \ OutputXmlAttribute(stream,\ kTestsuite,\ \textcolor{stringliteral}{"{}type\_param"{}},}
\DoxyCodeLine{04234\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ test\_info.type\_param());}
\DoxyCodeLine{04235\ \ \ \}}
\DoxyCodeLine{04236\ }
\DoxyCodeLine{04237\ \ \ OutputXmlAttribute(stream,\ kTestsuite,\ \textcolor{stringliteral}{"{}file"{}},\ test\_info.file());}
\DoxyCodeLine{04238\ \ \ OutputXmlAttribute(stream,\ kTestsuite,\ \textcolor{stringliteral}{"{}line"{}},}
\DoxyCodeLine{04239\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ StreamableToString(test\_info.line()));}
\DoxyCodeLine{04240\ \ \ \textcolor{keywordflow}{if}\ (GTEST\_FLAG\_GET(list\_tests))\ \{}
\DoxyCodeLine{04241\ \ \ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}\ />\(\backslash\)n"{}};}
\DoxyCodeLine{04242\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{04243\ \ \ \}}
\DoxyCodeLine{04244\ }
\DoxyCodeLine{04245\ \ \ OutputXmlAttribute(stream,\ kTestsuite,\ \textcolor{stringliteral}{"{}status"{}},}
\DoxyCodeLine{04246\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ test\_info.should\_run()\ ?\ \textcolor{stringliteral}{"{}run"{}}\ :\ \textcolor{stringliteral}{"{}notrun"{}});}
\DoxyCodeLine{04247\ \ \ OutputXmlAttribute(stream,\ kTestsuite,\ \textcolor{stringliteral}{"{}result"{}},}
\DoxyCodeLine{04248\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ test\_info.should\_run()}
\DoxyCodeLine{04249\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ?\ (result.Skipped()\ ?\ \textcolor{stringliteral}{"{}skipped"{}}\ :\ \textcolor{stringliteral}{"{}completed"{}})}
\DoxyCodeLine{04250\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ \textcolor{stringliteral}{"{}suppressed"{}});}
\DoxyCodeLine{04251\ \ \ OutputXmlAttribute(stream,\ kTestsuite,\ \textcolor{stringliteral}{"{}time"{}},}
\DoxyCodeLine{04252\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FormatTimeInMillisAsSeconds(result.elapsed\_time()));}
\DoxyCodeLine{04253\ \ \ OutputXmlAttribute(}
\DoxyCodeLine{04254\ \ \ \ \ \ \ stream,\ kTestsuite,\ \textcolor{stringliteral}{"{}timestamp"{}},}
\DoxyCodeLine{04255\ \ \ \ \ \ \ FormatEpochTimeInMillisAsIso8601(result.start\_timestamp()));}
\DoxyCodeLine{04256\ \ \ OutputXmlAttribute(stream,\ kTestsuite,\ \textcolor{stringliteral}{"{}classname"{}},\ test\_suite\_name);}
\DoxyCodeLine{04257\ }
\DoxyCodeLine{04258\ \ \ OutputXmlTestResult(stream,\ result);}
\DoxyCodeLine{04259\ \}}
\DoxyCodeLine{04260\ }
\DoxyCodeLine{04261\ \textcolor{keywordtype}{void}\ XmlUnitTestResultPrinter::OutputXmlTestResult(::std::ostream*\ stream,}
\DoxyCodeLine{04262\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ TestResult\&\ result)\ \{}
\DoxyCodeLine{04263\ \ \ \textcolor{keywordtype}{int}\ failures\ =\ 0;}
\DoxyCodeLine{04264\ \ \ \textcolor{keywordtype}{int}\ skips\ =\ 0;}
\DoxyCodeLine{04265\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ result.total\_part\_count();\ ++i)\ \{}
\DoxyCodeLine{04266\ \ \ \ \ \textcolor{keyword}{const}\ TestPartResult\&\ part\ =\ result.GetTestPartResult(i);}
\DoxyCodeLine{04267\ \ \ \ \ \textcolor{keywordflow}{if}\ (part.failed())\ \{}
\DoxyCodeLine{04268\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (++failures\ ==\ 1\ \&\&\ skips\ ==\ 0)\ \{}
\DoxyCodeLine{04269\ \ \ \ \ \ \ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}>\(\backslash\)n"{}};}
\DoxyCodeLine{04270\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04271\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ location\ =}
\DoxyCodeLine{04272\ \ \ \ \ \ \ \ \ \ \ internal::FormatCompilerIndependentFileLocation(part.file\_name(),}
\DoxyCodeLine{04273\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ part.line\_number());}
\DoxyCodeLine{04274\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ summary\ =\ location\ +\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}\ +\ part.summary();}
\DoxyCodeLine{04275\ \ \ \ \ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}\ \ \ \ \ \ <failure\ message=\(\backslash\)"{}"{}}\ <<\ EscapeXmlAttribute(summary)}
\DoxyCodeLine{04276\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}\ type=\(\backslash\)"{}\(\backslash\)"{}>"{}};}
\DoxyCodeLine{04277\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ detail\ =\ location\ +\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}\ +\ part.message();}
\DoxyCodeLine{04278\ \ \ \ \ \ \ OutputXmlCDataSection(stream,\ RemoveInvalidXmlCharacters(detail).c\_str());}
\DoxyCodeLine{04279\ \ \ \ \ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}</failure>\(\backslash\)n"{}};}
\DoxyCodeLine{04280\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (part.skipped())\ \{}
\DoxyCodeLine{04281\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (++skips\ ==\ 1\ \&\&\ failures\ ==\ 0)\ \{}
\DoxyCodeLine{04282\ \ \ \ \ \ \ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}>\(\backslash\)n"{}};}
\DoxyCodeLine{04283\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04284\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ location\ =}
\DoxyCodeLine{04285\ \ \ \ \ \ \ \ \ \ \ internal::FormatCompilerIndependentFileLocation(part.file\_name(),}
\DoxyCodeLine{04286\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ part.line\_number());}
\DoxyCodeLine{04287\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ summary\ =\ location\ +\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}\ +\ part.summary();}
\DoxyCodeLine{04288\ \ \ \ \ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}\ \ \ \ \ \ <skipped\ message=\(\backslash\)"{}"{}}}
\DoxyCodeLine{04289\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ EscapeXmlAttribute(summary.c\_str())\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}>"{}};}
\DoxyCodeLine{04290\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ detail\ =\ location\ +\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}\ +\ part.message();}
\DoxyCodeLine{04291\ \ \ \ \ \ \ OutputXmlCDataSection(stream,\ RemoveInvalidXmlCharacters(detail).c\_str());}
\DoxyCodeLine{04292\ \ \ \ \ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}</skipped>\(\backslash\)n"{}};}
\DoxyCodeLine{04293\ \ \ \ \ \}}
\DoxyCodeLine{04294\ \ \ \}}
\DoxyCodeLine{04295\ }
\DoxyCodeLine{04296\ \ \ \textcolor{keywordflow}{if}\ (failures\ ==\ 0\ \&\&\ skips\ ==\ 0\ \&\&\ result.test\_property\_count()\ ==\ 0)\ \{}
\DoxyCodeLine{04297\ \ \ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}\ />\(\backslash\)n"{}};}
\DoxyCodeLine{04298\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{04299\ \ \ \ \ \textcolor{keywordflow}{if}\ (failures\ ==\ 0\ \&\&\ skips\ ==\ 0)\ \{}
\DoxyCodeLine{04300\ \ \ \ \ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}>\(\backslash\)n"{}};}
\DoxyCodeLine{04301\ \ \ \ \ \}}
\DoxyCodeLine{04302\ \ \ \ \ OutputXmlTestProperties(stream,\ result);}
\DoxyCodeLine{04303\ \ \ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}\ \ \ \ </testcase>\(\backslash\)n"{}};}
\DoxyCodeLine{04304\ \ \ \}}
\DoxyCodeLine{04305\ \}}
\DoxyCodeLine{04306\ }
\DoxyCodeLine{04307\ \textcolor{comment}{//\ Prints\ an\ XML\ representation\ of\ a\ TestSuite\ object}}
\DoxyCodeLine{04308\ \textcolor{keywordtype}{void}\ XmlUnitTestResultPrinter::PrintXmlTestSuite(std::ostream*\ stream,}
\DoxyCodeLine{04309\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ TestSuite\&\ test\_suite)\ \{}
\DoxyCodeLine{04310\ \ \ \textcolor{keyword}{const}\ std::string\ kTestsuite\ =\ \textcolor{stringliteral}{"{}testsuite"{}};}
\DoxyCodeLine{04311\ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}\ \ <"{}}\ <<\ kTestsuite;}
\DoxyCodeLine{04312\ \ \ OutputXmlAttribute(stream,\ kTestsuite,\ \textcolor{stringliteral}{"{}name"{}},\ test\_suite.name());}
\DoxyCodeLine{04313\ \ \ OutputXmlAttribute(stream,\ kTestsuite,\ \textcolor{stringliteral}{"{}tests"{}},}
\DoxyCodeLine{04314\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ StreamableToString(test\_suite.reportable\_test\_count()));}
\DoxyCodeLine{04315\ \ \ \textcolor{keywordflow}{if}\ (!GTEST\_FLAG\_GET(list\_tests))\ \{}
\DoxyCodeLine{04316\ \ \ \ \ OutputXmlAttribute(stream,\ kTestsuite,\ \textcolor{stringliteral}{"{}failures"{}},}
\DoxyCodeLine{04317\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ StreamableToString(test\_suite.failed\_test\_count()));}
\DoxyCodeLine{04318\ \ \ \ \ OutputXmlAttribute(}
\DoxyCodeLine{04319\ \ \ \ \ \ \ \ \ stream,\ kTestsuite,\ \textcolor{stringliteral}{"{}disabled"{}},}
\DoxyCodeLine{04320\ \ \ \ \ \ \ \ \ StreamableToString(test\_suite.reportable\_disabled\_test\_count()));}
\DoxyCodeLine{04321\ \ \ \ \ OutputXmlAttribute(stream,\ kTestsuite,\ \textcolor{stringliteral}{"{}skipped"{}},}
\DoxyCodeLine{04322\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ StreamableToString(test\_suite.skipped\_test\_count()));}
\DoxyCodeLine{04323\ }
\DoxyCodeLine{04324\ \ \ \ \ OutputXmlAttribute(stream,\ kTestsuite,\ \textcolor{stringliteral}{"{}errors"{}},\ \textcolor{stringliteral}{"{}0"{}});}
\DoxyCodeLine{04325\ }
\DoxyCodeLine{04326\ \ \ \ \ OutputXmlAttribute(stream,\ kTestsuite,\ \textcolor{stringliteral}{"{}time"{}},}
\DoxyCodeLine{04327\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FormatTimeInMillisAsSeconds(test\_suite.elapsed\_time()));}
\DoxyCodeLine{04328\ \ \ \ \ OutputXmlAttribute(}
\DoxyCodeLine{04329\ \ \ \ \ \ \ \ \ stream,\ kTestsuite,\ \textcolor{stringliteral}{"{}timestamp"{}},}
\DoxyCodeLine{04330\ \ \ \ \ \ \ \ \ FormatEpochTimeInMillisAsIso8601(test\_suite.start\_timestamp()));}
\DoxyCodeLine{04331\ \ \ \ \ *stream\ <<\ TestPropertiesAsXmlAttributes(test\_suite.ad\_hoc\_test\_result());}
\DoxyCodeLine{04332\ \ \ \}}
\DoxyCodeLine{04333\ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}>\(\backslash\)n"{}};}
\DoxyCodeLine{04334\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ test\_suite.total\_test\_count();\ ++i)\ \{}
\DoxyCodeLine{04335\ \ \ \ \ \textcolor{keywordflow}{if}\ (test\_suite.GetTestInfo(i)-\/>is\_reportable())}
\DoxyCodeLine{04336\ \ \ \ \ \ \ OutputXmlTestInfo(stream,\ test\_suite.name(),\ *test\_suite.GetTestInfo(i));}
\DoxyCodeLine{04337\ \ \ \}}
\DoxyCodeLine{04338\ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}\ \ </"{}}\ <<\ kTestsuite\ <<\ \textcolor{stringliteral}{"{}>\(\backslash\)n"{}};}
\DoxyCodeLine{04339\ \}}
\DoxyCodeLine{04340\ }
\DoxyCodeLine{04341\ \textcolor{comment}{//\ Prints\ an\ XML\ summary\ of\ unit\_test\ to\ output\ stream\ out.}}
\DoxyCodeLine{04342\ \textcolor{keywordtype}{void}\ XmlUnitTestResultPrinter::PrintXmlUnitTest(std::ostream*\ stream,}
\DoxyCodeLine{04343\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ UnitTest\&\ unit\_test)\ \{}
\DoxyCodeLine{04344\ \ \ \textcolor{keyword}{const}\ std::string\ kTestsuites\ =\ \textcolor{stringliteral}{"{}testsuites"{}};}
\DoxyCodeLine{04345\ }
\DoxyCodeLine{04346\ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}<?xml\ version=\(\backslash\)"{}1.0\(\backslash\)"{}\ encoding=\(\backslash\)"{}UTF-\/8\(\backslash\)"{}?>\(\backslash\)n"{}};}
\DoxyCodeLine{04347\ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}<"{}}\ <<\ kTestsuites;}
\DoxyCodeLine{04348\ }
\DoxyCodeLine{04349\ \ \ OutputXmlAttribute(stream,\ kTestsuites,\ \textcolor{stringliteral}{"{}tests"{}},}
\DoxyCodeLine{04350\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ StreamableToString(unit\_test.reportable\_test\_count()));}
\DoxyCodeLine{04351\ \ \ OutputXmlAttribute(stream,\ kTestsuites,\ \textcolor{stringliteral}{"{}failures"{}},}
\DoxyCodeLine{04352\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ StreamableToString(unit\_test.failed\_test\_count()));}
\DoxyCodeLine{04353\ \ \ OutputXmlAttribute(}
\DoxyCodeLine{04354\ \ \ \ \ \ \ stream,\ kTestsuites,\ \textcolor{stringliteral}{"{}disabled"{}},}
\DoxyCodeLine{04355\ \ \ \ \ \ \ StreamableToString(unit\_test.reportable\_disabled\_test\_count()));}
\DoxyCodeLine{04356\ \ \ OutputXmlAttribute(stream,\ kTestsuites,\ \textcolor{stringliteral}{"{}errors"{}},\ \textcolor{stringliteral}{"{}0"{}});}
\DoxyCodeLine{04357\ \ \ OutputXmlAttribute(stream,\ kTestsuites,\ \textcolor{stringliteral}{"{}time"{}},}
\DoxyCodeLine{04358\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FormatTimeInMillisAsSeconds(unit\_test.elapsed\_time()));}
\DoxyCodeLine{04359\ \ \ OutputXmlAttribute(}
\DoxyCodeLine{04360\ \ \ \ \ \ \ stream,\ kTestsuites,\ \textcolor{stringliteral}{"{}timestamp"{}},}
\DoxyCodeLine{04361\ \ \ \ \ \ \ FormatEpochTimeInMillisAsIso8601(unit\_test.start\_timestamp()));}
\DoxyCodeLine{04362\ }
\DoxyCodeLine{04363\ \ \ \textcolor{keywordflow}{if}\ (GTEST\_FLAG\_GET(shuffle))\ \{}
\DoxyCodeLine{04364\ \ \ \ \ OutputXmlAttribute(stream,\ kTestsuites,\ \textcolor{stringliteral}{"{}random\_seed"{}},}
\DoxyCodeLine{04365\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ StreamableToString(unit\_test.random\_seed()));}
\DoxyCodeLine{04366\ \ \ \}}
\DoxyCodeLine{04367\ \ \ *stream\ <<\ TestPropertiesAsXmlAttributes(unit\_test.ad\_hoc\_test\_result());}
\DoxyCodeLine{04368\ }
\DoxyCodeLine{04369\ \ \ OutputXmlAttribute(stream,\ kTestsuites,\ \textcolor{stringliteral}{"{}name"{}},\ \textcolor{stringliteral}{"{}AllTests"{}});}
\DoxyCodeLine{04370\ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}>\(\backslash\)n"{}};}
\DoxyCodeLine{04371\ }
\DoxyCodeLine{04372\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ unit\_test.total\_test\_suite\_count();\ ++i)\ \{}
\DoxyCodeLine{04373\ \ \ \ \ \textcolor{keywordflow}{if}\ (unit\_test.GetTestSuite(i)-\/>reportable\_test\_count()\ >\ 0)}
\DoxyCodeLine{04374\ \ \ \ \ \ \ PrintXmlTestSuite(stream,\ *unit\_test.GetTestSuite(i));}
\DoxyCodeLine{04375\ \ \ \}}
\DoxyCodeLine{04376\ }
\DoxyCodeLine{04377\ \ \ \textcolor{comment}{//\ If\ there\ was\ a\ test\ failure\ outside\ of\ one\ of\ the\ test\ suites\ (like\ in\ a}}
\DoxyCodeLine{04378\ \ \ \textcolor{comment}{//\ test\ environment)\ include\ that\ in\ the\ output.}}
\DoxyCodeLine{04379\ \ \ \textcolor{keywordflow}{if}\ (unit\_test.ad\_hoc\_test\_result().Failed())\ \{}
\DoxyCodeLine{04380\ \ \ \ \ OutputXmlTestSuiteForTestResult(stream,\ unit\_test.ad\_hoc\_test\_result());}
\DoxyCodeLine{04381\ \ \ \}}
\DoxyCodeLine{04382\ }
\DoxyCodeLine{04383\ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}</"{}}\ <<\ kTestsuites\ <<\ \textcolor{stringliteral}{"{}>\(\backslash\)n"{}};}
\DoxyCodeLine{04384\ \}}
\DoxyCodeLine{04385\ }
\DoxyCodeLine{04386\ \textcolor{keywordtype}{void}\ XmlUnitTestResultPrinter::PrintXmlTestsList(}
\DoxyCodeLine{04387\ \ \ \ \ std::ostream*\ stream,\ \textcolor{keyword}{const}\ std::vector<TestSuite*>\&\ test\_suites)\ \{}
\DoxyCodeLine{04388\ \ \ \textcolor{keyword}{const}\ std::string\ kTestsuites\ =\ \textcolor{stringliteral}{"{}testsuites"{}};}
\DoxyCodeLine{04389\ }
\DoxyCodeLine{04390\ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}<?xml\ version=\(\backslash\)"{}1.0\(\backslash\)"{}\ encoding=\(\backslash\)"{}UTF-\/8\(\backslash\)"{}?>\(\backslash\)n"{}};}
\DoxyCodeLine{04391\ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}<"{}}\ <<\ kTestsuites;}
\DoxyCodeLine{04392\ }
\DoxyCodeLine{04393\ \ \ \textcolor{keywordtype}{int}\ total\_tests\ =\ 0;}
\DoxyCodeLine{04394\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ test\_suite\ :\ test\_suites)\ \{}
\DoxyCodeLine{04395\ \ \ \ \ total\_tests\ +=\ test\_suite-\/>total\_test\_count();}
\DoxyCodeLine{04396\ \ \ \}}
\DoxyCodeLine{04397\ \ \ OutputXmlAttribute(stream,\ kTestsuites,\ \textcolor{stringliteral}{"{}tests"{}},}
\DoxyCodeLine{04398\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ StreamableToString(total\_tests));}
\DoxyCodeLine{04399\ \ \ OutputXmlAttribute(stream,\ kTestsuites,\ \textcolor{stringliteral}{"{}name"{}},\ \textcolor{stringliteral}{"{}AllTests"{}});}
\DoxyCodeLine{04400\ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}>\(\backslash\)n"{}};}
\DoxyCodeLine{04401\ }
\DoxyCodeLine{04402\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ test\_suite\ :\ test\_suites)\ \{}
\DoxyCodeLine{04403\ \ \ \ \ PrintXmlTestSuite(stream,\ *test\_suite);}
\DoxyCodeLine{04404\ \ \ \}}
\DoxyCodeLine{04405\ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}</"{}}\ <<\ kTestsuites\ <<\ \textcolor{stringliteral}{"{}>\(\backslash\)n"{}};}
\DoxyCodeLine{04406\ \}}
\DoxyCodeLine{04407\ }
\DoxyCodeLine{04408\ \textcolor{comment}{//\ Produces\ a\ string\ representing\ the\ test\ properties\ in\ a\ result\ as\ space}}
\DoxyCodeLine{04409\ \textcolor{comment}{//\ delimited\ XML\ attributes\ based\ on\ the\ property\ key="{}value"{}\ pairs.}}
\DoxyCodeLine{04410\ std::string\ XmlUnitTestResultPrinter::TestPropertiesAsXmlAttributes(}
\DoxyCodeLine{04411\ \ \ \ \ \textcolor{keyword}{const}\ TestResult\&\ result)\ \{}
\DoxyCodeLine{04412\ \ \ Message\ attributes;}
\DoxyCodeLine{04413\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ result.test\_property\_count();\ ++i)\ \{}
\DoxyCodeLine{04414\ \ \ \ \ \textcolor{keyword}{const}\ TestProperty\&\ \textcolor{keyword}{property}\ =\ result.GetTestProperty(i);}
\DoxyCodeLine{04415\ \ \ \ \ attributes\ <<\ \textcolor{stringliteral}{"{}\ "{}}\ <<\ \textcolor{keyword}{property}.key()\ <<\ \textcolor{stringliteral}{"{}="{}}}
\DoxyCodeLine{04416\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}"{}}\ <<\ EscapeXmlAttribute(property.value())\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}"{}};}
\DoxyCodeLine{04417\ \ \ \}}
\DoxyCodeLine{04418\ \ \ \textcolor{keywordflow}{return}\ attributes.GetString();}
\DoxyCodeLine{04419\ \}}
\DoxyCodeLine{04420\ }
\DoxyCodeLine{04421\ \textcolor{keywordtype}{void}\ XmlUnitTestResultPrinter::OutputXmlTestProperties(}
\DoxyCodeLine{04422\ \ \ \ \ std::ostream*\ stream,\ \textcolor{keyword}{const}\ TestResult\&\ result)\ \{}
\DoxyCodeLine{04423\ \ \ \textcolor{keyword}{const}\ std::string\ kProperties\ =\ \textcolor{stringliteral}{"{}properties"{}};}
\DoxyCodeLine{04424\ \ \ \textcolor{keyword}{const}\ std::string\ kProperty\ =\ \textcolor{stringliteral}{"{}property"{}};}
\DoxyCodeLine{04425\ }
\DoxyCodeLine{04426\ \ \ \textcolor{keywordflow}{if}\ (result.test\_property\_count()\ <=\ 0)\ \{}
\DoxyCodeLine{04427\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{04428\ \ \ \}}
\DoxyCodeLine{04429\ }
\DoxyCodeLine{04430\ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}\ \ \ \ \ \ <"{}}\ <<\ kProperties\ <<\ \textcolor{stringliteral}{"{}>\(\backslash\)n"{}};}
\DoxyCodeLine{04431\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ result.test\_property\_count();\ ++i)\ \{}
\DoxyCodeLine{04432\ \ \ \ \ \textcolor{keyword}{const}\ TestProperty\&\ \textcolor{keyword}{property}\ =\ result.GetTestProperty(i);}
\DoxyCodeLine{04433\ \ \ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}\ \ \ \ \ \ \ \ <"{}}\ <<\ kProperty;}
\DoxyCodeLine{04434\ \ \ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}\ name=\(\backslash\)"{}"{}}\ <<\ EscapeXmlAttribute(property.key())\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}"{}};}
\DoxyCodeLine{04435\ \ \ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}\ value=\(\backslash\)"{}"{}}\ <<\ EscapeXmlAttribute(property.value())\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}"{}};}
\DoxyCodeLine{04436\ \ \ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}/>\(\backslash\)n"{}};}
\DoxyCodeLine{04437\ \ \ \}}
\DoxyCodeLine{04438\ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}\ \ \ \ \ \ </"{}}\ <<\ kProperties\ <<\ \textcolor{stringliteral}{"{}>\(\backslash\)n"{}};}
\DoxyCodeLine{04439\ \}}
\DoxyCodeLine{04440\ }
\DoxyCodeLine{04441\ \textcolor{comment}{//\ End\ XmlUnitTestResultPrinter}}
\DoxyCodeLine{04442\ }
\DoxyCodeLine{04443\ \textcolor{comment}{//\ This\ class\ generates\ an\ JSON\ output\ file.}}
\DoxyCodeLine{04444\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classtesting_1_1internal_1_1_json_unit_test_result_printer}{JsonUnitTestResultPrinter}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classtesting_1_1_empty_test_event_listener}{EmptyTestEventListener}}\ \{}
\DoxyCodeLine{04445\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{04446\ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{classtesting_1_1internal_1_1_json_unit_test_result_printer}{JsonUnitTestResultPrinter}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ output\_file);}
\DoxyCodeLine{04447\ }
\DoxyCodeLine{04448\ \ \ \textcolor{keywordtype}{void}\ OnTestIterationEnd(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_unit_test}{UnitTest}}\&\ unit\_test,\ \textcolor{keywordtype}{int}\ iteration)\ \textcolor{keyword}{override};}
\DoxyCodeLine{04449\ }
\DoxyCodeLine{04450\ \ \ \textcolor{comment}{//\ Prints\ an\ JSON\ summary\ of\ all\ unit\ tests.}}
\DoxyCodeLine{04451\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ PrintJsonTestList(::std::ostream*\ stream,}
\DoxyCodeLine{04452\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::vector<TestSuite*>\&\ test\_suites);}
\DoxyCodeLine{04453\ }
\DoxyCodeLine{04454\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{04455\ \ \ \textcolor{comment}{//\ Returns\ an\ JSON-\/escaped\ copy\ of\ the\ input\ string\ str.}}
\DoxyCodeLine{04456\ \ \ \textcolor{keyword}{static}\ std::string\ EscapeJson(\textcolor{keyword}{const}\ std::string\&\ str);}
\DoxyCodeLine{04457\ }
\DoxyCodeLine{04460\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ OutputJsonKey(std::ostream*\ stream,}
\DoxyCodeLine{04461\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ element\_name,}
\DoxyCodeLine{04462\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ name,\ \textcolor{keyword}{const}\ std::string\&\ value,}
\DoxyCodeLine{04463\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ indent,\ \textcolor{keywordtype}{bool}\ comma\ =\ \textcolor{keyword}{true});}
\DoxyCodeLine{04464\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ OutputJsonKey(std::ostream*\ stream,}
\DoxyCodeLine{04465\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ element\_name,}
\DoxyCodeLine{04466\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ name,\ \textcolor{keywordtype}{int}\ value,}
\DoxyCodeLine{04467\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ indent,\ \textcolor{keywordtype}{bool}\ comma\ =\ \textcolor{keyword}{true});}
\DoxyCodeLine{04468\ }
\DoxyCodeLine{04469\ \ \ \textcolor{comment}{//\ Streams\ a\ test\ suite\ JSON\ stanza\ containing\ the\ given\ test\ result.}}
\DoxyCodeLine{04470\ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{04471\ \ \ \textcolor{comment}{//\ Requires:\ result.Failed()}}
\DoxyCodeLine{04472\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ OutputJsonTestSuiteForTestResult(::std::ostream*\ stream,}
\DoxyCodeLine{04473\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_test_result}{TestResult}}\&\ result);}
\DoxyCodeLine{04474\ }
\DoxyCodeLine{04475\ \ \ \textcolor{comment}{//\ Streams\ a\ JSON\ representation\ of\ a\ TestResult\ object.}}
\DoxyCodeLine{04476\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ OutputJsonTestResult(::std::ostream*\ stream,}
\DoxyCodeLine{04477\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_test_result}{TestResult}}\&\ result);}
\DoxyCodeLine{04478\ }
\DoxyCodeLine{04479\ \ \ \textcolor{comment}{//\ Streams\ a\ JSON\ representation\ of\ a\ TestInfo\ object.}}
\DoxyCodeLine{04480\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ OutputJsonTestInfo(::std::ostream*\ stream,}
\DoxyCodeLine{04481\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ test\_suite\_name,}
\DoxyCodeLine{04482\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_test_info}{TestInfo}}\&\ test\_info);}
\DoxyCodeLine{04483\ }
\DoxyCodeLine{04484\ \ \ \textcolor{comment}{//\ Prints\ a\ JSON\ representation\ of\ a\ TestSuite\ object}}
\DoxyCodeLine{04485\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ PrintJsonTestSuite(::std::ostream*\ stream,}
\DoxyCodeLine{04486\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_test_suite}{TestSuite}}\&\ test\_suite);}
\DoxyCodeLine{04487\ }
\DoxyCodeLine{04488\ \ \ \textcolor{comment}{//\ Prints\ a\ JSON\ summary\ of\ unit\_test\ to\ output\ stream\ out.}}
\DoxyCodeLine{04489\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ PrintJsonUnitTest(::std::ostream*\ stream,}
\DoxyCodeLine{04490\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_unit_test}{UnitTest}}\&\ unit\_test);}
\DoxyCodeLine{04491\ }
\DoxyCodeLine{04492\ \ \ \textcolor{comment}{//\ Produces\ a\ string\ representing\ the\ test\ properties\ in\ a\ result\ as}}
\DoxyCodeLine{04493\ \ \ \textcolor{comment}{//\ a\ JSON\ dictionary.}}
\DoxyCodeLine{04494\ \ \ \textcolor{keyword}{static}\ std::string\ TestPropertiesAsJson(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_test_result}{TestResult}}\&\ result,}
\DoxyCodeLine{04495\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ indent);}
\DoxyCodeLine{04496\ }
\DoxyCodeLine{04497\ \ \ \textcolor{comment}{//\ The\ output\ file.}}
\DoxyCodeLine{04498\ \ \ \textcolor{keyword}{const}\ std::string\ output\_file\_;}
\DoxyCodeLine{04499\ }
\DoxyCodeLine{04500\ \ \ \mbox{\hyperlink{classtesting_1_1internal_1_1_json_unit_test_result_printer}{JsonUnitTestResultPrinter}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1internal_1_1_json_unit_test_result_printer}{JsonUnitTestResultPrinter}}\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{04501\ \ \ \mbox{\hyperlink{classtesting_1_1internal_1_1_json_unit_test_result_printer}{JsonUnitTestResultPrinter}}\&\ operator=(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1internal_1_1_json_unit_test_result_printer}{JsonUnitTestResultPrinter}}\&)\ =}
\DoxyCodeLine{04502\ \ \ \ \ \ \ \textcolor{keyword}{delete};}
\DoxyCodeLine{04503\ \};}
\DoxyCodeLine{04504\ }
\DoxyCodeLine{04505\ \textcolor{comment}{//\ Creates\ a\ new\ JsonUnitTestResultPrinter.}}
\DoxyCodeLine{04506\ JsonUnitTestResultPrinter::JsonUnitTestResultPrinter(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ output\_file)}
\DoxyCodeLine{04507\ \ \ \ \ :\ output\_file\_(output\_file)\ \{}
\DoxyCodeLine{04508\ \ \ \textcolor{keywordflow}{if}\ (output\_file\_.empty())\ \{}
\DoxyCodeLine{04509\ \ \ \ \ GTEST\_LOG\_(FATAL)\ <<\ \textcolor{stringliteral}{"{}JSON\ output\ file\ may\ not\ be\ null"{}};}
\DoxyCodeLine{04510\ \ \ \}}
\DoxyCodeLine{04511\ \}}
\DoxyCodeLine{04512\ }
\DoxyCodeLine{04513\ \textcolor{keywordtype}{void}\ JsonUnitTestResultPrinter::OnTestIterationEnd(\textcolor{keyword}{const}\ UnitTest\&\ unit\_test,}
\DoxyCodeLine{04514\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \textcolor{comment}{/*iteration*/})\ \{}
\DoxyCodeLine{04515\ \ \ FILE*\ jsonout\ =\ OpenFileForWriting(output\_file\_);}
\DoxyCodeLine{04516\ \ \ std::stringstream\ stream;}
\DoxyCodeLine{04517\ \ \ PrintJsonUnitTest(\&stream,\ unit\_test);}
\DoxyCodeLine{04518\ \ \ fprintf(jsonout,\ \textcolor{stringliteral}{"{}\%s"{}},\ StringStreamToString(\&stream).c\_str());}
\DoxyCodeLine{04519\ \ \ fclose(jsonout);}
\DoxyCodeLine{04520\ \}}
\DoxyCodeLine{04521\ }
\DoxyCodeLine{04522\ \textcolor{comment}{//\ Returns\ an\ JSON-\/escaped\ copy\ of\ the\ input\ string\ str.}}
\DoxyCodeLine{04523\ std::string\ JsonUnitTestResultPrinter::EscapeJson(\textcolor{keyword}{const}\ std::string\&\ str)\ \{}
\DoxyCodeLine{04524\ \ \ Message\ m;}
\DoxyCodeLine{04525\ }
\DoxyCodeLine{04526\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ str.size();\ ++i)\ \{}
\DoxyCodeLine{04527\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ ch\ =\ str[i];}
\DoxyCodeLine{04528\ \ \ \ \ \textcolor{keywordflow}{switch}\ (ch)\ \{}
\DoxyCodeLine{04529\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'\(\backslash\)\(\backslash\)'}:}
\DoxyCodeLine{04530\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'"{}'}:}
\DoxyCodeLine{04531\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'/'}:}
\DoxyCodeLine{04532\ \ \ \ \ \ \ \ \ m\ <<\ \textcolor{charliteral}{'\(\backslash\)\(\backslash\)'}\ <<\ ch;}
\DoxyCodeLine{04533\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04534\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'\(\backslash\)b'}:}
\DoxyCodeLine{04535\ \ \ \ \ \ \ \ \ m\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)\(\backslash\)b"{}};}
\DoxyCodeLine{04536\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04537\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'\(\backslash\)t'}:}
\DoxyCodeLine{04538\ \ \ \ \ \ \ \ \ m\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)\(\backslash\)t"{}};}
\DoxyCodeLine{04539\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04540\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'\(\backslash\)n'}:}
\DoxyCodeLine{04541\ \ \ \ \ \ \ \ \ m\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)\(\backslash\)n"{}};}
\DoxyCodeLine{04542\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04543\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'\(\backslash\)f'}:}
\DoxyCodeLine{04544\ \ \ \ \ \ \ \ \ m\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)\(\backslash\)f"{}};}
\DoxyCodeLine{04545\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04546\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'\(\backslash\)r'}:}
\DoxyCodeLine{04547\ \ \ \ \ \ \ \ \ m\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)\(\backslash\)r"{}};}
\DoxyCodeLine{04548\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04549\ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{04550\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ch\ <\ \textcolor{charliteral}{'\ '})\ \{}
\DoxyCodeLine{04551\ \ \ \ \ \ \ \ \ \ \ m\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)\(\backslash\)u00"{}}\ <<\ String::FormatByte(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\textcolor{keyword}{>}(ch));}
\DoxyCodeLine{04552\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{04553\ \ \ \ \ \ \ \ \ \ \ m\ <<\ ch;}
\DoxyCodeLine{04554\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04555\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04556\ \ \ \ \ \}}
\DoxyCodeLine{04557\ \ \ \}}
\DoxyCodeLine{04558\ }
\DoxyCodeLine{04559\ \ \ \textcolor{keywordflow}{return}\ m.GetString();}
\DoxyCodeLine{04560\ \}}
\DoxyCodeLine{04561\ }
\DoxyCodeLine{04562\ \textcolor{comment}{//\ The\ following\ routines\ generate\ an\ JSON\ representation\ of\ a\ UnitTest}}
\DoxyCodeLine{04563\ \textcolor{comment}{//\ object.}}
\DoxyCodeLine{04564\ }
\DoxyCodeLine{04565\ \textcolor{comment}{//\ Formats\ the\ given\ time\ in\ milliseconds\ as\ seconds.}}
\DoxyCodeLine{04566\ \textcolor{keyword}{static}\ std::string\ FormatTimeInMillisAsDuration(TimeInMillis\ ms)\ \{}
\DoxyCodeLine{04567\ \ \ ::std::stringstream\ ss;}
\DoxyCodeLine{04568\ \ \ ss\ <<\ (static\_cast<double>(ms)\ *\ 1e-\/3)\ <<\ \textcolor{stringliteral}{"{}s"{}};}
\DoxyCodeLine{04569\ \ \ \textcolor{keywordflow}{return}\ ss.str();}
\DoxyCodeLine{04570\ \}}
\DoxyCodeLine{04571\ }
\DoxyCodeLine{04572\ \textcolor{comment}{//\ Converts\ the\ given\ epoch\ time\ in\ milliseconds\ to\ a\ date\ string\ in\ the}}
\DoxyCodeLine{04573\ \textcolor{comment}{//\ RFC3339\ format,\ without\ the\ timezone\ information.}}
\DoxyCodeLine{04574\ \textcolor{keyword}{static}\ std::string\ FormatEpochTimeInMillisAsRFC3339(TimeInMillis\ ms)\ \{}
\DoxyCodeLine{04575\ \ \ \textcolor{keyword}{struct\ }tm\ time\_struct;}
\DoxyCodeLine{04576\ \ \ \textcolor{keywordflow}{if}\ (!PortableLocaltime(\textcolor{keyword}{static\_cast<}time\_t\textcolor{keyword}{>}(ms\ /\ 1000),\ \&time\_struct))}
\DoxyCodeLine{04577\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{04578\ \ \ \textcolor{comment}{//\ YYYY-\/MM-\/DDThh:mm:ss}}
\DoxyCodeLine{04579\ \ \ \textcolor{keywordflow}{return}\ StreamableToString(time\_struct.tm\_year\ +\ 1900)\ +\ \textcolor{stringliteral}{"{}-\/"{}}\ +}
\DoxyCodeLine{04580\ \ \ \ \ \ \ \ \ \ String::FormatIntWidth2(time\_struct.tm\_mon\ +\ 1)\ +\ \textcolor{stringliteral}{"{}-\/"{}}\ +}
\DoxyCodeLine{04581\ \ \ \ \ \ \ \ \ \ String::FormatIntWidth2(time\_struct.tm\_mday)\ +\ \textcolor{stringliteral}{"{}T"{}}\ +}
\DoxyCodeLine{04582\ \ \ \ \ \ \ \ \ \ String::FormatIntWidth2(time\_struct.tm\_hour)\ +\ \textcolor{stringliteral}{"{}:"{}}\ +}
\DoxyCodeLine{04583\ \ \ \ \ \ \ \ \ \ String::FormatIntWidth2(time\_struct.tm\_min)\ +\ \textcolor{stringliteral}{"{}:"{}}\ +}
\DoxyCodeLine{04584\ \ \ \ \ \ \ \ \ \ String::FormatIntWidth2(time\_struct.tm\_sec)\ +\ \textcolor{stringliteral}{"{}Z"{}};}
\DoxyCodeLine{04585\ \}}
\DoxyCodeLine{04586\ }
\DoxyCodeLine{04587\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ std::string\ Indent(\textcolor{keywordtype}{size\_t}\ width)\ \{}
\DoxyCodeLine{04588\ \ \ \textcolor{keywordflow}{return}\ std::string(width,\ \textcolor{charliteral}{'\ '});}
\DoxyCodeLine{04589\ \}}
\DoxyCodeLine{04590\ }
\DoxyCodeLine{04591\ \textcolor{keywordtype}{void}\ JsonUnitTestResultPrinter::OutputJsonKey(std::ostream*\ stream,}
\DoxyCodeLine{04592\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ element\_name,}
\DoxyCodeLine{04593\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ name,}
\DoxyCodeLine{04594\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ value,}
\DoxyCodeLine{04595\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ indent,}
\DoxyCodeLine{04596\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ comma)\ \{}
\DoxyCodeLine{04597\ \ \ \textcolor{keyword}{const}\ std::vector<std::string>\&\ allowed\_names\ =}
\DoxyCodeLine{04598\ \ \ \ \ \ \ GetReservedOutputAttributesForElement(element\_name);}
\DoxyCodeLine{04599\ }
\DoxyCodeLine{04600\ \ \ GTEST\_CHECK\_(std::find(allowed\_names.begin(),\ allowed\_names.end(),\ name)\ !=}
\DoxyCodeLine{04601\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ allowed\_names.end())}
\DoxyCodeLine{04602\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Key\ \(\backslash\)"{}"{}}\ <<\ name\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}\ is\ not\ allowed\ for\ value\ \(\backslash\)"{}"{}}\ <<\ element\_name}
\DoxyCodeLine{04603\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}."{}};}
\DoxyCodeLine{04604\ }
\DoxyCodeLine{04605\ \ \ *stream\ <<\ indent\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}"{}}\ <<\ name\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}:\ \(\backslash\)"{}"{}}\ <<\ EscapeJson(value)\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}"{}};}
\DoxyCodeLine{04606\ \ \ \textcolor{keywordflow}{if}\ (comma)\ *stream\ <<\ \textcolor{stringliteral}{"{},\(\backslash\)n"{}};}
\DoxyCodeLine{04607\ \}}
\DoxyCodeLine{04608\ }
\DoxyCodeLine{04609\ \textcolor{keywordtype}{void}\ JsonUnitTestResultPrinter::OutputJsonKey(}
\DoxyCodeLine{04610\ \ \ \ \ std::ostream*\ stream,\ \textcolor{keyword}{const}\ std::string\&\ element\_name,}
\DoxyCodeLine{04611\ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ name,\ \textcolor{keywordtype}{int}\ value,\ \textcolor{keyword}{const}\ std::string\&\ indent,\ \textcolor{keywordtype}{bool}\ comma)\ \{}
\DoxyCodeLine{04612\ \ \ \textcolor{keyword}{const}\ std::vector<std::string>\&\ allowed\_names\ =}
\DoxyCodeLine{04613\ \ \ \ \ \ \ GetReservedOutputAttributesForElement(element\_name);}
\DoxyCodeLine{04614\ }
\DoxyCodeLine{04615\ \ \ GTEST\_CHECK\_(std::find(allowed\_names.begin(),\ allowed\_names.end(),\ name)\ !=}
\DoxyCodeLine{04616\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ allowed\_names.end())}
\DoxyCodeLine{04617\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Key\ \(\backslash\)"{}"{}}\ <<\ name\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}\ is\ not\ allowed\ for\ value\ \(\backslash\)"{}"{}}\ <<\ element\_name}
\DoxyCodeLine{04618\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}."{}};}
\DoxyCodeLine{04619\ }
\DoxyCodeLine{04620\ \ \ *stream\ <<\ indent\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}"{}}\ <<\ name\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}:\ "{}}\ <<\ StreamableToString(value);}
\DoxyCodeLine{04621\ \ \ \textcolor{keywordflow}{if}\ (comma)\ *stream\ <<\ \textcolor{stringliteral}{"{},\(\backslash\)n"{}};}
\DoxyCodeLine{04622\ \}}
\DoxyCodeLine{04623\ }
\DoxyCodeLine{04624\ \textcolor{comment}{//\ Streams\ a\ test\ suite\ JSON\ stanza\ containing\ the\ given\ test\ result.}}
\DoxyCodeLine{04625\ \textcolor{keywordtype}{void}\ JsonUnitTestResultPrinter::OutputJsonTestSuiteForTestResult(}
\DoxyCodeLine{04626\ \ \ \ \ ::std::ostream*\ stream,\ \textcolor{keyword}{const}\ TestResult\&\ result)\ \{}
\DoxyCodeLine{04627\ \ \ \textcolor{comment}{//\ Output\ the\ boilerplate\ for\ a\ new\ test\ suite.}}
\DoxyCodeLine{04628\ \ \ *stream\ <<\ Indent(4)\ <<\ \textcolor{stringliteral}{"{}\{\(\backslash\)n"{}};}
\DoxyCodeLine{04629\ \ \ OutputJsonKey(stream,\ \textcolor{stringliteral}{"{}testsuite"{}},\ \textcolor{stringliteral}{"{}name"{}},\ \textcolor{stringliteral}{"{}NonTestSuiteFailure"{}},\ Indent(6));}
\DoxyCodeLine{04630\ \ \ OutputJsonKey(stream,\ \textcolor{stringliteral}{"{}testsuite"{}},\ \textcolor{stringliteral}{"{}tests"{}},\ 1,\ Indent(6));}
\DoxyCodeLine{04631\ \ \ \textcolor{keywordflow}{if}\ (!GTEST\_FLAG\_GET(list\_tests))\ \{}
\DoxyCodeLine{04632\ \ \ \ \ OutputJsonKey(stream,\ \textcolor{stringliteral}{"{}testsuite"{}},\ \textcolor{stringliteral}{"{}failures"{}},\ 1,\ Indent(6));}
\DoxyCodeLine{04633\ \ \ \ \ OutputJsonKey(stream,\ \textcolor{stringliteral}{"{}testsuite"{}},\ \textcolor{stringliteral}{"{}disabled"{}},\ 0,\ Indent(6));}
\DoxyCodeLine{04634\ \ \ \ \ OutputJsonKey(stream,\ \textcolor{stringliteral}{"{}testsuite"{}},\ \textcolor{stringliteral}{"{}skipped"{}},\ 0,\ Indent(6));}
\DoxyCodeLine{04635\ \ \ \ \ OutputJsonKey(stream,\ \textcolor{stringliteral}{"{}testsuite"{}},\ \textcolor{stringliteral}{"{}errors"{}},\ 0,\ Indent(6));}
\DoxyCodeLine{04636\ \ \ \ \ OutputJsonKey(stream,\ \textcolor{stringliteral}{"{}testsuite"{}},\ \textcolor{stringliteral}{"{}time"{}},}
\DoxyCodeLine{04637\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FormatTimeInMillisAsDuration(result.elapsed\_time()),}
\DoxyCodeLine{04638\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Indent(6));}
\DoxyCodeLine{04639\ \ \ \ \ OutputJsonKey(stream,\ \textcolor{stringliteral}{"{}testsuite"{}},\ \textcolor{stringliteral}{"{}timestamp"{}},}
\DoxyCodeLine{04640\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FormatEpochTimeInMillisAsRFC3339(result.start\_timestamp()),}
\DoxyCodeLine{04641\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Indent(6));}
\DoxyCodeLine{04642\ \ \ \}}
\DoxyCodeLine{04643\ \ \ *stream\ <<\ Indent(6)\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}testsuite\(\backslash\)"{}:\ [\(\backslash\)n"{}};}
\DoxyCodeLine{04644\ }
\DoxyCodeLine{04645\ \ \ \textcolor{comment}{//\ Output\ the\ boilerplate\ for\ a\ new\ test\ case.}}
\DoxyCodeLine{04646\ \ \ *stream\ <<\ Indent(8)\ <<\ \textcolor{stringliteral}{"{}\{\(\backslash\)n"{}};}
\DoxyCodeLine{04647\ \ \ OutputJsonKey(stream,\ \textcolor{stringliteral}{"{}testcase"{}},\ \textcolor{stringliteral}{"{}name"{}},\ \textcolor{stringliteral}{"{}"{}},\ Indent(10));}
\DoxyCodeLine{04648\ \ \ OutputJsonKey(stream,\ \textcolor{stringliteral}{"{}testcase"{}},\ \textcolor{stringliteral}{"{}status"{}},\ \textcolor{stringliteral}{"{}RUN"{}},\ Indent(10));}
\DoxyCodeLine{04649\ \ \ OutputJsonKey(stream,\ \textcolor{stringliteral}{"{}testcase"{}},\ \textcolor{stringliteral}{"{}result"{}},\ \textcolor{stringliteral}{"{}COMPLETED"{}},\ Indent(10));}
\DoxyCodeLine{04650\ \ \ OutputJsonKey(stream,\ \textcolor{stringliteral}{"{}testcase"{}},\ \textcolor{stringliteral}{"{}timestamp"{}},}
\DoxyCodeLine{04651\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FormatEpochTimeInMillisAsRFC3339(result.start\_timestamp()),}
\DoxyCodeLine{04652\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Indent(10));}
\DoxyCodeLine{04653\ \ \ OutputJsonKey(stream,\ \textcolor{stringliteral}{"{}testcase"{}},\ \textcolor{stringliteral}{"{}time"{}},}
\DoxyCodeLine{04654\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FormatTimeInMillisAsDuration(result.elapsed\_time()),}
\DoxyCodeLine{04655\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Indent(10));}
\DoxyCodeLine{04656\ \ \ OutputJsonKey(stream,\ \textcolor{stringliteral}{"{}testcase"{}},\ \textcolor{stringliteral}{"{}classname"{}},\ \textcolor{stringliteral}{"{}"{}},\ Indent(10),\ \textcolor{keyword}{false});}
\DoxyCodeLine{04657\ \ \ *stream\ <<\ TestPropertiesAsJson(result,\ Indent(10));}
\DoxyCodeLine{04658\ }
\DoxyCodeLine{04659\ \ \ \textcolor{comment}{//\ Output\ the\ actual\ test\ result.}}
\DoxyCodeLine{04660\ \ \ OutputJsonTestResult(stream,\ result);}
\DoxyCodeLine{04661\ }
\DoxyCodeLine{04662\ \ \ \textcolor{comment}{//\ Finish\ the\ test\ suite.}}
\DoxyCodeLine{04663\ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}\ <<\ Indent(6)\ <<\ \textcolor{stringliteral}{"{}]\(\backslash\)n"{}}\ <<\ Indent(4)\ <<\ \textcolor{stringliteral}{"{}\}"{}};}
\DoxyCodeLine{04664\ \}}
\DoxyCodeLine{04665\ }
\DoxyCodeLine{04666\ \textcolor{comment}{//\ Prints\ a\ JSON\ representation\ of\ a\ TestInfo\ object.}}
\DoxyCodeLine{04667\ \textcolor{keywordtype}{void}\ JsonUnitTestResultPrinter::OutputJsonTestInfo(::std::ostream*\ stream,}
\DoxyCodeLine{04668\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ test\_suite\_name,}
\DoxyCodeLine{04669\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ TestInfo\&\ test\_info)\ \{}
\DoxyCodeLine{04670\ \ \ \textcolor{keyword}{const}\ TestResult\&\ result\ =\ *test\_info.result();}
\DoxyCodeLine{04671\ \ \ \textcolor{keyword}{const}\ std::string\ kTestsuite\ =\ \textcolor{stringliteral}{"{}testcase"{}};}
\DoxyCodeLine{04672\ \ \ \textcolor{keyword}{const}\ std::string\ kIndent\ =\ Indent(10);}
\DoxyCodeLine{04673\ }
\DoxyCodeLine{04674\ \ \ *stream\ <<\ Indent(8)\ <<\ \textcolor{stringliteral}{"{}\{\(\backslash\)n"{}};}
\DoxyCodeLine{04675\ \ \ OutputJsonKey(stream,\ kTestsuite,\ \textcolor{stringliteral}{"{}name"{}},\ test\_info.name(),\ kIndent);}
\DoxyCodeLine{04676\ }
\DoxyCodeLine{04677\ \ \ \textcolor{keywordflow}{if}\ (test\_info.value\_param()\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{04678\ \ \ \ \ OutputJsonKey(stream,\ kTestsuite,\ \textcolor{stringliteral}{"{}value\_param"{}},\ test\_info.value\_param(),}
\DoxyCodeLine{04679\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ kIndent);}
\DoxyCodeLine{04680\ \ \ \}}
\DoxyCodeLine{04681\ \ \ \textcolor{keywordflow}{if}\ (test\_info.type\_param()\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{04682\ \ \ \ \ OutputJsonKey(stream,\ kTestsuite,\ \textcolor{stringliteral}{"{}type\_param"{}},\ test\_info.type\_param(),}
\DoxyCodeLine{04683\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ kIndent);}
\DoxyCodeLine{04684\ \ \ \}}
\DoxyCodeLine{04685\ }
\DoxyCodeLine{04686\ \ \ OutputJsonKey(stream,\ kTestsuite,\ \textcolor{stringliteral}{"{}file"{}},\ test\_info.file(),\ kIndent);}
\DoxyCodeLine{04687\ \ \ OutputJsonKey(stream,\ kTestsuite,\ \textcolor{stringliteral}{"{}line"{}},\ test\_info.line(),\ kIndent,\ \textcolor{keyword}{false});}
\DoxyCodeLine{04688\ \ \ \textcolor{keywordflow}{if}\ (GTEST\_FLAG\_GET(list\_tests))\ \{}
\DoxyCodeLine{04689\ \ \ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}\ <<\ Indent(8)\ <<\ \textcolor{stringliteral}{"{}\}"{}};}
\DoxyCodeLine{04690\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{04691\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{04692\ \ \ \ \ *stream\ <<\ \textcolor{stringliteral}{"{},\(\backslash\)n"{}};}
\DoxyCodeLine{04693\ \ \ \}}
\DoxyCodeLine{04694\ }
\DoxyCodeLine{04695\ \ \ OutputJsonKey(stream,\ kTestsuite,\ \textcolor{stringliteral}{"{}status"{}},}
\DoxyCodeLine{04696\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ test\_info.should\_run()\ ?\ \textcolor{stringliteral}{"{}RUN"{}}\ :\ \textcolor{stringliteral}{"{}NOTRUN"{}},\ kIndent);}
\DoxyCodeLine{04697\ \ \ OutputJsonKey(stream,\ kTestsuite,\ \textcolor{stringliteral}{"{}result"{}},}
\DoxyCodeLine{04698\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ test\_info.should\_run()}
\DoxyCodeLine{04699\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ?\ (result.Skipped()\ ?\ \textcolor{stringliteral}{"{}SKIPPED"{}}\ :\ \textcolor{stringliteral}{"{}COMPLETED"{}})}
\DoxyCodeLine{04700\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ \textcolor{stringliteral}{"{}SUPPRESSED"{}},}
\DoxyCodeLine{04701\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ kIndent);}
\DoxyCodeLine{04702\ \ \ OutputJsonKey(stream,\ kTestsuite,\ \textcolor{stringliteral}{"{}timestamp"{}},}
\DoxyCodeLine{04703\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FormatEpochTimeInMillisAsRFC3339(result.start\_timestamp()),}
\DoxyCodeLine{04704\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ kIndent);}
\DoxyCodeLine{04705\ \ \ OutputJsonKey(stream,\ kTestsuite,\ \textcolor{stringliteral}{"{}time"{}},}
\DoxyCodeLine{04706\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FormatTimeInMillisAsDuration(result.elapsed\_time()),\ kIndent);}
\DoxyCodeLine{04707\ \ \ OutputJsonKey(stream,\ kTestsuite,\ \textcolor{stringliteral}{"{}classname"{}},\ test\_suite\_name,\ kIndent,}
\DoxyCodeLine{04708\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{false});}
\DoxyCodeLine{04709\ \ \ *stream\ <<\ TestPropertiesAsJson(result,\ kIndent);}
\DoxyCodeLine{04710\ }
\DoxyCodeLine{04711\ \ \ OutputJsonTestResult(stream,\ result);}
\DoxyCodeLine{04712\ \}}
\DoxyCodeLine{04713\ }
\DoxyCodeLine{04714\ \textcolor{keywordtype}{void}\ JsonUnitTestResultPrinter::OutputJsonTestResult(::std::ostream*\ stream,}
\DoxyCodeLine{04715\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ TestResult\&\ result)\ \{}
\DoxyCodeLine{04716\ \ \ \textcolor{keyword}{const}\ std::string\ kIndent\ =\ Indent(10);}
\DoxyCodeLine{04717\ }
\DoxyCodeLine{04718\ \ \ \textcolor{keywordtype}{int}\ failures\ =\ 0;}
\DoxyCodeLine{04719\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ result.total\_part\_count();\ ++i)\ \{}
\DoxyCodeLine{04720\ \ \ \ \ \textcolor{keyword}{const}\ TestPartResult\&\ part\ =\ result.GetTestPartResult(i);}
\DoxyCodeLine{04721\ \ \ \ \ \textcolor{keywordflow}{if}\ (part.failed())\ \{}
\DoxyCodeLine{04722\ \ \ \ \ \ \ *stream\ <<\ \textcolor{stringliteral}{"{},\(\backslash\)n"{}};}
\DoxyCodeLine{04723\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (++failures\ ==\ 1)\ \{}
\DoxyCodeLine{04724\ \ \ \ \ \ \ \ \ *stream\ <<\ kIndent\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}"{}}}
\DoxyCodeLine{04725\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}failures"{}}}
\DoxyCodeLine{04726\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}:\ [\(\backslash\)n"{}};}
\DoxyCodeLine{04727\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04728\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ location\ =}
\DoxyCodeLine{04729\ \ \ \ \ \ \ \ \ \ \ internal::FormatCompilerIndependentFileLocation(part.file\_name(),}
\DoxyCodeLine{04730\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ part.line\_number());}
\DoxyCodeLine{04731\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ message\ =\ EscapeJson(location\ +\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}\ +\ part.message());}
\DoxyCodeLine{04732\ \ \ \ \ \ \ *stream\ <<\ kIndent\ <<\ \textcolor{stringliteral}{"{}\ \ \{\(\backslash\)n"{}}}
\DoxyCodeLine{04733\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ kIndent\ <<\ \textcolor{stringliteral}{"{}\ \ \ \ \(\backslash\)"{}failure\(\backslash\)"{}:\ \(\backslash\)"{}"{}}\ <<\ message\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{},\(\backslash\)n"{}}}
\DoxyCodeLine{04734\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ kIndent\ <<\ \textcolor{stringliteral}{"{}\ \ \ \ \(\backslash\)"{}type\(\backslash\)"{}:\ \(\backslash\)"{}\(\backslash\)"{}\(\backslash\)n"{}}}
\DoxyCodeLine{04735\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ kIndent\ <<\ \textcolor{stringliteral}{"{}\ \ \}"{}};}
\DoxyCodeLine{04736\ \ \ \ \ \}}
\DoxyCodeLine{04737\ \ \ \}}
\DoxyCodeLine{04738\ }
\DoxyCodeLine{04739\ \ \ \textcolor{keywordflow}{if}\ (failures\ >\ 0)\ *stream\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}\ <<\ kIndent\ <<\ \textcolor{stringliteral}{"{}]"{}};}
\DoxyCodeLine{04740\ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}\ <<\ Indent(8)\ <<\ \textcolor{stringliteral}{"{}\}"{}};}
\DoxyCodeLine{04741\ \}}
\DoxyCodeLine{04742\ }
\DoxyCodeLine{04743\ \textcolor{comment}{//\ Prints\ an\ JSON\ representation\ of\ a\ TestSuite\ object}}
\DoxyCodeLine{04744\ \textcolor{keywordtype}{void}\ JsonUnitTestResultPrinter::PrintJsonTestSuite(}
\DoxyCodeLine{04745\ \ \ \ \ std::ostream*\ stream,\ \textcolor{keyword}{const}\ TestSuite\&\ test\_suite)\ \{}
\DoxyCodeLine{04746\ \ \ \textcolor{keyword}{const}\ std::string\ kTestsuite\ =\ \textcolor{stringliteral}{"{}testsuite"{}};}
\DoxyCodeLine{04747\ \ \ \textcolor{keyword}{const}\ std::string\ kIndent\ =\ Indent(6);}
\DoxyCodeLine{04748\ }
\DoxyCodeLine{04749\ \ \ *stream\ <<\ Indent(4)\ <<\ \textcolor{stringliteral}{"{}\{\(\backslash\)n"{}};}
\DoxyCodeLine{04750\ \ \ OutputJsonKey(stream,\ kTestsuite,\ \textcolor{stringliteral}{"{}name"{}},\ test\_suite.name(),\ kIndent);}
\DoxyCodeLine{04751\ \ \ OutputJsonKey(stream,\ kTestsuite,\ \textcolor{stringliteral}{"{}tests"{}},\ test\_suite.reportable\_test\_count(),}
\DoxyCodeLine{04752\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ kIndent);}
\DoxyCodeLine{04753\ \ \ \textcolor{keywordflow}{if}\ (!GTEST\_FLAG\_GET(list\_tests))\ \{}
\DoxyCodeLine{04754\ \ \ \ \ OutputJsonKey(stream,\ kTestsuite,\ \textcolor{stringliteral}{"{}failures"{}},}
\DoxyCodeLine{04755\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ test\_suite.failed\_test\_count(),\ kIndent);}
\DoxyCodeLine{04756\ \ \ \ \ OutputJsonKey(stream,\ kTestsuite,\ \textcolor{stringliteral}{"{}disabled"{}},}
\DoxyCodeLine{04757\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ test\_suite.reportable\_disabled\_test\_count(),\ kIndent);}
\DoxyCodeLine{04758\ \ \ \ \ OutputJsonKey(stream,\ kTestsuite,\ \textcolor{stringliteral}{"{}errors"{}},\ 0,\ kIndent);}
\DoxyCodeLine{04759\ \ \ \ \ OutputJsonKey(}
\DoxyCodeLine{04760\ \ \ \ \ \ \ \ \ stream,\ kTestsuite,\ \textcolor{stringliteral}{"{}timestamp"{}},}
\DoxyCodeLine{04761\ \ \ \ \ \ \ \ \ FormatEpochTimeInMillisAsRFC3339(test\_suite.start\_timestamp()),}
\DoxyCodeLine{04762\ \ \ \ \ \ \ \ \ kIndent);}
\DoxyCodeLine{04763\ \ \ \ \ OutputJsonKey(stream,\ kTestsuite,\ \textcolor{stringliteral}{"{}time"{}},}
\DoxyCodeLine{04764\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FormatTimeInMillisAsDuration(test\_suite.elapsed\_time()),}
\DoxyCodeLine{04765\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ kIndent,\ \textcolor{keyword}{false});}
\DoxyCodeLine{04766\ \ \ \ \ *stream\ <<\ TestPropertiesAsJson(test\_suite.ad\_hoc\_test\_result(),\ kIndent)}
\DoxyCodeLine{04767\ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{},\(\backslash\)n"{}};}
\DoxyCodeLine{04768\ \ \ \}}
\DoxyCodeLine{04769\ }
\DoxyCodeLine{04770\ \ \ *stream\ <<\ kIndent\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}"{}}\ <<\ kTestsuite\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}:\ [\(\backslash\)n"{}};}
\DoxyCodeLine{04771\ }
\DoxyCodeLine{04772\ \ \ \textcolor{keywordtype}{bool}\ comma\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{04773\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ test\_suite.total\_test\_count();\ ++i)\ \{}
\DoxyCodeLine{04774\ \ \ \ \ \textcolor{keywordflow}{if}\ (test\_suite.GetTestInfo(i)-\/>is\_reportable())\ \{}
\DoxyCodeLine{04775\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (comma)\ \{}
\DoxyCodeLine{04776\ \ \ \ \ \ \ \ \ *stream\ <<\ \textcolor{stringliteral}{"{},\(\backslash\)n"{}};}
\DoxyCodeLine{04777\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{04778\ \ \ \ \ \ \ \ \ comma\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{04779\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04780\ \ \ \ \ \ \ OutputJsonTestInfo(stream,\ test\_suite.name(),\ *test\_suite.GetTestInfo(i));}
\DoxyCodeLine{04781\ \ \ \ \ \}}
\DoxyCodeLine{04782\ \ \ \}}
\DoxyCodeLine{04783\ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}\ <<\ kIndent\ <<\ \textcolor{stringliteral}{"{}]\(\backslash\)n"{}}\ <<\ Indent(4)\ <<\ \textcolor{stringliteral}{"{}\}"{}};}
\DoxyCodeLine{04784\ \}}
\DoxyCodeLine{04785\ }
\DoxyCodeLine{04786\ \textcolor{comment}{//\ Prints\ a\ JSON\ summary\ of\ unit\_test\ to\ output\ stream\ out.}}
\DoxyCodeLine{04787\ \textcolor{keywordtype}{void}\ JsonUnitTestResultPrinter::PrintJsonUnitTest(std::ostream*\ stream,}
\DoxyCodeLine{04788\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ UnitTest\&\ unit\_test)\ \{}
\DoxyCodeLine{04789\ \ \ \textcolor{keyword}{const}\ std::string\ kTestsuites\ =\ \textcolor{stringliteral}{"{}testsuites"{}};}
\DoxyCodeLine{04790\ \ \ \textcolor{keyword}{const}\ std::string\ kIndent\ =\ Indent(2);}
\DoxyCodeLine{04791\ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}\{\(\backslash\)n"{}};}
\DoxyCodeLine{04792\ }
\DoxyCodeLine{04793\ \ \ OutputJsonKey(stream,\ kTestsuites,\ \textcolor{stringliteral}{"{}tests"{}},\ unit\_test.reportable\_test\_count(),}
\DoxyCodeLine{04794\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ kIndent);}
\DoxyCodeLine{04795\ \ \ OutputJsonKey(stream,\ kTestsuites,\ \textcolor{stringliteral}{"{}failures"{}},\ unit\_test.failed\_test\_count(),}
\DoxyCodeLine{04796\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ kIndent);}
\DoxyCodeLine{04797\ \ \ OutputJsonKey(stream,\ kTestsuites,\ \textcolor{stringliteral}{"{}disabled"{}},}
\DoxyCodeLine{04798\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ unit\_test.reportable\_disabled\_test\_count(),\ kIndent);}
\DoxyCodeLine{04799\ \ \ OutputJsonKey(stream,\ kTestsuites,\ \textcolor{stringliteral}{"{}errors"{}},\ 0,\ kIndent);}
\DoxyCodeLine{04800\ \ \ \textcolor{keywordflow}{if}\ (GTEST\_FLAG\_GET(shuffle))\ \{}
\DoxyCodeLine{04801\ \ \ \ \ OutputJsonKey(stream,\ kTestsuites,\ \textcolor{stringliteral}{"{}random\_seed"{}},\ unit\_test.random\_seed(),}
\DoxyCodeLine{04802\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ kIndent);}
\DoxyCodeLine{04803\ \ \ \}}
\DoxyCodeLine{04804\ \ \ OutputJsonKey(stream,\ kTestsuites,\ \textcolor{stringliteral}{"{}timestamp"{}},}
\DoxyCodeLine{04805\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FormatEpochTimeInMillisAsRFC3339(unit\_test.start\_timestamp()),}
\DoxyCodeLine{04806\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ kIndent);}
\DoxyCodeLine{04807\ \ \ OutputJsonKey(stream,\ kTestsuites,\ \textcolor{stringliteral}{"{}time"{}},}
\DoxyCodeLine{04808\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FormatTimeInMillisAsDuration(unit\_test.elapsed\_time()),\ kIndent,}
\DoxyCodeLine{04809\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{false});}
\DoxyCodeLine{04810\ }
\DoxyCodeLine{04811\ \ \ *stream\ <<\ TestPropertiesAsJson(unit\_test.ad\_hoc\_test\_result(),\ kIndent)}
\DoxyCodeLine{04812\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{},\(\backslash\)n"{}};}
\DoxyCodeLine{04813\ }
\DoxyCodeLine{04814\ \ \ OutputJsonKey(stream,\ kTestsuites,\ \textcolor{stringliteral}{"{}name"{}},\ \textcolor{stringliteral}{"{}AllTests"{}},\ kIndent);}
\DoxyCodeLine{04815\ \ \ *stream\ <<\ kIndent\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}"{}}\ <<\ kTestsuites\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}:\ [\(\backslash\)n"{}};}
\DoxyCodeLine{04816\ }
\DoxyCodeLine{04817\ \ \ \textcolor{keywordtype}{bool}\ comma\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{04818\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ unit\_test.total\_test\_suite\_count();\ ++i)\ \{}
\DoxyCodeLine{04819\ \ \ \ \ \textcolor{keywordflow}{if}\ (unit\_test.GetTestSuite(i)-\/>reportable\_test\_count()\ >\ 0)\ \{}
\DoxyCodeLine{04820\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (comma)\ \{}
\DoxyCodeLine{04821\ \ \ \ \ \ \ \ \ *stream\ <<\ \textcolor{stringliteral}{"{},\(\backslash\)n"{}};}
\DoxyCodeLine{04822\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{04823\ \ \ \ \ \ \ \ \ comma\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{04824\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04825\ \ \ \ \ \ \ PrintJsonTestSuite(stream,\ *unit\_test.GetTestSuite(i));}
\DoxyCodeLine{04826\ \ \ \ \ \}}
\DoxyCodeLine{04827\ \ \ \}}
\DoxyCodeLine{04828\ }
\DoxyCodeLine{04829\ \ \ \textcolor{comment}{//\ If\ there\ was\ a\ test\ failure\ outside\ of\ one\ of\ the\ test\ suites\ (like\ in\ a}}
\DoxyCodeLine{04830\ \ \ \textcolor{comment}{//\ test\ environment)\ include\ that\ in\ the\ output.}}
\DoxyCodeLine{04831\ \ \ \textcolor{keywordflow}{if}\ (unit\_test.ad\_hoc\_test\_result().Failed())\ \{}
\DoxyCodeLine{04832\ \ \ \ \ \textcolor{keywordflow}{if}\ (comma)\ \{}
\DoxyCodeLine{04833\ \ \ \ \ \ \ *stream\ <<\ \textcolor{stringliteral}{"{},\(\backslash\)n"{}};}
\DoxyCodeLine{04834\ \ \ \ \ \}}
\DoxyCodeLine{04835\ \ \ \ \ OutputJsonTestSuiteForTestResult(stream,\ unit\_test.ad\_hoc\_test\_result());}
\DoxyCodeLine{04836\ \ \ \}}
\DoxyCodeLine{04837\ }
\DoxyCodeLine{04838\ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{04839\ \ \ \ \ \ \ \ \ \ \ <<\ kIndent\ <<\ \textcolor{stringliteral}{"{}]\(\backslash\)n"{}}}
\DoxyCodeLine{04840\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\}\(\backslash\)n"{}};}
\DoxyCodeLine{04841\ \}}
\DoxyCodeLine{04842\ }
\DoxyCodeLine{04843\ \textcolor{keywordtype}{void}\ JsonUnitTestResultPrinter::PrintJsonTestList(}
\DoxyCodeLine{04844\ \ \ \ \ std::ostream*\ stream,\ \textcolor{keyword}{const}\ std::vector<TestSuite*>\&\ test\_suites)\ \{}
\DoxyCodeLine{04845\ \ \ \textcolor{keyword}{const}\ std::string\ kTestsuites\ =\ \textcolor{stringliteral}{"{}testsuites"{}};}
\DoxyCodeLine{04846\ \ \ \textcolor{keyword}{const}\ std::string\ kIndent\ =\ Indent(2);}
\DoxyCodeLine{04847\ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}\{\(\backslash\)n"{}};}
\DoxyCodeLine{04848\ \ \ \textcolor{keywordtype}{int}\ total\_tests\ =\ 0;}
\DoxyCodeLine{04849\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ test\_suite\ :\ test\_suites)\ \{}
\DoxyCodeLine{04850\ \ \ \ \ total\_tests\ +=\ test\_suite-\/>total\_test\_count();}
\DoxyCodeLine{04851\ \ \ \}}
\DoxyCodeLine{04852\ \ \ OutputJsonKey(stream,\ kTestsuites,\ \textcolor{stringliteral}{"{}tests"{}},\ total\_tests,\ kIndent);}
\DoxyCodeLine{04853\ }
\DoxyCodeLine{04854\ \ \ OutputJsonKey(stream,\ kTestsuites,\ \textcolor{stringliteral}{"{}name"{}},\ \textcolor{stringliteral}{"{}AllTests"{}},\ kIndent);}
\DoxyCodeLine{04855\ \ \ *stream\ <<\ kIndent\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}"{}}\ <<\ kTestsuites\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}:\ [\(\backslash\)n"{}};}
\DoxyCodeLine{04856\ }
\DoxyCodeLine{04857\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ test\_suites.size();\ ++i)\ \{}
\DoxyCodeLine{04858\ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ !=\ 0)\ \{}
\DoxyCodeLine{04859\ \ \ \ \ \ \ *stream\ <<\ \textcolor{stringliteral}{"{},\(\backslash\)n"{}};}
\DoxyCodeLine{04860\ \ \ \ \ \}}
\DoxyCodeLine{04861\ \ \ \ \ PrintJsonTestSuite(stream,\ *test\_suites[i]);}
\DoxyCodeLine{04862\ \ \ \}}
\DoxyCodeLine{04863\ }
\DoxyCodeLine{04864\ \ \ *stream\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{04865\ \ \ \ \ \ \ \ \ \ \ <<\ kIndent\ <<\ \textcolor{stringliteral}{"{}]\(\backslash\)n"{}}}
\DoxyCodeLine{04866\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\}\(\backslash\)n"{}};}
\DoxyCodeLine{04867\ \}}
\DoxyCodeLine{04868\ \textcolor{comment}{//\ Produces\ a\ string\ representing\ the\ test\ properties\ in\ a\ result\ as}}
\DoxyCodeLine{04869\ \textcolor{comment}{//\ a\ JSON\ dictionary.}}
\DoxyCodeLine{04870\ std::string\ JsonUnitTestResultPrinter::TestPropertiesAsJson(}
\DoxyCodeLine{04871\ \ \ \ \ \textcolor{keyword}{const}\ TestResult\&\ result,\ \textcolor{keyword}{const}\ std::string\&\ indent)\ \{}
\DoxyCodeLine{04872\ \ \ Message\ attributes;}
\DoxyCodeLine{04873\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ result.test\_property\_count();\ ++i)\ \{}
\DoxyCodeLine{04874\ \ \ \ \ \textcolor{keyword}{const}\ TestProperty\&\ \textcolor{keyword}{property}\ =\ result.GetTestProperty(i);}
\DoxyCodeLine{04875\ \ \ \ \ attributes\ <<\ \textcolor{stringliteral}{"{},\(\backslash\)n"{}}}
\DoxyCodeLine{04876\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ indent\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}"{}}\ <<\ \textcolor{keyword}{property}.key()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}:\ "{}}}
\DoxyCodeLine{04877\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}"{}}\ <<\ EscapeJson(property.value())\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}"{}};}
\DoxyCodeLine{04878\ \ \ \}}
\DoxyCodeLine{04879\ \ \ \textcolor{keywordflow}{return}\ attributes.GetString();}
\DoxyCodeLine{04880\ \}}
\DoxyCodeLine{04881\ }
\DoxyCodeLine{04882\ \textcolor{comment}{//\ End\ JsonUnitTestResultPrinter}}
\DoxyCodeLine{04883\ }
\DoxyCodeLine{04884\ \textcolor{preprocessor}{\#if\ GTEST\_CAN\_STREAM\_RESULTS\_}}
\DoxyCodeLine{04885\ }
\DoxyCodeLine{04886\ \textcolor{comment}{//\ Checks\ if\ str\ contains\ '=',\ '\&',\ '\%'\ or\ '\(\backslash\)n'\ characters.\ If\ yes,}}
\DoxyCodeLine{04887\ \textcolor{comment}{//\ replaces\ them\ by\ "{}\%xx"{}\ where\ xx\ is\ their\ hexadecimal\ value.\ For}}
\DoxyCodeLine{04888\ \textcolor{comment}{//\ example,\ replaces\ "{}="{}\ with\ "{}\%3D"{}.\ \ This\ algorithm\ is\ O(strlen(str))}}
\DoxyCodeLine{04889\ \textcolor{comment}{//\ in\ both\ time\ and\ space\ -\/-\/\ important\ as\ the\ input\ str\ may\ contain\ an}}
\DoxyCodeLine{04890\ \textcolor{comment}{//\ arbitrarily\ long\ test\ failure\ message\ and\ stack\ trace.}}
\DoxyCodeLine{04891\ std::string\ StreamingListener::UrlEncode(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ str)\ \{}
\DoxyCodeLine{04892\ \ \ std::string\ result;}
\DoxyCodeLine{04893\ \ \ result.reserve(strlen(str)\ +\ 1);}
\DoxyCodeLine{04894\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{char}\ ch\ =\ *str;\ ch\ !=\ \textcolor{charliteral}{'\(\backslash\)0'};\ ch\ =\ *++str)\ \{}
\DoxyCodeLine{04895\ \ \ \ \ \textcolor{keywordflow}{switch}\ (ch)\ \{}
\DoxyCodeLine{04896\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'\%'}:}
\DoxyCodeLine{04897\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'='}:}
\DoxyCodeLine{04898\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'\&'}:}
\DoxyCodeLine{04899\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'\(\backslash\)n'}:}
\DoxyCodeLine{04900\ \ \ \ \ \ \ \ \ result.append(\textcolor{stringliteral}{"{}\%"{}}\ +\ String::FormatByte(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\textcolor{keyword}{>}(ch)));}
\DoxyCodeLine{04901\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04902\ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{04903\ \ \ \ \ \ \ \ \ result.push\_back(ch);}
\DoxyCodeLine{04904\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04905\ \ \ \ \ \}}
\DoxyCodeLine{04906\ \ \ \}}
\DoxyCodeLine{04907\ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{04908\ \}}
\DoxyCodeLine{04909\ }
\DoxyCodeLine{04910\ \textcolor{keywordtype}{void}\ StreamingListener::SocketWriter::MakeConnection()\ \{}
\DoxyCodeLine{04911\ \ \ GTEST\_CHECK\_(sockfd\_\ ==\ -\/1)}
\DoxyCodeLine{04912\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}MakeConnection()\ can't\ be\ called\ when\ there\ is\ already\ a\ connection."{}};}
\DoxyCodeLine{04913\ }
\DoxyCodeLine{04914\ \ \ addrinfo\ hints;}
\DoxyCodeLine{04915\ \ \ memset(\&hints,\ 0,\ \textcolor{keyword}{sizeof}(hints));}
\DoxyCodeLine{04916\ \ \ hints.ai\_family\ =\ AF\_UNSPEC;\ \ \textcolor{comment}{//\ To\ allow\ both\ IPv4\ and\ IPv6\ addresses.}}
\DoxyCodeLine{04917\ \ \ hints.ai\_socktype\ =\ SOCK\_STREAM;}
\DoxyCodeLine{04918\ \ \ addrinfo*\ servinfo\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{04919\ }
\DoxyCodeLine{04920\ \ \ \textcolor{comment}{//\ Use\ the\ getaddrinfo()\ to\ get\ a\ linked\ list\ of\ IP\ addresses\ for}}
\DoxyCodeLine{04921\ \ \ \textcolor{comment}{//\ the\ given\ host\ name.}}
\DoxyCodeLine{04922\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ error\_num\ =}
\DoxyCodeLine{04923\ \ \ \ \ \ \ getaddrinfo(host\_name\_.c\_str(),\ port\_num\_.c\_str(),\ \&hints,\ \&servinfo);}
\DoxyCodeLine{04924\ \ \ \textcolor{keywordflow}{if}\ (error\_num\ !=\ 0)\ \{}
\DoxyCodeLine{04925\ \ \ \ \ GTEST\_LOG\_(WARNING)\ <<\ \textcolor{stringliteral}{"{}stream\_result\_to:\ getaddrinfo()\ failed:\ "{}}}
\DoxyCodeLine{04926\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ gai\_strerror(error\_num);}
\DoxyCodeLine{04927\ \ \ \}}
\DoxyCodeLine{04928\ }
\DoxyCodeLine{04929\ \ \ \textcolor{comment}{//\ Loop\ through\ all\ the\ results\ and\ connect\ to\ the\ first\ we\ can.}}
\DoxyCodeLine{04930\ \ \ \textcolor{keywordflow}{for}\ (addrinfo*\ cur\_addr\ =\ servinfo;\ sockfd\_\ ==\ -\/1\ \&\&\ cur\_addr\ !=\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{04931\ \ \ \ \ \ \ \ cur\_addr\ =\ cur\_addr-\/>ai\_next)\ \{}
\DoxyCodeLine{04932\ \ \ \ \ sockfd\_\ =\ socket(cur\_addr-\/>ai\_family,\ cur\_addr-\/>ai\_socktype,}
\DoxyCodeLine{04933\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cur\_addr-\/>ai\_protocol);}
\DoxyCodeLine{04934\ \ \ \ \ \textcolor{keywordflow}{if}\ (sockfd\_\ !=\ -\/1)\ \{}
\DoxyCodeLine{04935\ \ \ \ \ \ \ \textcolor{comment}{//\ Connect\ the\ client\ socket\ to\ the\ server\ socket.}}
\DoxyCodeLine{04936\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (connect(sockfd\_,\ cur\_addr-\/>ai\_addr,\ cur\_addr-\/>ai\_addrlen)\ ==\ -\/1)\ \{}
\DoxyCodeLine{04937\ \ \ \ \ \ \ \ \ close(sockfd\_);}
\DoxyCodeLine{04938\ \ \ \ \ \ \ \ \ sockfd\_\ =\ -\/1;}
\DoxyCodeLine{04939\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04940\ \ \ \ \ \}}
\DoxyCodeLine{04941\ \ \ \}}
\DoxyCodeLine{04942\ }
\DoxyCodeLine{04943\ \ \ freeaddrinfo(servinfo);\ \ \textcolor{comment}{//\ all\ done\ with\ this\ structure}}
\DoxyCodeLine{04944\ }
\DoxyCodeLine{04945\ \ \ \textcolor{keywordflow}{if}\ (sockfd\_\ ==\ -\/1)\ \{}
\DoxyCodeLine{04946\ \ \ \ \ GTEST\_LOG\_(WARNING)\ <<\ \textcolor{stringliteral}{"{}stream\_result\_to:\ failed\ to\ connect\ to\ "{}}}
\DoxyCodeLine{04947\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ host\_name\_\ <<\ \textcolor{stringliteral}{"{}:"{}}\ <<\ port\_num\_;}
\DoxyCodeLine{04948\ \ \ \}}
\DoxyCodeLine{04949\ \}}
\DoxyCodeLine{04950\ }
\DoxyCodeLine{04951\ \textcolor{comment}{//\ End\ of\ class\ Streaming\ Listener}}
\DoxyCodeLine{04952\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GTEST\_CAN\_STREAM\_RESULTS\_\_}}
\DoxyCodeLine{04953\ }
\DoxyCodeLine{04954\ \textcolor{comment}{//\ class\ OsStackTraceGetter}}
\DoxyCodeLine{04955\ }
\DoxyCodeLine{04956\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \textcolor{keyword}{const}\ OsStackTraceGetterInterface::kElidedFramesMarker\ =}
\DoxyCodeLine{04957\ \ \ \ \ \textcolor{stringliteral}{"{}...\ "{}}\ GTEST\_NAME\_\ \textcolor{stringliteral}{"{}\ internal\ frames\ ..."{}};}
\DoxyCodeLine{04958\ }
\DoxyCodeLine{04959\ std::string\ OsStackTraceGetter::CurrentStackTrace(\textcolor{keywordtype}{int}\ max\_depth,\ \textcolor{keywordtype}{int}\ skip\_count)}
\DoxyCodeLine{04960\ \ \ \ \ GTEST\_LOCK\_EXCLUDED\_(mutex\_)\ \{}
\DoxyCodeLine{04961\ \textcolor{preprocessor}{\#if\ GTEST\_HAS\_ABSL}}
\DoxyCodeLine{04962\ \ \ std::string\ result;}
\DoxyCodeLine{04963\ }
\DoxyCodeLine{04964\ \ \ \textcolor{keywordflow}{if}\ (max\_depth\ <=\ 0)\ \{}
\DoxyCodeLine{04965\ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{04966\ \ \ \}}
\DoxyCodeLine{04967\ }
\DoxyCodeLine{04968\ \ \ max\_depth\ =\ std::min(max\_depth,\ kMaxStackTraceDepth);}
\DoxyCodeLine{04969\ }
\DoxyCodeLine{04970\ \ \ std::vector<void*>\ raw\_stack(max\_depth);}
\DoxyCodeLine{04971\ \ \ \textcolor{comment}{//\ Skips\ the\ frames\ requested\ by\ the\ caller,\ plus\ this\ function.}}
\DoxyCodeLine{04972\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ raw\_stack\_size\ =}
\DoxyCodeLine{04973\ \ \ \ \ \ \ absl::GetStackTrace(\&raw\_stack[0],\ max\_depth,\ skip\_count\ +\ 1);}
\DoxyCodeLine{04974\ }
\DoxyCodeLine{04975\ \ \ \textcolor{keywordtype}{void}*\ caller\_frame\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{04976\ \ \ \{}
\DoxyCodeLine{04977\ \ \ \ \ MutexLock\ lock(\&mutex\_);}
\DoxyCodeLine{04978\ \ \ \ \ caller\_frame\ =\ caller\_frame\_;}
\DoxyCodeLine{04979\ \ \ \}}
\DoxyCodeLine{04980\ }
\DoxyCodeLine{04981\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ raw\_stack\_size;\ ++i)\ \{}
\DoxyCodeLine{04982\ \ \ \ \ \textcolor{keywordflow}{if}\ (raw\_stack[i]\ ==\ caller\_frame\ \&\&}
\DoxyCodeLine{04983\ \ \ \ \ \ \ \ \ !GTEST\_FLAG\_GET(show\_internal\_stack\_frames))\ \{}
\DoxyCodeLine{04984\ \ \ \ \ \ \ \textcolor{comment}{//\ Add\ a\ marker\ to\ the\ trace\ and\ stop\ adding\ frames.}}
\DoxyCodeLine{04985\ \ \ \ \ \ \ absl::StrAppend(\&result,\ kElidedFramesMarker,\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{04986\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04987\ \ \ \ \ \}}
\DoxyCodeLine{04988\ }
\DoxyCodeLine{04989\ \ \ \ \ \textcolor{keywordtype}{char}\ tmp[1024];}
\DoxyCodeLine{04990\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ symbol\ =\ \textcolor{stringliteral}{"{}(unknown)"{}};}
\DoxyCodeLine{04991\ \ \ \ \ \textcolor{keywordflow}{if}\ (absl::Symbolize(raw\_stack[i],\ tmp,\ \textcolor{keyword}{sizeof}(tmp)))\ \{}
\DoxyCodeLine{04992\ \ \ \ \ \ \ symbol\ =\ tmp;}
\DoxyCodeLine{04993\ \ \ \ \ \}}
\DoxyCodeLine{04994\ }
\DoxyCodeLine{04995\ \ \ \ \ \textcolor{keywordtype}{char}\ line[1024];}
\DoxyCodeLine{04996\ \ \ \ \ snprintf(line,\ \textcolor{keyword}{sizeof}(line),\ \textcolor{stringliteral}{"{}\ \ \%p:\ \%s\(\backslash\)n"{}},\ raw\_stack[i],\ symbol);}
\DoxyCodeLine{04997\ \ \ \ \ result\ +=\ line;}
\DoxyCodeLine{04998\ \ \ \}}
\DoxyCodeLine{04999\ }
\DoxyCodeLine{05000\ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{05001\ }
\DoxyCodeLine{05002\ \textcolor{preprocessor}{\#else\ \ \ }\textcolor{comment}{//\ !GTEST\_HAS\_ABSL}}
\DoxyCodeLine{05003\ \ \ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{void}\textcolor{keyword}{>}(max\_depth);}
\DoxyCodeLine{05004\ \ \ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{void}\textcolor{keyword}{>}(skip\_count);}
\DoxyCodeLine{05005\ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{05006\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GTEST\_HAS\_ABSL}}
\DoxyCodeLine{05007\ \}}
\DoxyCodeLine{05008\ }
\DoxyCodeLine{05009\ \textcolor{keywordtype}{void}\ OsStackTraceGetter::UponLeavingGTest()\ GTEST\_LOCK\_EXCLUDED\_(mutex\_)\ \{}
\DoxyCodeLine{05010\ \textcolor{preprocessor}{\#if\ GTEST\_HAS\_ABSL}}
\DoxyCodeLine{05011\ \ \ \textcolor{keywordtype}{void}*\ caller\_frame\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{05012\ \ \ \textcolor{keywordflow}{if}\ (absl::GetStackTrace(\&caller\_frame,\ 1,\ 3)\ <=\ 0)\ \{}
\DoxyCodeLine{05013\ \ \ \ \ caller\_frame\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{05014\ \ \ \}}
\DoxyCodeLine{05015\ }
\DoxyCodeLine{05016\ \ \ MutexLock\ lock(\&mutex\_);}
\DoxyCodeLine{05017\ \ \ caller\_frame\_\ =\ caller\_frame;}
\DoxyCodeLine{05018\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GTEST\_HAS\_ABSL}}
\DoxyCodeLine{05019\ \}}
\DoxyCodeLine{05020\ }
\DoxyCodeLine{05021\ \textcolor{comment}{//\ A\ helper\ class\ that\ creates\ the\ premature-\/exit\ file\ in\ its}}
\DoxyCodeLine{05022\ \textcolor{comment}{//\ constructor\ and\ deletes\ the\ file\ in\ its\ destructor.}}
\DoxyCodeLine{05023\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classtesting_1_1internal_1_1_scoped_premature_exit_file}{ScopedPrematureExitFile}}\ \{}
\DoxyCodeLine{05024\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{05025\ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{classtesting_1_1internal_1_1_scoped_premature_exit_file}{ScopedPrematureExitFile}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ premature\_exit\_filepath)}
\DoxyCodeLine{05026\ \ \ \ \ \ \ :\ premature\_exit\_filepath\_(}
\DoxyCodeLine{05027\ \ \ \ \ \ \ \ \ \ \ \ \ premature\_exit\_filepath\ ?\ premature\_exit\_filepath\ :\ \textcolor{stringliteral}{"{}"{}})\ \{}
\DoxyCodeLine{05028\ \ \ \ \ \textcolor{comment}{//\ If\ a\ path\ to\ the\ premature-\/exit\ file\ is\ specified...}}
\DoxyCodeLine{05029\ \ \ \ \ \textcolor{keywordflow}{if}\ (!premature\_exit\_filepath\_.empty())\ \{}
\DoxyCodeLine{05030\ \ \ \ \ \ \ \textcolor{comment}{//\ create\ the\ file\ with\ a\ single\ "{}0"{}\ character\ in\ it.\ \ I/O}}
\DoxyCodeLine{05031\ \ \ \ \ \ \ \textcolor{comment}{//\ errors\ are\ ignored\ as\ there's\ nothing\ better\ we\ can\ do\ and\ we}}
\DoxyCodeLine{05032\ \ \ \ \ \ \ \textcolor{comment}{//\ don't\ want\ to\ fail\ the\ test\ because\ of\ this.}}
\DoxyCodeLine{05033\ \ \ \ \ \ \ FILE*\ pfile\ =\ posix::FOpen(premature\_exit\_filepath\_.c\_str(),\ \textcolor{stringliteral}{"{}w"{}});}
\DoxyCodeLine{05034\ \ \ \ \ \ \ fwrite(\textcolor{stringliteral}{"{}0"{}},\ 1,\ 1,\ pfile);}
\DoxyCodeLine{05035\ \ \ \ \ \ \ fclose(pfile);}
\DoxyCodeLine{05036\ \ \ \ \ \}}
\DoxyCodeLine{05037\ \ \ \}}
\DoxyCodeLine{05038\ }
\DoxyCodeLine{05039\ \ \ \mbox{\hyperlink{classtesting_1_1internal_1_1_scoped_premature_exit_file}{\string~ScopedPrematureExitFile}}()\ \{}
\DoxyCodeLine{05040\ \textcolor{preprocessor}{\#if\ !defined\ GTEST\_OS\_ESP8266}}
\DoxyCodeLine{05041\ \ \ \ \ \textcolor{keywordflow}{if}\ (!premature\_exit\_filepath\_.empty())\ \{}
\DoxyCodeLine{05042\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ retval\ =\ remove(premature\_exit\_filepath\_.c\_str());}
\DoxyCodeLine{05043\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (retval)\ \{}
\DoxyCodeLine{05044\ \ \ \ \ \ \ \ \ GTEST\_LOG\_(ERROR)\ <<\ \textcolor{stringliteral}{"{}Failed\ to\ remove\ premature\ exit\ filepath\ \(\backslash\)"{}"{}}}
\DoxyCodeLine{05045\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ premature\_exit\_filepath\_\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}\ with\ error\ "{}}}
\DoxyCodeLine{05046\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ retval;}
\DoxyCodeLine{05047\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05048\ \ \ \ \ \}}
\DoxyCodeLine{05049\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{05050\ \ \ \}}
\DoxyCodeLine{05051\ }
\DoxyCodeLine{05052\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{05053\ \ \ \textcolor{keyword}{const}\ std::string\ premature\_exit\_filepath\_;}
\DoxyCodeLine{05054\ }
\DoxyCodeLine{05055\ \ \ \mbox{\hyperlink{classtesting_1_1internal_1_1_scoped_premature_exit_file}{ScopedPrematureExitFile}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1internal_1_1_scoped_premature_exit_file}{ScopedPrematureExitFile}}\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{05056\ \ \ \mbox{\hyperlink{classtesting_1_1internal_1_1_scoped_premature_exit_file}{ScopedPrematureExitFile}}\&\ operator=(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1internal_1_1_scoped_premature_exit_file}{ScopedPrematureExitFile}}\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{05057\ \};}
\DoxyCodeLine{05058\ }
\DoxyCodeLine{05059\ \}\ \ \textcolor{comment}{//\ namespace\ internal}}
\DoxyCodeLine{05060\ }
\DoxyCodeLine{05061\ \textcolor{comment}{//\ class\ TestEventListeners}}
\DoxyCodeLine{05062\ }
\DoxyCodeLine{05063\ TestEventListeners::TestEventListeners()}
\DoxyCodeLine{05064\ \ \ \ \ :\ repeater\_(new\ internal::TestEventRepeater()),}
\DoxyCodeLine{05065\ \ \ \ \ \ \ default\_result\_printer\_(nullptr),}
\DoxyCodeLine{05066\ \ \ \ \ \ \ default\_xml\_generator\_(nullptr)\ \{\}}
\DoxyCodeLine{05067\ }
\DoxyCodeLine{05068\ TestEventListeners::\string~TestEventListeners()\ \{\ \textcolor{keyword}{delete}\ repeater\_;\ \}}
\DoxyCodeLine{05069\ }
\DoxyCodeLine{05070\ \textcolor{comment}{//\ Returns\ the\ standard\ listener\ responsible\ for\ the\ default\ console}}
\DoxyCodeLine{05071\ \textcolor{comment}{//\ output.\ \ Can\ be\ removed\ from\ the\ listeners\ list\ to\ shut\ down\ default}}
\DoxyCodeLine{05072\ \textcolor{comment}{//\ console\ output.\ \ Note\ that\ removing\ this\ object\ from\ the\ listener\ list}}
\DoxyCodeLine{05073\ \textcolor{comment}{//\ with\ Release\ transfers\ its\ ownership\ to\ the\ user.}}
\DoxyCodeLine{05074\ \textcolor{keywordtype}{void}\ TestEventListeners::Append(TestEventListener*\ listener)\ \{}
\DoxyCodeLine{05075\ \ \ repeater\_-\/>Append(listener);}
\DoxyCodeLine{05076\ \}}
\DoxyCodeLine{05077\ }
\DoxyCodeLine{05078\ \textcolor{comment}{//\ Removes\ the\ given\ event\ listener\ from\ the\ list\ and\ returns\ it.\ \ It\ then}}
\DoxyCodeLine{05079\ \textcolor{comment}{//\ becomes\ the\ caller's\ responsibility\ to\ delete\ the\ listener.\ Returns}}
\DoxyCodeLine{05080\ \textcolor{comment}{//\ NULL\ if\ the\ listener\ is\ not\ found\ in\ the\ list.}}
\DoxyCodeLine{05081\ TestEventListener*\ TestEventListeners::Release(TestEventListener*\ listener)\ \{}
\DoxyCodeLine{05082\ \ \ \textcolor{keywordflow}{if}\ (listener\ ==\ default\_result\_printer\_)}
\DoxyCodeLine{05083\ \ \ \ \ default\_result\_printer\_\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{05084\ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (listener\ ==\ default\_xml\_generator\_)}
\DoxyCodeLine{05085\ \ \ \ \ default\_xml\_generator\_\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{05086\ \ \ \textcolor{keywordflow}{return}\ repeater\_-\/>Release(listener);}
\DoxyCodeLine{05087\ \}}
\DoxyCodeLine{05088\ }
\DoxyCodeLine{05089\ \textcolor{comment}{//\ Returns\ repeater\ that\ broadcasts\ the\ TestEventListener\ events\ to\ all}}
\DoxyCodeLine{05090\ \textcolor{comment}{//\ subscribers.}}
\DoxyCodeLine{05091\ TestEventListener*\ TestEventListeners::repeater()\ \{\ \textcolor{keywordflow}{return}\ repeater\_;\ \}}
\DoxyCodeLine{05092\ }
\DoxyCodeLine{05093\ \textcolor{comment}{//\ Sets\ the\ default\_result\_printer\ attribute\ to\ the\ provided\ listener.}}
\DoxyCodeLine{05094\ \textcolor{comment}{//\ The\ listener\ is\ also\ added\ to\ the\ listener\ list\ and\ previous}}
\DoxyCodeLine{05095\ \textcolor{comment}{//\ default\_result\_printer\ is\ removed\ from\ it\ and\ deleted.\ The\ listener\ can}}
\DoxyCodeLine{05096\ \textcolor{comment}{//\ also\ be\ NULL\ in\ which\ case\ it\ will\ not\ be\ added\ to\ the\ list.\ Does}}
\DoxyCodeLine{05097\ \textcolor{comment}{//\ nothing\ if\ the\ previous\ and\ the\ current\ listener\ objects\ are\ the\ same.}}
\DoxyCodeLine{05098\ \textcolor{keywordtype}{void}\ TestEventListeners::SetDefaultResultPrinter(TestEventListener*\ listener)\ \{}
\DoxyCodeLine{05099\ \ \ \textcolor{keywordflow}{if}\ (default\_result\_printer\_\ !=\ listener)\ \{}
\DoxyCodeLine{05100\ \ \ \ \ \textcolor{comment}{//\ It\ is\ an\ error\ to\ pass\ this\ method\ a\ listener\ that\ is\ already\ in\ the}}
\DoxyCodeLine{05101\ \ \ \ \ \textcolor{comment}{//\ list.}}
\DoxyCodeLine{05102\ \ \ \ \ \textcolor{keyword}{delete}\ Release(default\_result\_printer\_);}
\DoxyCodeLine{05103\ \ \ \ \ default\_result\_printer\_\ =\ listener;}
\DoxyCodeLine{05104\ \ \ \ \ \textcolor{keywordflow}{if}\ (listener\ !=\ \textcolor{keyword}{nullptr})\ Append(listener);}
\DoxyCodeLine{05105\ \ \ \}}
\DoxyCodeLine{05106\ \}}
\DoxyCodeLine{05107\ }
\DoxyCodeLine{05108\ \textcolor{comment}{//\ Sets\ the\ default\_xml\_generator\ attribute\ to\ the\ provided\ listener.\ \ The}}
\DoxyCodeLine{05109\ \textcolor{comment}{//\ listener\ is\ also\ added\ to\ the\ listener\ list\ and\ previous}}
\DoxyCodeLine{05110\ \textcolor{comment}{//\ default\_xml\_generator\ is\ removed\ from\ it\ and\ deleted.\ The\ listener\ can}}
\DoxyCodeLine{05111\ \textcolor{comment}{//\ also\ be\ NULL\ in\ which\ case\ it\ will\ not\ be\ added\ to\ the\ list.\ Does}}
\DoxyCodeLine{05112\ \textcolor{comment}{//\ nothing\ if\ the\ previous\ and\ the\ current\ listener\ objects\ are\ the\ same.}}
\DoxyCodeLine{05113\ \textcolor{keywordtype}{void}\ TestEventListeners::SetDefaultXmlGenerator(TestEventListener*\ listener)\ \{}
\DoxyCodeLine{05114\ \ \ \textcolor{keywordflow}{if}\ (default\_xml\_generator\_\ !=\ listener)\ \{}
\DoxyCodeLine{05115\ \ \ \ \ \textcolor{comment}{//\ It\ is\ an\ error\ to\ pass\ this\ method\ a\ listener\ that\ is\ already\ in\ the}}
\DoxyCodeLine{05116\ \ \ \ \ \textcolor{comment}{//\ list.}}
\DoxyCodeLine{05117\ \ \ \ \ \textcolor{keyword}{delete}\ Release(default\_xml\_generator\_);}
\DoxyCodeLine{05118\ \ \ \ \ default\_xml\_generator\_\ =\ listener;}
\DoxyCodeLine{05119\ \ \ \ \ \textcolor{keywordflow}{if}\ (listener\ !=\ \textcolor{keyword}{nullptr})\ Append(listener);}
\DoxyCodeLine{05120\ \ \ \}}
\DoxyCodeLine{05121\ \}}
\DoxyCodeLine{05122\ }
\DoxyCodeLine{05123\ \textcolor{comment}{//\ Controls\ whether\ events\ will\ be\ forwarded\ by\ the\ repeater\ to\ the}}
\DoxyCodeLine{05124\ \textcolor{comment}{//\ listeners\ in\ the\ list.}}
\DoxyCodeLine{05125\ \textcolor{keywordtype}{bool}\ TestEventListeners::EventForwardingEnabled()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{05126\ \ \ \textcolor{keywordflow}{return}\ repeater\_-\/>forwarding\_enabled();}
\DoxyCodeLine{05127\ \}}
\DoxyCodeLine{05128\ }
\DoxyCodeLine{05129\ \textcolor{keywordtype}{void}\ TestEventListeners::SuppressEventForwarding()\ \{}
\DoxyCodeLine{05130\ \ \ repeater\_-\/>set\_forwarding\_enabled(\textcolor{keyword}{false});}
\DoxyCodeLine{05131\ \}}
\DoxyCodeLine{05132\ }
\DoxyCodeLine{05133\ \textcolor{comment}{//\ class\ UnitTest}}
\DoxyCodeLine{05134\ }
\DoxyCodeLine{05135\ \textcolor{comment}{//\ Gets\ the\ singleton\ UnitTest\ object.\ \ The\ first\ time\ this\ method\ is}}
\DoxyCodeLine{05136\ \textcolor{comment}{//\ called,\ a\ UnitTest\ object\ is\ constructed\ and\ returned.\ \ Consecutive}}
\DoxyCodeLine{05137\ \textcolor{comment}{//\ calls\ will\ return\ the\ same\ object.}}
\DoxyCodeLine{05138\ \textcolor{comment}{//}}
\DoxyCodeLine{05139\ \textcolor{comment}{//\ We\ don't\ protect\ this\ under\ mutex\_\ as\ a\ user\ is\ not\ supposed\ to}}
\DoxyCodeLine{05140\ \textcolor{comment}{//\ call\ this\ before\ main()\ starts,\ from\ which\ point\ on\ the\ return}}
\DoxyCodeLine{05141\ \textcolor{comment}{//\ value\ will\ never\ change.}}
\DoxyCodeLine{05142\ UnitTest*\ UnitTest::GetInstance()\ \{}
\DoxyCodeLine{05143\ \ \ \textcolor{comment}{//\ CodeGear\ C++Builder\ insists\ on\ a\ public\ destructor\ for\ the}}
\DoxyCodeLine{05144\ \ \ \textcolor{comment}{//\ default\ implementation.\ \ Use\ this\ implementation\ to\ keep\ good\ OO}}
\DoxyCodeLine{05145\ \ \ \textcolor{comment}{//\ design\ with\ private\ destructor.}}
\DoxyCodeLine{05146\ }
\DoxyCodeLine{05147\ \textcolor{preprocessor}{\#if\ defined(\_\_BORLANDC\_\_)}}
\DoxyCodeLine{05148\ \ \ \textcolor{keyword}{static}\ UnitTest*\ \textcolor{keyword}{const}\ instance\ =\ \textcolor{keyword}{new}\ UnitTest;}
\DoxyCodeLine{05149\ \ \ \textcolor{keywordflow}{return}\ instance;}
\DoxyCodeLine{05150\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{05151\ \ \ \textcolor{keyword}{static}\ UnitTest\ instance;}
\DoxyCodeLine{05152\ \ \ \textcolor{keywordflow}{return}\ \&instance;}
\DoxyCodeLine{05153\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ defined(\_\_BORLANDC\_\_)}}
\DoxyCodeLine{05154\ \}}
\DoxyCodeLine{05155\ }
\DoxyCodeLine{05156\ \textcolor{comment}{//\ Gets\ the\ number\ of\ successful\ test\ suites.}}
\DoxyCodeLine{05157\ \textcolor{keywordtype}{int}\ UnitTest::successful\_test\_suite\_count()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{05158\ \ \ \textcolor{keywordflow}{return}\ impl()-\/>successful\_test\_suite\_count();}
\DoxyCodeLine{05159\ \}}
\DoxyCodeLine{05160\ }
\DoxyCodeLine{05161\ \textcolor{comment}{//\ Gets\ the\ number\ of\ failed\ test\ suites.}}
\DoxyCodeLine{05162\ \textcolor{keywordtype}{int}\ UnitTest::failed\_test\_suite\_count()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{05163\ \ \ \textcolor{keywordflow}{return}\ impl()-\/>failed\_test\_suite\_count();}
\DoxyCodeLine{05164\ \}}
\DoxyCodeLine{05165\ }
\DoxyCodeLine{05166\ \textcolor{comment}{//\ Gets\ the\ number\ of\ all\ test\ suites.}}
\DoxyCodeLine{05167\ \textcolor{keywordtype}{int}\ UnitTest::total\_test\_suite\_count()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{05168\ \ \ \textcolor{keywordflow}{return}\ impl()-\/>total\_test\_suite\_count();}
\DoxyCodeLine{05169\ \}}
\DoxyCodeLine{05170\ }
\DoxyCodeLine{05171\ \textcolor{comment}{//\ Gets\ the\ number\ of\ all\ test\ suites\ that\ contain\ at\ least\ one\ test}}
\DoxyCodeLine{05172\ \textcolor{comment}{//\ that\ should\ run.}}
\DoxyCodeLine{05173\ \textcolor{keywordtype}{int}\ UnitTest::test\_suite\_to\_run\_count()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{05174\ \ \ \textcolor{keywordflow}{return}\ impl()-\/>test\_suite\_to\_run\_count();}
\DoxyCodeLine{05175\ \}}
\DoxyCodeLine{05176\ }
\DoxyCodeLine{05177\ \textcolor{comment}{//\ \ Legacy\ API\ is\ deprecated\ but\ still\ available}}
\DoxyCodeLine{05178\ \textcolor{preprocessor}{\#ifndef\ GTEST\_REMOVE\_LEGACY\_TEST\_CASEAPI\_}}
\DoxyCodeLine{05179\ \textcolor{keywordtype}{int}\ UnitTest::successful\_test\_case\_count()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{05180\ \ \ \textcolor{keywordflow}{return}\ impl()-\/>successful\_test\_suite\_count();}
\DoxyCodeLine{05181\ \}}
\DoxyCodeLine{05182\ \textcolor{keywordtype}{int}\ UnitTest::failed\_test\_case\_count()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{05183\ \ \ \textcolor{keywordflow}{return}\ impl()-\/>failed\_test\_suite\_count();}
\DoxyCodeLine{05184\ \}}
\DoxyCodeLine{05185\ \textcolor{keywordtype}{int}\ UnitTest::total\_test\_case\_count()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{05186\ \ \ \textcolor{keywordflow}{return}\ impl()-\/>total\_test\_suite\_count();}
\DoxyCodeLine{05187\ \}}
\DoxyCodeLine{05188\ \textcolor{keywordtype}{int}\ UnitTest::test\_case\_to\_run\_count()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{05189\ \ \ \textcolor{keywordflow}{return}\ impl()-\/>test\_suite\_to\_run\_count();}
\DoxyCodeLine{05190\ \}}
\DoxyCodeLine{05191\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ \ GTEST\_REMOVE\_LEGACY\_TEST\_CASEAPI\_}}
\DoxyCodeLine{05192\ }
\DoxyCodeLine{05193\ \textcolor{comment}{//\ Gets\ the\ number\ of\ successful\ tests.}}
\DoxyCodeLine{05194\ \textcolor{keywordtype}{int}\ UnitTest::successful\_test\_count()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{05195\ \ \ \textcolor{keywordflow}{return}\ impl()-\/>successful\_test\_count();}
\DoxyCodeLine{05196\ \}}
\DoxyCodeLine{05197\ }
\DoxyCodeLine{05198\ \textcolor{comment}{//\ Gets\ the\ number\ of\ skipped\ tests.}}
\DoxyCodeLine{05199\ \textcolor{keywordtype}{int}\ UnitTest::skipped\_test\_count()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{05200\ \ \ \textcolor{keywordflow}{return}\ impl()-\/>skipped\_test\_count();}
\DoxyCodeLine{05201\ \}}
\DoxyCodeLine{05202\ }
\DoxyCodeLine{05203\ \textcolor{comment}{//\ Gets\ the\ number\ of\ failed\ tests.}}
\DoxyCodeLine{05204\ \textcolor{keywordtype}{int}\ UnitTest::failed\_test\_count()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ impl()-\/>failed\_test\_count();\ \}}
\DoxyCodeLine{05205\ }
\DoxyCodeLine{05206\ \textcolor{comment}{//\ Gets\ the\ number\ of\ disabled\ tests\ that\ will\ be\ reported\ in\ the\ XML\ report.}}
\DoxyCodeLine{05207\ \textcolor{keywordtype}{int}\ UnitTest::reportable\_disabled\_test\_count()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{05208\ \ \ \textcolor{keywordflow}{return}\ impl()-\/>reportable\_disabled\_test\_count();}
\DoxyCodeLine{05209\ \}}
\DoxyCodeLine{05210\ }
\DoxyCodeLine{05211\ \textcolor{comment}{//\ Gets\ the\ number\ of\ disabled\ tests.}}
\DoxyCodeLine{05212\ \textcolor{keywordtype}{int}\ UnitTest::disabled\_test\_count()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{05213\ \ \ \textcolor{keywordflow}{return}\ impl()-\/>disabled\_test\_count();}
\DoxyCodeLine{05214\ \}}
\DoxyCodeLine{05215\ }
\DoxyCodeLine{05216\ \textcolor{comment}{//\ Gets\ the\ number\ of\ tests\ to\ be\ printed\ in\ the\ XML\ report.}}
\DoxyCodeLine{05217\ \textcolor{keywordtype}{int}\ UnitTest::reportable\_test\_count()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{05218\ \ \ \textcolor{keywordflow}{return}\ impl()-\/>reportable\_test\_count();}
\DoxyCodeLine{05219\ \}}
\DoxyCodeLine{05220\ }
\DoxyCodeLine{05221\ \textcolor{comment}{//\ Gets\ the\ number\ of\ all\ tests.}}
\DoxyCodeLine{05222\ \textcolor{keywordtype}{int}\ UnitTest::total\_test\_count()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ impl()-\/>total\_test\_count();\ \}}
\DoxyCodeLine{05223\ }
\DoxyCodeLine{05224\ \textcolor{comment}{//\ Gets\ the\ number\ of\ tests\ that\ should\ run.}}
\DoxyCodeLine{05225\ \textcolor{keywordtype}{int}\ UnitTest::test\_to\_run\_count()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ impl()-\/>test\_to\_run\_count();\ \}}
\DoxyCodeLine{05226\ }
\DoxyCodeLine{05227\ \textcolor{comment}{//\ Gets\ the\ time\ of\ the\ test\ program\ start,\ in\ ms\ from\ the\ start\ of\ the}}
\DoxyCodeLine{05228\ \textcolor{comment}{//\ UNIX\ epoch.}}
\DoxyCodeLine{05229\ internal::TimeInMillis\ UnitTest::start\_timestamp()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{05230\ \ \ \textcolor{keywordflow}{return}\ impl()-\/>start\_timestamp();}
\DoxyCodeLine{05231\ \}}
\DoxyCodeLine{05232\ }
\DoxyCodeLine{05233\ \textcolor{comment}{//\ Gets\ the\ elapsed\ time,\ in\ milliseconds.}}
\DoxyCodeLine{05234\ internal::TimeInMillis\ UnitTest::elapsed\_time()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{05235\ \ \ \textcolor{keywordflow}{return}\ impl()-\/>elapsed\_time();}
\DoxyCodeLine{05236\ \}}
\DoxyCodeLine{05237\ }
\DoxyCodeLine{05238\ \textcolor{comment}{//\ Returns\ true\ if\ and\ only\ if\ the\ unit\ test\ passed\ (i.e.\ all\ test\ suites}}
\DoxyCodeLine{05239\ \textcolor{comment}{//\ passed).}}
\DoxyCodeLine{05240\ \textcolor{keywordtype}{bool}\ UnitTest::Passed()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ impl()-\/>Passed();\ \}}
\DoxyCodeLine{05241\ }
\DoxyCodeLine{05242\ \textcolor{comment}{//\ Returns\ true\ if\ and\ only\ if\ the\ unit\ test\ failed\ (i.e.\ some\ test\ suite}}
\DoxyCodeLine{05243\ \textcolor{comment}{//\ failed\ or\ something\ outside\ of\ all\ tests\ failed).}}
\DoxyCodeLine{05244\ \textcolor{keywordtype}{bool}\ UnitTest::Failed()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ impl()-\/>Failed();\ \}}
\DoxyCodeLine{05245\ }
\DoxyCodeLine{05246\ \textcolor{comment}{//\ Gets\ the\ i-\/th\ test\ suite\ among\ all\ the\ test\ suites.\ i\ can\ range\ from\ 0\ to}}
\DoxyCodeLine{05247\ \textcolor{comment}{//\ total\_test\_suite\_count()\ -\/\ 1.\ If\ i\ is\ not\ in\ that\ range,\ returns\ NULL.}}
\DoxyCodeLine{05248\ \textcolor{keyword}{const}\ TestSuite*\ UnitTest::GetTestSuite(\textcolor{keywordtype}{int}\ i)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{05249\ \ \ \textcolor{keywordflow}{return}\ impl()-\/>GetTestSuite(i);}
\DoxyCodeLine{05250\ \}}
\DoxyCodeLine{05251\ }
\DoxyCodeLine{05252\ \textcolor{comment}{//\ \ Legacy\ API\ is\ deprecated\ but\ still\ available}}
\DoxyCodeLine{05253\ \textcolor{preprocessor}{\#ifndef\ GTEST\_REMOVE\_LEGACY\_TEST\_CASEAPI\_}}
\DoxyCodeLine{05254\ \textcolor{keyword}{const}\ TestCase*\ UnitTest::GetTestCase(\textcolor{keywordtype}{int}\ i)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{05255\ \ \ \textcolor{keywordflow}{return}\ impl()-\/>GetTestCase(i);}
\DoxyCodeLine{05256\ \}}
\DoxyCodeLine{05257\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ \ GTEST\_REMOVE\_LEGACY\_TEST\_CASEAPI\_}}
\DoxyCodeLine{05258\ }
\DoxyCodeLine{05259\ \textcolor{comment}{//\ Returns\ the\ TestResult\ containing\ information\ on\ test\ failures\ and}}
\DoxyCodeLine{05260\ \textcolor{comment}{//\ properties\ logged\ outside\ of\ individual\ test\ suites.}}
\DoxyCodeLine{05261\ \textcolor{keyword}{const}\ TestResult\&\ UnitTest::ad\_hoc\_test\_result()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{05262\ \ \ \textcolor{keywordflow}{return}\ *impl()-\/>ad\_hoc\_test\_result();}
\DoxyCodeLine{05263\ \}}
\DoxyCodeLine{05264\ }
\DoxyCodeLine{05265\ \textcolor{comment}{//\ Gets\ the\ i-\/th\ test\ suite\ among\ all\ the\ test\ suites.\ i\ can\ range\ from\ 0\ to}}
\DoxyCodeLine{05266\ \textcolor{comment}{//\ total\_test\_suite\_count()\ -\/\ 1.\ If\ i\ is\ not\ in\ that\ range,\ returns\ NULL.}}
\DoxyCodeLine{05267\ TestSuite*\ UnitTest::GetMutableTestSuite(\textcolor{keywordtype}{int}\ i)\ \{}
\DoxyCodeLine{05268\ \ \ \textcolor{keywordflow}{return}\ impl()-\/>GetMutableSuiteCase(i);}
\DoxyCodeLine{05269\ \}}
\DoxyCodeLine{05270\ }
\DoxyCodeLine{05271\ \textcolor{comment}{//\ Returns\ the\ list\ of\ event\ listeners\ that\ can\ be\ used\ to\ track\ events}}
\DoxyCodeLine{05272\ \textcolor{comment}{//\ inside\ Google\ Test.}}
\DoxyCodeLine{05273\ TestEventListeners\&\ UnitTest::listeners()\ \{\ \textcolor{keywordflow}{return}\ *impl()-\/>listeners();\ \}}
\DoxyCodeLine{05274\ }
\DoxyCodeLine{05275\ \textcolor{comment}{//\ Registers\ and\ returns\ a\ global\ test\ environment.\ \ When\ a\ test}}
\DoxyCodeLine{05276\ \textcolor{comment}{//\ program\ is\ run,\ all\ global\ test\ environments\ will\ be\ set-\/up\ in\ the}}
\DoxyCodeLine{05277\ \textcolor{comment}{//\ order\ they\ were\ registered.\ \ After\ all\ tests\ in\ the\ program\ have}}
\DoxyCodeLine{05278\ \textcolor{comment}{//\ finished,\ all\ global\ test\ environments\ will\ be\ torn-\/down\ in\ the}}
\DoxyCodeLine{05279\ \textcolor{comment}{//\ *reverse*\ order\ they\ were\ registered.}}
\DoxyCodeLine{05280\ \textcolor{comment}{//}}
\DoxyCodeLine{05281\ \textcolor{comment}{//\ The\ UnitTest\ object\ takes\ ownership\ of\ the\ given\ environment.}}
\DoxyCodeLine{05282\ \textcolor{comment}{//}}
\DoxyCodeLine{05283\ \textcolor{comment}{//\ We\ don't\ protect\ this\ under\ mutex\_,\ as\ we\ only\ support\ calling\ it}}
\DoxyCodeLine{05284\ \textcolor{comment}{//\ from\ the\ main\ thread.}}
\DoxyCodeLine{05285\ \mbox{\hyperlink{class_environment}{Environment}}*\ UnitTest::AddEnvironment(\mbox{\hyperlink{class_environment}{Environment}}*\ env)\ \{}
\DoxyCodeLine{05286\ \ \ \textcolor{keywordflow}{if}\ (env\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{05287\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{05288\ \ \ \}}
\DoxyCodeLine{05289\ }
\DoxyCodeLine{05290\ \ \ impl\_-\/>environments().push\_back(env);}
\DoxyCodeLine{05291\ \ \ \textcolor{keywordflow}{return}\ env;}
\DoxyCodeLine{05292\ \}}
\DoxyCodeLine{05293\ }
\DoxyCodeLine{05294\ \textcolor{comment}{//\ Adds\ a\ TestPartResult\ to\ the\ current\ TestResult\ object.\ \ All\ Google\ Test}}
\DoxyCodeLine{05295\ \textcolor{comment}{//\ assertion\ macros\ (e.g.\ ASSERT\_TRUE,\ EXPECT\_EQ,\ etc)\ eventually\ call}}
\DoxyCodeLine{05296\ \textcolor{comment}{//\ this\ to\ report\ their\ results.\ \ The\ user\ code\ should\ use\ the}}
\DoxyCodeLine{05297\ \textcolor{comment}{//\ assertion\ macros\ instead\ of\ calling\ this\ directly.}}
\DoxyCodeLine{05298\ \textcolor{keywordtype}{void}\ UnitTest::AddTestPartResult(TestPartResult::Type\ result\_type,}
\DoxyCodeLine{05299\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ file\_name,\ \textcolor{keywordtype}{int}\ line\_number,}
\DoxyCodeLine{05300\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ message,}
\DoxyCodeLine{05301\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ os\_stack\_trace)}
\DoxyCodeLine{05302\ \ \ \ \ GTEST\_LOCK\_EXCLUDED\_(mutex\_)\ \{}
\DoxyCodeLine{05303\ \ \ Message\ msg;}
\DoxyCodeLine{05304\ \ \ msg\ <<\ message;}
\DoxyCodeLine{05305\ }
\DoxyCodeLine{05306\ \ \ internal::MutexLock\ lock(\&mutex\_);}
\DoxyCodeLine{05307\ \ \ \textcolor{keywordflow}{if}\ (impl\_-\/>gtest\_trace\_stack().size()\ >\ 0)\ \{}
\DoxyCodeLine{05308\ \ \ \ \ msg\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}\ <<\ GTEST\_NAME\_\ <<\ \textcolor{stringliteral}{"{}\ trace:"{}};}
\DoxyCodeLine{05309\ }
\DoxyCodeLine{05310\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ impl\_-\/>gtest\_trace\_stack().size();\ i\ >\ 0;\ -\/-\/i)\ \{}
\DoxyCodeLine{05311\ \ \ \ \ \ \ \textcolor{keyword}{const}\ internal::TraceInfo\&\ trace\ =\ impl\_-\/>gtest\_trace\_stack()[i\ -\/\ 1];}
\DoxyCodeLine{05312\ \ \ \ \ \ \ msg\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{05313\ \ \ \ \ \ \ \ \ \ \ <<\ internal::FormatFileLocation(trace.file,\ trace.line)\ <<\ \textcolor{stringliteral}{"{}\ "{}}}
\DoxyCodeLine{05314\ \ \ \ \ \ \ \ \ \ \ <<\ trace.message;}
\DoxyCodeLine{05315\ \ \ \ \ \}}
\DoxyCodeLine{05316\ \ \ \}}
\DoxyCodeLine{05317\ }
\DoxyCodeLine{05318\ \ \ \textcolor{keywordflow}{if}\ (os\_stack\_trace.c\_str()\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ !os\_stack\_trace.empty())\ \{}
\DoxyCodeLine{05319\ \ \ \ \ msg\ <<\ internal::kStackTraceMarker\ <<\ os\_stack\_trace;}
\DoxyCodeLine{05320\ \ \ \}}
\DoxyCodeLine{05321\ }
\DoxyCodeLine{05322\ \ \ \textcolor{keyword}{const}\ TestPartResult\ result\ =\ TestPartResult(}
\DoxyCodeLine{05323\ \ \ \ \ \ \ result\_type,\ file\_name,\ line\_number,\ msg.GetString().c\_str());}
\DoxyCodeLine{05324\ \ \ impl\_-\/>GetTestPartResultReporterForCurrentThread()-\/>ReportTestPartResult(}
\DoxyCodeLine{05325\ \ \ \ \ \ \ result);}
\DoxyCodeLine{05326\ }
\DoxyCodeLine{05327\ \ \ \textcolor{keywordflow}{if}\ (result\_type\ !=\ TestPartResult::kSuccess\ \&\&}
\DoxyCodeLine{05328\ \ \ \ \ \ \ result\_type\ !=\ TestPartResult::kSkip)\ \{}
\DoxyCodeLine{05329\ \ \ \ \ \textcolor{comment}{//\ gtest\_break\_on\_failure\ takes\ precedence\ over}}
\DoxyCodeLine{05330\ \ \ \ \ \textcolor{comment}{//\ gtest\_throw\_on\_failure.\ \ This\ allows\ a\ user\ to\ set\ the\ latter}}
\DoxyCodeLine{05331\ \ \ \ \ \textcolor{comment}{//\ in\ the\ code\ (perhaps\ in\ order\ to\ use\ Google\ Test\ assertions}}
\DoxyCodeLine{05332\ \ \ \ \ \textcolor{comment}{//\ with\ another\ testing\ framework)\ and\ specify\ the\ former\ on\ the}}
\DoxyCodeLine{05333\ \ \ \ \ \textcolor{comment}{//\ command\ line\ for\ debugging.}}
\DoxyCodeLine{05334\ \ \ \ \ \textcolor{keywordflow}{if}\ (GTEST\_FLAG\_GET(break\_on\_failure))\ \{}
\DoxyCodeLine{05335\ \textcolor{preprocessor}{\#if\ GTEST\_OS\_WINDOWS\ \&\&\ !GTEST\_OS\_WINDOWS\_PHONE\ \&\&\ !GTEST\_OS\_WINDOWS\_RT}}
\DoxyCodeLine{05336\ \ \ \ \ \ \ \textcolor{comment}{//\ Using\ DebugBreak\ on\ Windows\ allows\ gtest\ to\ still\ break\ into\ a\ debugger}}
\DoxyCodeLine{05337\ \ \ \ \ \ \ \textcolor{comment}{//\ when\ a\ failure\ happens\ and\ both\ the\ -\/-\/gtest\_break\_on\_failure\ and}}
\DoxyCodeLine{05338\ \ \ \ \ \ \ \textcolor{comment}{//\ the\ -\/-\/gtest\_catch\_exceptions\ flags\ are\ specified.}}
\DoxyCodeLine{05339\ \ \ \ \ \ \ DebugBreak();}
\DoxyCodeLine{05340\ \textcolor{preprocessor}{\#elif\ (!defined(\_\_native\_client\_\_))\ \&\&\ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{05341\ \textcolor{preprocessor}{\ \ \ \ ((defined(\_\_clang\_\_)\ ||\ defined(\_\_GNUC\_\_))\ \&\&\ \(\backslash\)}}
\DoxyCodeLine{05342\ \textcolor{preprocessor}{\ \ \ \ \ (defined(\_\_x86\_64\_\_)\ ||\ defined(\_\_i386\_\_)))}}
\DoxyCodeLine{05343\ \ \ \ \ \ \ \textcolor{comment}{//\ with\ clang/gcc\ we\ can\ achieve\ the\ same\ effect\ on\ x86\ by\ invoking\ int3}}
\DoxyCodeLine{05344\ \ \ \ \ \ \ \textcolor{keyword}{asm}(\textcolor{stringliteral}{"{}int3"{}});}
\DoxyCodeLine{05345\ \textcolor{preprocessor}{\#elif\ GTEST\_HAS\_BUILTIN(\_\_builtin\_trap)}}
\DoxyCodeLine{05346\ \ \ \ \ \ \ \_\_builtin\_trap();}
\DoxyCodeLine{05347\ \textcolor{preprocessor}{\#elif\ defined(SIGTRAP)}}
\DoxyCodeLine{05348\ \ \ \ \ \ \ raise(SIGTRAP);}
\DoxyCodeLine{05349\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{05350\ \ \ \ \ \ \ \textcolor{comment}{//\ Dereference\ nullptr\ through\ a\ volatile\ pointer\ to\ prevent\ the\ compiler}}
\DoxyCodeLine{05351\ \ \ \ \ \ \ \textcolor{comment}{//\ from\ removing.\ We\ use\ this\ rather\ than\ abort()\ or\ \_\_builtin\_trap()\ for}}
\DoxyCodeLine{05352\ \ \ \ \ \ \ \textcolor{comment}{//\ portability:\ some\ debuggers\ don't\ correctly\ trap\ abort().}}
\DoxyCodeLine{05353\ \ \ \ \ \ \ *\textcolor{keyword}{static\_cast<}\textcolor{keyword}{volatile\ }\textcolor{keywordtype}{int}*\textcolor{keyword}{>}(\textcolor{keyword}{nullptr})\ =\ 1;}
\DoxyCodeLine{05354\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GTEST\_OS\_WINDOWS}}
\DoxyCodeLine{05355\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (GTEST\_FLAG\_GET(throw\_on\_failure))\ \{}
\DoxyCodeLine{05356\ \textcolor{preprocessor}{\#if\ GTEST\_HAS\_EXCEPTIONS}}
\DoxyCodeLine{05357\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ internal::GoogleTestFailureException(result);}
\DoxyCodeLine{05358\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{05359\ \ \ \ \ \ \ \textcolor{comment}{//\ We\ cannot\ call\ abort()\ as\ it\ generates\ a\ pop-\/up\ in\ debug\ mode}}
\DoxyCodeLine{05360\ \ \ \ \ \ \ \textcolor{comment}{//\ that\ cannot\ be\ suppressed\ in\ VC\ 7.1\ or\ below.}}
\DoxyCodeLine{05361\ \ \ \ \ \ \ exit(1);}
\DoxyCodeLine{05362\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{05363\ \ \ \ \ \}}
\DoxyCodeLine{05364\ \ \ \}}
\DoxyCodeLine{05365\ \}}
\DoxyCodeLine{05366\ }
\DoxyCodeLine{05367\ \textcolor{comment}{//\ Adds\ a\ TestProperty\ to\ the\ current\ TestResult\ object\ when\ invoked\ from}}
\DoxyCodeLine{05368\ \textcolor{comment}{//\ inside\ a\ test,\ to\ current\ TestSuite's\ ad\_hoc\_test\_result\_\ when\ invoked}}
\DoxyCodeLine{05369\ \textcolor{comment}{//\ from\ SetUpTestSuite\ or\ TearDownTestSuite,\ or\ to\ the\ global\ property\ set}}
\DoxyCodeLine{05370\ \textcolor{comment}{//\ when\ invoked\ elsewhere.\ \ If\ the\ result\ already\ contains\ a\ property\ with}}
\DoxyCodeLine{05371\ \textcolor{comment}{//\ the\ same\ key,\ the\ value\ will\ be\ updated.}}
\DoxyCodeLine{05372\ \textcolor{keywordtype}{void}\ UnitTest::RecordProperty(\textcolor{keyword}{const}\ std::string\&\ key,}
\DoxyCodeLine{05373\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ value)\ \{}
\DoxyCodeLine{05374\ \ \ impl\_-\/>RecordProperty(TestProperty(key,\ value));}
\DoxyCodeLine{05375\ \}}
\DoxyCodeLine{05376\ }
\DoxyCodeLine{05377\ \textcolor{comment}{//\ Runs\ all\ tests\ in\ this\ UnitTest\ object\ and\ prints\ the\ result.}}
\DoxyCodeLine{05378\ \textcolor{comment}{//\ Returns\ 0\ if\ successful,\ or\ 1\ otherwise.}}
\DoxyCodeLine{05379\ \textcolor{comment}{//}}
\DoxyCodeLine{05380\ \textcolor{comment}{//\ We\ don't\ protect\ this\ under\ mutex\_,\ as\ we\ only\ support\ calling\ it}}
\DoxyCodeLine{05381\ \textcolor{comment}{//\ from\ the\ main\ thread.}}
\DoxyCodeLine{05382\ \textcolor{keywordtype}{int}\ UnitTest::Run()\ \{}
\DoxyCodeLine{05383\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ in\_death\_test\_child\_process\ =}
\DoxyCodeLine{05384\ \ \ \ \ \ \ GTEST\_FLAG\_GET(internal\_run\_death\_test).length()\ >\ 0;}
\DoxyCodeLine{05385\ }
\DoxyCodeLine{05386\ \ \ \textcolor{comment}{//\ Google\ Test\ implements\ this\ protocol\ for\ catching\ that\ a\ test}}
\DoxyCodeLine{05387\ \ \ \textcolor{comment}{//\ program\ exits\ before\ returning\ control\ to\ Google\ Test:}}
\DoxyCodeLine{05388\ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{05389\ \ \ \textcolor{comment}{//\ \ \ 1.\ Upon\ start,\ Google\ Test\ creates\ a\ file\ whose\ absolute\ path}}
\DoxyCodeLine{05390\ \ \ \textcolor{comment}{//\ \ \ \ \ \ is\ specified\ by\ the\ environment\ variable}}
\DoxyCodeLine{05391\ \ \ \textcolor{comment}{//\ \ \ \ \ \ TEST\_PREMATURE\_EXIT\_FILE.}}
\DoxyCodeLine{05392\ \ \ \textcolor{comment}{//\ \ \ 2.\ When\ Google\ Test\ has\ finished\ its\ work,\ it\ deletes\ the\ file.}}
\DoxyCodeLine{05393\ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{05394\ \ \ \textcolor{comment}{//\ This\ allows\ a\ test\ runner\ to\ set\ TEST\_PREMATURE\_EXIT\_FILE\ before}}
\DoxyCodeLine{05395\ \ \ \textcolor{comment}{//\ running\ a\ Google-\/Test-\/based\ test\ program\ and\ check\ the\ existence}}
\DoxyCodeLine{05396\ \ \ \textcolor{comment}{//\ of\ the\ file\ at\ the\ end\ of\ the\ test\ execution\ to\ see\ if\ it\ has}}
\DoxyCodeLine{05397\ \ \ \textcolor{comment}{//\ exited\ prematurely.}}
\DoxyCodeLine{05398\ }
\DoxyCodeLine{05399\ \ \ \textcolor{comment}{//\ If\ we\ are\ in\ the\ child\ process\ of\ a\ death\ test,\ don't}}
\DoxyCodeLine{05400\ \ \ \textcolor{comment}{//\ create/delete\ the\ premature\ exit\ file,\ as\ doing\ so\ is\ unnecessary}}
\DoxyCodeLine{05401\ \ \ \textcolor{comment}{//\ and\ will\ confuse\ the\ parent\ process.\ \ Otherwise,\ create/delete}}
\DoxyCodeLine{05402\ \ \ \textcolor{comment}{//\ the\ file\ upon\ entering/leaving\ this\ function.\ \ If\ the\ program}}
\DoxyCodeLine{05403\ \ \ \textcolor{comment}{//\ somehow\ exits\ before\ this\ function\ has\ a\ chance\ to\ return,\ the}}
\DoxyCodeLine{05404\ \ \ \textcolor{comment}{//\ premature-\/exit\ file\ will\ be\ left\ undeleted,\ causing\ a\ test\ runner}}
\DoxyCodeLine{05405\ \ \ \textcolor{comment}{//\ that\ understands\ the\ premature-\/exit-\/file\ protocol\ to\ report\ the}}
\DoxyCodeLine{05406\ \ \ \textcolor{comment}{//\ test\ as\ having\ failed.}}
\DoxyCodeLine{05407\ \ \ \textcolor{keyword}{const}\ internal::ScopedPrematureExitFile\ premature\_exit\_file(}
\DoxyCodeLine{05408\ \ \ \ \ \ \ in\_death\_test\_child\_process}
\DoxyCodeLine{05409\ \ \ \ \ \ \ \ \ \ \ ?\ \textcolor{keyword}{nullptr}}
\DoxyCodeLine{05410\ \ \ \ \ \ \ \ \ \ \ :\ internal::posix::GetEnv(\textcolor{stringliteral}{"{}TEST\_PREMATURE\_EXIT\_FILE"{}}));}
\DoxyCodeLine{05411\ }
\DoxyCodeLine{05412\ \ \ \textcolor{comment}{//\ Captures\ the\ value\ of\ GTEST\_FLAG(catch\_exceptions).\ \ This\ value\ will\ be}}
\DoxyCodeLine{05413\ \ \ \textcolor{comment}{//\ used\ for\ the\ duration\ of\ the\ program.}}
\DoxyCodeLine{05414\ \ \ impl()-\/>set\_catch\_exceptions(GTEST\_FLAG\_GET(catch\_exceptions));}
\DoxyCodeLine{05415\ }
\DoxyCodeLine{05416\ \textcolor{preprocessor}{\#if\ GTEST\_OS\_WINDOWS}}
\DoxyCodeLine{05417\ \ \ \textcolor{comment}{//\ Either\ the\ user\ wants\ Google\ Test\ to\ catch\ exceptions\ thrown\ by\ the}}
\DoxyCodeLine{05418\ \ \ \textcolor{comment}{//\ tests\ or\ this\ is\ executing\ in\ the\ context\ of\ death\ test\ child}}
\DoxyCodeLine{05419\ \ \ \textcolor{comment}{//\ process.\ In\ either\ case\ the\ user\ does\ not\ want\ to\ see\ pop-\/up\ dialogs}}
\DoxyCodeLine{05420\ \ \ \textcolor{comment}{//\ about\ crashes\ -\/\ they\ are\ expected.}}
\DoxyCodeLine{05421\ \ \ \textcolor{keywordflow}{if}\ (impl()-\/>catch\_exceptions()\ ||\ in\_death\_test\_child\_process)\ \{}
\DoxyCodeLine{05422\ \textcolor{preprocessor}{\#if\ !GTEST\_OS\_WINDOWS\_MOBILE\ \&\&\ !GTEST\_OS\_WINDOWS\_PHONE\ \&\&\ !GTEST\_OS\_WINDOWS\_RT}}
\DoxyCodeLine{05423\ \ \ \ \ \textcolor{comment}{//\ SetErrorMode\ doesn't\ exist\ on\ CE.}}
\DoxyCodeLine{05424\ \ \ \ \ SetErrorMode(SEM\_FAILCRITICALERRORS\ |\ SEM\_NOALIGNMENTFAULTEXCEPT\ |}
\DoxyCodeLine{05425\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ SEM\_NOGPFAULTERRORBOX\ |\ SEM\_NOOPENFILEERRORBOX);}
\DoxyCodeLine{05426\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ !GTEST\_OS\_WINDOWS\_MOBILE}}
\DoxyCodeLine{05427\ }
\DoxyCodeLine{05428\ \textcolor{preprocessor}{\#if\ (defined(\_MSC\_VER)\ ||\ GTEST\_OS\_WINDOWS\_MINGW)\ \&\&\ !GTEST\_OS\_WINDOWS\_MOBILE}}
\DoxyCodeLine{05429\ \ \ \ \ \textcolor{comment}{//\ Death\ test\ children\ can\ be\ terminated\ with\ \_abort().\ \ On\ Windows,}}
\DoxyCodeLine{05430\ \ \ \ \ \textcolor{comment}{//\ \_abort()\ can\ show\ a\ dialog\ with\ a\ warning\ message.\ \ This\ forces\ the}}
\DoxyCodeLine{05431\ \ \ \ \ \textcolor{comment}{//\ abort\ message\ to\ go\ to\ stderr\ instead.}}
\DoxyCodeLine{05432\ \ \ \ \ \_set\_error\_mode(\_OUT\_TO\_STDERR);}
\DoxyCodeLine{05433\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{05434\ }
\DoxyCodeLine{05435\ \textcolor{preprocessor}{\#if\ defined(\_MSC\_VER)\ \&\&\ !GTEST\_OS\_WINDOWS\_MOBILE}}
\DoxyCodeLine{05436\ \ \ \ \ \textcolor{comment}{//\ In\ the\ debug\ version,\ Visual\ Studio\ pops\ up\ a\ separate\ dialog}}
\DoxyCodeLine{05437\ \ \ \ \ \textcolor{comment}{//\ offering\ a\ choice\ to\ debug\ the\ aborted\ program.\ We\ need\ to\ suppress}}
\DoxyCodeLine{05438\ \ \ \ \ \textcolor{comment}{//\ this\ dialog\ or\ it\ will\ pop\ up\ for\ every\ EXPECT/ASSERT\_DEATH\ statement}}
\DoxyCodeLine{05439\ \ \ \ \ \textcolor{comment}{//\ executed.\ Google\ Test\ will\ notify\ the\ user\ of\ any\ unexpected}}
\DoxyCodeLine{05440\ \ \ \ \ \textcolor{comment}{//\ failure\ via\ stderr.}}
\DoxyCodeLine{05441\ \ \ \ \ \textcolor{keywordflow}{if}\ (!GTEST\_FLAG\_GET(break\_on\_failure))}
\DoxyCodeLine{05442\ \ \ \ \ \ \ \_set\_abort\_behavior(}
\DoxyCodeLine{05443\ \ \ \ \ \ \ \ \ \ \ 0x0,\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Clear\ the\ following\ flags:}}
\DoxyCodeLine{05444\ \ \ \ \ \ \ \ \ \ \ \_WRITE\_ABORT\_MSG\ |\ \_CALL\_REPORTFAULT);\ \ \textcolor{comment}{//\ pop-\/up\ window,\ core\ dump.}}
\DoxyCodeLine{05445\ }
\DoxyCodeLine{05446\ \ \ \ \ \textcolor{comment}{//\ In\ debug\ mode,\ the\ Windows\ CRT\ can\ crash\ with\ an\ assertion\ over\ invalid}}
\DoxyCodeLine{05447\ \ \ \ \ \textcolor{comment}{//\ input\ (e.g.\ passing\ an\ invalid\ file\ descriptor).\ \ The\ default\ handling}}
\DoxyCodeLine{05448\ \ \ \ \ \textcolor{comment}{//\ for\ these\ assertions\ is\ to\ pop\ up\ a\ dialog\ and\ wait\ for\ user\ input.}}
\DoxyCodeLine{05449\ \ \ \ \ \textcolor{comment}{//\ Instead\ ask\ the\ CRT\ to\ dump\ such\ assertions\ to\ stderr\ non-\/interactively.}}
\DoxyCodeLine{05450\ \ \ \ \ \textcolor{keywordflow}{if}\ (!IsDebuggerPresent())\ \{}
\DoxyCodeLine{05451\ \ \ \ \ \ \ (void)\_CrtSetReportMode(\_CRT\_ASSERT,}
\DoxyCodeLine{05452\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_CRTDBG\_MODE\_FILE\ |\ \_CRTDBG\_MODE\_DEBUG);}
\DoxyCodeLine{05453\ \ \ \ \ \ \ (void)\_CrtSetReportFile(\_CRT\_ASSERT,\ \_CRTDBG\_FILE\_STDERR);}
\DoxyCodeLine{05454\ \ \ \ \ \}}
\DoxyCodeLine{05455\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{05456\ \ \ \}}
\DoxyCodeLine{05457\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GTEST\_OS\_WINDOWS}}
\DoxyCodeLine{05458\ }
\DoxyCodeLine{05459\ \ \ \textcolor{keywordflow}{return}\ internal::HandleExceptionsInMethodIfSupported(}
\DoxyCodeLine{05460\ \ \ \ \ \ \ \ \ \ \ \ \ \ impl(),\ \&internal::UnitTestImpl::RunAllTests,}
\DoxyCodeLine{05461\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}auxiliary\ test\ code\ (environments\ or\ event\ listeners)"{}})}
\DoxyCodeLine{05462\ \ \ \ \ \ \ \ \ \ \ \ \ \ ?\ 0}
\DoxyCodeLine{05463\ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ 1;}
\DoxyCodeLine{05464\ \}}
\DoxyCodeLine{05465\ }
\DoxyCodeLine{05466\ \textcolor{comment}{//\ Returns\ the\ working\ directory\ when\ the\ first\ TEST()\ or\ TEST\_F()\ was}}
\DoxyCodeLine{05467\ \textcolor{comment}{//\ executed.}}
\DoxyCodeLine{05468\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ UnitTest::original\_working\_dir()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{05469\ \ \ \textcolor{keywordflow}{return}\ impl\_-\/>original\_working\_dir\_.c\_str();}
\DoxyCodeLine{05470\ \}}
\DoxyCodeLine{05471\ }
\DoxyCodeLine{05472\ \textcolor{comment}{//\ Returns\ the\ TestSuite\ object\ for\ the\ test\ that's\ currently\ running,}}
\DoxyCodeLine{05473\ \textcolor{comment}{//\ or\ NULL\ if\ no\ test\ is\ running.}}
\DoxyCodeLine{05474\ \textcolor{keyword}{const}\ TestSuite*\ UnitTest::current\_test\_suite()\ const}
\DoxyCodeLine{05475\ \ \ \ \ GTEST\_LOCK\_EXCLUDED\_(mutex\_)\ \{}
\DoxyCodeLine{05476\ \ \ internal::MutexLock\ lock(\&mutex\_);}
\DoxyCodeLine{05477\ \ \ \textcolor{keywordflow}{return}\ impl\_-\/>current\_test\_suite();}
\DoxyCodeLine{05478\ \}}
\DoxyCodeLine{05479\ }
\DoxyCodeLine{05480\ \textcolor{comment}{//\ Legacy\ API\ is\ still\ available\ but\ deprecated}}
\DoxyCodeLine{05481\ \textcolor{preprocessor}{\#ifndef\ GTEST\_REMOVE\_LEGACY\_TEST\_CASEAPI\_}}
\DoxyCodeLine{05482\ \textcolor{keyword}{const}\ TestCase*\ UnitTest::current\_test\_case()\ const}
\DoxyCodeLine{05483\ \ \ \ \ GTEST\_LOCK\_EXCLUDED\_(mutex\_)\ \{}
\DoxyCodeLine{05484\ \ \ internal::MutexLock\ lock(\&mutex\_);}
\DoxyCodeLine{05485\ \ \ \textcolor{keywordflow}{return}\ impl\_-\/>current\_test\_suite();}
\DoxyCodeLine{05486\ \}}
\DoxyCodeLine{05487\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{05488\ }
\DoxyCodeLine{05489\ \textcolor{comment}{//\ Returns\ the\ TestInfo\ object\ for\ the\ test\ that's\ currently\ running,}}
\DoxyCodeLine{05490\ \textcolor{comment}{//\ or\ NULL\ if\ no\ test\ is\ running.}}
\DoxyCodeLine{05491\ \textcolor{keyword}{const}\ TestInfo*\ UnitTest::current\_test\_info()\ const}
\DoxyCodeLine{05492\ \ \ \ \ GTEST\_LOCK\_EXCLUDED\_(mutex\_)\ \{}
\DoxyCodeLine{05493\ \ \ internal::MutexLock\ lock(\&mutex\_);}
\DoxyCodeLine{05494\ \ \ \textcolor{keywordflow}{return}\ impl\_-\/>current\_test\_info();}
\DoxyCodeLine{05495\ \}}
\DoxyCodeLine{05496\ }
\DoxyCodeLine{05497\ \textcolor{comment}{//\ Returns\ the\ random\ seed\ used\ at\ the\ start\ of\ the\ current\ test\ run.}}
\DoxyCodeLine{05498\ \textcolor{keywordtype}{int}\ UnitTest::random\_seed()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ impl\_-\/>random\_seed();\ \}}
\DoxyCodeLine{05499\ }
\DoxyCodeLine{05500\ \textcolor{comment}{//\ Returns\ ParameterizedTestSuiteRegistry\ object\ used\ to\ keep\ track\ of}}
\DoxyCodeLine{05501\ \textcolor{comment}{//\ value-\/parameterized\ tests\ and\ instantiate\ and\ register\ them.}}
\DoxyCodeLine{05502\ internal::ParameterizedTestSuiteRegistry\&}
\DoxyCodeLine{05503\ UnitTest::parameterized\_test\_registry()\ GTEST\_LOCK\_EXCLUDED\_(mutex\_)\ \{}
\DoxyCodeLine{05504\ \ \ \textcolor{keywordflow}{return}\ impl\_-\/>parameterized\_test\_registry();}
\DoxyCodeLine{05505\ \}}
\DoxyCodeLine{05506\ }
\DoxyCodeLine{05507\ \textcolor{comment}{//\ Creates\ an\ empty\ UnitTest.}}
\DoxyCodeLine{05508\ UnitTest::UnitTest()\ \{\ impl\_\ =\ \textcolor{keyword}{new}\ internal::UnitTestImpl(\textcolor{keyword}{this});\ \}}
\DoxyCodeLine{05509\ }
\DoxyCodeLine{05510\ \textcolor{comment}{//\ Destructor\ of\ UnitTest.}}
\DoxyCodeLine{05511\ UnitTest::\string~UnitTest()\ \{\ \textcolor{keyword}{delete}\ impl\_;\ \}}
\DoxyCodeLine{05512\ }
\DoxyCodeLine{05513\ \textcolor{comment}{//\ Pushes\ a\ trace\ defined\ by\ SCOPED\_TRACE()\ on\ to\ the\ per-\/thread}}
\DoxyCodeLine{05514\ \textcolor{comment}{//\ Google\ Test\ trace\ stack.}}
\DoxyCodeLine{05515\ \textcolor{keywordtype}{void}\ UnitTest::PushGTestTrace(\textcolor{keyword}{const}\ internal::TraceInfo\&\ trace)}
\DoxyCodeLine{05516\ \ \ \ \ GTEST\_LOCK\_EXCLUDED\_(mutex\_)\ \{}
\DoxyCodeLine{05517\ \ \ internal::MutexLock\ lock(\&mutex\_);}
\DoxyCodeLine{05518\ \ \ impl\_-\/>gtest\_trace\_stack().push\_back(trace);}
\DoxyCodeLine{05519\ \}}
\DoxyCodeLine{05520\ }
\DoxyCodeLine{05521\ \textcolor{comment}{//\ Pops\ a\ trace\ from\ the\ per-\/thread\ Google\ Test\ trace\ stack.}}
\DoxyCodeLine{05522\ \textcolor{keywordtype}{void}\ UnitTest::PopGTestTrace()\ GTEST\_LOCK\_EXCLUDED\_(mutex\_)\ \{}
\DoxyCodeLine{05523\ \ \ internal::MutexLock\ lock(\&mutex\_);}
\DoxyCodeLine{05524\ \ \ impl\_-\/>gtest\_trace\_stack().pop\_back();}
\DoxyCodeLine{05525\ \}}
\DoxyCodeLine{05526\ }
\DoxyCodeLine{05527\ \textcolor{keyword}{namespace\ }internal\ \{}
\DoxyCodeLine{05528\ }
\DoxyCodeLine{05529\ UnitTestImpl::UnitTestImpl(UnitTest*\ parent)}
\DoxyCodeLine{05530\ \ \ \ \ :\ parent\_(parent),}
\DoxyCodeLine{05531\ \ \ \ \ \ \ GTEST\_DISABLE\_MSC\_WARNINGS\_PUSH\_(4355\ \textcolor{comment}{/*\ using\ this\ in\ initializer\ */})}
\DoxyCodeLine{05532\ \ \ \ \ \ \ \ \ \ \ default\_global\_test\_part\_result\_reporter\_(this),}
\DoxyCodeLine{05533\ \ \ \ \ \ \ default\_per\_thread\_test\_part\_result\_reporter\_(this),}
\DoxyCodeLine{05534\ \ \ \ \ \ \ GTEST\_DISABLE\_MSC\_WARNINGS\_POP\_()\ global\_test\_part\_result\_reporter\_(}
\DoxyCodeLine{05535\ \ \ \ \ \ \ \ \ \ \ \&default\_global\_test\_part\_result\_reporter\_),}
\DoxyCodeLine{05536\ \ \ \ \ \ \ per\_thread\_test\_part\_result\_reporter\_(}
\DoxyCodeLine{05537\ \ \ \ \ \ \ \ \ \ \ \&default\_per\_thread\_test\_part\_result\_reporter\_),}
\DoxyCodeLine{05538\ \ \ \ \ \ \ parameterized\_test\_registry\_(),}
\DoxyCodeLine{05539\ \ \ \ \ \ \ parameterized\_tests\_registered\_(false),}
\DoxyCodeLine{05540\ \ \ \ \ \ \ last\_death\_test\_suite\_(-\/1),}
\DoxyCodeLine{05541\ \ \ \ \ \ \ current\_test\_suite\_(nullptr),}
\DoxyCodeLine{05542\ \ \ \ \ \ \ current\_test\_info\_(nullptr),}
\DoxyCodeLine{05543\ \ \ \ \ \ \ ad\_hoc\_test\_result\_(),}
\DoxyCodeLine{05544\ \ \ \ \ \ \ os\_stack\_trace\_getter\_(nullptr),}
\DoxyCodeLine{05545\ \ \ \ \ \ \ post\_flag\_parse\_init\_performed\_(false),}
\DoxyCodeLine{05546\ \ \ \ \ \ \ random\_seed\_(0),\ \ \textcolor{comment}{//\ Will\ be\ overridden\ by\ the\ flag\ before\ first\ use.}}
\DoxyCodeLine{05547\ \ \ \ \ \ \ random\_(0),\ \ \ \ \ \ \ \textcolor{comment}{//\ Will\ be\ reseeded\ before\ first\ use.}}
\DoxyCodeLine{05548\ \ \ \ \ \ \ start\_timestamp\_(0),}
\DoxyCodeLine{05549\ \ \ \ \ \ \ elapsed\_time\_(0),}
\DoxyCodeLine{05550\ \#if\ GTEST\_HAS\_DEATH\_TEST}
\DoxyCodeLine{05551\ \ \ \ \ \ \ death\_test\_factory\_(new\ DefaultDeathTestFactory),}
\DoxyCodeLine{05552\ \#endif}
\DoxyCodeLine{05553\ \ \ \ \ \ \ \textcolor{comment}{//\ Will\ be\ overridden\ by\ the\ flag\ before\ first\ use.}}
\DoxyCodeLine{05554\ \ \ \ \ \ \ catch\_exceptions\_(false)\ \{}
\DoxyCodeLine{05555\ \ \ listeners()-\/>SetDefaultResultPrinter(\textcolor{keyword}{new}\ PrettyUnitTestResultPrinter);}
\DoxyCodeLine{05556\ \}}
\DoxyCodeLine{05557\ }
\DoxyCodeLine{05558\ UnitTestImpl::\string~UnitTestImpl()\ \{}
\DoxyCodeLine{05559\ \ \ \textcolor{comment}{//\ Deletes\ every\ TestSuite.}}
\DoxyCodeLine{05560\ \ \ ForEach(test\_suites\_,\ internal::Delete<TestSuite>);}
\DoxyCodeLine{05561\ }
\DoxyCodeLine{05562\ \ \ \textcolor{comment}{//\ Deletes\ every\ Environment.}}
\DoxyCodeLine{05563\ \ \ ForEach(environments\_,\ internal::Delete<Environment>);}
\DoxyCodeLine{05564\ }
\DoxyCodeLine{05565\ \ \ \textcolor{keyword}{delete}\ os\_stack\_trace\_getter\_;}
\DoxyCodeLine{05566\ \}}
\DoxyCodeLine{05567\ }
\DoxyCodeLine{05568\ \textcolor{comment}{//\ Adds\ a\ TestProperty\ to\ the\ current\ TestResult\ object\ when\ invoked\ in\ a}}
\DoxyCodeLine{05569\ \textcolor{comment}{//\ context\ of\ a\ test,\ to\ current\ test\ suite's\ ad\_hoc\_test\_result\ when\ invoke}}
\DoxyCodeLine{05570\ \textcolor{comment}{//\ from\ SetUpTestSuite/TearDownTestSuite,\ or\ to\ the\ global\ property\ set}}
\DoxyCodeLine{05571\ \textcolor{comment}{//\ otherwise.\ \ If\ the\ result\ already\ contains\ a\ property\ with\ the\ same\ key,}}
\DoxyCodeLine{05572\ \textcolor{comment}{//\ the\ value\ will\ be\ updated.}}
\DoxyCodeLine{05573\ \textcolor{keywordtype}{void}\ UnitTestImpl::RecordProperty(\textcolor{keyword}{const}\ TestProperty\&\ test\_property)\ \{}
\DoxyCodeLine{05574\ \ \ std::string\ xml\_element;}
\DoxyCodeLine{05575\ \ \ TestResult*\ test\_result;\ \ \textcolor{comment}{//\ TestResult\ appropriate\ for\ property\ recording.}}
\DoxyCodeLine{05576\ }
\DoxyCodeLine{05577\ \ \ \textcolor{keywordflow}{if}\ (current\_test\_info\_\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{05578\ \ \ \ \ xml\_element\ =\ \textcolor{stringliteral}{"{}testcase"{}};}
\DoxyCodeLine{05579\ \ \ \ \ test\_result\ =\ \&(current\_test\_info\_-\/>result\_);}
\DoxyCodeLine{05580\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (current\_test\_suite\_\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{05581\ \ \ \ \ xml\_element\ =\ \textcolor{stringliteral}{"{}testsuite"{}};}
\DoxyCodeLine{05582\ \ \ \ \ test\_result\ =\ \&(current\_test\_suite\_-\/>ad\_hoc\_test\_result\_);}
\DoxyCodeLine{05583\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05584\ \ \ \ \ xml\_element\ =\ \textcolor{stringliteral}{"{}testsuites"{}};}
\DoxyCodeLine{05585\ \ \ \ \ test\_result\ =\ \&ad\_hoc\_test\_result\_;}
\DoxyCodeLine{05586\ \ \ \}}
\DoxyCodeLine{05587\ \ \ test\_result-\/>RecordProperty(xml\_element,\ test\_property);}
\DoxyCodeLine{05588\ \}}
\DoxyCodeLine{05589\ }
\DoxyCodeLine{05590\ \textcolor{preprocessor}{\#if\ GTEST\_HAS\_DEATH\_TEST}}
\DoxyCodeLine{05591\ \textcolor{comment}{//\ Disables\ event\ forwarding\ if\ the\ control\ is\ currently\ in\ a\ death\ test}}
\DoxyCodeLine{05592\ \textcolor{comment}{//\ subprocess.\ Must\ not\ be\ called\ before\ InitGoogleTest.}}
\DoxyCodeLine{05593\ \textcolor{keywordtype}{void}\ UnitTestImpl::SuppressTestEventsIfInSubprocess()\ \{}
\DoxyCodeLine{05594\ \ \ \textcolor{keywordflow}{if}\ (internal\_run\_death\_test\_flag\_.get()\ !=\ \textcolor{keyword}{nullptr})}
\DoxyCodeLine{05595\ \ \ \ \ listeners()-\/>SuppressEventForwarding();}
\DoxyCodeLine{05596\ \}}
\DoxyCodeLine{05597\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GTEST\_HAS\_DEATH\_TEST}}
\DoxyCodeLine{05598\ }
\DoxyCodeLine{05599\ \textcolor{comment}{//\ Initializes\ event\ listeners\ performing\ XML\ output\ as\ specified\ by}}
\DoxyCodeLine{05600\ \textcolor{comment}{//\ UnitTestOptions.\ Must\ not\ be\ called\ before\ InitGoogleTest.}}
\DoxyCodeLine{05601\ \textcolor{keywordtype}{void}\ UnitTestImpl::ConfigureXmlOutput()\ \{}
\DoxyCodeLine{05602\ \ \ \textcolor{keyword}{const}\ std::string\&\ output\_format\ =\ UnitTestOptions::GetOutputFormat();}
\DoxyCodeLine{05603\ \ \ \textcolor{keywordflow}{if}\ (output\_format\ ==\ \textcolor{stringliteral}{"{}xml"{}})\ \{}
\DoxyCodeLine{05604\ \ \ \ \ listeners()-\/>SetDefaultXmlGenerator(\textcolor{keyword}{new}\ XmlUnitTestResultPrinter(}
\DoxyCodeLine{05605\ \ \ \ \ \ \ \ \ UnitTestOptions::GetAbsolutePathToOutputFile().c\_str()));}
\DoxyCodeLine{05606\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (output\_format\ ==\ \textcolor{stringliteral}{"{}json"{}})\ \{}
\DoxyCodeLine{05607\ \ \ \ \ listeners()-\/>SetDefaultXmlGenerator(\textcolor{keyword}{new}\ JsonUnitTestResultPrinter(}
\DoxyCodeLine{05608\ \ \ \ \ \ \ \ \ UnitTestOptions::GetAbsolutePathToOutputFile().c\_str()));}
\DoxyCodeLine{05609\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (output\_format\ !=\ \textcolor{stringliteral}{"{}"{}})\ \{}
\DoxyCodeLine{05610\ \ \ \ \ GTEST\_LOG\_(WARNING)\ <<\ \textcolor{stringliteral}{"{}WARNING:\ unrecognized\ output\ format\ \(\backslash\)"{}"{}}}
\DoxyCodeLine{05611\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ output\_format\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}\ ignored."{}};}
\DoxyCodeLine{05612\ \ \ \}}
\DoxyCodeLine{05613\ \}}
\DoxyCodeLine{05614\ }
\DoxyCodeLine{05615\ \textcolor{preprocessor}{\#if\ GTEST\_CAN\_STREAM\_RESULTS\_}}
\DoxyCodeLine{05616\ \textcolor{comment}{//\ Initializes\ event\ listeners\ for\ streaming\ test\ results\ in\ string\ form.}}
\DoxyCodeLine{05617\ \textcolor{comment}{//\ Must\ not\ be\ called\ before\ InitGoogleTest.}}
\DoxyCodeLine{05618\ \textcolor{keywordtype}{void}\ UnitTestImpl::ConfigureStreamingOutput()\ \{}
\DoxyCodeLine{05619\ \ \ \textcolor{keyword}{const}\ std::string\&\ target\ =\ GTEST\_FLAG\_GET(stream\_result\_to);}
\DoxyCodeLine{05620\ \ \ \textcolor{keywordflow}{if}\ (!target.empty())\ \{}
\DoxyCodeLine{05621\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ pos\ =\ target.find(\textcolor{charliteral}{':'});}
\DoxyCodeLine{05622\ \ \ \ \ \textcolor{keywordflow}{if}\ (pos\ !=\ std::string::npos)\ \{}
\DoxyCodeLine{05623\ \ \ \ \ \ \ listeners()-\/>Append(}
\DoxyCodeLine{05624\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{new}\ StreamingListener(target.substr(0,\ pos),\ target.substr(pos\ +\ 1)));}
\DoxyCodeLine{05625\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05626\ \ \ \ \ \ \ GTEST\_LOG\_(WARNING)\ <<\ \textcolor{stringliteral}{"{}unrecognized\ streaming\ target\ \(\backslash\)"{}"{}}\ <<\ target}
\DoxyCodeLine{05627\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}\ ignored."{}};}
\DoxyCodeLine{05628\ \ \ \ \ \}}
\DoxyCodeLine{05629\ \ \ \}}
\DoxyCodeLine{05630\ \}}
\DoxyCodeLine{05631\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GTEST\_CAN\_STREAM\_RESULTS\_}}
\DoxyCodeLine{05632\ }
\DoxyCodeLine{05633\ \textcolor{comment}{//\ Performs\ initialization\ dependent\ upon\ flag\ values\ obtained\ in}}
\DoxyCodeLine{05634\ \textcolor{comment}{//\ ParseGoogleTestFlagsOnly.\ \ Is\ called\ from\ InitGoogleTest\ after\ the\ call\ to}}
\DoxyCodeLine{05635\ \textcolor{comment}{//\ ParseGoogleTestFlagsOnly.\ \ In\ case\ a\ user\ neglects\ to\ call\ InitGoogleTest}}
\DoxyCodeLine{05636\ \textcolor{comment}{//\ this\ function\ is\ also\ called\ from\ RunAllTests.\ \ Since\ this\ function\ can\ be}}
\DoxyCodeLine{05637\ \textcolor{comment}{//\ called\ more\ than\ once,\ it\ has\ to\ be\ idempotent.}}
\DoxyCodeLine{05638\ \textcolor{keywordtype}{void}\ UnitTestImpl::PostFlagParsingInit()\ \{}
\DoxyCodeLine{05639\ \ \ \textcolor{comment}{//\ Ensures\ that\ this\ function\ does\ not\ execute\ more\ than\ once.}}
\DoxyCodeLine{05640\ \ \ \textcolor{keywordflow}{if}\ (!post\_flag\_parse\_init\_performed\_)\ \{}
\DoxyCodeLine{05641\ \ \ \ \ post\_flag\_parse\_init\_performed\_\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{05642\ }
\DoxyCodeLine{05643\ \textcolor{preprocessor}{\#if\ defined(GTEST\_CUSTOM\_TEST\_EVENT\_LISTENER\_)}}
\DoxyCodeLine{05644\ \ \ \ \ \textcolor{comment}{//\ Register\ to\ send\ notifications\ about\ key\ process\ state\ changes.}}
\DoxyCodeLine{05645\ \ \ \ \ listeners()-\/>Append(\textcolor{keyword}{new}\ GTEST\_CUSTOM\_TEST\_EVENT\_LISTENER\_());}
\DoxyCodeLine{05646\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ defined(GTEST\_CUSTOM\_TEST\_EVENT\_LISTENER\_)}}
\DoxyCodeLine{05647\ }
\DoxyCodeLine{05648\ \textcolor{preprocessor}{\#if\ GTEST\_HAS\_DEATH\_TEST}}
\DoxyCodeLine{05649\ \ \ \ \ InitDeathTestSubprocessControlInfo();}
\DoxyCodeLine{05650\ \ \ \ \ SuppressTestEventsIfInSubprocess();}
\DoxyCodeLine{05651\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GTEST\_HAS\_DEATH\_TEST}}
\DoxyCodeLine{05652\ }
\DoxyCodeLine{05653\ \ \ \ \ \textcolor{comment}{//\ Registers\ parameterized\ tests.\ This\ makes\ parameterized\ tests}}
\DoxyCodeLine{05654\ \ \ \ \ \textcolor{comment}{//\ available\ to\ the\ UnitTest\ reflection\ API\ without\ running}}
\DoxyCodeLine{05655\ \ \ \ \ \textcolor{comment}{//\ RUN\_ALL\_TESTS.}}
\DoxyCodeLine{05656\ \ \ \ \ RegisterParameterizedTests();}
\DoxyCodeLine{05657\ }
\DoxyCodeLine{05658\ \ \ \ \ \textcolor{comment}{//\ Configures\ listeners\ for\ XML\ output.\ This\ makes\ it\ possible\ for\ users}}
\DoxyCodeLine{05659\ \ \ \ \ \textcolor{comment}{//\ to\ shut\ down\ the\ default\ XML\ output\ before\ invoking\ RUN\_ALL\_TESTS.}}
\DoxyCodeLine{05660\ \ \ \ \ ConfigureXmlOutput();}
\DoxyCodeLine{05661\ }
\DoxyCodeLine{05662\ \ \ \ \ \textcolor{keywordflow}{if}\ (GTEST\_FLAG\_GET(brief))\ \{}
\DoxyCodeLine{05663\ \ \ \ \ \ \ listeners()-\/>SetDefaultResultPrinter(\textcolor{keyword}{new}\ BriefUnitTestResultPrinter);}
\DoxyCodeLine{05664\ \ \ \ \ \}}
\DoxyCodeLine{05665\ }
\DoxyCodeLine{05666\ \textcolor{preprocessor}{\#if\ GTEST\_CAN\_STREAM\_RESULTS\_}}
\DoxyCodeLine{05667\ \ \ \ \ \textcolor{comment}{//\ Configures\ listeners\ for\ streaming\ test\ results\ to\ the\ specified\ server.}}
\DoxyCodeLine{05668\ \ \ \ \ ConfigureStreamingOutput();}
\DoxyCodeLine{05669\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GTEST\_CAN\_STREAM\_RESULTS\_}}
\DoxyCodeLine{05670\ }
\DoxyCodeLine{05671\ \textcolor{preprocessor}{\#if\ GTEST\_HAS\_ABSL}}
\DoxyCodeLine{05672\ \ \ \ \ \textcolor{keywordflow}{if}\ (GTEST\_FLAG\_GET(install\_failure\_signal\_handler))\ \{}
\DoxyCodeLine{05673\ \ \ \ \ \ \ absl::FailureSignalHandlerOptions\ options;}
\DoxyCodeLine{05674\ \ \ \ \ \ \ absl::InstallFailureSignalHandler(options);}
\DoxyCodeLine{05675\ \ \ \ \ \}}
\DoxyCodeLine{05676\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GTEST\_HAS\_ABSL}}
\DoxyCodeLine{05677\ \ \ \}}
\DoxyCodeLine{05678\ \}}
\DoxyCodeLine{05679\ }
\DoxyCodeLine{05680\ \textcolor{comment}{//\ A\ predicate\ that\ checks\ the\ name\ of\ a\ TestSuite\ against\ a\ known}}
\DoxyCodeLine{05681\ \textcolor{comment}{//\ value.}}
\DoxyCodeLine{05682\ \textcolor{comment}{//}}
\DoxyCodeLine{05683\ \textcolor{comment}{//\ This\ is\ used\ for\ implementation\ of\ the\ UnitTest\ class\ only.\ \ We\ put}}
\DoxyCodeLine{05684\ \textcolor{comment}{//\ it\ in\ the\ anonymous\ namespace\ to\ prevent\ polluting\ the\ outer}}
\DoxyCodeLine{05685\ \textcolor{comment}{//\ namespace.}}
\DoxyCodeLine{05686\ \textcolor{comment}{//}}
\DoxyCodeLine{05687\ \textcolor{comment}{//\ TestSuiteNameIs\ is\ copyable.}}
\DoxyCodeLine{05688\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classtesting_1_1internal_1_1_test_suite_name_is}{TestSuiteNameIs}}\ \{}
\DoxyCodeLine{05689\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{05690\ \ \ \textcolor{comment}{//\ Constructor.}}
\DoxyCodeLine{05691\ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{classtesting_1_1internal_1_1_test_suite_name_is}{TestSuiteNameIs}}(\textcolor{keyword}{const}\ std::string\&\ name)\ :\ name\_(name)\ \{\}}
\DoxyCodeLine{05692\ }
\DoxyCodeLine{05693\ \ \ \textcolor{comment}{//\ Returns\ true\ if\ and\ only\ if\ the\ name\ of\ test\_suite\ matches\ name\_.}}
\DoxyCodeLine{05694\ \ \ \textcolor{keywordtype}{bool}\ operator()(\textcolor{keyword}{const}\ \mbox{\hyperlink{classtesting_1_1_test_suite}{TestSuite}}*\ test\_suite)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{05695\ \ \ \ \ \textcolor{keywordflow}{return}\ test\_suite\ !=\ \textcolor{keyword}{nullptr}\ \&\&}
\DoxyCodeLine{05696\ \ \ \ \ \ \ \ \ \ \ \ strcmp(test\_suite-\/>name(),\ name\_.c\_str())\ ==\ 0;}
\DoxyCodeLine{05697\ \ \ \}}
\DoxyCodeLine{05698\ }
\DoxyCodeLine{05699\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{05700\ \ \ std::string\ name\_;}
\DoxyCodeLine{05701\ \};}
\DoxyCodeLine{05702\ }
\DoxyCodeLine{05703\ \textcolor{comment}{//\ Finds\ and\ returns\ a\ TestSuite\ with\ the\ given\ name.\ \ If\ one\ doesn't}}
\DoxyCodeLine{05704\ \textcolor{comment}{//\ exist,\ creates\ one\ and\ returns\ it.\ \ It's\ the\ CALLER'S}}
\DoxyCodeLine{05705\ \textcolor{comment}{//\ RESPONSIBILITY\ to\ ensure\ that\ this\ function\ is\ only\ called\ WHEN\ THE}}
\DoxyCodeLine{05706\ \textcolor{comment}{//\ TESTS\ ARE\ NOT\ SHUFFLED.}}
\DoxyCodeLine{05707\ \textcolor{comment}{//}}
\DoxyCodeLine{05708\ \textcolor{comment}{//\ Arguments:}}
\DoxyCodeLine{05709\ \textcolor{comment}{//}}
\DoxyCodeLine{05710\ \textcolor{comment}{//\ \ \ test\_suite\_name:\ name\ of\ the\ test\ suite}}
\DoxyCodeLine{05711\ \textcolor{comment}{//\ \ \ type\_param:\ \ \ \ \ \ the\ name\ of\ the\ test\ suite's\ type\ parameter,\ or\ NULL\ if}}
\DoxyCodeLine{05712\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this\ is\ not\ a\ typed\ or\ a\ type-\/parameterized\ test\ suite.}}
\DoxyCodeLine{05713\ \textcolor{comment}{//\ \ \ set\_up\_tc:\ \ \ \ \ \ \ pointer\ to\ the\ function\ that\ sets\ up\ the\ test\ suite}}
\DoxyCodeLine{05714\ \textcolor{comment}{//\ \ \ tear\_down\_tc:\ \ \ \ pointer\ to\ the\ function\ that\ tears\ down\ the\ test\ suite}}
\DoxyCodeLine{05715\ \mbox{\hyperlink{classtesting_1_1_test_suite}{TestSuite}}*\ UnitTestImpl::GetTestSuite(}
\DoxyCodeLine{05716\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ test\_suite\_name,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ type\_param,}
\DoxyCodeLine{05717\ \ \ \ \ internal::SetUpTestSuiteFunc\ set\_up\_tc,}
\DoxyCodeLine{05718\ \ \ \ \ internal::TearDownTestSuiteFunc\ tear\_down\_tc)\ \{}
\DoxyCodeLine{05719\ \ \ \textcolor{comment}{//\ Can\ we\ find\ a\ TestSuite\ with\ the\ given\ name?}}
\DoxyCodeLine{05720\ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ test\_suite\ =}
\DoxyCodeLine{05721\ \ \ \ \ \ \ std::find\_if(test\_suites\_.rbegin(),\ test\_suites\_.rend(),}
\DoxyCodeLine{05722\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classtesting_1_1internal_1_1_test_suite_name_is}{TestSuiteNameIs}}(test\_suite\_name));}
\DoxyCodeLine{05723\ }
\DoxyCodeLine{05724\ \ \ \textcolor{keywordflow}{if}\ (test\_suite\ !=\ test\_suites\_.rend())\ \textcolor{keywordflow}{return}\ *test\_suite;}
\DoxyCodeLine{05725\ }
\DoxyCodeLine{05726\ \ \ \textcolor{comment}{//\ No.\ \ Let's\ create\ one.}}
\DoxyCodeLine{05727\ \ \ \textcolor{keyword}{auto}*\ \textcolor{keyword}{const}\ new\_test\_suite\ =}
\DoxyCodeLine{05728\ \ \ \ \ \ \ \textcolor{keyword}{new}\ \mbox{\hyperlink{classtesting_1_1_test_suite}{TestSuite}}(test\_suite\_name,\ type\_param,\ set\_up\_tc,\ tear\_down\_tc);}
\DoxyCodeLine{05729\ }
\DoxyCodeLine{05730\ \ \ \textcolor{keyword}{const}\ UnitTestFilter\ death\_test\_suite\_filter(kDeathTestSuiteFilter);}
\DoxyCodeLine{05731\ \ \ \textcolor{comment}{//\ Is\ this\ a\ death\ test\ suite?}}
\DoxyCodeLine{05732\ \ \ \textcolor{keywordflow}{if}\ (death\_test\_suite\_filter.MatchesName(test\_suite\_name))\ \{}
\DoxyCodeLine{05733\ \ \ \ \ \textcolor{comment}{//\ Yes.\ \ Inserts\ the\ test\ suite\ after\ the\ last\ death\ test\ suite}}
\DoxyCodeLine{05734\ \ \ \ \ \textcolor{comment}{//\ defined\ so\ far.\ \ This\ only\ works\ when\ the\ test\ suites\ haven't}}
\DoxyCodeLine{05735\ \ \ \ \ \textcolor{comment}{//\ been\ shuffled.\ \ Otherwise\ we\ may\ end\ up\ running\ a\ death\ test}}
\DoxyCodeLine{05736\ \ \ \ \ \textcolor{comment}{//\ after\ a\ non-\/death\ test.}}
\DoxyCodeLine{05737\ \ \ \ \ ++last\_death\_test\_suite\_;}
\DoxyCodeLine{05738\ \ \ \ \ test\_suites\_.insert(test\_suites\_.begin()\ +\ last\_death\_test\_suite\_,}
\DoxyCodeLine{05739\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ new\_test\_suite);}
\DoxyCodeLine{05740\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05741\ \ \ \ \ \textcolor{comment}{//\ No.\ \ Appends\ to\ the\ end\ of\ the\ list.}}
\DoxyCodeLine{05742\ \ \ \ \ test\_suites\_.push\_back(new\_test\_suite);}
\DoxyCodeLine{05743\ \ \ \}}
\DoxyCodeLine{05744\ }
\DoxyCodeLine{05745\ \ \ test\_suite\_indices\_.push\_back(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(test\_suite\_indices\_.size()));}
\DoxyCodeLine{05746\ \ \ \textcolor{keywordflow}{return}\ new\_test\_suite;}
\DoxyCodeLine{05747\ \}}
\DoxyCodeLine{05748\ }
\DoxyCodeLine{05749\ \textcolor{comment}{//\ Helpers\ for\ setting\ up\ /\ tearing\ down\ the\ given\ environment.\ \ They}}
\DoxyCodeLine{05750\ \textcolor{comment}{//\ are\ for\ use\ in\ the\ ForEach()\ function.}}
\DoxyCodeLine{05751\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ SetUpEnvironment(\mbox{\hyperlink{class_environment}{Environment}}*\ env)\ \{\ env-\/>SetUp();\ \}}
\DoxyCodeLine{05752\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ TearDownEnvironment(\mbox{\hyperlink{class_environment}{Environment}}*\ env)\ \{\ env-\/>TearDown();\ \}}
\DoxyCodeLine{05753\ }
\DoxyCodeLine{05754\ \textcolor{comment}{//\ Runs\ all\ tests\ in\ this\ UnitTest\ object,\ prints\ the\ result,\ and}}
\DoxyCodeLine{05755\ \textcolor{comment}{//\ returns\ true\ if\ all\ tests\ are\ successful.\ \ If\ any\ exception\ is}}
\DoxyCodeLine{05756\ \textcolor{comment}{//\ thrown\ during\ a\ test,\ the\ test\ is\ considered\ to\ be\ failed,\ but\ the}}
\DoxyCodeLine{05757\ \textcolor{comment}{//\ rest\ of\ the\ tests\ will\ still\ be\ run.}}
\DoxyCodeLine{05758\ \textcolor{comment}{//}}
\DoxyCodeLine{05759\ \textcolor{comment}{//\ When\ parameterized\ tests\ are\ enabled,\ it\ expands\ and\ registers}}
\DoxyCodeLine{05760\ \textcolor{comment}{//\ parameterized\ tests\ first\ in\ RegisterParameterizedTests().}}
\DoxyCodeLine{05761\ \textcolor{comment}{//\ All\ other\ functions\ called\ from\ RunAllTests()\ may\ safely\ assume\ that}}
\DoxyCodeLine{05762\ \textcolor{comment}{//\ parameterized\ tests\ are\ ready\ to\ be\ counted\ and\ run.}}
\DoxyCodeLine{05763\ \textcolor{keywordtype}{bool}\ UnitTestImpl::RunAllTests()\ \{}
\DoxyCodeLine{05764\ \ \ \textcolor{comment}{//\ True\ if\ and\ only\ if\ Google\ Test\ is\ initialized\ before\ RUN\_ALL\_TESTS()\ is}}
\DoxyCodeLine{05765\ \ \ \textcolor{comment}{//\ called.}}
\DoxyCodeLine{05766\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ gtest\_is\_initialized\_before\_run\_all\_tests\ =\ GTestIsInitialized();}
\DoxyCodeLine{05767\ }
\DoxyCodeLine{05768\ \ \ \textcolor{comment}{//\ Do\ not\ run\ any\ test\ if\ the\ -\/-\/help\ flag\ was\ specified.}}
\DoxyCodeLine{05769\ \ \ \textcolor{keywordflow}{if}\ (g\_help\_flag)\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{05770\ }
\DoxyCodeLine{05771\ \ \ \textcolor{comment}{//\ Repeats\ the\ call\ to\ the\ post-\/flag\ parsing\ initialization\ in\ case\ the}}
\DoxyCodeLine{05772\ \ \ \textcolor{comment}{//\ user\ didn't\ call\ InitGoogleTest.}}
\DoxyCodeLine{05773\ \ \ PostFlagParsingInit();}
\DoxyCodeLine{05774\ }
\DoxyCodeLine{05775\ \ \ \textcolor{comment}{//\ Even\ if\ sharding\ is\ not\ on,\ test\ runners\ may\ want\ to\ use\ the}}
\DoxyCodeLine{05776\ \ \ \textcolor{comment}{//\ GTEST\_SHARD\_STATUS\_FILE\ to\ query\ whether\ the\ test\ supports\ the\ sharding}}
\DoxyCodeLine{05777\ \ \ \textcolor{comment}{//\ protocol.}}
\DoxyCodeLine{05778\ \ \ internal::WriteToShardStatusFileIfNeeded();}
\DoxyCodeLine{05779\ }
\DoxyCodeLine{05780\ \ \ \textcolor{comment}{//\ True\ if\ and\ only\ if\ we\ are\ in\ a\ subprocess\ for\ running\ a\ thread-\/safe-\/style}}
\DoxyCodeLine{05781\ \ \ \textcolor{comment}{//\ death\ test.}}
\DoxyCodeLine{05782\ \ \ \textcolor{keywordtype}{bool}\ in\_subprocess\_for\_death\_test\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{05783\ }
\DoxyCodeLine{05784\ \textcolor{preprocessor}{\#if\ GTEST\_HAS\_DEATH\_TEST}}
\DoxyCodeLine{05785\ \ \ in\_subprocess\_for\_death\_test\ =}
\DoxyCodeLine{05786\ \ \ \ \ \ \ (internal\_run\_death\_test\_flag\_.get()\ !=\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{05787\ \textcolor{preprocessor}{\#if\ defined(GTEST\_EXTRA\_DEATH\_TEST\_CHILD\_SETUP\_)}}
\DoxyCodeLine{05788\ \ \ \textcolor{keywordflow}{if}\ (in\_subprocess\_for\_death\_test)\ \{}
\DoxyCodeLine{05789\ \ \ \ \ GTEST\_EXTRA\_DEATH\_TEST\_CHILD\_SETUP\_();}
\DoxyCodeLine{05790\ \ \ \}}
\DoxyCodeLine{05791\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ defined(GTEST\_EXTRA\_DEATH\_TEST\_CHILD\_SETUP\_)}}
\DoxyCodeLine{05792\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GTEST\_HAS\_DEATH\_TEST}}
\DoxyCodeLine{05793\ }
\DoxyCodeLine{05794\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ should\_shard\ =\ ShouldShard(kTestTotalShards,\ kTestShardIndex,}
\DoxyCodeLine{05795\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ in\_subprocess\_for\_death\_test);}
\DoxyCodeLine{05796\ }
\DoxyCodeLine{05797\ \ \ \textcolor{comment}{//\ Compares\ the\ full\ test\ names\ with\ the\ filter\ to\ decide\ which}}
\DoxyCodeLine{05798\ \ \ \textcolor{comment}{//\ tests\ to\ run.}}
\DoxyCodeLine{05799\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ has\_tests\_to\_run\ =}
\DoxyCodeLine{05800\ \ \ \ \ \ \ FilterTests(should\_shard\ ?\ HONOR\_SHARDING\_PROTOCOL}
\DoxyCodeLine{05801\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ IGNORE\_SHARDING\_PROTOCOL)\ >\ 0;}
\DoxyCodeLine{05802\ }
\DoxyCodeLine{05803\ \ \ \textcolor{comment}{//\ Lists\ the\ tests\ and\ exits\ if\ the\ -\/-\/gtest\_list\_tests\ flag\ was\ specified.}}
\DoxyCodeLine{05804\ \ \ \textcolor{keywordflow}{if}\ (GTEST\_FLAG\_GET(list\_tests))\ \{}
\DoxyCodeLine{05805\ \ \ \ \ \textcolor{comment}{//\ This\ must\ be\ called\ *after*\ FilterTests()\ has\ been\ called.}}
\DoxyCodeLine{05806\ \ \ \ \ ListTestsMatchingFilter();}
\DoxyCodeLine{05807\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{05808\ \ \ \}}
\DoxyCodeLine{05809\ }
\DoxyCodeLine{05810\ \ \ random\_seed\_\ =\ GetRandomSeedFromFlag(GTEST\_FLAG\_GET(random\_seed));}
\DoxyCodeLine{05811\ }
\DoxyCodeLine{05812\ \ \ \textcolor{comment}{//\ True\ if\ and\ only\ if\ at\ least\ one\ test\ has\ failed.}}
\DoxyCodeLine{05813\ \ \ \textcolor{keywordtype}{bool}\ failed\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{05814\ }
\DoxyCodeLine{05815\ \ \ TestEventListener*\ repeater\ =\ listeners()-\/>repeater();}
\DoxyCodeLine{05816\ }
\DoxyCodeLine{05817\ \ \ start\_timestamp\_\ =\ GetTimeInMillis();}
\DoxyCodeLine{05818\ \ \ repeater-\/>OnTestProgramStart(*parent\_);}
\DoxyCodeLine{05819\ }
\DoxyCodeLine{05820\ \ \ \textcolor{comment}{//\ How\ many\ times\ to\ repeat\ the\ tests?\ \ We\ don't\ want\ to\ repeat\ them}}
\DoxyCodeLine{05821\ \ \ \textcolor{comment}{//\ when\ we\ are\ inside\ the\ subprocess\ of\ a\ death\ test.}}
\DoxyCodeLine{05822\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ repeat\ =\ in\_subprocess\_for\_death\_test\ ?\ 1\ :\ GTEST\_FLAG\_GET(repeat);}
\DoxyCodeLine{05823\ }
\DoxyCodeLine{05824\ \ \ \textcolor{comment}{//\ Repeats\ forever\ if\ the\ repeat\ count\ is\ negative.}}
\DoxyCodeLine{05825\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ gtest\_repeat\_forever\ =\ repeat\ <\ 0;}
\DoxyCodeLine{05826\ }
\DoxyCodeLine{05827\ \ \ \textcolor{comment}{//\ Should\ test\ environments\ be\ set\ up\ and\ torn\ down\ for\ each\ repeat,\ or\ only}}
\DoxyCodeLine{05828\ \ \ \textcolor{comment}{//\ set\ up\ on\ the\ first\ and\ torn\ down\ on\ the\ last\ iteration?\ If\ there\ is\ no}}
\DoxyCodeLine{05829\ \ \ \textcolor{comment}{//\ "{}last"{}\ iteration\ because\ the\ tests\ will\ repeat\ forever,\ always\ recreate\ the}}
\DoxyCodeLine{05830\ \ \ \textcolor{comment}{//\ environments\ to\ avoid\ leaks\ in\ case\ one\ of\ the\ environments\ is\ using}}
\DoxyCodeLine{05831\ \ \ \textcolor{comment}{//\ resources\ that\ are\ external\ to\ this\ process.\ Without\ this\ check\ there\ would}}
\DoxyCodeLine{05832\ \ \ \textcolor{comment}{//\ be\ no\ way\ to\ clean\ up\ those\ external\ resources\ automatically.}}
\DoxyCodeLine{05833\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ recreate\_environments\_when\_repeating\ =}
\DoxyCodeLine{05834\ \ \ \ \ \ \ GTEST\_FLAG\_GET(recreate\_environments\_when\_repeating)\ ||}
\DoxyCodeLine{05835\ \ \ \ \ \ \ gtest\_repeat\_forever;}
\DoxyCodeLine{05836\ }
\DoxyCodeLine{05837\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ gtest\_repeat\_forever\ ||\ i\ !=\ repeat;\ i++)\ \{}
\DoxyCodeLine{05838\ \ \ \ \ \textcolor{comment}{//\ We\ want\ to\ preserve\ failures\ generated\ by\ ad-\/hoc\ test}}
\DoxyCodeLine{05839\ \ \ \ \ \textcolor{comment}{//\ assertions\ executed\ before\ RUN\_ALL\_TESTS().}}
\DoxyCodeLine{05840\ \ \ \ \ ClearNonAdHocTestResult();}
\DoxyCodeLine{05841\ }
\DoxyCodeLine{05842\ \ \ \ \ Timer\ timer;}
\DoxyCodeLine{05843\ }
\DoxyCodeLine{05844\ \ \ \ \ \textcolor{comment}{//\ Shuffles\ test\ suites\ and\ tests\ if\ requested.}}
\DoxyCodeLine{05845\ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_tests\_to\_run\ \&\&\ GTEST\_FLAG\_GET(shuffle))\ \{}
\DoxyCodeLine{05846\ \ \ \ \ \ \ random()-\/>Reseed(\textcolor{keyword}{static\_cast<}uint32\_t\textcolor{keyword}{>}(random\_seed\_));}
\DoxyCodeLine{05847\ \ \ \ \ \ \ \textcolor{comment}{//\ This\ should\ be\ done\ before\ calling\ OnTestIterationStart(),}}
\DoxyCodeLine{05848\ \ \ \ \ \ \ \textcolor{comment}{//\ such\ that\ a\ test\ event\ listener\ can\ see\ the\ actual\ test\ order}}
\DoxyCodeLine{05849\ \ \ \ \ \ \ \textcolor{comment}{//\ in\ the\ event.}}
\DoxyCodeLine{05850\ \ \ \ \ \ \ ShuffleTests();}
\DoxyCodeLine{05851\ \ \ \ \ \}}
\DoxyCodeLine{05852\ }
\DoxyCodeLine{05853\ \ \ \ \ \textcolor{comment}{//\ Tells\ the\ unit\ test\ event\ listeners\ that\ the\ tests\ are\ about\ to\ start.}}
\DoxyCodeLine{05854\ \ \ \ \ repeater-\/>OnTestIterationStart(*parent\_,\ i);}
\DoxyCodeLine{05855\ }
\DoxyCodeLine{05856\ \ \ \ \ \textcolor{comment}{//\ Runs\ each\ test\ suite\ if\ there\ is\ at\ least\ one\ test\ to\ run.}}
\DoxyCodeLine{05857\ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_tests\_to\_run)\ \{}
\DoxyCodeLine{05858\ \ \ \ \ \ \ \textcolor{comment}{//\ Sets\ up\ all\ environments\ beforehand.\ If\ test\ environments\ aren't}}
\DoxyCodeLine{05859\ \ \ \ \ \ \ \textcolor{comment}{//\ recreated\ for\ each\ iteration,\ only\ do\ so\ on\ the\ first\ iteration.}}
\DoxyCodeLine{05860\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ ==\ 0\ ||\ recreate\_environments\_when\_repeating)\ \{}
\DoxyCodeLine{05861\ \ \ \ \ \ \ \ \ repeater-\/>OnEnvironmentsSetUpStart(*parent\_);}
\DoxyCodeLine{05862\ \ \ \ \ \ \ \ \ ForEach(environments\_,\ SetUpEnvironment);}
\DoxyCodeLine{05863\ \ \ \ \ \ \ \ \ repeater-\/>OnEnvironmentsSetUpEnd(*parent\_);}
\DoxyCodeLine{05864\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05865\ }
\DoxyCodeLine{05866\ \ \ \ \ \ \ \textcolor{comment}{//\ Runs\ the\ tests\ only\ if\ there\ was\ no\ fatal\ failure\ or\ skip\ triggered}}
\DoxyCodeLine{05867\ \ \ \ \ \ \ \textcolor{comment}{//\ during\ global\ set-\/up.}}
\DoxyCodeLine{05868\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (Test::IsSkipped())\ \{}
\DoxyCodeLine{05869\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Emit\ diagnostics\ when\ global\ set-\/up\ calls\ skip,\ as\ it\ will\ not\ be}}
\DoxyCodeLine{05870\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ emitted\ by\ default.}}
\DoxyCodeLine{05871\ \ \ \ \ \ \ \ \ TestResult\&\ test\_result\ =}
\DoxyCodeLine{05872\ \ \ \ \ \ \ \ \ \ \ \ \ *internal::GetUnitTestImpl()-\/>current\_test\_result();}
\DoxyCodeLine{05873\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ test\_result.total\_part\_count();\ ++j)\ \{}
\DoxyCodeLine{05874\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ TestPartResult\&\ test\_part\_result\ =}
\DoxyCodeLine{05875\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ test\_result.GetTestPartResult(j);}
\DoxyCodeLine{05876\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (test\_part\_result.type()\ ==\ TestPartResult::kSkip)\ \{}
\DoxyCodeLine{05877\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ result\ =\ test\_part\_result.message();}
\DoxyCodeLine{05878\ \ \ \ \ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\%s\(\backslash\)n"{}},\ result.c\_str());}
\DoxyCodeLine{05879\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05880\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05881\ \ \ \ \ \ \ \ \ fflush(stdout);}
\DoxyCodeLine{05882\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (!Test::HasFatalFailure())\ \{}
\DoxyCodeLine{05883\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ test\_index\ =\ 0;\ test\_index\ <\ total\_test\_suite\_count();}
\DoxyCodeLine{05884\ \ \ \ \ \ \ \ \ \ \ \ \ \ test\_index++)\ \{}
\DoxyCodeLine{05885\ \ \ \ \ \ \ \ \ \ \ GetMutableSuiteCase(test\_index)-\/>Run();}
\DoxyCodeLine{05886\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (GTEST\_FLAG\_GET(fail\_fast)\ \&\&}
\DoxyCodeLine{05887\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ GetMutableSuiteCase(test\_index)-\/>Failed())\ \{}
\DoxyCodeLine{05888\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ test\_index\ +\ 1;\ j\ <\ total\_test\_suite\_count();\ j++)\ \{}
\DoxyCodeLine{05889\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ GetMutableSuiteCase(j)-\/>Skip();}
\DoxyCodeLine{05890\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05891\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{05892\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05893\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05894\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (Test::HasFatalFailure())\ \{}
\DoxyCodeLine{05895\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ If\ there\ was\ a\ fatal\ failure\ during\ the\ global\ setup\ then\ we\ know\ we}}
\DoxyCodeLine{05896\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ aren't\ going\ to\ run\ any\ tests.\ Explicitly\ mark\ all\ of\ the\ tests\ as}}
\DoxyCodeLine{05897\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ skipped\ to\ make\ this\ obvious\ in\ the\ output.}}
\DoxyCodeLine{05898\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ test\_index\ =\ 0;\ test\_index\ <\ total\_test\_suite\_count();}
\DoxyCodeLine{05899\ \ \ \ \ \ \ \ \ \ \ \ \ \ test\_index++)\ \{}
\DoxyCodeLine{05900\ \ \ \ \ \ \ \ \ \ \ GetMutableSuiteCase(test\_index)-\/>Skip();}
\DoxyCodeLine{05901\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05902\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05903\ }
\DoxyCodeLine{05904\ \ \ \ \ \ \ \textcolor{comment}{//\ Tears\ down\ all\ environments\ in\ reverse\ order\ afterwards.\ If\ test}}
\DoxyCodeLine{05905\ \ \ \ \ \ \ \textcolor{comment}{//\ environments\ aren't\ recreated\ for\ each\ iteration,\ only\ do\ so\ on\ the}}
\DoxyCodeLine{05906\ \ \ \ \ \ \ \textcolor{comment}{//\ last\ iteration.}}
\DoxyCodeLine{05907\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ ==\ repeat\ -\/\ 1\ ||\ recreate\_environments\_when\_repeating)\ \{}
\DoxyCodeLine{05908\ \ \ \ \ \ \ \ \ repeater-\/>OnEnvironmentsTearDownStart(*parent\_);}
\DoxyCodeLine{05909\ \ \ \ \ \ \ \ \ std::for\_each(environments\_.rbegin(),\ environments\_.rend(),}
\DoxyCodeLine{05910\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ TearDownEnvironment);}
\DoxyCodeLine{05911\ \ \ \ \ \ \ \ \ repeater-\/>OnEnvironmentsTearDownEnd(*parent\_);}
\DoxyCodeLine{05912\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05913\ \ \ \ \ \}}
\DoxyCodeLine{05914\ }
\DoxyCodeLine{05915\ \ \ \ \ elapsed\_time\_\ =\ timer.Elapsed();}
\DoxyCodeLine{05916\ }
\DoxyCodeLine{05917\ \ \ \ \ \textcolor{comment}{//\ Tells\ the\ unit\ test\ event\ listener\ that\ the\ tests\ have\ just\ finished.}}
\DoxyCodeLine{05918\ \ \ \ \ repeater-\/>OnTestIterationEnd(*parent\_,\ i);}
\DoxyCodeLine{05919\ }
\DoxyCodeLine{05920\ \ \ \ \ \textcolor{comment}{//\ Gets\ the\ result\ and\ clears\ it.}}
\DoxyCodeLine{05921\ \ \ \ \ \textcolor{keywordflow}{if}\ (!Passed())\ \{}
\DoxyCodeLine{05922\ \ \ \ \ \ \ failed\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{05923\ \ \ \ \ \}}
\DoxyCodeLine{05924\ }
\DoxyCodeLine{05925\ \ \ \ \ \textcolor{comment}{//\ Restores\ the\ original\ test\ order\ after\ the\ iteration.\ \ This}}
\DoxyCodeLine{05926\ \ \ \ \ \textcolor{comment}{//\ allows\ the\ user\ to\ quickly\ repro\ a\ failure\ that\ happens\ in\ the}}
\DoxyCodeLine{05927\ \ \ \ \ \textcolor{comment}{//\ N-\/th\ iteration\ without\ repeating\ the\ first\ (N\ -\/\ 1)\ iterations.}}
\DoxyCodeLine{05928\ \ \ \ \ \textcolor{comment}{//\ This\ is\ not\ enclosed\ in\ "{}if\ (GTEST\_FLAG(shuffle))\ \{\ ...\ \}"{},\ in}}
\DoxyCodeLine{05929\ \ \ \ \ \textcolor{comment}{//\ case\ the\ user\ somehow\ changes\ the\ value\ of\ the\ flag\ somewhere}}
\DoxyCodeLine{05930\ \ \ \ \ \textcolor{comment}{//\ (it's\ always\ safe\ to\ unshuffle\ the\ tests).}}
\DoxyCodeLine{05931\ \ \ \ \ UnshuffleTests();}
\DoxyCodeLine{05932\ }
\DoxyCodeLine{05933\ \ \ \ \ \textcolor{keywordflow}{if}\ (GTEST\_FLAG\_GET(shuffle))\ \{}
\DoxyCodeLine{05934\ \ \ \ \ \ \ \textcolor{comment}{//\ Picks\ a\ new\ random\ seed\ for\ each\ iteration.}}
\DoxyCodeLine{05935\ \ \ \ \ \ \ random\_seed\_\ =\ GetNextRandomSeed(random\_seed\_);}
\DoxyCodeLine{05936\ \ \ \ \ \}}
\DoxyCodeLine{05937\ \ \ \}}
\DoxyCodeLine{05938\ }
\DoxyCodeLine{05939\ \ \ repeater-\/>OnTestProgramEnd(*parent\_);}
\DoxyCodeLine{05940\ }
\DoxyCodeLine{05941\ \ \ \textcolor{keywordflow}{if}\ (!gtest\_is\_initialized\_before\_run\_all\_tests)\ \{}
\DoxyCodeLine{05942\ \ \ \ \ ColoredPrintf(}
\DoxyCodeLine{05943\ \ \ \ \ \ \ \ \ GTestColor::kRed,}
\DoxyCodeLine{05944\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\(\backslash\)nIMPORTANT\ NOTICE\ -\/\ DO\ NOT\ IGNORE:\(\backslash\)n"{}}}
\DoxyCodeLine{05945\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}This\ test\ program\ did\ NOT\ call\ "{}}\ GTEST\_INIT\_GOOGLE\_TEST\_NAME\_}
\DoxyCodeLine{05946\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}()\ before\ calling\ RUN\_ALL\_TESTS().\ This\ is\ INVALID.\ Soon\ "{}}\ GTEST\_NAME\_}
\DoxyCodeLine{05947\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ will\ start\ to\ enforce\ the\ valid\ usage.\ "{}}}
\DoxyCodeLine{05948\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Please\ fix\ it\ ASAP,\ or\ IT\ WILL\ START\ TO\ FAIL.\(\backslash\)n"{}});\ \ \textcolor{comment}{//\ NOLINT}}
\DoxyCodeLine{05949\ \textcolor{preprocessor}{\#if\ GTEST\_FOR\_GOOGLE\_}}
\DoxyCodeLine{05950\ \ \ \ \ ColoredPrintf(GTestColor::kRed,}
\DoxyCodeLine{05951\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}For\ more\ details,\ see\ http://wiki/Main/ValidGUnitMain.\(\backslash\)n"{}});}
\DoxyCodeLine{05952\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GTEST\_FOR\_GOOGLE\_}}
\DoxyCodeLine{05953\ \ \ \}}
\DoxyCodeLine{05954\ }
\DoxyCodeLine{05955\ \ \ \textcolor{keywordflow}{return}\ !failed;}
\DoxyCodeLine{05956\ \}}
\DoxyCodeLine{05957\ }
\DoxyCodeLine{05958\ \textcolor{comment}{//\ Reads\ the\ GTEST\_SHARD\_STATUS\_FILE\ environment\ variable,\ and\ creates\ the\ file}}
\DoxyCodeLine{05959\ \textcolor{comment}{//\ if\ the\ variable\ is\ present.\ If\ a\ file\ already\ exists\ at\ this\ location,\ this}}
\DoxyCodeLine{05960\ \textcolor{comment}{//\ function\ will\ write\ over\ it.\ If\ the\ variable\ is\ present,\ but\ the\ file\ cannot}}
\DoxyCodeLine{05961\ \textcolor{comment}{//\ be\ created,\ prints\ an\ error\ and\ exits.}}
\DoxyCodeLine{05962\ \textcolor{keywordtype}{void}\ WriteToShardStatusFileIfNeeded()\ \{}
\DoxyCodeLine{05963\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \textcolor{keyword}{const}\ test\_shard\_file\ =\ posix::GetEnv(kTestShardStatusFile);}
\DoxyCodeLine{05964\ \ \ \textcolor{keywordflow}{if}\ (test\_shard\_file\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{05965\ \ \ \ \ FILE*\ \textcolor{keyword}{const}\ file\ =\ posix::FOpen(test\_shard\_file,\ \textcolor{stringliteral}{"{}w"{}});}
\DoxyCodeLine{05966\ \ \ \ \ \textcolor{keywordflow}{if}\ (file\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{05967\ \ \ \ \ \ \ ColoredPrintf(GTestColor::kRed,}
\DoxyCodeLine{05968\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Could\ not\ write\ to\ the\ test\ shard\ status\ file\ \(\backslash\)"{}\%s\(\backslash\)"{}\ "{}}}
\DoxyCodeLine{05969\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}specified\ by\ the\ \%s\ environment\ variable.\(\backslash\)n"{}},}
\DoxyCodeLine{05970\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ test\_shard\_file,\ kTestShardStatusFile);}
\DoxyCodeLine{05971\ \ \ \ \ \ \ fflush(stdout);}
\DoxyCodeLine{05972\ \ \ \ \ \ \ exit(EXIT\_FAILURE);}
\DoxyCodeLine{05973\ \ \ \ \ \}}
\DoxyCodeLine{05974\ \ \ \ \ fclose(file);}
\DoxyCodeLine{05975\ \ \ \}}
\DoxyCodeLine{05976\ \}}
\DoxyCodeLine{05977\ }
\DoxyCodeLine{05978\ \textcolor{comment}{//\ Checks\ whether\ sharding\ is\ enabled\ by\ examining\ the\ relevant}}
\DoxyCodeLine{05979\ \textcolor{comment}{//\ environment\ variable\ values.\ If\ the\ variables\ are\ present,}}
\DoxyCodeLine{05980\ \textcolor{comment}{//\ but\ inconsistent\ (i.e.,\ shard\_index\ >=\ total\_shards),\ prints}}
\DoxyCodeLine{05981\ \textcolor{comment}{//\ an\ error\ and\ exits.\ If\ in\_subprocess\_for\_death\_test,\ sharding\ is}}
\DoxyCodeLine{05982\ \textcolor{comment}{//\ disabled\ because\ it\ must\ only\ be\ applied\ to\ the\ original\ test}}
\DoxyCodeLine{05983\ \textcolor{comment}{//\ process.\ Otherwise,\ we\ could\ filter\ out\ death\ tests\ we\ intended\ to\ execute.}}
\DoxyCodeLine{05984\ \textcolor{keywordtype}{bool}\ ShouldShard(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ total\_shards\_env,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ shard\_index\_env,}
\DoxyCodeLine{05985\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ in\_subprocess\_for\_death\_test)\ \{}
\DoxyCodeLine{05986\ \ \ \textcolor{keywordflow}{if}\ (in\_subprocess\_for\_death\_test)\ \{}
\DoxyCodeLine{05987\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05988\ \ \ \}}
\DoxyCodeLine{05989\ }
\DoxyCodeLine{05990\ \ \ \textcolor{keyword}{const}\ int32\_t\ total\_shards\ =\ Int32FromEnvOrDie(total\_shards\_env,\ -\/1);}
\DoxyCodeLine{05991\ \ \ \textcolor{keyword}{const}\ int32\_t\ shard\_index\ =\ Int32FromEnvOrDie(shard\_index\_env,\ -\/1);}
\DoxyCodeLine{05992\ }
\DoxyCodeLine{05993\ \ \ \textcolor{keywordflow}{if}\ (total\_shards\ ==\ -\/1\ \&\&\ shard\_index\ ==\ -\/1)\ \{}
\DoxyCodeLine{05994\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05995\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (total\_shards\ ==\ -\/1\ \&\&\ shard\_index\ !=\ -\/1)\ \{}
\DoxyCodeLine{05996\ \ \ \ \ \textcolor{keyword}{const}\ Message\ msg\ =\ Message()\ <<\ \textcolor{stringliteral}{"{}Invalid\ environment\ variables:\ you\ have\ "{}}}
\DoxyCodeLine{05997\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ kTestShardIndex\ <<\ \textcolor{stringliteral}{"{}\ =\ "{}}\ <<\ shard\_index}
\DoxyCodeLine{05998\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{},\ but\ have\ left\ "{}}\ <<\ kTestTotalShards}
\DoxyCodeLine{05999\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ unset.\(\backslash\)n"{}};}
\DoxyCodeLine{06000\ \ \ \ \ ColoredPrintf(GTestColor::kRed,\ \textcolor{stringliteral}{"{}\%s"{}},\ msg.GetString().c\_str());}
\DoxyCodeLine{06001\ \ \ \ \ fflush(stdout);}
\DoxyCodeLine{06002\ \ \ \ \ exit(EXIT\_FAILURE);}
\DoxyCodeLine{06003\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (total\_shards\ !=\ -\/1\ \&\&\ shard\_index\ ==\ -\/1)\ \{}
\DoxyCodeLine{06004\ \ \ \ \ \textcolor{keyword}{const}\ Message\ msg\ =\ Message()}
\DoxyCodeLine{06005\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Invalid\ environment\ variables:\ you\ have\ "{}}}
\DoxyCodeLine{06006\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ kTestTotalShards\ <<\ \textcolor{stringliteral}{"{}\ =\ "{}}\ <<\ total\_shards}
\DoxyCodeLine{06007\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{},\ but\ have\ left\ "{}}\ <<\ kTestShardIndex\ <<\ \textcolor{stringliteral}{"{}\ unset.\(\backslash\)n"{}};}
\DoxyCodeLine{06008\ \ \ \ \ ColoredPrintf(GTestColor::kRed,\ \textcolor{stringliteral}{"{}\%s"{}},\ msg.GetString().c\_str());}
\DoxyCodeLine{06009\ \ \ \ \ fflush(stdout);}
\DoxyCodeLine{06010\ \ \ \ \ exit(EXIT\_FAILURE);}
\DoxyCodeLine{06011\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (shard\_index\ <\ 0\ ||\ shard\_index\ >=\ total\_shards)\ \{}
\DoxyCodeLine{06012\ \ \ \ \ \textcolor{keyword}{const}\ Message\ msg\ =}
\DoxyCodeLine{06013\ \ \ \ \ \ \ \ \ Message()\ <<\ \textcolor{stringliteral}{"{}Invalid\ environment\ variables:\ we\ require\ 0\ <=\ "{}}}
\DoxyCodeLine{06014\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ kTestShardIndex\ <<\ \textcolor{stringliteral}{"{}\ <\ "{}}\ <<\ kTestTotalShards}
\DoxyCodeLine{06015\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{},\ but\ you\ have\ "{}}\ <<\ kTestShardIndex\ <<\ \textcolor{stringliteral}{"{}="{}}\ <<\ shard\_index}
\DoxyCodeLine{06016\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{},\ "{}}\ <<\ kTestTotalShards\ <<\ \textcolor{stringliteral}{"{}="{}}\ <<\ total\_shards\ <<\ \textcolor{stringliteral}{"{}.\(\backslash\)n"{}};}
\DoxyCodeLine{06017\ \ \ \ \ ColoredPrintf(GTestColor::kRed,\ \textcolor{stringliteral}{"{}\%s"{}},\ msg.GetString().c\_str());}
\DoxyCodeLine{06018\ \ \ \ \ fflush(stdout);}
\DoxyCodeLine{06019\ \ \ \ \ exit(EXIT\_FAILURE);}
\DoxyCodeLine{06020\ \ \ \}}
\DoxyCodeLine{06021\ }
\DoxyCodeLine{06022\ \ \ \textcolor{keywordflow}{return}\ total\_shards\ >\ 1;}
\DoxyCodeLine{06023\ \}}
\DoxyCodeLine{06024\ }
\DoxyCodeLine{06025\ \textcolor{comment}{//\ Parses\ the\ environment\ variable\ var\ as\ an\ Int32.\ If\ it\ is\ unset,}}
\DoxyCodeLine{06026\ \textcolor{comment}{//\ returns\ default\_val.\ If\ it\ is\ not\ an\ Int32,\ prints\ an\ error}}
\DoxyCodeLine{06027\ \textcolor{comment}{//\ and\ aborts.}}
\DoxyCodeLine{06028\ int32\_t\ Int32FromEnvOrDie(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ var,\ int32\_t\ default\_val)\ \{}
\DoxyCodeLine{06029\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ str\_val\ =\ posix::GetEnv(var);}
\DoxyCodeLine{06030\ \ \ \textcolor{keywordflow}{if}\ (str\_val\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{06031\ \ \ \ \ \textcolor{keywordflow}{return}\ default\_val;}
\DoxyCodeLine{06032\ \ \ \}}
\DoxyCodeLine{06033\ }
\DoxyCodeLine{06034\ \ \ int32\_t\ result;}
\DoxyCodeLine{06035\ \ \ \textcolor{keywordflow}{if}\ (!ParseInt32(Message()\ <<\ \textcolor{stringliteral}{"{}The\ value\ of\ environment\ variable\ "{}}\ <<\ var,}
\DoxyCodeLine{06036\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ str\_val,\ \&result))\ \{}
\DoxyCodeLine{06037\ \ \ \ \ exit(EXIT\_FAILURE);}
\DoxyCodeLine{06038\ \ \ \}}
\DoxyCodeLine{06039\ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{06040\ \}}
\DoxyCodeLine{06041\ }
\DoxyCodeLine{06042\ \textcolor{comment}{//\ Given\ the\ total\ number\ of\ shards,\ the\ shard\ index,\ and\ the\ test\ id,}}
\DoxyCodeLine{06043\ \textcolor{comment}{//\ returns\ true\ if\ and\ only\ if\ the\ test\ should\ be\ run\ on\ this\ shard.\ The\ test\ id}}
\DoxyCodeLine{06044\ \textcolor{comment}{//\ is\ some\ arbitrary\ but\ unique\ non-\/negative\ integer\ assigned\ to\ each\ test}}
\DoxyCodeLine{06045\ \textcolor{comment}{//\ method.\ Assumes\ that\ 0\ <=\ shard\_index\ <\ total\_shards.}}
\DoxyCodeLine{06046\ \textcolor{keywordtype}{bool}\ ShouldRunTestOnShard(\textcolor{keywordtype}{int}\ total\_shards,\ \textcolor{keywordtype}{int}\ shard\_index,\ \textcolor{keywordtype}{int}\ test\_id)\ \{}
\DoxyCodeLine{06047\ \ \ \textcolor{keywordflow}{return}\ (test\_id\ \%\ total\_shards)\ ==\ shard\_index;}
\DoxyCodeLine{06048\ \}}
\DoxyCodeLine{06049\ }
\DoxyCodeLine{06050\ \textcolor{comment}{//\ Compares\ the\ name\ of\ each\ test\ with\ the\ user-\/specified\ filter\ to}}
\DoxyCodeLine{06051\ \textcolor{comment}{//\ decide\ whether\ the\ test\ should\ be\ run,\ then\ records\ the\ result\ in}}
\DoxyCodeLine{06052\ \textcolor{comment}{//\ each\ TestSuite\ and\ TestInfo\ object.}}
\DoxyCodeLine{06053\ \textcolor{comment}{//\ If\ shard\_tests\ ==\ true,\ further\ filters\ tests\ based\ on\ sharding}}
\DoxyCodeLine{06054\ \textcolor{comment}{//\ variables\ in\ the\ environment\ -\/\ see}}
\DoxyCodeLine{06055\ \textcolor{comment}{//\ https://github.com/google/googletest/blob/main/docs/advanced.md}}
\DoxyCodeLine{06056\ \textcolor{comment}{//\ .\ Returns\ the\ number\ of\ tests\ that\ should\ run.}}
\DoxyCodeLine{06057\ \textcolor{keywordtype}{int}\ UnitTestImpl::FilterTests(ReactionToSharding\ shard\_tests)\ \{}
\DoxyCodeLine{06058\ \ \ \textcolor{keyword}{const}\ int32\_t\ total\_shards\ =\ shard\_tests\ ==\ HONOR\_SHARDING\_PROTOCOL}
\DoxyCodeLine{06059\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ?\ Int32FromEnvOrDie(kTestTotalShards,\ -\/1)}
\DoxyCodeLine{06060\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ -\/1;}
\DoxyCodeLine{06061\ \ \ \textcolor{keyword}{const}\ int32\_t\ shard\_index\ =\ shard\_tests\ ==\ HONOR\_SHARDING\_PROTOCOL}
\DoxyCodeLine{06062\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ?\ Int32FromEnvOrDie(kTestShardIndex,\ -\/1)}
\DoxyCodeLine{06063\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ -\/1;}
\DoxyCodeLine{06064\ }
\DoxyCodeLine{06065\ \ \ \textcolor{keyword}{const}\ PositiveAndNegativeUnitTestFilter\ gtest\_flag\_filter(}
\DoxyCodeLine{06066\ \ \ \ \ \ \ GTEST\_FLAG\_GET(filter));}
\DoxyCodeLine{06067\ \ \ \textcolor{keyword}{const}\ UnitTestFilter\ disable\_test\_filter(kDisableTestFilter);}
\DoxyCodeLine{06068\ \ \ \textcolor{comment}{//\ num\_runnable\_tests\ are\ the\ number\ of\ tests\ that\ will}}
\DoxyCodeLine{06069\ \ \ \textcolor{comment}{//\ run\ across\ all\ shards\ (i.e.,\ match\ filter\ and\ are\ not\ disabled).}}
\DoxyCodeLine{06070\ \ \ \textcolor{comment}{//\ num\_selected\_tests\ are\ the\ number\ of\ tests\ to\ be\ run\ on}}
\DoxyCodeLine{06071\ \ \ \textcolor{comment}{//\ this\ shard.}}
\DoxyCodeLine{06072\ \ \ \textcolor{keywordtype}{int}\ num\_runnable\_tests\ =\ 0;}
\DoxyCodeLine{06073\ \ \ \textcolor{keywordtype}{int}\ num\_selected\_tests\ =\ 0;}
\DoxyCodeLine{06074\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}*\ test\_suite\ :\ test\_suites\_)\ \{}
\DoxyCodeLine{06075\ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ test\_suite\_name\ =\ test\_suite-\/>name();}
\DoxyCodeLine{06076\ \ \ \ \ test\_suite-\/>set\_should\_run(\textcolor{keyword}{false});}
\DoxyCodeLine{06077\ }
\DoxyCodeLine{06078\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ j\ =\ 0;\ j\ <\ test\_suite-\/>test\_info\_list().size();\ j++)\ \{}
\DoxyCodeLine{06079\ \ \ \ \ \ \ TestInfo*\ \textcolor{keyword}{const}\ test\_info\ =\ test\_suite-\/>test\_info\_list()[j];}
\DoxyCodeLine{06080\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ test\_name(test\_info-\/>name());}
\DoxyCodeLine{06081\ \ \ \ \ \ \ \textcolor{comment}{//\ A\ test\ is\ disabled\ if\ test\ suite\ name\ or\ test\ name\ matches}}
\DoxyCodeLine{06082\ \ \ \ \ \ \ \textcolor{comment}{//\ kDisableTestFilter.}}
\DoxyCodeLine{06083\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ is\_disabled\ =}
\DoxyCodeLine{06084\ \ \ \ \ \ \ \ \ \ \ disable\_test\_filter.MatchesName(test\_suite\_name)\ ||}
\DoxyCodeLine{06085\ \ \ \ \ \ \ \ \ \ \ disable\_test\_filter.MatchesName(test\_name);}
\DoxyCodeLine{06086\ \ \ \ \ \ \ test\_info-\/>is\_disabled\_\ =\ is\_disabled;}
\DoxyCodeLine{06087\ }
\DoxyCodeLine{06088\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ matches\_filter\ =}
\DoxyCodeLine{06089\ \ \ \ \ \ \ \ \ \ \ gtest\_flag\_filter.MatchesTest(test\_suite\_name,\ test\_name);}
\DoxyCodeLine{06090\ \ \ \ \ \ \ test\_info-\/>matches\_filter\_\ =\ matches\_filter;}
\DoxyCodeLine{06091\ }
\DoxyCodeLine{06092\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ is\_runnable\ =}
\DoxyCodeLine{06093\ \ \ \ \ \ \ \ \ \ \ (GTEST\_FLAG\_GET(also\_run\_disabled\_tests)\ ||\ !is\_disabled)\ \&\&}
\DoxyCodeLine{06094\ \ \ \ \ \ \ \ \ \ \ matches\_filter;}
\DoxyCodeLine{06095\ }
\DoxyCodeLine{06096\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ is\_in\_another\_shard\ =}
\DoxyCodeLine{06097\ \ \ \ \ \ \ \ \ \ \ shard\_tests\ !=\ IGNORE\_SHARDING\_PROTOCOL\ \&\&}
\DoxyCodeLine{06098\ \ \ \ \ \ \ \ \ \ \ !ShouldRunTestOnShard(total\_shards,\ shard\_index,\ num\_runnable\_tests);}
\DoxyCodeLine{06099\ \ \ \ \ \ \ test\_info-\/>is\_in\_another\_shard\_\ =\ is\_in\_another\_shard;}
\DoxyCodeLine{06100\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ is\_selected\ =\ is\_runnable\ \&\&\ !is\_in\_another\_shard;}
\DoxyCodeLine{06101\ }
\DoxyCodeLine{06102\ \ \ \ \ \ \ num\_runnable\_tests\ +=\ is\_runnable;}
\DoxyCodeLine{06103\ \ \ \ \ \ \ num\_selected\_tests\ +=\ is\_selected;}
\DoxyCodeLine{06104\ }
\DoxyCodeLine{06105\ \ \ \ \ \ \ test\_info-\/>should\_run\_\ =\ is\_selected;}
\DoxyCodeLine{06106\ \ \ \ \ \ \ test\_suite-\/>set\_should\_run(test\_suite-\/>should\_run()\ ||\ is\_selected);}
\DoxyCodeLine{06107\ \ \ \ \ \}}
\DoxyCodeLine{06108\ \ \ \}}
\DoxyCodeLine{06109\ \ \ \textcolor{keywordflow}{return}\ num\_selected\_tests;}
\DoxyCodeLine{06110\ \}}
\DoxyCodeLine{06111\ }
\DoxyCodeLine{06112\ \textcolor{comment}{//\ Prints\ the\ given\ C-\/string\ on\ a\ single\ line\ by\ replacing\ all\ '\(\backslash\)n'}}
\DoxyCodeLine{06113\ \textcolor{comment}{//\ characters\ with\ string\ "{}\(\backslash\)\(\backslash\)n"{}.\ \ If\ the\ output\ takes\ more\ than}}
\DoxyCodeLine{06114\ \textcolor{comment}{//\ max\_length\ characters,\ only\ prints\ the\ first\ max\_length\ characters}}
\DoxyCodeLine{06115\ \textcolor{comment}{//\ and\ "{}..."{}.}}
\DoxyCodeLine{06116\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ PrintOnOneLine(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ str,\ \textcolor{keywordtype}{int}\ max\_length)\ \{}
\DoxyCodeLine{06117\ \ \ \textcolor{keywordflow}{if}\ (str\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{06118\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ *str\ !=\ \textcolor{charliteral}{'\(\backslash\)0'};\ ++str)\ \{}
\DoxyCodeLine{06119\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ >=\ max\_length)\ \{}
\DoxyCodeLine{06120\ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}..."{}});}
\DoxyCodeLine{06121\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{06122\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06123\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (*str\ ==\ \textcolor{charliteral}{'\(\backslash\)n'})\ \{}
\DoxyCodeLine{06124\ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)\(\backslash\)n"{}});}
\DoxyCodeLine{06125\ \ \ \ \ \ \ \ \ i\ +=\ 2;}
\DoxyCodeLine{06126\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{06127\ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\%c"{}},\ *str);}
\DoxyCodeLine{06128\ \ \ \ \ \ \ \ \ ++i;}
\DoxyCodeLine{06129\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06130\ \ \ \ \ \}}
\DoxyCodeLine{06131\ \ \ \}}
\DoxyCodeLine{06132\ \}}
\DoxyCodeLine{06133\ }
\DoxyCodeLine{06134\ \textcolor{comment}{//\ Prints\ the\ names\ of\ the\ tests\ matching\ the\ user-\/specified\ filter\ flag.}}
\DoxyCodeLine{06135\ \textcolor{keywordtype}{void}\ UnitTestImpl::ListTestsMatchingFilter()\ \{}
\DoxyCodeLine{06136\ \ \ \textcolor{comment}{//\ Print\ at\ most\ this\ many\ characters\ for\ each\ type/value\ parameter.}}
\DoxyCodeLine{06137\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ kMaxParamLength\ =\ 250;}
\DoxyCodeLine{06138\ }
\DoxyCodeLine{06139\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}*\ test\_suite\ :\ test\_suites\_)\ \{}
\DoxyCodeLine{06140\ \ \ \ \ \textcolor{keywordtype}{bool}\ printed\_test\_suite\_name\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{06141\ }
\DoxyCodeLine{06142\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ j\ =\ 0;\ j\ <\ test\_suite-\/>test\_info\_list().size();\ j++)\ \{}
\DoxyCodeLine{06143\ \ \ \ \ \ \ \textcolor{keyword}{const}\ TestInfo*\ \textcolor{keyword}{const}\ test\_info\ =\ test\_suite-\/>test\_info\_list()[j];}
\DoxyCodeLine{06144\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (test\_info-\/>matches\_filter\_)\ \{}
\DoxyCodeLine{06145\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!printed\_test\_suite\_name)\ \{}
\DoxyCodeLine{06146\ \ \ \ \ \ \ \ \ \ \ printed\_test\_suite\_name\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{06147\ \ \ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\%s."{}},\ test\_suite-\/>name());}
\DoxyCodeLine{06148\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (test\_suite-\/>type\_param()\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{06149\ \ \ \ \ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\ \ \#\ \%s\ =\ "{}},\ kTypeParamLabel);}
\DoxyCodeLine{06150\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ We\ print\ the\ type\ parameter\ on\ a\ single\ line\ to\ make}}
\DoxyCodeLine{06151\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ the\ output\ easy\ to\ parse\ by\ a\ program.}}
\DoxyCodeLine{06152\ \ \ \ \ \ \ \ \ \ \ \ \ PrintOnOneLine(test\_suite-\/>type\_param(),\ kMaxParamLength);}
\DoxyCodeLine{06153\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{06154\ \ \ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{06155\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{06156\ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\ \ \%s"{}},\ test\_info-\/>name());}
\DoxyCodeLine{06157\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (test\_info-\/>value\_param()\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{06158\ \ \ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\ \ \#\ \%s\ =\ "{}},\ kValueParamLabel);}
\DoxyCodeLine{06159\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ We\ print\ the\ value\ parameter\ on\ a\ single\ line\ to\ make\ the}}
\DoxyCodeLine{06160\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ output\ easy\ to\ parse\ by\ a\ program.}}
\DoxyCodeLine{06161\ \ \ \ \ \ \ \ \ \ \ PrintOnOneLine(test\_info-\/>value\_param(),\ kMaxParamLength);}
\DoxyCodeLine{06162\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{06163\ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{06164\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06165\ \ \ \ \ \}}
\DoxyCodeLine{06166\ \ \ \}}
\DoxyCodeLine{06167\ \ \ fflush(stdout);}
\DoxyCodeLine{06168\ \ \ \textcolor{keyword}{const}\ std::string\&\ output\_format\ =\ UnitTestOptions::GetOutputFormat();}
\DoxyCodeLine{06169\ \ \ \textcolor{keywordflow}{if}\ (output\_format\ ==\ \textcolor{stringliteral}{"{}xml"{}}\ ||\ output\_format\ ==\ \textcolor{stringliteral}{"{}json"{}})\ \{}
\DoxyCodeLine{06170\ \ \ \ \ FILE*\ fileout\ =\ OpenFileForWriting(}
\DoxyCodeLine{06171\ \ \ \ \ \ \ \ \ UnitTestOptions::GetAbsolutePathToOutputFile().c\_str());}
\DoxyCodeLine{06172\ \ \ \ \ std::stringstream\ stream;}
\DoxyCodeLine{06173\ \ \ \ \ \textcolor{keywordflow}{if}\ (output\_format\ ==\ \textcolor{stringliteral}{"{}xml"{}})\ \{}
\DoxyCodeLine{06174\ \ \ \ \ \ \ XmlUnitTestResultPrinter(}
\DoxyCodeLine{06175\ \ \ \ \ \ \ \ \ \ \ UnitTestOptions::GetAbsolutePathToOutputFile().c\_str())}
\DoxyCodeLine{06176\ \ \ \ \ \ \ \ \ \ \ .PrintXmlTestsList(\&stream,\ test\_suites\_);}
\DoxyCodeLine{06177\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (output\_format\ ==\ \textcolor{stringliteral}{"{}json"{}})\ \{}
\DoxyCodeLine{06178\ \ \ \ \ \ \ JsonUnitTestResultPrinter(}
\DoxyCodeLine{06179\ \ \ \ \ \ \ \ \ \ \ UnitTestOptions::GetAbsolutePathToOutputFile().c\_str())}
\DoxyCodeLine{06180\ \ \ \ \ \ \ \ \ \ \ .PrintJsonTestList(\&stream,\ test\_suites\_);}
\DoxyCodeLine{06181\ \ \ \ \ \}}
\DoxyCodeLine{06182\ \ \ \ \ fprintf(fileout,\ \textcolor{stringliteral}{"{}\%s"{}},\ StringStreamToString(\&stream).c\_str());}
\DoxyCodeLine{06183\ \ \ \ \ fclose(fileout);}
\DoxyCodeLine{06184\ \ \ \}}
\DoxyCodeLine{06185\ \}}
\DoxyCodeLine{06186\ }
\DoxyCodeLine{06187\ \textcolor{comment}{//\ Sets\ the\ OS\ stack\ trace\ getter.}}
\DoxyCodeLine{06188\ \textcolor{comment}{//}}
\DoxyCodeLine{06189\ \textcolor{comment}{//\ Does\ nothing\ if\ the\ input\ and\ the\ current\ OS\ stack\ trace\ getter\ are}}
\DoxyCodeLine{06190\ \textcolor{comment}{//\ the\ same;\ otherwise,\ deletes\ the\ old\ getter\ and\ makes\ the\ input\ the}}
\DoxyCodeLine{06191\ \textcolor{comment}{//\ current\ getter.}}
\DoxyCodeLine{06192\ \textcolor{keywordtype}{void}\ UnitTestImpl::set\_os\_stack\_trace\_getter(}
\DoxyCodeLine{06193\ \ \ \ \ OsStackTraceGetterInterface*\ getter)\ \{}
\DoxyCodeLine{06194\ \ \ \textcolor{keywordflow}{if}\ (os\_stack\_trace\_getter\_\ !=\ getter)\ \{}
\DoxyCodeLine{06195\ \ \ \ \ \textcolor{keyword}{delete}\ os\_stack\_trace\_getter\_;}
\DoxyCodeLine{06196\ \ \ \ \ os\_stack\_trace\_getter\_\ =\ getter;}
\DoxyCodeLine{06197\ \ \ \}}
\DoxyCodeLine{06198\ \}}
\DoxyCodeLine{06199\ }
\DoxyCodeLine{06200\ \textcolor{comment}{//\ Returns\ the\ current\ OS\ stack\ trace\ getter\ if\ it\ is\ not\ NULL;}}
\DoxyCodeLine{06201\ \textcolor{comment}{//\ otherwise,\ creates\ an\ OsStackTraceGetter,\ makes\ it\ the\ current}}
\DoxyCodeLine{06202\ \textcolor{comment}{//\ getter,\ and\ returns\ it.}}
\DoxyCodeLine{06203\ OsStackTraceGetterInterface*\ UnitTestImpl::os\_stack\_trace\_getter()\ \{}
\DoxyCodeLine{06204\ \ \ \textcolor{keywordflow}{if}\ (os\_stack\_trace\_getter\_\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{06205\ \textcolor{preprocessor}{\#ifdef\ GTEST\_OS\_STACK\_TRACE\_GETTER\_}}
\DoxyCodeLine{06206\ \ \ \ \ os\_stack\_trace\_getter\_\ =\ \textcolor{keyword}{new}\ GTEST\_OS\_STACK\_TRACE\_GETTER\_;}
\DoxyCodeLine{06207\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{06208\ \ \ \ \ os\_stack\_trace\_getter\_\ =\ \textcolor{keyword}{new}\ OsStackTraceGetter;}
\DoxyCodeLine{06209\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GTEST\_OS\_STACK\_TRACE\_GETTER\_}}
\DoxyCodeLine{06210\ \ \ \}}
\DoxyCodeLine{06211\ }
\DoxyCodeLine{06212\ \ \ \textcolor{keywordflow}{return}\ os\_stack\_trace\_getter\_;}
\DoxyCodeLine{06213\ \}}
\DoxyCodeLine{06214\ }
\DoxyCodeLine{06215\ \textcolor{comment}{//\ Returns\ the\ most\ specific\ TestResult\ currently\ running.}}
\DoxyCodeLine{06216\ TestResult*\ UnitTestImpl::current\_test\_result()\ \{}
\DoxyCodeLine{06217\ \ \ \textcolor{keywordflow}{if}\ (current\_test\_info\_\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{06218\ \ \ \ \ \textcolor{keywordflow}{return}\ \&current\_test\_info\_-\/>result\_;}
\DoxyCodeLine{06219\ \ \ \}}
\DoxyCodeLine{06220\ \ \ \textcolor{keywordflow}{if}\ (current\_test\_suite\_\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{06221\ \ \ \ \ \textcolor{keywordflow}{return}\ \&current\_test\_suite\_-\/>ad\_hoc\_test\_result\_;}
\DoxyCodeLine{06222\ \ \ \}}
\DoxyCodeLine{06223\ \ \ \textcolor{keywordflow}{return}\ \&ad\_hoc\_test\_result\_;}
\DoxyCodeLine{06224\ \}}
\DoxyCodeLine{06225\ }
\DoxyCodeLine{06226\ \textcolor{comment}{//\ Shuffles\ all\ test\ suites,\ and\ the\ tests\ within\ each\ test\ suite,}}
\DoxyCodeLine{06227\ \textcolor{comment}{//\ making\ sure\ that\ death\ tests\ are\ still\ run\ first.}}
\DoxyCodeLine{06228\ \textcolor{keywordtype}{void}\ UnitTestImpl::ShuffleTests()\ \{}
\DoxyCodeLine{06229\ \ \ \textcolor{comment}{//\ Shuffles\ the\ death\ test\ suites.}}
\DoxyCodeLine{06230\ \ \ ShuffleRange(random(),\ 0,\ last\_death\_test\_suite\_\ +\ 1,\ \&test\_suite\_indices\_);}
\DoxyCodeLine{06231\ }
\DoxyCodeLine{06232\ \ \ \textcolor{comment}{//\ Shuffles\ the\ non-\/death\ test\ suites.}}
\DoxyCodeLine{06233\ \ \ ShuffleRange(random(),\ last\_death\_test\_suite\_\ +\ 1,}
\DoxyCodeLine{06234\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(test\_suites\_.size()),\ \&test\_suite\_indices\_);}
\DoxyCodeLine{06235\ }
\DoxyCodeLine{06236\ \ \ \textcolor{comment}{//\ Shuffles\ the\ tests\ inside\ each\ test\ suite.}}
\DoxyCodeLine{06237\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\&\ test\_suite\ :\ test\_suites\_)\ \{}
\DoxyCodeLine{06238\ \ \ \ \ test\_suite-\/>ShuffleTests(random());}
\DoxyCodeLine{06239\ \ \ \}}
\DoxyCodeLine{06240\ \}}
\DoxyCodeLine{06241\ }
\DoxyCodeLine{06242\ \textcolor{comment}{//\ Restores\ the\ test\ suites\ and\ tests\ to\ their\ order\ before\ the\ first\ shuffle.}}
\DoxyCodeLine{06243\ \textcolor{keywordtype}{void}\ UnitTestImpl::UnshuffleTests()\ \{}
\DoxyCodeLine{06244\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ test\_suites\_.size();\ i++)\ \{}
\DoxyCodeLine{06245\ \ \ \ \ \textcolor{comment}{//\ Unshuffles\ the\ tests\ in\ each\ test\ suite.}}
\DoxyCodeLine{06246\ \ \ \ \ test\_suites\_[i]-\/>UnshuffleTests();}
\DoxyCodeLine{06247\ \ \ \ \ \textcolor{comment}{//\ Resets\ the\ index\ of\ each\ test\ suite.}}
\DoxyCodeLine{06248\ \ \ \ \ test\_suite\_indices\_[i]\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(i);}
\DoxyCodeLine{06249\ \ \ \}}
\DoxyCodeLine{06250\ \}}
\DoxyCodeLine{06251\ }
\DoxyCodeLine{06252\ \textcolor{comment}{//\ Returns\ the\ current\ OS\ stack\ trace\ as\ an\ std::string.}}
\DoxyCodeLine{06253\ \textcolor{comment}{//}}
\DoxyCodeLine{06254\ \textcolor{comment}{//\ The\ maximum\ number\ of\ stack\ frames\ to\ be\ included\ is\ specified\ by}}
\DoxyCodeLine{06255\ \textcolor{comment}{//\ the\ gtest\_stack\_trace\_depth\ flag.\ \ The\ skip\_count\ parameter}}
\DoxyCodeLine{06256\ \textcolor{comment}{//\ specifies\ the\ number\ of\ top\ frames\ to\ be\ skipped,\ which\ doesn't}}
\DoxyCodeLine{06257\ \textcolor{comment}{//\ count\ against\ the\ number\ of\ frames\ to\ be\ included.}}
\DoxyCodeLine{06258\ \textcolor{comment}{//}}
\DoxyCodeLine{06259\ \textcolor{comment}{//\ For\ example,\ if\ Foo()\ calls\ Bar(),\ which\ in\ turn\ calls}}
\DoxyCodeLine{06260\ \textcolor{comment}{//\ GetCurrentOsStackTraceExceptTop(...,\ 1),\ Foo()\ will\ be\ included\ in}}
\DoxyCodeLine{06261\ \textcolor{comment}{//\ the\ trace\ but\ Bar()\ and\ GetCurrentOsStackTraceExceptTop()\ won't.}}
\DoxyCodeLine{06262\ GTEST\_NO\_INLINE\_\ GTEST\_NO\_TAIL\_CALL\_\ std::string}
\DoxyCodeLine{06263\ GetCurrentOsStackTraceExceptTop(\textcolor{keywordtype}{int}\ skip\_count)\ \{}
\DoxyCodeLine{06264\ \ \ \textcolor{comment}{//\ We\ pass\ skip\_count\ +\ 1\ to\ skip\ this\ wrapper\ function\ in\ addition}}
\DoxyCodeLine{06265\ \ \ \textcolor{comment}{//\ to\ what\ the\ user\ really\ wants\ to\ skip.}}
\DoxyCodeLine{06266\ \ \ \textcolor{keywordflow}{return}\ GetUnitTestImpl()-\/>CurrentOsStackTraceExceptTop(skip\_count\ +\ 1);}
\DoxyCodeLine{06267\ \}}
\DoxyCodeLine{06268\ }
\DoxyCodeLine{06269\ \textcolor{comment}{//\ Used\ by\ the\ GTEST\_SUPPRESS\_UNREACHABLE\_CODE\_WARNING\_BELOW\_\ macro\ to}}
\DoxyCodeLine{06270\ \textcolor{comment}{//\ suppress\ unreachable\ code\ warnings.}}
\DoxyCodeLine{06271\ \textcolor{keyword}{namespace\ }\{}
\DoxyCodeLine{06272\ \textcolor{keyword}{class\ }ClassUniqueToAlwaysTrue\ \{\};}
\DoxyCodeLine{06273\ \}\ \ \textcolor{comment}{//\ namespace}}
\DoxyCodeLine{06274\ }
\DoxyCodeLine{06275\ \textcolor{keywordtype}{bool}\ IsTrue(\textcolor{keywordtype}{bool}\ condition)\ \{\ \textcolor{keywordflow}{return}\ condition;\ \}}
\DoxyCodeLine{06276\ }
\DoxyCodeLine{06277\ \textcolor{keywordtype}{bool}\ AlwaysTrue()\ \{}
\DoxyCodeLine{06278\ \textcolor{preprocessor}{\#if\ GTEST\_HAS\_EXCEPTIONS}}
\DoxyCodeLine{06279\ \ \ \textcolor{comment}{//\ This\ condition\ is\ always\ false\ so\ AlwaysTrue()\ never\ actually\ throws,}}
\DoxyCodeLine{06280\ \ \ \textcolor{comment}{//\ but\ it\ makes\ the\ compiler\ think\ that\ it\ may\ throw.}}
\DoxyCodeLine{06281\ \ \ \textcolor{keywordflow}{if}\ (IsTrue(\textcolor{keyword}{false}))\ \textcolor{keywordflow}{throw}\ ClassUniqueToAlwaysTrue();}
\DoxyCodeLine{06282\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GTEST\_HAS\_EXCEPTIONS}}
\DoxyCodeLine{06283\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{06284\ \}}
\DoxyCodeLine{06285\ }
\DoxyCodeLine{06286\ \textcolor{comment}{//\ If\ *pstr\ starts\ with\ the\ given\ prefix,\ modifies\ *pstr\ to\ be\ right}}
\DoxyCodeLine{06287\ \textcolor{comment}{//\ past\ the\ prefix\ and\ returns\ true;\ otherwise\ leaves\ *pstr\ unchanged}}
\DoxyCodeLine{06288\ \textcolor{comment}{//\ and\ returns\ false.\ \ None\ of\ pstr,\ *pstr,\ and\ prefix\ can\ be\ NULL.}}
\DoxyCodeLine{06289\ \textcolor{keywordtype}{bool}\ SkipPrefix(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ prefix,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}**\ pstr)\ \{}
\DoxyCodeLine{06290\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ prefix\_len\ =\ strlen(prefix);}
\DoxyCodeLine{06291\ \ \ \textcolor{keywordflow}{if}\ (strncmp(*pstr,\ prefix,\ prefix\_len)\ ==\ 0)\ \{}
\DoxyCodeLine{06292\ \ \ \ \ *pstr\ +=\ prefix\_len;}
\DoxyCodeLine{06293\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{06294\ \ \ \}}
\DoxyCodeLine{06295\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{06296\ \}}
\DoxyCodeLine{06297\ }
\DoxyCodeLine{06298\ \textcolor{comment}{//\ Parses\ a\ string\ as\ a\ command\ line\ flag.\ \ The\ string\ should\ have}}
\DoxyCodeLine{06299\ \textcolor{comment}{//\ the\ format\ "{}-\/-\/flag=value"{}.\ \ When\ def\_optional\ is\ true,\ the\ "{}=value"{}}}
\DoxyCodeLine{06300\ \textcolor{comment}{//\ part\ can\ be\ omitted.}}
\DoxyCodeLine{06301\ \textcolor{comment}{//}}
\DoxyCodeLine{06302\ \textcolor{comment}{//\ Returns\ the\ value\ of\ the\ flag,\ or\ NULL\ if\ the\ parsing\ failed.}}
\DoxyCodeLine{06303\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ ParseFlagValue(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ str,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ flag\_name,}
\DoxyCodeLine{06304\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ def\_optional)\ \{}
\DoxyCodeLine{06305\ \ \ \textcolor{comment}{//\ str\ and\ flag\ must\ not\ be\ NULL.}}
\DoxyCodeLine{06306\ \ \ \textcolor{keywordflow}{if}\ (str\ ==\ \textcolor{keyword}{nullptr}\ ||\ flag\_name\ ==\ \textcolor{keyword}{nullptr})\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{06307\ }
\DoxyCodeLine{06308\ \ \ \textcolor{comment}{//\ The\ flag\ must\ start\ with\ "{}-\/-\/"{}\ followed\ by\ GTEST\_FLAG\_PREFIX\_.}}
\DoxyCodeLine{06309\ \ \ \textcolor{keyword}{const}\ std::string\ flag\_str\ =}
\DoxyCodeLine{06310\ \ \ \ \ \ \ std::string(\textcolor{stringliteral}{"{}-\/-\/"{}})\ +\ GTEST\_FLAG\_PREFIX\_\ +\ flag\_name;}
\DoxyCodeLine{06311\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ flag\_len\ =\ flag\_str.length();}
\DoxyCodeLine{06312\ \ \ \textcolor{keywordflow}{if}\ (strncmp(str,\ flag\_str.c\_str(),\ flag\_len)\ !=\ 0)\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{06313\ }
\DoxyCodeLine{06314\ \ \ \textcolor{comment}{//\ Skips\ the\ flag\ name.}}
\DoxyCodeLine{06315\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ flag\_end\ =\ str\ +\ flag\_len;}
\DoxyCodeLine{06316\ }
\DoxyCodeLine{06317\ \ \ \textcolor{comment}{//\ When\ def\_optional\ is\ true,\ it's\ OK\ to\ not\ have\ a\ "{}=value"{}\ part.}}
\DoxyCodeLine{06318\ \ \ \textcolor{keywordflow}{if}\ (def\_optional\ \&\&\ (flag\_end[0]\ ==\ \textcolor{charliteral}{'\(\backslash\)0'}))\ \{}
\DoxyCodeLine{06319\ \ \ \ \ \textcolor{keywordflow}{return}\ flag\_end;}
\DoxyCodeLine{06320\ \ \ \}}
\DoxyCodeLine{06321\ }
\DoxyCodeLine{06322\ \ \ \textcolor{comment}{//\ If\ def\_optional\ is\ true\ and\ there\ are\ more\ characters\ after\ the}}
\DoxyCodeLine{06323\ \ \ \textcolor{comment}{//\ flag\ name,\ or\ if\ def\_optional\ is\ false,\ there\ must\ be\ a\ '='\ after}}
\DoxyCodeLine{06324\ \ \ \textcolor{comment}{//\ the\ flag\ name.}}
\DoxyCodeLine{06325\ \ \ \textcolor{keywordflow}{if}\ (flag\_end[0]\ !=\ \textcolor{charliteral}{'='})\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{06326\ }
\DoxyCodeLine{06327\ \ \ \textcolor{comment}{//\ Returns\ the\ string\ after\ "{}="{}.}}
\DoxyCodeLine{06328\ \ \ \textcolor{keywordflow}{return}\ flag\_end\ +\ 1;}
\DoxyCodeLine{06329\ \}}
\DoxyCodeLine{06330\ }
\DoxyCodeLine{06331\ \textcolor{comment}{//\ Parses\ a\ string\ for\ a\ bool\ flag,\ in\ the\ form\ of\ either}}
\DoxyCodeLine{06332\ \textcolor{comment}{//\ "{}-\/-\/flag=value"{}\ or\ "{}-\/-\/flag"{}.}}
\DoxyCodeLine{06333\ \textcolor{comment}{//}}
\DoxyCodeLine{06334\ \textcolor{comment}{//\ In\ the\ former\ case,\ the\ value\ is\ taken\ as\ true\ as\ long\ as\ it\ does}}
\DoxyCodeLine{06335\ \textcolor{comment}{//\ not\ start\ with\ '0',\ 'f',\ or\ 'F'.}}
\DoxyCodeLine{06336\ \textcolor{comment}{//}}
\DoxyCodeLine{06337\ \textcolor{comment}{//\ In\ the\ latter\ case,\ the\ value\ is\ taken\ as\ true.}}
\DoxyCodeLine{06338\ \textcolor{comment}{//}}
\DoxyCodeLine{06339\ \textcolor{comment}{//\ On\ success,\ stores\ the\ value\ of\ the\ flag\ in\ *value,\ and\ returns}}
\DoxyCodeLine{06340\ \textcolor{comment}{//\ true.\ \ On\ failure,\ returns\ false\ without\ changing\ *value.}}
\DoxyCodeLine{06341\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ ParseFlag(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ str,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ flag\_name,\ \textcolor{keywordtype}{bool}*\ value)\ \{}
\DoxyCodeLine{06342\ \ \ \textcolor{comment}{//\ Gets\ the\ value\ of\ the\ flag\ as\ a\ string.}}
\DoxyCodeLine{06343\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \textcolor{keyword}{const}\ value\_str\ =\ ParseFlagValue(str,\ flag\_name,\ \textcolor{keyword}{true});}
\DoxyCodeLine{06344\ }
\DoxyCodeLine{06345\ \ \ \textcolor{comment}{//\ Aborts\ if\ the\ parsing\ failed.}}
\DoxyCodeLine{06346\ \ \ \textcolor{keywordflow}{if}\ (value\_str\ ==\ \textcolor{keyword}{nullptr})\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{06347\ }
\DoxyCodeLine{06348\ \ \ \textcolor{comment}{//\ Converts\ the\ string\ value\ to\ a\ bool.}}
\DoxyCodeLine{06349\ \ \ *value\ =\ !(*value\_str\ ==\ \textcolor{charliteral}{'0'}\ ||\ *value\_str\ ==\ \textcolor{charliteral}{'f'}\ ||\ *value\_str\ ==\ \textcolor{charliteral}{'F'});}
\DoxyCodeLine{06350\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{06351\ \}}
\DoxyCodeLine{06352\ }
\DoxyCodeLine{06353\ \textcolor{comment}{//\ Parses\ a\ string\ for\ an\ int32\_t\ flag,\ in\ the\ form\ of\ "{}-\/-\/flag=value"{}.}}
\DoxyCodeLine{06354\ \textcolor{comment}{//}}
\DoxyCodeLine{06355\ \textcolor{comment}{//\ On\ success,\ stores\ the\ value\ of\ the\ flag\ in\ *value,\ and\ returns}}
\DoxyCodeLine{06356\ \textcolor{comment}{//\ true.\ \ On\ failure,\ returns\ false\ without\ changing\ *value.}}
\DoxyCodeLine{06357\ \textcolor{keywordtype}{bool}\ ParseFlag(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ str,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ flag\_name,\ int32\_t*\ value)\ \{}
\DoxyCodeLine{06358\ \ \ \textcolor{comment}{//\ Gets\ the\ value\ of\ the\ flag\ as\ a\ string.}}
\DoxyCodeLine{06359\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \textcolor{keyword}{const}\ value\_str\ =\ ParseFlagValue(str,\ flag\_name,\ \textcolor{keyword}{false});}
\DoxyCodeLine{06360\ }
\DoxyCodeLine{06361\ \ \ \textcolor{comment}{//\ Aborts\ if\ the\ parsing\ failed.}}
\DoxyCodeLine{06362\ \ \ \textcolor{keywordflow}{if}\ (value\_str\ ==\ \textcolor{keyword}{nullptr})\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{06363\ }
\DoxyCodeLine{06364\ \ \ \textcolor{comment}{//\ Sets\ *value\ to\ the\ value\ of\ the\ flag.}}
\DoxyCodeLine{06365\ \ \ \textcolor{keywordflow}{return}\ ParseInt32(Message()\ <<\ \textcolor{stringliteral}{"{}The\ value\ of\ flag\ -\/-\/"{}}\ <<\ flag\_name,\ value\_str,}
\DoxyCodeLine{06366\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ value);}
\DoxyCodeLine{06367\ \}}
\DoxyCodeLine{06368\ }
\DoxyCodeLine{06369\ \textcolor{comment}{//\ Parses\ a\ string\ for\ a\ string\ flag,\ in\ the\ form\ of\ "{}-\/-\/flag=value"{}.}}
\DoxyCodeLine{06370\ \textcolor{comment}{//}}
\DoxyCodeLine{06371\ \textcolor{comment}{//\ On\ success,\ stores\ the\ value\ of\ the\ flag\ in\ *value,\ and\ returns}}
\DoxyCodeLine{06372\ \textcolor{comment}{//\ true.\ \ On\ failure,\ returns\ false\ without\ changing\ *value.}}
\DoxyCodeLine{06373\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ String>}
\DoxyCodeLine{06374\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ ParseFlag(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ str,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ flag\_name,\ String*\ value)\ \{}
\DoxyCodeLine{06375\ \ \ \textcolor{comment}{//\ Gets\ the\ value\ of\ the\ flag\ as\ a\ string.}}
\DoxyCodeLine{06376\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \textcolor{keyword}{const}\ value\_str\ =\ ParseFlagValue(str,\ flag\_name,\ \textcolor{keyword}{false});}
\DoxyCodeLine{06377\ }
\DoxyCodeLine{06378\ \ \ \textcolor{comment}{//\ Aborts\ if\ the\ parsing\ failed.}}
\DoxyCodeLine{06379\ \ \ \textcolor{keywordflow}{if}\ (value\_str\ ==\ \textcolor{keyword}{nullptr})\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{06380\ }
\DoxyCodeLine{06381\ \ \ \textcolor{comment}{//\ Sets\ *value\ to\ the\ value\ of\ the\ flag.}}
\DoxyCodeLine{06382\ \ \ *value\ =\ value\_str;}
\DoxyCodeLine{06383\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{06384\ \}}
\DoxyCodeLine{06385\ }
\DoxyCodeLine{06386\ \textcolor{comment}{//\ Determines\ whether\ a\ string\ has\ a\ prefix\ that\ Google\ Test\ uses\ for\ its}}
\DoxyCodeLine{06387\ \textcolor{comment}{//\ flags,\ i.e.,\ starts\ with\ GTEST\_FLAG\_PREFIX\_\ or\ GTEST\_FLAG\_PREFIX\_DASH\_.}}
\DoxyCodeLine{06388\ \textcolor{comment}{//\ If\ Google\ Test\ detects\ that\ a\ command\ line\ flag\ has\ its\ prefix\ but\ is\ not}}
\DoxyCodeLine{06389\ \textcolor{comment}{//\ recognized,\ it\ will\ print\ its\ help\ message.\ Flags\ starting\ with}}
\DoxyCodeLine{06390\ \textcolor{comment}{//\ GTEST\_INTERNAL\_PREFIX\_\ followed\ by\ "{}internal\_"{}\ are\ considered\ Google\ Test}}
\DoxyCodeLine{06391\ \textcolor{comment}{//\ internal\ flags\ and\ do\ not\ trigger\ the\ help\ message.}}
\DoxyCodeLine{06392\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ HasGoogleTestFlagPrefix(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ str)\ \{}
\DoxyCodeLine{06393\ \ \ \textcolor{keywordflow}{return}\ (SkipPrefix(\textcolor{stringliteral}{"{}-\/-\/"{}},\ \&str)\ ||\ SkipPrefix(\textcolor{stringliteral}{"{}-\/"{}},\ \&str)\ ||}
\DoxyCodeLine{06394\ \ \ \ \ \ \ \ \ \ \ SkipPrefix(\textcolor{stringliteral}{"{}/"{}},\ \&str))\ \&\&}
\DoxyCodeLine{06395\ \ \ \ \ \ \ \ \ \ !SkipPrefix(GTEST\_FLAG\_PREFIX\_\ \textcolor{stringliteral}{"{}internal\_"{}},\ \&str)\ \&\&}
\DoxyCodeLine{06396\ \ \ \ \ \ \ \ \ \ (SkipPrefix(GTEST\_FLAG\_PREFIX\_,\ \&str)\ ||}
\DoxyCodeLine{06397\ \ \ \ \ \ \ \ \ \ \ SkipPrefix(GTEST\_FLAG\_PREFIX\_DASH\_,\ \&str));}
\DoxyCodeLine{06398\ \}}
\DoxyCodeLine{06399\ }
\DoxyCodeLine{06400\ \textcolor{comment}{//\ Prints\ a\ string\ containing\ code-\/encoded\ text.\ \ The\ following\ escape}}
\DoxyCodeLine{06401\ \textcolor{comment}{//\ sequences\ can\ be\ used\ in\ the\ string\ to\ control\ the\ text\ color:}}
\DoxyCodeLine{06402\ \textcolor{comment}{//}}
\DoxyCodeLine{06403\ \textcolor{comment}{//\ \ \ @@\ \ \ \ prints\ a\ single\ '@'\ character.}}
\DoxyCodeLine{06404\ \textcolor{comment}{//\ \ \ @R\ \ \ \ changes\ the\ color\ to\ red.}}
\DoxyCodeLine{06405\ \textcolor{comment}{//\ \ \ @G\ \ \ \ changes\ the\ color\ to\ green.}}
\DoxyCodeLine{06406\ \textcolor{comment}{//\ \ \ @Y\ \ \ \ changes\ the\ color\ to\ yellow.}}
\DoxyCodeLine{06407\ \textcolor{comment}{//\ \ \ @D\ \ \ \ changes\ to\ the\ default\ terminal\ text\ color.}}
\DoxyCodeLine{06408\ \textcolor{comment}{//}}
\DoxyCodeLine{06409\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ PrintColorEncoded(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ str)\ \{}
\DoxyCodeLine{06410\ \ \ GTestColor\ color\ =\ GTestColor::kDefault;\ \ \textcolor{comment}{//\ The\ current\ color.}}
\DoxyCodeLine{06411\ }
\DoxyCodeLine{06412\ \ \ \textcolor{comment}{//\ Conceptually,\ we\ split\ the\ string\ into\ segments\ divided\ by\ escape}}
\DoxyCodeLine{06413\ \ \ \textcolor{comment}{//\ sequences.\ \ Then\ we\ print\ one\ segment\ at\ a\ time.\ \ At\ the\ end\ of}}
\DoxyCodeLine{06414\ \ \ \textcolor{comment}{//\ each\ iteration,\ the\ str\ pointer\ advances\ to\ the\ beginning\ of\ the}}
\DoxyCodeLine{06415\ \ \ \textcolor{comment}{//\ next\ segment.}}
\DoxyCodeLine{06416\ \ \ \textcolor{keywordflow}{for}\ (;;)\ \{}
\DoxyCodeLine{06417\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ p\ =\ strchr(str,\ \textcolor{charliteral}{'@'});}
\DoxyCodeLine{06418\ \ \ \ \ \textcolor{keywordflow}{if}\ (p\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{06419\ \ \ \ \ \ \ ColoredPrintf(color,\ \textcolor{stringliteral}{"{}\%s"{}},\ str);}
\DoxyCodeLine{06420\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{06421\ \ \ \ \ \}}
\DoxyCodeLine{06422\ }
\DoxyCodeLine{06423\ \ \ \ \ ColoredPrintf(color,\ \textcolor{stringliteral}{"{}\%s"{}},\ std::string(str,\ p).c\_str());}
\DoxyCodeLine{06424\ }
\DoxyCodeLine{06425\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ ch\ =\ p[1];}
\DoxyCodeLine{06426\ \ \ \ \ str\ =\ p\ +\ 2;}
\DoxyCodeLine{06427\ \ \ \ \ \textcolor{keywordflow}{if}\ (ch\ ==\ \textcolor{charliteral}{'@'})\ \{}
\DoxyCodeLine{06428\ \ \ \ \ \ \ ColoredPrintf(color,\ \textcolor{stringliteral}{"{}@"{}});}
\DoxyCodeLine{06429\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (ch\ ==\ \textcolor{charliteral}{'D'})\ \{}
\DoxyCodeLine{06430\ \ \ \ \ \ \ color\ =\ GTestColor::kDefault;}
\DoxyCodeLine{06431\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (ch\ ==\ \textcolor{charliteral}{'R'})\ \{}
\DoxyCodeLine{06432\ \ \ \ \ \ \ color\ =\ GTestColor::kRed;}
\DoxyCodeLine{06433\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (ch\ ==\ \textcolor{charliteral}{'G'})\ \{}
\DoxyCodeLine{06434\ \ \ \ \ \ \ color\ =\ GTestColor::kGreen;}
\DoxyCodeLine{06435\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (ch\ ==\ \textcolor{charliteral}{'Y'})\ \{}
\DoxyCodeLine{06436\ \ \ \ \ \ \ color\ =\ GTestColor::kYellow;}
\DoxyCodeLine{06437\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{06438\ \ \ \ \ \ \ -\/-\/str;}
\DoxyCodeLine{06439\ \ \ \ \ \}}
\DoxyCodeLine{06440\ \ \ \}}
\DoxyCodeLine{06441\ \}}
\DoxyCodeLine{06442\ }
\DoxyCodeLine{06443\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ kColorEncodedHelpMessage[]\ =}
\DoxyCodeLine{06444\ \ \ \ \ \textcolor{stringliteral}{"{}This\ program\ contains\ tests\ written\ using\ "{}}\ GTEST\_NAME\_}
\DoxyCodeLine{06445\ \ \ \ \ \textcolor{stringliteral}{"{}.\ You\ can\ use\ the\(\backslash\)n"{}}}
\DoxyCodeLine{06446\ \ \ \ \ \textcolor{stringliteral}{"{}following\ command\ line\ flags\ to\ control\ its\ behavior:\(\backslash\)n"{}}}
\DoxyCodeLine{06447\ \ \ \ \ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{06448\ \ \ \ \ \textcolor{stringliteral}{"{}Test\ Selection:\(\backslash\)n"{}}}
\DoxyCodeLine{06449\ \ \ \ \ \textcolor{stringliteral}{"{}\ \ @G-\/-\/"{}}\ GTEST\_FLAG\_PREFIX\_}
\DoxyCodeLine{06450\ \ \ \ \ \textcolor{stringliteral}{"{}list\_tests@D\(\backslash\)n"{}}}
\DoxyCodeLine{06451\ \ \ \ \ \textcolor{stringliteral}{"{}\ \ \ \ \ \ List\ the\ names\ of\ all\ tests\ instead\ of\ running\ them.\ The\ name\ of\(\backslash\)n"{}}}
\DoxyCodeLine{06452\ \ \ \ \ \textcolor{stringliteral}{"{}\ \ \ \ \ \ TEST(Foo,\ Bar)\ is\ \(\backslash\)"{}Foo.Bar\(\backslash\)"{}.\(\backslash\)n"{}}}
\DoxyCodeLine{06453\ \ \ \ \ \textcolor{stringliteral}{"{}\ \ @G-\/-\/"{}}\ GTEST\_FLAG\_PREFIX\_}
\DoxyCodeLine{06454\ \ \ \ \ \textcolor{stringliteral}{"{}filter=@YPOSITIVE\_PATTERNS"{}}}
\DoxyCodeLine{06455\ \ \ \ \ \textcolor{stringliteral}{"{}[@G-\/@YNEGATIVE\_PATTERNS]@D\(\backslash\)n"{}}}
\DoxyCodeLine{06456\ \ \ \ \ \textcolor{stringliteral}{"{}\ \ \ \ \ \ Run\ only\ the\ tests\ whose\ name\ matches\ one\ of\ the\ positive\ patterns\ "{}}}
\DoxyCodeLine{06457\ \ \ \ \ \textcolor{stringliteral}{"{}but\(\backslash\)n"{}}}
\DoxyCodeLine{06458\ \ \ \ \ \textcolor{stringliteral}{"{}\ \ \ \ \ \ none\ of\ the\ negative\ patterns.\ '?'\ matches\ any\ single\ character;\ "{}}}
\DoxyCodeLine{06459\ \ \ \ \ \textcolor{stringliteral}{"{}'*'\(\backslash\)n"{}}}
\DoxyCodeLine{06460\ \ \ \ \ \textcolor{stringliteral}{"{}\ \ \ \ \ \ matches\ any\ substring;\ ':'\ separates\ two\ patterns.\(\backslash\)n"{}}}
\DoxyCodeLine{06461\ \ \ \ \ \textcolor{stringliteral}{"{}\ \ @G-\/-\/"{}}\ GTEST\_FLAG\_PREFIX\_}
\DoxyCodeLine{06462\ \ \ \ \ \textcolor{stringliteral}{"{}also\_run\_disabled\_tests@D\(\backslash\)n"{}}}
\DoxyCodeLine{06463\ \ \ \ \ \textcolor{stringliteral}{"{}\ \ \ \ \ \ Run\ all\ disabled\ tests\ too.\(\backslash\)n"{}}}
\DoxyCodeLine{06464\ \ \ \ \ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{06465\ \ \ \ \ \textcolor{stringliteral}{"{}Test\ Execution:\(\backslash\)n"{}}}
\DoxyCodeLine{06466\ \ \ \ \ \textcolor{stringliteral}{"{}\ \ @G-\/-\/"{}}\ GTEST\_FLAG\_PREFIX\_}
\DoxyCodeLine{06467\ \ \ \ \ \textcolor{stringliteral}{"{}repeat=@Y[COUNT]@D\(\backslash\)n"{}}}
\DoxyCodeLine{06468\ \ \ \ \ \textcolor{stringliteral}{"{}\ \ \ \ \ \ Run\ the\ tests\ repeatedly;\ use\ a\ negative\ count\ to\ repeat\ forever.\(\backslash\)n"{}}}
\DoxyCodeLine{06469\ \ \ \ \ \textcolor{stringliteral}{"{}\ \ @G-\/-\/"{}}\ GTEST\_FLAG\_PREFIX\_}
\DoxyCodeLine{06470\ \ \ \ \ \textcolor{stringliteral}{"{}shuffle@D\(\backslash\)n"{}}}
\DoxyCodeLine{06471\ \ \ \ \ \textcolor{stringliteral}{"{}\ \ \ \ \ \ Randomize\ tests'\ orders\ on\ every\ iteration.\(\backslash\)n"{}}}
\DoxyCodeLine{06472\ \ \ \ \ \textcolor{stringliteral}{"{}\ \ @G-\/-\/"{}}\ GTEST\_FLAG\_PREFIX\_}
\DoxyCodeLine{06473\ \ \ \ \ \textcolor{stringliteral}{"{}random\_seed=@Y[NUMBER]@D\(\backslash\)n"{}}}
\DoxyCodeLine{06474\ \ \ \ \ \textcolor{stringliteral}{"{}\ \ \ \ \ \ Random\ number\ seed\ to\ use\ for\ shuffling\ test\ orders\ (between\ 1\ and\(\backslash\)n"{}}}
\DoxyCodeLine{06475\ \ \ \ \ \textcolor{stringliteral}{"{}\ \ \ \ \ \ 99999,\ or\ 0\ to\ use\ a\ seed\ based\ on\ the\ current\ time).\(\backslash\)n"{}}}
\DoxyCodeLine{06476\ \ \ \ \ \textcolor{stringliteral}{"{}\ \ @G-\/-\/"{}}\ GTEST\_FLAG\_PREFIX\_}
\DoxyCodeLine{06477\ \ \ \ \ \textcolor{stringliteral}{"{}recreate\_environments\_when\_repeating@D\(\backslash\)n"{}}}
\DoxyCodeLine{06478\ \ \ \ \ \textcolor{stringliteral}{"{}\ \ \ \ \ \ Sets\ up\ and\ tears\ down\ the\ global\ test\ environment\ on\ each\ repeat\(\backslash\)n"{}}}
\DoxyCodeLine{06479\ \ \ \ \ \textcolor{stringliteral}{"{}\ \ \ \ \ \ of\ the\ test.\(\backslash\)n"{}}}
\DoxyCodeLine{06480\ \ \ \ \ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{06481\ \ \ \ \ \textcolor{stringliteral}{"{}Test\ Output:\(\backslash\)n"{}}}
\DoxyCodeLine{06482\ \ \ \ \ \textcolor{stringliteral}{"{}\ \ @G-\/-\/"{}}\ GTEST\_FLAG\_PREFIX\_}
\DoxyCodeLine{06483\ \ \ \ \ \textcolor{stringliteral}{"{}color=@Y(@Gyes@Y|@Gno@Y|@Gauto@Y)@D\(\backslash\)n"{}}}
\DoxyCodeLine{06484\ \ \ \ \ \textcolor{stringliteral}{"{}\ \ \ \ \ \ Enable/disable\ colored\ output.\ The\ default\ is\ @Gauto@D.\(\backslash\)n"{}}}
\DoxyCodeLine{06485\ \ \ \ \ \textcolor{stringliteral}{"{}\ \ @G-\/-\/"{}}\ GTEST\_FLAG\_PREFIX\_}
\DoxyCodeLine{06486\ \ \ \ \ \textcolor{stringliteral}{"{}brief=1@D\(\backslash\)n"{}}}
\DoxyCodeLine{06487\ \ \ \ \ \textcolor{stringliteral}{"{}\ \ \ \ \ \ Only\ print\ test\ failures.\(\backslash\)n"{}}}
\DoxyCodeLine{06488\ \ \ \ \ \textcolor{stringliteral}{"{}\ \ @G-\/-\/"{}}\ GTEST\_FLAG\_PREFIX\_}
\DoxyCodeLine{06489\ \ \ \ \ \textcolor{stringliteral}{"{}print\_time=0@D\(\backslash\)n"{}}}
\DoxyCodeLine{06490\ \ \ \ \ \textcolor{stringliteral}{"{}\ \ \ \ \ \ Don't\ print\ the\ elapsed\ time\ of\ each\ test.\(\backslash\)n"{}}}
\DoxyCodeLine{06491\ \ \ \ \ \textcolor{stringliteral}{"{}\ \ @G-\/-\/"{}}\ GTEST\_FLAG\_PREFIX\_}
\DoxyCodeLine{06492\ \ \ \ \ \textcolor{stringliteral}{"{}output=@Y(@Gjson@Y|@Gxml@Y)[@G:@YDIRECTORY\_PATH@G"{}}\ GTEST\_PATH\_SEP\_}
\DoxyCodeLine{06493\ \ \ \ \ \textcolor{stringliteral}{"{}@Y|@G:@YFILE\_PATH]@D\(\backslash\)n"{}}}
\DoxyCodeLine{06494\ \ \ \ \ \textcolor{stringliteral}{"{}\ \ \ \ \ \ Generate\ a\ JSON\ or\ XML\ report\ in\ the\ given\ directory\ or\ with\ the\ "{}}}
\DoxyCodeLine{06495\ \ \ \ \ \textcolor{stringliteral}{"{}given\(\backslash\)n"{}}}
\DoxyCodeLine{06496\ \ \ \ \ \textcolor{stringliteral}{"{}\ \ \ \ \ \ file\ name.\ @YFILE\_PATH@D\ defaults\ to\ @Gtest\_detail.xml@D.\(\backslash\)n"{}}}
\DoxyCodeLine{06497\ \textcolor{preprocessor}{\#if\ GTEST\_CAN\_STREAM\_RESULTS\_}}
\DoxyCodeLine{06498\ \ \ \ \ \textcolor{stringliteral}{"{}\ \ @G-\/-\/"{}}\ GTEST\_FLAG\_PREFIX\_}
\DoxyCodeLine{06499\ \ \ \ \ \textcolor{stringliteral}{"{}stream\_result\_to=@YHOST@G:@YPORT@D\(\backslash\)n"{}}}
\DoxyCodeLine{06500\ \ \ \ \ \textcolor{stringliteral}{"{}\ \ \ \ \ \ Stream\ test\ results\ to\ the\ given\ server.\(\backslash\)n"{}}}
\DoxyCodeLine{06501\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GTEST\_CAN\_STREAM\_RESULTS\_}}
\DoxyCodeLine{06502\ \ \ \ \ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{06503\ \ \ \ \ \textcolor{stringliteral}{"{}Assertion\ Behavior:\(\backslash\)n"{}}}
\DoxyCodeLine{06504\ \textcolor{preprocessor}{\#if\ GTEST\_HAS\_DEATH\_TEST\ \&\&\ !GTEST\_OS\_WINDOWS}}
\DoxyCodeLine{06505\ \ \ \ \ \textcolor{stringliteral}{"{}\ \ @G-\/-\/"{}}\ GTEST\_FLAG\_PREFIX\_}
\DoxyCodeLine{06506\ \ \ \ \ \textcolor{stringliteral}{"{}death\_test\_style=@Y(@Gfast@Y|@Gthreadsafe@Y)@D\(\backslash\)n"{}}}
\DoxyCodeLine{06507\ \ \ \ \ \textcolor{stringliteral}{"{}\ \ \ \ \ \ Set\ the\ default\ death\ test\ style.\(\backslash\)n"{}}}
\DoxyCodeLine{06508\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GTEST\_HAS\_DEATH\_TEST\ \&\&\ !GTEST\_OS\_WINDOWS}}
\DoxyCodeLine{06509\ \ \ \ \ \textcolor{stringliteral}{"{}\ \ @G-\/-\/"{}}\ GTEST\_FLAG\_PREFIX\_}
\DoxyCodeLine{06510\ \ \ \ \ \textcolor{stringliteral}{"{}break\_on\_failure@D\(\backslash\)n"{}}}
\DoxyCodeLine{06511\ \ \ \ \ \textcolor{stringliteral}{"{}\ \ \ \ \ \ Turn\ assertion\ failures\ into\ debugger\ break-\/points.\(\backslash\)n"{}}}
\DoxyCodeLine{06512\ \ \ \ \ \textcolor{stringliteral}{"{}\ \ @G-\/-\/"{}}\ GTEST\_FLAG\_PREFIX\_}
\DoxyCodeLine{06513\ \ \ \ \ \textcolor{stringliteral}{"{}throw\_on\_failure@D\(\backslash\)n"{}}}
\DoxyCodeLine{06514\ \ \ \ \ \textcolor{stringliteral}{"{}\ \ \ \ \ \ Turn\ assertion\ failures\ into\ C++\ exceptions\ for\ use\ by\ an\ external\(\backslash\)n"{}}}
\DoxyCodeLine{06515\ \ \ \ \ \textcolor{stringliteral}{"{}\ \ \ \ \ \ test\ framework.\(\backslash\)n"{}}}
\DoxyCodeLine{06516\ \ \ \ \ \textcolor{stringliteral}{"{}\ \ @G-\/-\/"{}}\ GTEST\_FLAG\_PREFIX\_}
\DoxyCodeLine{06517\ \ \ \ \ \textcolor{stringliteral}{"{}catch\_exceptions=0@D\(\backslash\)n"{}}}
\DoxyCodeLine{06518\ \ \ \ \ \textcolor{stringliteral}{"{}\ \ \ \ \ \ Do\ not\ report\ exceptions\ as\ test\ failures.\ Instead,\ allow\ them\(\backslash\)n"{}}}
\DoxyCodeLine{06519\ \ \ \ \ \textcolor{stringliteral}{"{}\ \ \ \ \ \ to\ crash\ the\ program\ or\ throw\ a\ pop-\/up\ (on\ Windows).\(\backslash\)n"{}}}
\DoxyCodeLine{06520\ \ \ \ \ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{06521\ \ \ \ \ \textcolor{stringliteral}{"{}Except\ for\ @G-\/-\/"{}}\ GTEST\_FLAG\_PREFIX\_}
\DoxyCodeLine{06522\ \ \ \ \ \textcolor{stringliteral}{"{}list\_tests@D,\ you\ can\ alternatively\ set\ "{}}}
\DoxyCodeLine{06523\ \ \ \ \ \textcolor{stringliteral}{"{}the\ corresponding\(\backslash\)n"{}}}
\DoxyCodeLine{06524\ \ \ \ \ \textcolor{stringliteral}{"{}environment\ variable\ of\ a\ flag\ (all\ letters\ in\ upper-\/case).\ For\ example,\ "{}}}
\DoxyCodeLine{06525\ \ \ \ \ \textcolor{stringliteral}{"{}to\(\backslash\)n"{}}}
\DoxyCodeLine{06526\ \ \ \ \ \textcolor{stringliteral}{"{}disable\ colored\ text\ output,\ you\ can\ either\ specify\ "{}}}
\DoxyCodeLine{06527\ \ \ \ \ \textcolor{stringliteral}{"{}@G-\/-\/"{}}\ GTEST\_FLAG\_PREFIX\_}
\DoxyCodeLine{06528\ \ \ \ \ \textcolor{stringliteral}{"{}color=no@D\ or\ set\(\backslash\)n"{}}}
\DoxyCodeLine{06529\ \ \ \ \ \textcolor{stringliteral}{"{}the\ @G"{}}\ GTEST\_FLAG\_PREFIX\_UPPER\_}
\DoxyCodeLine{06530\ \ \ \ \ \textcolor{stringliteral}{"{}COLOR@D\ environment\ variable\ to\ @Gno@D.\(\backslash\)n"{}}}
\DoxyCodeLine{06531\ \ \ \ \ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{06532\ \ \ \ \ \textcolor{stringliteral}{"{}For\ more\ information,\ please\ read\ the\ "{}}\ GTEST\_NAME\_}
\DoxyCodeLine{06533\ \ \ \ \ \textcolor{stringliteral}{"{}\ documentation\ at\(\backslash\)n"{}}}
\DoxyCodeLine{06534\ \ \ \ \ \textcolor{stringliteral}{"{}@G"{}}\ GTEST\_PROJECT\_URL\_\ \textcolor{stringliteral}{"{}@D.\ If\ you\ find\ a\ bug\ in\ "{}}\ GTEST\_NAME\_}
\DoxyCodeLine{06535\ \ \ \ \ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{06536\ \ \ \ \ \textcolor{stringliteral}{"{}(not\ one\ in\ your\ own\ code\ or\ tests),\ please\ report\ it\ to\(\backslash\)n"{}}}
\DoxyCodeLine{06537\ \ \ \ \ \textcolor{stringliteral}{"{}@G<"{}}\ GTEST\_DEV\_EMAIL\_\ \textcolor{stringliteral}{"{}>@D.\(\backslash\)n"{}};}
\DoxyCodeLine{06538\ }
\DoxyCodeLine{06539\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ ParseGoogleTestFlag(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \textcolor{keyword}{const}\ arg)\ \{}
\DoxyCodeLine{06540\ \textcolor{preprocessor}{\#define\ GTEST\_INTERNAL\_PARSE\_FLAG(flag\_name)\ \ \(\backslash\)}}
\DoxyCodeLine{06541\ \textcolor{preprocessor}{\ \ do\ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{06542\ \textcolor{preprocessor}{\ \ \ \ auto\ value\ =\ GTEST\_FLAG\_GET(flag\_name);\ \ \ \(\backslash\)}}
\DoxyCodeLine{06543\ \textcolor{preprocessor}{\ \ \ \ if\ (ParseFlag(arg,\ \#flag\_name,\ \&value))\ \{\ \(\backslash\)}}
\DoxyCodeLine{06544\ \textcolor{preprocessor}{\ \ \ \ \ \ GTEST\_FLAG\_SET(flag\_name,\ value);\ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{06545\ \textcolor{preprocessor}{\ \ \ \ \ \ return\ true;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{06546\ \textcolor{preprocessor}{\ \ \ \ \}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{06547\ \textcolor{preprocessor}{\ \ \}\ while\ (false)}}
\DoxyCodeLine{06548\ }
\DoxyCodeLine{06549\ \ \ GTEST\_INTERNAL\_PARSE\_FLAG(also\_run\_disabled\_tests);}
\DoxyCodeLine{06550\ \ \ GTEST\_INTERNAL\_PARSE\_FLAG(break\_on\_failure);}
\DoxyCodeLine{06551\ \ \ GTEST\_INTERNAL\_PARSE\_FLAG(catch\_exceptions);}
\DoxyCodeLine{06552\ \ \ GTEST\_INTERNAL\_PARSE\_FLAG(color);}
\DoxyCodeLine{06553\ \ \ GTEST\_INTERNAL\_PARSE\_FLAG(death\_test\_style);}
\DoxyCodeLine{06554\ \ \ GTEST\_INTERNAL\_PARSE\_FLAG(death\_test\_use\_fork);}
\DoxyCodeLine{06555\ \ \ GTEST\_INTERNAL\_PARSE\_FLAG(fail\_fast);}
\DoxyCodeLine{06556\ \ \ GTEST\_INTERNAL\_PARSE\_FLAG(filter);}
\DoxyCodeLine{06557\ \ \ GTEST\_INTERNAL\_PARSE\_FLAG(internal\_run\_death\_test);}
\DoxyCodeLine{06558\ \ \ GTEST\_INTERNAL\_PARSE\_FLAG(list\_tests);}
\DoxyCodeLine{06559\ \ \ GTEST\_INTERNAL\_PARSE\_FLAG(output);}
\DoxyCodeLine{06560\ \ \ GTEST\_INTERNAL\_PARSE\_FLAG(brief);}
\DoxyCodeLine{06561\ \ \ GTEST\_INTERNAL\_PARSE\_FLAG(print\_time);}
\DoxyCodeLine{06562\ \ \ GTEST\_INTERNAL\_PARSE\_FLAG(print\_utf8);}
\DoxyCodeLine{06563\ \ \ GTEST\_INTERNAL\_PARSE\_FLAG(random\_seed);}
\DoxyCodeLine{06564\ \ \ GTEST\_INTERNAL\_PARSE\_FLAG(repeat);}
\DoxyCodeLine{06565\ \ \ GTEST\_INTERNAL\_PARSE\_FLAG(recreate\_environments\_when\_repeating);}
\DoxyCodeLine{06566\ \ \ GTEST\_INTERNAL\_PARSE\_FLAG(shuffle);}
\DoxyCodeLine{06567\ \ \ GTEST\_INTERNAL\_PARSE\_FLAG(stack\_trace\_depth);}
\DoxyCodeLine{06568\ \ \ GTEST\_INTERNAL\_PARSE\_FLAG(stream\_result\_to);}
\DoxyCodeLine{06569\ \ \ GTEST\_INTERNAL\_PARSE\_FLAG(throw\_on\_failure);}
\DoxyCodeLine{06570\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{06571\ \}}
\DoxyCodeLine{06572\ }
\DoxyCodeLine{06573\ \textcolor{preprocessor}{\#if\ GTEST\_USE\_OWN\_FLAGFILE\_FLAG\_}}
\DoxyCodeLine{06574\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ LoadFlagsFromFile(\textcolor{keyword}{const}\ std::string\&\ path)\ \{}
\DoxyCodeLine{06575\ \ \ FILE*\ flagfile\ =\ posix::FOpen(path.c\_str(),\ \textcolor{stringliteral}{"{}r"{}});}
\DoxyCodeLine{06576\ \ \ \textcolor{keywordflow}{if}\ (!flagfile)\ \{}
\DoxyCodeLine{06577\ \ \ \ \ GTEST\_LOG\_(FATAL)\ <<\ \textcolor{stringliteral}{"{}Unable\ to\ open\ file\ \(\backslash\)"{}"{}}\ <<\ GTEST\_FLAG\_GET(flagfile)}
\DoxyCodeLine{06578\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}"{}};}
\DoxyCodeLine{06579\ \ \ \}}
\DoxyCodeLine{06580\ \ \ std::string\ contents(ReadEntireFile(flagfile));}
\DoxyCodeLine{06581\ \ \ posix::FClose(flagfile);}
\DoxyCodeLine{06582\ \ \ std::vector<std::string>\ lines;}
\DoxyCodeLine{06583\ \ \ SplitString(contents,\ \textcolor{charliteral}{'\(\backslash\)n'},\ \&lines);}
\DoxyCodeLine{06584\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ lines.size();\ ++i)\ \{}
\DoxyCodeLine{06585\ \ \ \ \ \textcolor{keywordflow}{if}\ (lines[i].empty())\ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{06586\ \ \ \ \ \textcolor{keywordflow}{if}\ (!ParseGoogleTestFlag(lines[i].c\_str()))\ g\_help\_flag\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{06587\ \ \ \}}
\DoxyCodeLine{06588\ \}}
\DoxyCodeLine{06589\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GTEST\_USE\_OWN\_FLAGFILE\_FLAG\_}}
\DoxyCodeLine{06590\ }
\DoxyCodeLine{06591\ \textcolor{comment}{//\ Parses\ the\ command\ line\ for\ Google\ Test\ flags,\ without\ initializing}}
\DoxyCodeLine{06592\ \textcolor{comment}{//\ other\ parts\ of\ Google\ Test.\ \ The\ type\ parameter\ CharType\ can\ be}}
\DoxyCodeLine{06593\ \textcolor{comment}{//\ instantiated\ to\ either\ char\ or\ wchar\_t.}}
\DoxyCodeLine{06594\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ CharType>}
\DoxyCodeLine{06595\ \textcolor{keywordtype}{void}\ ParseGoogleTestFlagsOnlyImpl(\textcolor{keywordtype}{int}*\ argc,\ CharType**\ argv)\ \{}
\DoxyCodeLine{06596\ \ \ std::string\ flagfile\_value;}
\DoxyCodeLine{06597\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <\ *argc;\ i++)\ \{}
\DoxyCodeLine{06598\ \ \ \ \ \textcolor{keyword}{const}\ std::string\ arg\_string\ =\ StreamableToString(argv[i]);}
\DoxyCodeLine{06599\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ \textcolor{keyword}{const}\ arg\ =\ arg\_string.c\_str();}
\DoxyCodeLine{06600\ }
\DoxyCodeLine{06601\ \ \ \ \ \textcolor{keyword}{using\ }internal::ParseFlag;}
\DoxyCodeLine{06602\ }
\DoxyCodeLine{06603\ \ \ \ \ \textcolor{keywordtype}{bool}\ remove\_flag\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{06604\ \ \ \ \ \textcolor{keywordflow}{if}\ (ParseGoogleTestFlag(arg))\ \{}
\DoxyCodeLine{06605\ \ \ \ \ \ \ remove\_flag\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{06606\ \textcolor{preprocessor}{\#if\ GTEST\_USE\_OWN\_FLAGFILE\_FLAG\_}}
\DoxyCodeLine{06607\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (ParseFlag(arg,\ \textcolor{stringliteral}{"{}flagfile"{}},\ \&flagfile\_value))\ \{}
\DoxyCodeLine{06608\ \ \ \ \ \ \ GTEST\_FLAG\_SET(flagfile,\ flagfile\_value);}
\DoxyCodeLine{06609\ \ \ \ \ \ \ LoadFlagsFromFile(flagfile\_value);}
\DoxyCodeLine{06610\ \ \ \ \ \ \ remove\_flag\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{06611\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GTEST\_USE\_OWN\_FLAGFILE\_FLAG\_}}
\DoxyCodeLine{06612\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (arg\_string\ ==\ \textcolor{stringliteral}{"{}-\/-\/help"{}}\ ||\ HasGoogleTestFlagPrefix(arg))\ \{}
\DoxyCodeLine{06613\ \ \ \ \ \ \ \textcolor{comment}{//\ Both\ help\ flag\ and\ unrecognized\ Google\ Test\ flags\ (excluding}}
\DoxyCodeLine{06614\ \ \ \ \ \ \ \textcolor{comment}{//\ internal\ ones)\ trigger\ help\ display.}}
\DoxyCodeLine{06615\ \ \ \ \ \ \ g\_help\_flag\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{06616\ \ \ \ \ \}}
\DoxyCodeLine{06617\ }
\DoxyCodeLine{06618\ \ \ \ \ \textcolor{keywordflow}{if}\ (remove\_flag)\ \{}
\DoxyCodeLine{06619\ \ \ \ \ \ \ \textcolor{comment}{//\ Shift\ the\ remainder\ of\ the\ argv\ list\ left\ by\ one.\ \ Note}}
\DoxyCodeLine{06620\ \ \ \ \ \ \ \textcolor{comment}{//\ that\ argv\ has\ (*argc\ +\ 1)\ elements,\ the\ last\ one\ always\ being}}
\DoxyCodeLine{06621\ \ \ \ \ \ \ \textcolor{comment}{//\ NULL.\ \ The\ following\ loop\ moves\ the\ trailing\ NULL\ element\ as}}
\DoxyCodeLine{06622\ \ \ \ \ \ \ \textcolor{comment}{//\ well.}}
\DoxyCodeLine{06623\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ i;\ j\ !=\ *argc;\ j++)\ \{}
\DoxyCodeLine{06624\ \ \ \ \ \ \ \ \ argv[j]\ =\ argv[j\ +\ 1];}
\DoxyCodeLine{06625\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06626\ }
\DoxyCodeLine{06627\ \ \ \ \ \ \ \textcolor{comment}{//\ Decrements\ the\ argument\ count.}}
\DoxyCodeLine{06628\ \ \ \ \ \ \ (*argc)-\/-\/;}
\DoxyCodeLine{06629\ }
\DoxyCodeLine{06630\ \ \ \ \ \ \ \textcolor{comment}{//\ We\ also\ need\ to\ decrement\ the\ iterator\ as\ we\ just\ removed}}
\DoxyCodeLine{06631\ \ \ \ \ \ \ \textcolor{comment}{//\ an\ element.}}
\DoxyCodeLine{06632\ \ \ \ \ \ \ i-\/-\/;}
\DoxyCodeLine{06633\ \ \ \ \ \}}
\DoxyCodeLine{06634\ \ \ \}}
\DoxyCodeLine{06635\ }
\DoxyCodeLine{06636\ \ \ \textcolor{keywordflow}{if}\ (g\_help\_flag)\ \{}
\DoxyCodeLine{06637\ \ \ \ \ \textcolor{comment}{//\ We\ print\ the\ help\ here\ instead\ of\ in\ RUN\_ALL\_TESTS(),\ as\ the}}
\DoxyCodeLine{06638\ \ \ \ \ \textcolor{comment}{//\ latter\ may\ not\ be\ called\ at\ all\ if\ the\ user\ is\ using\ Google}}
\DoxyCodeLine{06639\ \ \ \ \ \textcolor{comment}{//\ Test\ with\ another\ testing\ framework.}}
\DoxyCodeLine{06640\ \ \ \ \ PrintColorEncoded(kColorEncodedHelpMessage);}
\DoxyCodeLine{06641\ \ \ \}}
\DoxyCodeLine{06642\ \}}
\DoxyCodeLine{06643\ }
\DoxyCodeLine{06644\ \textcolor{comment}{//\ Parses\ the\ command\ line\ for\ Google\ Test\ flags,\ without\ initializing}}
\DoxyCodeLine{06645\ \textcolor{comment}{//\ other\ parts\ of\ Google\ Test.}}
\DoxyCodeLine{06646\ \textcolor{keywordtype}{void}\ ParseGoogleTestFlagsOnly(\textcolor{keywordtype}{int}*\ argc,\ \textcolor{keywordtype}{char}**\ argv)\ \{}
\DoxyCodeLine{06647\ \textcolor{preprocessor}{\#if\ GTEST\_HAS\_ABSL}}
\DoxyCodeLine{06648\ \ \ \textcolor{keywordflow}{if}\ (*argc\ >\ 0)\ \{}
\DoxyCodeLine{06649\ \ \ \ \ \textcolor{comment}{//\ absl::ParseCommandLine()\ requires\ *argc\ >\ 0.}}
\DoxyCodeLine{06650\ \ \ \ \ \textcolor{keyword}{auto}\ positional\_args\ =\ absl::flags\_internal::ParseCommandLineImpl(}
\DoxyCodeLine{06651\ \ \ \ \ \ \ \ \ *argc,\ argv,\ absl::flags\_internal::ArgvListAction::kRemoveParsedArgs,}
\DoxyCodeLine{06652\ \ \ \ \ \ \ \ \ absl::flags\_internal::UsageFlagsAction::kHandleUsage,}
\DoxyCodeLine{06653\ \ \ \ \ \ \ \ \ absl::flags\_internal::OnUndefinedFlag::kReportUndefined);}
\DoxyCodeLine{06654\ \ \ \ \ \textcolor{comment}{//\ Any\ command-\/line\ positional\ arguments\ not\ part\ of\ any\ command-\/line\ flag}}
\DoxyCodeLine{06655\ \ \ \ \ \textcolor{comment}{//\ (or\ arguments\ to\ a\ flag)\ are\ copied\ back\ out\ to\ argv,\ with\ the\ program}}
\DoxyCodeLine{06656\ \ \ \ \ \textcolor{comment}{//\ invocation\ name\ at\ position\ 0,\ and\ argc\ is\ resized.\ This\ includes}}
\DoxyCodeLine{06657\ \ \ \ \ \textcolor{comment}{//\ positional\ arguments\ after\ the\ flag-\/terminating\ delimiter\ '-\/-\/'.}}
\DoxyCodeLine{06658\ \ \ \ \ \textcolor{comment}{//\ See\ https://abseil.io/docs/cpp/guides/flags.}}
\DoxyCodeLine{06659\ \ \ \ \ std::copy(positional\_args.begin(),\ positional\_args.end(),\ argv);}
\DoxyCodeLine{06660\ \ \ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(positional\_args.size())\ <\ *argc)\ \{}
\DoxyCodeLine{06661\ \ \ \ \ \ \ argv[positional\_args.size()]\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{06662\ \ \ \ \ \ \ *argc\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(positional\_args.size());}
\DoxyCodeLine{06663\ \ \ \ \ \}}
\DoxyCodeLine{06664\ \ \ \}}
\DoxyCodeLine{06665\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{06666\ \ \ ParseGoogleTestFlagsOnlyImpl(argc,\ argv);}
\DoxyCodeLine{06667\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{06668\ }
\DoxyCodeLine{06669\ \ \ \textcolor{comment}{//\ Fix\ the\ value\ of\ *\_NSGetArgc()\ on\ macOS,\ but\ if\ and\ only\ if}}
\DoxyCodeLine{06670\ \ \ \textcolor{comment}{//\ *\_NSGetArgv()\ ==\ argv}}
\DoxyCodeLine{06671\ \ \ \textcolor{comment}{//\ Only\ applicable\ to\ char**\ version\ of\ argv}}
\DoxyCodeLine{06672\ \textcolor{preprocessor}{\#if\ GTEST\_OS\_MAC}}
\DoxyCodeLine{06673\ \textcolor{preprocessor}{\#ifndef\ GTEST\_OS\_IOS}}
\DoxyCodeLine{06674\ \ \ \textcolor{keywordflow}{if}\ (*\_NSGetArgv()\ ==\ argv)\ \{}
\DoxyCodeLine{06675\ \ \ \ \ *\_NSGetArgc()\ =\ *argc;}
\DoxyCodeLine{06676\ \ \ \}}
\DoxyCodeLine{06677\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{06678\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{06679\ \}}
\DoxyCodeLine{06680\ \textcolor{keywordtype}{void}\ ParseGoogleTestFlagsOnly(\textcolor{keywordtype}{int}*\ argc,\ \textcolor{keywordtype}{wchar\_t}**\ argv)\ \{}
\DoxyCodeLine{06681\ \ \ ParseGoogleTestFlagsOnlyImpl(argc,\ argv);}
\DoxyCodeLine{06682\ \}}
\DoxyCodeLine{06683\ }
\DoxyCodeLine{06684\ \textcolor{comment}{//\ The\ internal\ implementation\ of\ InitGoogleTest().}}
\DoxyCodeLine{06685\ \textcolor{comment}{//}}
\DoxyCodeLine{06686\ \textcolor{comment}{//\ The\ type\ parameter\ CharType\ can\ be\ instantiated\ to\ either\ char\ or}}
\DoxyCodeLine{06687\ \textcolor{comment}{//\ wchar\_t.}}
\DoxyCodeLine{06688\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ CharType>}
\DoxyCodeLine{06689\ \textcolor{keywordtype}{void}\ InitGoogleTestImpl(\textcolor{keywordtype}{int}*\ argc,\ CharType**\ argv)\ \{}
\DoxyCodeLine{06690\ \ \ \textcolor{comment}{//\ We\ don't\ want\ to\ run\ the\ initialization\ code\ twice.}}
\DoxyCodeLine{06691\ \ \ \textcolor{keywordflow}{if}\ (GTestIsInitialized())\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{06692\ }
\DoxyCodeLine{06693\ \ \ \textcolor{keywordflow}{if}\ (*argc\ <=\ 0)\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{06694\ }
\DoxyCodeLine{06695\ \ \ g\_argvs.clear();}
\DoxyCodeLine{06696\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ !=\ *argc;\ i++)\ \{}
\DoxyCodeLine{06697\ \ \ \ \ g\_argvs.push\_back(StreamableToString(argv[i]));}
\DoxyCodeLine{06698\ \ \ \}}
\DoxyCodeLine{06699\ }
\DoxyCodeLine{06700\ \textcolor{preprocessor}{\#if\ GTEST\_HAS\_ABSL}}
\DoxyCodeLine{06701\ \ \ absl::InitializeSymbolizer(g\_argvs[0].c\_str());}
\DoxyCodeLine{06702\ }
\DoxyCodeLine{06703\ \ \ \textcolor{comment}{//\ When\ using\ the\ Abseil\ Flags\ library,\ set\ the\ program\ usage\ message\ to\ the}}
\DoxyCodeLine{06704\ \ \ \textcolor{comment}{//\ help\ message,\ but\ remove\ the\ color-\/encoding\ from\ the\ message\ first.}}
\DoxyCodeLine{06705\ \ \ absl::SetProgramUsageMessage(absl::StrReplaceAll(}
\DoxyCodeLine{06706\ \ \ \ \ \ \ kColorEncodedHelpMessage,}
\DoxyCodeLine{06707\ \ \ \ \ \ \ \{\{\textcolor{stringliteral}{"{}@D"{}},\ \textcolor{stringliteral}{"{}"{}}\},\ \{\textcolor{stringliteral}{"{}@R"{}},\ \textcolor{stringliteral}{"{}"{}}\},\ \{\textcolor{stringliteral}{"{}@G"{}},\ \textcolor{stringliteral}{"{}"{}}\},\ \{\textcolor{stringliteral}{"{}@Y"{}},\ \textcolor{stringliteral}{"{}"{}}\},\ \{\textcolor{stringliteral}{"{}@@"{}},\ \textcolor{stringliteral}{"{}@"{}}\}\}));}
\DoxyCodeLine{06708\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GTEST\_HAS\_ABSL}}
\DoxyCodeLine{06709\ }
\DoxyCodeLine{06710\ \ \ ParseGoogleTestFlagsOnly(argc,\ argv);}
\DoxyCodeLine{06711\ \ \ GetUnitTestImpl()-\/>PostFlagParsingInit();}
\DoxyCodeLine{06712\ \}}
\DoxyCodeLine{06713\ }
\DoxyCodeLine{06714\ \}\ \ \textcolor{comment}{//\ namespace\ internal}}
\DoxyCodeLine{06715\ }
\DoxyCodeLine{06716\ \textcolor{comment}{//\ Initializes\ Google\ Test.\ \ This\ must\ be\ called\ before\ calling}}
\DoxyCodeLine{06717\ \textcolor{comment}{//\ RUN\_ALL\_TESTS().\ \ In\ particular,\ it\ parses\ a\ command\ line\ for\ the}}
\DoxyCodeLine{06718\ \textcolor{comment}{//\ flags\ that\ Google\ Test\ recognizes.\ \ Whenever\ a\ Google\ Test\ flag\ is}}
\DoxyCodeLine{06719\ \textcolor{comment}{//\ seen,\ it\ is\ removed\ from\ argv,\ and\ *argc\ is\ decremented.}}
\DoxyCodeLine{06720\ \textcolor{comment}{//}}
\DoxyCodeLine{06721\ \textcolor{comment}{//\ No\ value\ is\ returned.\ \ Instead,\ the\ Google\ Test\ flag\ variables\ are}}
\DoxyCodeLine{06722\ \textcolor{comment}{//\ updated.}}
\DoxyCodeLine{06723\ \textcolor{comment}{//}}
\DoxyCodeLine{06724\ \textcolor{comment}{//\ Calling\ the\ function\ for\ the\ second\ time\ has\ no\ user-\/visible\ effect.}}
\DoxyCodeLine{06725\ \textcolor{keywordtype}{void}\ InitGoogleTest(\textcolor{keywordtype}{int}*\ argc,\ \textcolor{keywordtype}{char}**\ argv)\ \{}
\DoxyCodeLine{06726\ \textcolor{preprocessor}{\#if\ defined(GTEST\_CUSTOM\_INIT\_GOOGLE\_TEST\_FUNCTION\_)}}
\DoxyCodeLine{06727\ \ \ GTEST\_CUSTOM\_INIT\_GOOGLE\_TEST\_FUNCTION\_(argc,\ argv);}
\DoxyCodeLine{06728\ \textcolor{preprocessor}{\#else\ \ \ }\textcolor{comment}{//\ defined(GTEST\_CUSTOM\_INIT\_GOOGLE\_TEST\_FUNCTION\_)}}
\DoxyCodeLine{06729\ \ \ internal::InitGoogleTestImpl(argc,\ argv);}
\DoxyCodeLine{06730\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ defined(GTEST\_CUSTOM\_INIT\_GOOGLE\_TEST\_FUNCTION\_)}}
\DoxyCodeLine{06731\ \}}
\DoxyCodeLine{06732\ }
\DoxyCodeLine{06733\ \textcolor{comment}{//\ This\ overloaded\ version\ can\ be\ used\ in\ Windows\ programs\ compiled\ in}}
\DoxyCodeLine{06734\ \textcolor{comment}{//\ UNICODE\ mode.}}
\DoxyCodeLine{06735\ \textcolor{keywordtype}{void}\ InitGoogleTest(\textcolor{keywordtype}{int}*\ argc,\ \textcolor{keywordtype}{wchar\_t}**\ argv)\ \{}
\DoxyCodeLine{06736\ \textcolor{preprocessor}{\#if\ defined(GTEST\_CUSTOM\_INIT\_GOOGLE\_TEST\_FUNCTION\_)}}
\DoxyCodeLine{06737\ \ \ GTEST\_CUSTOM\_INIT\_GOOGLE\_TEST\_FUNCTION\_(argc,\ argv);}
\DoxyCodeLine{06738\ \textcolor{preprocessor}{\#else\ \ \ }\textcolor{comment}{//\ defined(GTEST\_CUSTOM\_INIT\_GOOGLE\_TEST\_FUNCTION\_)}}
\DoxyCodeLine{06739\ \ \ internal::InitGoogleTestImpl(argc,\ argv);}
\DoxyCodeLine{06740\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ defined(GTEST\_CUSTOM\_INIT\_GOOGLE\_TEST\_FUNCTION\_)}}
\DoxyCodeLine{06741\ \}}
\DoxyCodeLine{06742\ }
\DoxyCodeLine{06743\ \textcolor{comment}{//\ This\ overloaded\ version\ can\ be\ used\ on\ Arduino/embedded\ platforms\ where}}
\DoxyCodeLine{06744\ \textcolor{comment}{//\ there\ is\ no\ argc/argv.}}
\DoxyCodeLine{06745\ \textcolor{keywordtype}{void}\ InitGoogleTest()\ \{}
\DoxyCodeLine{06746\ \ \ \textcolor{comment}{//\ Since\ Arduino\ doesn't\ have\ a\ command\ line,\ fake\ out\ the\ argc/argv\ arguments}}
\DoxyCodeLine{06747\ \ \ \textcolor{keywordtype}{int}\ argc\ =\ 1;}
\DoxyCodeLine{06748\ \ \ \textcolor{keyword}{const}\ \textcolor{keyword}{auto}\ arg0\ =\ \textcolor{stringliteral}{"{}dummy"{}};}
\DoxyCodeLine{06749\ \ \ \textcolor{keywordtype}{char}*\ argv0\ =\ \textcolor{keyword}{const\_cast<}\textcolor{keywordtype}{char}*\textcolor{keyword}{>}(arg0);}
\DoxyCodeLine{06750\ \ \ \textcolor{keywordtype}{char}**\ argv\ =\ \&argv0;}
\DoxyCodeLine{06751\ }
\DoxyCodeLine{06752\ \textcolor{preprocessor}{\#if\ defined(GTEST\_CUSTOM\_INIT\_GOOGLE\_TEST\_FUNCTION\_)}}
\DoxyCodeLine{06753\ \ \ GTEST\_CUSTOM\_INIT\_GOOGLE\_TEST\_FUNCTION\_(\&argc,\ argv);}
\DoxyCodeLine{06754\ \textcolor{preprocessor}{\#else\ \ \ }\textcolor{comment}{//\ defined(GTEST\_CUSTOM\_INIT\_GOOGLE\_TEST\_FUNCTION\_)}}
\DoxyCodeLine{06755\ \ \ internal::InitGoogleTestImpl(\&argc,\ argv);}
\DoxyCodeLine{06756\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ defined(GTEST\_CUSTOM\_INIT\_GOOGLE\_TEST\_FUNCTION\_)}}
\DoxyCodeLine{06757\ \}}
\DoxyCodeLine{06758\ }
\DoxyCodeLine{06759\ \textcolor{preprocessor}{\#if\ !defined(GTEST\_CUSTOM\_TEMPDIR\_FUNCTION\_)}}
\DoxyCodeLine{06760\ \textcolor{comment}{//\ Return\ value\ of\ first\ environment\ variable\ that\ is\ set\ and\ contains}}
\DoxyCodeLine{06761\ \textcolor{comment}{//\ a\ non-\/empty\ string.\ If\ there\ are\ none,\ return\ the\ "{}fallback"{}\ string.}}
\DoxyCodeLine{06762\ \textcolor{comment}{//\ Since\ we\ like\ the\ temporary\ directory\ to\ have\ a\ directory\ separator\ suffix,}}
\DoxyCodeLine{06763\ \textcolor{comment}{//\ add\ it\ if\ not\ provided\ in\ the\ environment\ variable\ value.}}
\DoxyCodeLine{06764\ \textcolor{keyword}{static}\ std::string\ GetTempDirFromEnv(}
\DoxyCodeLine{06765\ \ \ \ \ std::initializer\_list<const\ char*>\ environment\_variables,}
\DoxyCodeLine{06766\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ fallback,\ \textcolor{keywordtype}{char}\ separator)\ \{}
\DoxyCodeLine{06767\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ variable\_name\ :\ environment\_variables)\ \{}
\DoxyCodeLine{06768\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ value\ =\ internal::posix::GetEnv(variable\_name);}
\DoxyCodeLine{06769\ \ \ \ \ \textcolor{keywordflow}{if}\ (value\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ value[0]\ !=\ \textcolor{charliteral}{'\(\backslash\)0'})\ \{}
\DoxyCodeLine{06770\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (value[strlen(value)\ -\/\ 1]\ !=\ separator)\ \{}
\DoxyCodeLine{06771\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::string(value).append(1,\ separator);}
\DoxyCodeLine{06772\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06773\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ value;}
\DoxyCodeLine{06774\ \ \ \ \ \}}
\DoxyCodeLine{06775\ \ \ \}}
\DoxyCodeLine{06776\ \ \ \textcolor{keywordflow}{return}\ fallback;}
\DoxyCodeLine{06777\ \}}
\DoxyCodeLine{06778\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{06779\ }
\DoxyCodeLine{06780\ std::string\ TempDir()\ \{}
\DoxyCodeLine{06781\ \textcolor{preprocessor}{\#if\ defined(GTEST\_CUSTOM\_TEMPDIR\_FUNCTION\_)}}
\DoxyCodeLine{06782\ \ \ \textcolor{keywordflow}{return}\ GTEST\_CUSTOM\_TEMPDIR\_FUNCTION\_();}
\DoxyCodeLine{06783\ \textcolor{preprocessor}{\#elif\ GTEST\_OS\_WINDOWS\ ||\ GTEST\_OS\_WINDOWS\_MOBILE}}
\DoxyCodeLine{06784\ \ \ \textcolor{keywordflow}{return}\ GetTempDirFromEnv(\{\textcolor{stringliteral}{"{}TEST\_TMPDIR"{}},\ \textcolor{stringliteral}{"{}TEMP"{}}\},\ \textcolor{stringliteral}{"{}\(\backslash\)\(\backslash\)temp\(\backslash\)\(\backslash\)"{}},\ \textcolor{charliteral}{'\(\backslash\)\(\backslash\)'});}
\DoxyCodeLine{06785\ \textcolor{preprocessor}{\#elif\ GTEST\_OS\_LINUX\_ANDROID}}
\DoxyCodeLine{06786\ \ \ \textcolor{keywordflow}{return}\ GetTempDirFromEnv(\{\textcolor{stringliteral}{"{}TEST\_TMPDIR"{}},\ \textcolor{stringliteral}{"{}TMPDIR"{}}\},\ \textcolor{stringliteral}{"{}/data/local/tmp/"{}},\ \textcolor{charliteral}{'/'});}
\DoxyCodeLine{06787\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{06788\ \ \ \textcolor{keywordflow}{return}\ GetTempDirFromEnv(\{\textcolor{stringliteral}{"{}TEST\_TMPDIR"{}},\ \textcolor{stringliteral}{"{}TMPDIR"{}}\},\ \textcolor{stringliteral}{"{}/tmp/"{}},\ \textcolor{charliteral}{'/'});}
\DoxyCodeLine{06789\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{06790\ \}}
\DoxyCodeLine{06791\ }
\DoxyCodeLine{06792\ \textcolor{comment}{//\ Class\ ScopedTrace}}
\DoxyCodeLine{06793\ }
\DoxyCodeLine{06794\ \textcolor{comment}{//\ Pushes\ the\ given\ source\ file\ location\ and\ message\ onto\ a\ per-\/thread}}
\DoxyCodeLine{06795\ \textcolor{comment}{//\ trace\ stack\ maintained\ by\ Google\ Test.}}
\DoxyCodeLine{06796\ \textcolor{keywordtype}{void}\ ScopedTrace::PushTrace(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ file,\ \textcolor{keywordtype}{int}\ line,\ std::string\ message)\ \{}
\DoxyCodeLine{06797\ \ \ internal::TraceInfo\ trace;}
\DoxyCodeLine{06798\ \ \ trace.file\ =\ file;}
\DoxyCodeLine{06799\ \ \ trace.line\ =\ line;}
\DoxyCodeLine{06800\ \ \ trace.message.swap(message);}
\DoxyCodeLine{06801\ }
\DoxyCodeLine{06802\ \ \ UnitTest::GetInstance()-\/>PushGTestTrace(trace);}
\DoxyCodeLine{06803\ \}}
\DoxyCodeLine{06804\ }
\DoxyCodeLine{06805\ \textcolor{comment}{//\ Pops\ the\ info\ pushed\ by\ the\ c'tor.}}
\DoxyCodeLine{06806\ ScopedTrace::\string~ScopedTrace()\ GTEST\_LOCK\_EXCLUDED\_(\&UnitTest::mutex\_)\ \{}
\DoxyCodeLine{06807\ \ \ UnitTest::GetInstance()-\/>PopGTestTrace();}
\DoxyCodeLine{06808\ \}}
\DoxyCodeLine{06809\ }
\DoxyCodeLine{06810\ \}\ \ \textcolor{comment}{//\ namespace\ testing}}

\end{DoxyCode}
